cscope 15 $HOME/Researches/VirtualTimeKernel/iputils -q 0000006664 0000530009
	@SNAPSHOT.h

1 
	gSNAPSHOT
[] = "s20121221";

	@arping.c

13 
	~<¡dlib.h
>

14 
	~<sys/·¿m.h
>

15 
	~<sys/sock‘.h
>

16 
	~<lšux/sockios.h
>

17 
	~<sys/fe.h
>

18 
	~<sys/time.h
>

19 
	~<sys/sigÇl.h
>

20 
	~<sys/ioùl.h
>

21 
	~<Ãt/if.h
>

22 
	~<lšux/if_·ck‘.h
>

23 
	~<lšux/if_‘h”.h
>

24 
	~<Ãt/if_¬p.h
>

25 
	~<sys/uio.h
>

26 #ifdeà
CAPABILITIES


27 
	~<sys/´ùl.h
>

28 
	~<sys/ÿ·b™y.h
>

31 
	~<Ãtdb.h
>

32 
	~<uni¡d.h
>

33 
	~<¡dio.h
>

34 
	~<ùy³.h
>

35 
	~<”ºo.h
>

36 
	~<¡ršg.h
>

37 
	~<Ãtš‘/š.h
>

38 
	~<¬·/š‘.h
>

40 #ifdeà
USE_SYSFS


41 
	~<sysfs/libsysfs.h
>

42 
	gsysfs_dev©Œ_v®ues
;

45 #iâdeà
WITHOUT_IFADDRS


46 
	~<içddrs.h
>

49 #ifdeà
USE_IDN


50 
	~<idÇ.h
>

51 
	~<loÿË.h
>

54 
	~"SNAPSHOT.h
"

56 
	$u§ge
(è
	`__©Œibu‹__
((
nÜ‘uº
));

58 #ifdeà
DEFAULT_DEVICE


59 
	#DEFAULT_DEVICE_STR
 
DEFAULT_DEVICE


	)

61 
	#DEFAULT_DEVICE
 
NULL


	)

64 
	sdeviû
 {

65 *
Çme
;

66 
ifšdex
;

67 #iâdeà
WITHOUT_IFADDRS


68 
içddrs
 *
iç
;

70 #ifdeà
USE_SYSFS


71 
sysfs_dev©Œ_v®ues
 *
sysfs
;

75 
qu™_Ú_»¶y
=0;

76 
deviû
 device = {

77 .
Çme
 = 
DEFAULT_DEVICE
,

78 
	}
};

79 *
	gsourû
;

80 
š_addr
 
	g¤c
, 
	gd¡
;

81 *
	grg‘
;

82 
	gdad
, 
	gunsŞic™ed
, 
	gadv”t
;

83 
	gqu›t
;

84 
	gcouÁ
=-1;

85 
	gtimeout
;

86 
	guniÿ¡šg
;

87 
	gs
;

88 
	gbrßdÿ¡_Úly
;

90 
sockaddr_¡Üage
 
	gme
;

91 
sockaddr_¡Üage
 
	ghe
;

93 
timev®
 
	g¡¬t
, 
	gÏ¡
;

95 
	g£Á
, 
	gbrd_£Á
;

96 
	g»ûived
, 
	gbrd_»cv
, 
	g»q_»cv
;

98 #iâdeà
CAPABILITIES


99 
uid_t
 
	geuid
;

102 
	#MS_TDIFF
(
tv1
,
tv2
èĞ(Ñv1).
tv_£c
-(tv2).tv_sec)*1000 + \

103 ((
tv1
).
tv_u£c
-(
tv2
).tv_u£c)/1000 )

	)

105 
	#OFFSET_OF
(
Çme
,
–e
è((
size_t
)((Òam*)0)->–e))

	)

107 
šlše
 
sockËn_t
 
	$¦l_Ën
(
size_t
 
h®’
)

109 
sockËn_t
 
Ën
 = 
	`OFFSET_OF
(
sockaddr_Î
, 
¦l_addr
è+ 
h®’
;

110 ià(
Ën
 < (
sockaddr_Î
))

111 
Ën
 = (
sockaddr_Î
);

112  
Ën
;

113 
	}
}

115 
	#SLL_LEN
(
hÊ
è
	`¦l_Ën
(hÊ)

	)

117 
	$u§ge
()

119 
	`årštf
(
¡d”r
,

131 #ifdeà
DEFAULT_DEVICE_STR


132 " (" 
DEFAULT_DEVICE_STR
 ")"

138 
	`ex™
(2);

139 
	}
}

141 
£t_sigÇl
(
signo
, (*
hªdËr
)())

143 
sigaùiÚ
 
§
;

145 
	`mem£t
(&
§
, 0, (sa));

146 
§
.
§_hªdËr
 = ((*)())
hªdËr
;

147 
§
.
§_æags
 = 
SA_RESTART
;

148 
	`sigaùiÚ
(
signo
, &
§
, 
NULL
);

149 
	}
}

151 #ifdeà
CAPABILITIES


152 cÚ¡ 
ÿp_v®ue_t
 
	gÿps
[] = { 
CAP_NET_RAW
, };

153 
ÿp_æag_v®ue_t
 
	gÿp_¿w
 = 
CAP_CLEAR
;

156 
	$lim™_ÿ·b™›s
()

158 #ifdeà
CAPABILITIES


159 
ÿp_t
 
ÿp_p
;

161 
ÿp_p
 = 
	`ÿp_g‘_´oc
();

162 ià(!
ÿp_p
) {

163 
	`³¼Ü
("arping: cap_get_proc");

164 
	`ex™
(-1);

167 
	`ÿp_g‘_æag
(
ÿp_p
, 
CAP_NET_RAW
, 
CAP_PERMITTED
, &
ÿp_¿w
);

169 ià(
ÿp_¿w
 !ğ
CAP_CLEAR
) {

170 ià(
	`ÿp_ş—r
(
ÿp_p
) < 0) {

171 
	`³¼Ü
("arping: cap_clear");

172 
	`ex™
(-1);

175 
	`ÿp_£t_æag
(
ÿp_p
, 
CAP_PERMITTED
, 1, 
ÿps
, 
CAP_SET
);

177 ià(
	`ÿp_£t_´oc
(
ÿp_p
) < 0) {

178 
	`³¼Ü
("arping: cap_set_proc");

179 ià(
”ºo
 !ğ
EPERM
)

180 
	`ex™
(-1);

184 ià(
	`´ùl
(
PR_SET_KEEPCAPS
, 1) < 0) {

185 
	`³¼Ü
("arping:…rctl");

186 
	`ex™
(-1);

189 ià(
	`£tuid
(
	`g‘uid
()) < 0) {

190 
	`³¼Ü
("arping: setuid");

191 
	`ex™
(-1);

194 ià(
	`´ùl
(
PR_SET_KEEPCAPS
, 0) < 0) {

195 
	`³¼Ü
("arping:…rctl");

196 
	`ex™
(-1);

199 
	`ÿp_ä“
(
ÿp_p
);

201 
euid
 = 
	`g‘euid
();

203 
	}
}

205 
	$modify_ÿ·b™y_¿w
(
Ú
)

207 #ifdeà
CAPABILITIES


208 
ÿp_t
 
ÿp_p
;

210 ià(
ÿp_¿w
 !ğ
CAP_SET
)

211  
Ú
 ? -1 : 0;

213 
ÿp_p
 = 
	`ÿp_g‘_´oc
();

214 ià(!
ÿp_p
) {

215 
	`³¼Ü
("arping: cap_get_proc");

219 
	`ÿp_£t_æag
(
ÿp_p
, 
CAP_EFFECTIVE
, 1, 
ÿps
, 
Ú
 ? 
CAP_SET
 : 
CAP_CLEAR
);

221 ià(
	`ÿp_£t_´oc
(
ÿp_p
) < 0) {

222 
	`³¼Ü
("arping: cap_set_proc");

226 
	`ÿp_ä“
(
ÿp_p
);

228 ià(
	`£tuid
(
Ú
 ? 
euid
 : 
	`g‘uid
())) {

229 
	`³¼Ü
("arping: setuid");

234 
	}
}

236 
šlše
 
	$’abË_ÿ·b™y_¿w
()

238  
	`modify_ÿ·b™y_¿w
(1);

239 
	}
}

241 
šlše
 
	$di§bË_ÿ·b™y_¿w
()

243  
	`modify_ÿ·b™y_¿w
(0);

244 
	}
}

246 
	$drİ_ÿ·b™›s
()

248 #ifdeà
CAPABILITIES


249 
ÿp_t
 
ÿp_p
 = 
	`ÿp_š™
();

251 ià(!
ÿp_p
) {

252 
	`³¼Ü
("arping: cap_init");

253 
	`ex™
(-1);

256 ià(
	`ÿp_£t_´oc
(
ÿp_p
) < 0) {

257 
	`³¼Ü
("arping: cap_set_proc");

258 
	`ex™
(-1);

261 
	`ÿp_ä“
(
ÿp_p
);

263 ià(
	`£tuid
(
	`g‘uid
()) < 0) {

264 
	`³¼Ü
("arping: setuid");

265 
	`ex™
(-1);

268 
	}
}

270 
	$£nd_·ck
(
s
, 
š_addr
 
¤c
, š_add¸
d¡
,

271 
sockaddr_Î
 *
ME
, sockaddr_Î *
HE
)

273 
”r
;

274 
timev®
 
now
;

275 
buf
[256];

276 
¬phdr
 *
ah
 = (¬phdr*)
buf
;

277 *
p
 = (*)(
ah
+1);

279 
ah
->
¬_hrd
 = 
	`htÚs
(
ME
->
¦l_h©y³
);

280 ià(
ah
->
¬_hrd
 =ğ
	`htÚs
(
ARPHRD_FDDI
))

281 
ah
->
¬_hrd
 = 
	`htÚs
(
ARPHRD_ETHER
);

282 
ah
->
¬_´o
 = 
	`htÚs
(
ETH_P_IP
);

283 
ah
->
¬_hÊ
 = 
ME
->
¦l_h®’
;

284 
ah
->
¬_¶n
 = 4;

285 
ah
->
¬_İ
 = 
adv”t
 ? 
	`htÚs
(
ARPOP_REPLY
è: htÚs(
ARPOP_REQUEST
);

287 
	`memıy
(
p
, &
ME
->
¦l_addr
, 
ah
->
¬_hÊ
);

288 
p
+=
ME
->
¦l_h®’
;

290 
	`memıy
(
p
, &
¤c
, 4);

291 
p
+=4;

293 ià(
adv”t
)

294 
	`memıy
(
p
, &
ME
->
¦l_addr
, 
ah
->
¬_hÊ
);

296 
	`memıy
(
p
, &
HE
->
¦l_addr
, 
ah
->
¬_hÊ
);

297 
p
+=
ah
->
¬_hÊ
;

299 
	`memıy
(
p
, &
d¡
, 4);

300 
p
+=4;

302 
	`g‘timeofday
(&
now
, 
NULL
);

303 
”r
 = 
	`£ndto
(
s
, 
buf
, 
p
-buf, 0, (
sockaddr
*)
HE
, 
	`SLL_LEN
(
ah
->
¬_hÊ
));

304 ià(
”r
 =ğ
p
-
buf
) {

305 
Ï¡
 = 
now
;

306 
£Á
++;

307 ià(!
uniÿ¡šg
)

308 
brd_£Á
++;

310  
”r
;

311 
	}
}

313 
	$fšish
()

315 ià(!
qu›t
) {

316 
	`´štf
("S’ˆ%d…robe (%d brßdÿ¡(s))\n", 
£Á
, 
brd_£Á
);

317 
	`´štf
("Reûived %d„e¥Ú£(s)", 
»ûived
);

318 ià(
brd_»cv
 || 
»q_»cv
) {

319 
	`´štf
(" (");

320 ià(
»q_»cv
)

321 
	`´štf
("%d„eque¡(s)", 
»q_»cv
);

322 ià(
brd_»cv
)

323 
	`´štf
("%s%d broadcast(s)",

324 
»q_»cv
 ? ", " : "",

325 
brd_»cv
);

326 
	`´štf
(")");

328 
	`´štf
("\n");

329 
	`fæush
(
¡dout
);

331 ià(
dad
)

332 
	`ex™
(!!
»ûived
);

333 ià(
unsŞic™ed
)

334 
	`ex™
(0);

335 
	`ex™
(!
»ûived
);

336 
	}
}

338 
	$ÿtch”
()

340 
timev®
 
tv
, 
tv_s
, 
tv_o
;

342 
	`g‘timeofday
(&
tv
, 
NULL
);

344 ià(
¡¬t
.
tv_£c
==0)

345 
¡¬t
 = 
tv
;

347 
	`tim”sub
(&
tv
, &
¡¬t
, &
tv_s
);

348 
tv_o
.
tv_£c
 = 
timeout
;

349 
tv_o
.
tv_u£c
 = 500 * 1000;

351 ià(
couÁ
-- =ğ0 || (
timeout
 && 
	`tim”cmp
(&
tv_s
, &
tv_o
, >)))

352 
	`fšish
();

354 
	`tim”sub
(&
tv
, &
Ï¡
, &
tv_s
);

355 
tv_o
.
tv_£c
 = 0;

357 ià(
Ï¡
.
tv_£c
==0 || 
	`tim”cmp
(&
tv_s
, &
tv_o
, >)) {

358 
	`£nd_·ck
(
s
, 
¤c
, 
d¡
,

359 (
sockaddr_Î
 *)&
me
, (sockaddr_Î *)&
he
);

360 ià(
couÁ
 =ğ0 && 
unsŞic™ed
)

361 
	`fšish
();

363 
	`®¬m
(1);

364 
	}
}

366 
	$´št_hex
(*
p
, 
Ën
)

368 
i
;

369 
i
=0; i<
Ën
; i++) {

370 
	`´štf
("%02X", 
p
[
i
]);

371 ià(
i
 !ğ
Ën
-1)

372 
	`´štf
(":");

374 
	}
}

376 
	$»cv_·ck
(*
buf
, 
Ën
, 
sockaddr_Î
 *
FROM
)

378 
timev®
 
tv
;

379 
¬phdr
 *
ah
 = (¬phdr*)
buf
;

380 *
p
 = (*)(
ah
+1);

381 
š_addr
 
¤c_
, 
d¡_
;

383 
	`g‘timeofday
(&
tv
, 
NULL
);

386 ià(
FROM
->
¦l_pk‰y³
 !ğ
PACKET_HOST
 &&

387 
FROM
->
¦l_pk‰y³
 !ğ
PACKET_BROADCAST
 &&

388 
FROM
->
¦l_pk‰y³
 !ğ
PACKET_MULTICAST
)

392 ià(
ah
->
¬_İ
 !ğ
	`htÚs
(
ARPOP_REQUEST
) &&

393 
ah
->
¬_İ
 !ğ
	`htÚs
(
ARPOP_REPLY
))

397 ià(
ah
->
¬_hrd
 !ğ
	`htÚs
(
FROM
->
¦l_h©y³
) &&

398 (
FROM
->
¦l_h©y³
 !ğ
ARPHRD_FDDI
 || 
ah
->
¬_hrd
 !ğ
	`htÚs
(
ARPHRD_ETHER
)))

402 ià(
ah
->
¬_´o
 !ğ
	`htÚs
(
ETH_P_IP
))

404 ià(
ah
->
¬_¶n
 != 4)

406 ià(
ah
->
¬_hÊ
 !ğ((
sockaddr_Î
 *)&
me
)->
¦l_h®’
)

408 ià(
Ën
 < (*
ah
è+ 2*(4 +‡h->
¬_hÊ
))

410 
	`memıy
(&
¤c_
, 
p
+
ah
->
¬_hÊ
, 4);

411 
	`memıy
(&
d¡_
, 
p
+
ah
->
¬_hÊ
+4+ah->ar_hln, 4);

412 ià(!
dad
) {

413 ià(
¤c_
.
s_addr
 !ğ
d¡
.s_addr)

415 ià(
¤c
.
s_addr
 !ğ
d¡_
.s_addr)

417 ià(
	`memcmp
(
p
+
ah
->
¬_hÊ
+4, ((
sockaddr_Î
 *)&
me
)->
¦l_addr
,‡h->ar_hln))

433 ià(
¤c_
.
s_addr
 !ğ
d¡
.s_addr)

435 ià(
	`memcmp
(
p
, ((
sockaddr_Î
 *)&
me
)->
¦l_addr
, ((sockaddr_Î *)&me)->
¦l_h®’
) == 0)

437 ià(
¤c
.
s_addr
 && src.s_add¸!ğ
d¡_
.s_addr)

440 ià(!
qu›t
) {

441 
s_´š‹d
 = 0;

442 
	`´štf
("% ", 
FROM
->
¦l_pk‰y³
==
PACKET_HOST
 ? "Unicast" : "Broadcast");

443 
	`´štf
("% äom ", 
ah
->
¬_İ
 =ğ
	`htÚs
(
ARPOP_REPLY
) ? "reply" : "request");

444 
	`´štf
("% [", 
	`š‘_Áß
(
¤c_
));

445 
	`´št_hex
(
p
, 
ah
->
¬_hÊ
);

446 
	`´štf
("] ");

447 ià(
d¡_
.
s_addr
 !ğ
¤c
.s_addr) {

448 
	`´štf
("fÜ % ", 
	`š‘_Áß
(
d¡_
));

449 
s_´š‹d
 = 1;

451 ià(
	`memcmp
(
p
+
ah
->
¬_hÊ
+4, ((
sockaddr_Î
 *)&
me
)->
¦l_addr
,‡h->ar_hln)) {

452 ià(!
s_´š‹d
)

453 
	`´štf
("for ");

454 
	`´štf
("[");

455 
	`´št_hex
(
p
+
ah
->
¬_hÊ
+4,‡h->ar_hln);

456 
	`´štf
("]");

458 ià(
Ï¡
.
tv_£c
) {

459 
u£cs
 = (
tv
.
tv_£c
-
Ï¡
.tv_sec) * 1000000 +

460 
tv
.
tv_u£c
-
Ï¡
.tv_usec;

461 
m£cs
 = (
u£cs
+500)/1000;

462 
u£cs
 -ğ
m£cs
*1000 - 500;

463 
	`´štf
(" %ld.%03ldms\n", 
m£cs
, 
u£cs
);

465 
	`´štf
(" UNSOLICITED?\n");

467 
	`fæush
(
¡dout
);

469 
»ûived
++;

470 ià(
FROM
->
¦l_pk‰y³
 !ğ
PACKET_HOST
)

471 
brd_»cv
++;

472 ià(
ah
->
¬_İ
 =ğ
	`htÚs
(
ARPOP_REQUEST
))

473 
»q_»cv
++;

474 ià(
qu™_Ú_»¶y
)

475 
	`fšish
();

476 if(!
brßdÿ¡_Úly
) {

477 
	`memıy
(((
sockaddr_Î
 *)&
he
)->
¦l_addr
, 
p
, ((sockaddr_Î *)&
me
)->
¦l_h®’
);

478 
uniÿ¡šg
=1;

481 
	}
}

483 #ifdeà
USE_SYSFS


484 
	usysfs_dev©Œ_v®ue
 {

485 
	mulÚg
;

486 *
	m±r
;

490 
	mSYSFS_DEVATTR_IFINDEX
,

491 
	mSYSFS_DEVATTR_FLAGS
,

492 
	mSYSFS_DEVATTR_ADDR_LEN
,

494 
	mSYSFS_DEVATTR_TYPE
,

495 
	mSYSFS_DEVATTR_ADDRESS
,

497 
	mSYSFS_DEVATTR_BROADCAST
,

498 
	mSYSFS_DEVATTR_NUM


501 
	ssysfs_dev©Œ_v®ues


503 *
	miâame
;

504 
sysfs_dev©Œ_v®ue
 
	mv®ue
[
SYSFS_DEVATTR_NUM
];

507 
sysfs_dev©Œ_ulÚg_dec
(*
±r
, 
sysfs_dev©Œ_v®ues
 *
v
, 
idx
);

508 
sysfs_dev©Œ_ulÚg_hex
(*
±r
, 
sysfs_dev©Œ_v®ues
 *
v
, 
idx
);

509 
sysfs_dev©Œ_maÿddr
(*
±r
, 
sysfs_dev©Œ_v®ues
 *
v
, 
idx
);

511 
	ssysfs_dev©Œs
 {

512 cÚ¡ *
	mÇme
;

513 (*
	mhªdËr
)(*
	m±r
, 
sysfs_dev©Œ_v®ues
 *
	mv
, 
	midx
);

514 
	mä“
;

515 } 
	gsysfs_dev©Œs
[
SYSFS_DEVATTR_NUM
] = {

516 [
SYSFS_DEVATTR_IFINDEX
] = {

517 .
Çme
 = "ifindex",

518 .
	ghªdËr
 = 
sysfs_dev©Œ_ulÚg_dec
,

520 [
SYSFS_DEVATTR_ADDR_LEN
] = {

521 .
Çme
 = "addr_len",

522 .
	ghªdËr
 = 
sysfs_dev©Œ_ulÚg_dec
,

524 [
SYSFS_DEVATTR_FLAGS
] = {

525 .
Çme
 = "flags",

526 .
	ghªdËr
 = 
sysfs_dev©Œ_ulÚg_hex
,

529 [
SYSFS_DEVATTR_TYPE
] = {

530 .
Çme
 = "type",

531 .
	ghªdËr
 = 
sysfs_dev©Œ_ulÚg_dec
,

533 [
SYSFS_DEVATTR_ADDRESS
] = {

534 .
Çme
 = "address",

535 .
	ghªdËr
 = 
sysfs_dev©Œ_maÿddr
,

536 .
	gä“
 = 1,

539 [
SYSFS_DEVATTR_BROADCAST
] = {

540 .
Çme
 = "broadcast",

541 .
	ghªdËr
 = 
sysfs_dev©Œ_maÿddr
,

542 .
	gä“
 = 1,

573 
	$check_ifæags
(
ifæags
, 
çl
)

575 ià(!(
ifæags
 & 
IFF_UP
)) {

576 ià(
çl
) {

577 ià(!
qu›t
)

578 
	`´štf
("IÁ”çû \"%s\" i down\n", 
deviû
.
Çme
);

579 
	`ex™
(2);

583 ià(
ifæags
 & (
IFF_NOARP
 | 
IFF_LOOPBACK
)) {

584 ià(
çl
) {

585 ià(!
qu›t
)

586 
	`´štf
("IÁ”çû \"%s\" i nÙ ARPabË\n", 
deviû
.
Çme
);

587 
	`ex™
(
dad
 ? 0 : 2);

592 
	}
}

594 
	$fšd_deviû_by_içddrs
()

596 #iâdeà
WITHOUT_IFADDRS


597 
rc
;

598 
içddrs
 *
iç0
, *
iç
;

599 
couÁ
 = 0;

601 
rc
 = 
	`g‘içddrs
(&
iç0
);

602 ià(
rc
) {

603 
	`³¼Ü
("getifaddrs");

607 
iç
 = 
iç0
; iç; iç = iç->
iç_Ãxt
) {

608 ià(!
iç
->
iç_addr
)

610 ià(
iç
->
iç_addr
->
§_çmy
 !ğ
AF_PACKET
)

612 ià(
deviû
.
Çme
 && 
iç
->
iç_Çme
 && 
	`¡rcmp
(ifa->ifa_name, device.name))

615 ià(
	`check_ifæags
(
iç
->
iç_æags
, 
deviû
.
Çme
 !ğ
NULL
) < 0)

618 ià(!((
sockaddr_Î
 *)
iç
->
iç_addr
)->
¦l_h®’
)

620 ià(!
iç
->
iç_brßdaddr
)

623 
deviû
.
iç
 = ifa;

625 ià(
couÁ
++)

629 ià(
couÁ
 =ğ1 && 
deviû
.
iç
) {

630 
deviû
.
ifšdex
 = 
	`if_Çm‘ošdex
(deviû.
iç
->
iç_Çme
);

631 ià(!
deviû
.
ifšdex
) {

632 
	`³¼Ü
("arping: if_nametoindex");

633 
	`ä“içddrs
(
iç0
);

636 
deviû
.
Çme
 = deviû.
iç
->
iç_Çme
;

643 
	}
}

645 #ifdeà
USE_SYSFS


646 
	$sysfs_dev©Œ_v®ues_š™
(
sysfs_dev©Œ_v®ues
 *
v
, 
do_ä“
)

648 
i
;

649 ià(
do_ä“
) {

650 
	`ä“
(
v
->
iâame
);

651 
i
 = 0; i < 
SYSFS_DEVATTR_NUM
; i++) {

652 ià(
sysfs_dev©Œs
[
i
].
ä“
)

653 
	`ä“
(
v
->
v®ue
[
i
].
±r
);

656 
	`mem£t
(
v
, 0, (*v));

657 
	}
}

659 
	$sysfs_dev©Œ_ulÚg
(*
±r
, 
sysfs_dev©Œ_v®ues
 *
v
, 
idx
,

660 
ba£
)

662 *
p
;

663 *
•
;

665 ià(!
±r
 || !
v
)

668 
p
 = &
v
->
v®ue
[
idx
].
ulÚg
;

669 
”ºo
 = 0;

670 *
p
 = 
	`¡¹oul
(
±r
, &
•
, 
ba£
);

671 ià((*
±r
 && 
	`is¥aû
(*±¸& 0xff)è|| 
”ºo
 || (*
•
 != '\0' && *ep != '\n'))

672 
out
;

675 
out
:

677 
	}
}

679 
	$sysfs_dev©Œ_ulÚg_dec
(*
±r
, 
sysfs_dev©Œ_v®ues
 *
v
, 
idx
)

681 
rc
 = 
	`sysfs_dev©Œ_ulÚg
(
±r
, 
v
, 
idx
, 10);

682  
rc
;

683 
	}
}

685 
	$sysfs_dev©Œ_ulÚg_hex
(*
±r
, 
sysfs_dev©Œ_v®ues
 *
v
, 
idx
)

687 
rc
 = 
	`sysfs_dev©Œ_ulÚg
(
±r
, 
v
, 
idx
, 16);

688  
rc
;

689 
	}
}

691 
	$sysfs_dev©Œ_maÿddr
(*
±r
, 
sysfs_dev©Œ_v®ues
 *
v
, 
idx
)

693 *
m
;

694 
i
;

695 
add¾’
;

697 ià(!
±r
 || !
v
)

700 
add¾’
 = 
v
->
v®ue
[
SYSFS_DEVATTR_ADDR_LEN
].
ulÚg
;

701 
m
 = 
	`m®loc
(
add¾’
);

703 
i
 = 0; i < 
add¾’
; i++) {

704 ià(
i
 && *(
±r
 + i * 3 - 1) != ':')

705 
out
;

706 ià(
	`ssÿnf
(
±r
 + 
i
 * 3, "%02hhx", &
m
[i]) != 1)

707 
out
;

710 
v
->
v®ue
[
idx
].
±r
 = 
m
;

712 
out
:

713 
	`ä“
(
m
);

715 
	}
}

718 
	$fšd_deviû_by_sysfs
()

720 
rc
 = -1;

721 #ifdeà
USE_SYSFS


722 
sysfs_şass
 *
şs_Ãt
;

723 
dli¡
 *
dev_li¡
;

724 
sysfs_şass_deviû
 *
dev
;

725 
sysfs_©Œibu‹
 *
dev_©Œ
;

726 
sysfs_dev©Œ_v®ues
 sysfs_devattr_values;

727 
couÁ
 = 0;

729 ià(!
deviû
.
sysfs
) {

730 
deviû
.
sysfs
 = 
	`m®loc
((*device.sysfs));

731 
	`sysfs_dev©Œ_v®ues_š™
(
deviû
.
sysfs
, 0);

734 
şs_Ãt
 = 
	`sysfs_İ’_şass
("net");

735 ià(!
şs_Ãt
) {

736 
	`³¼Ü
("sysfs_open_class");

740 
dev_li¡
 = 
	`sysfs_g‘_şass_deviûs
(
şs_Ãt
);

741 ià(!
dev_li¡
) {

742 
	`³¼Ü
("sysfs_get_class_devices");

743 
out
;

746 
	`sysfs_dev©Œ_v®ues_š™
(&
sysfs_dev©Œ_v®ues
, 0);

748 
	`dli¡_fÜ_—ch_d©a
(
dev_li¡
, 
dev
, 
sysfs_şass_deviû
) {

749 
i
;

750 
rc
 = -1;

752 ià(
deviû
.
Çme
 && 
	`¡rcmp
(
dev
->name, device.name))

753 
do_Ãxt
;

755 
	`sysfs_dev©Œ_v®ues_š™
(&
sysfs_dev©Œ_v®ues
, 1);

757 
i
 = 0; i < 
SYSFS_DEVATTR_NUM
; i++) {

759 
dev_©Œ
 = 
	`sysfs_g‘_şassdev_©Œ
(
dev
, 
sysfs_dev©Œs
[
i
].
Çme
);

760 ià(!
dev_©Œ
) {

761 
	`³¼Ü
("sysfs_get_classdev_attr");

762 
rc
 = -1;

765 ià(
	`sysfs_»ad_©Œibu‹
(
dev_©Œ
)) {

766 
	`³¼Ü
("sysfs_read_attribute");

767 
rc
 = -1;

770 
rc
 = 
sysfs_dev©Œs
[
i
].
	`hªdËr
(
dev_©Œ
->
v®ue
, &
sysfs_dev©Œ_v®ues
, i);

772 ià(
rc
 < 0)

776 ià(
rc
 < 0)

777 
do_Ãxt
;

779 ià(
	`check_ifæags
(
sysfs_dev©Œ_v®ues
.
v®ue
[
SYSFS_DEVATTR_FLAGS
].
ulÚg
,

780 
deviû
.
Çme
 !ğ
NULL
) < 0)

781 
do_Ãxt
;

783 ià(!
sysfs_dev©Œ_v®ues
.
v®ue
[
SYSFS_DEVATTR_ADDR_LEN
].
ulÚg
)

784 
do_Ãxt
;

786 ià(
deviû
.
sysfs
->
v®ue
[
SYSFS_DEVATTR_IFINDEX
].
ulÚg
) {

787 ià(
deviû
.
sysfs
->
v®ue
[
SYSFS_DEVATTR_FLAGS
].
ulÚg
 & 
IFF_RUNNING
)

788 
do_Ãxt
;

791 
sysfs_dev©Œ_v®ues
.
iâame
 = 
	`¡rdup
(
dev
->
Çme
);

792 ià(!
sysfs_dev©Œ_v®ues
.
iâame
) {

793 
	`³¼Ü
("malloc");

794 
out
;

797 
	`sysfs_dev©Œ_v®ues_š™
(
deviû
.
sysfs
, 1);

798 
	`memıy
(
deviû
.
sysfs
, &
sysfs_dev©Œ_v®ues
, (*device.sysfs));

799 
	`sysfs_dev©Œ_v®ues_š™
(&
sysfs_dev©Œ_v®ues
, 0);

801 ià(
couÁ
++)

805 
do_Ãxt
:

806 
	`sysfs_dev©Œ_v®ues_š™
(&
sysfs_dev©Œ_v®ues
, 1);

809 ià(
couÁ
 == 1) {

810 
deviû
.
ifšdex
 = deviû.
sysfs
->
v®ue
[
SYSFS_DEVATTR_IFINDEX
].
ulÚg
;

811 
deviû
.
Çme
 = deviû.
sysfs
->
iâame
;

813 
rc
 = !
deviû
.
ifšdex
;

814 
out
:

815 
	`sysfs_şo£_şass
(
şs_Ãt
);

817  
rc
;

818 
	}
}

820 
	$check_deviû_by_ioùl
(
s
, 
iäeq
 *
iä
)

822 ià(
	`ioùl
(
s
, 
SIOCGIFFLAGS
, 
iä
) < 0) {

823 
	`³¼Ü
("ioctl(SIOCGIFINDEX");

827 ià(
	`check_ifæags
(
iä
->
iä_æags
, 
deviû
.
Çme
 !ğ
NULL
) < 0)

830 ià(
	`ioùl
(
s
, 
SIOCGIFINDEX
, 
iä
) < 0) {

831 
	`³¼Ü
("ioctl(SIOCGIFINDEX");

836 
	}
}

838 
	$fšd_deviû_by_ioùl
()

840 
s
;

841 
iäeq
 *
iä0
, *
iä
, *
iä_’d
;

842 
size_t
 
iäsize
 = (*
iä
);

843 
ifcÚf
 
ifc
;

844 
iäeq
 
iäbuf
;

845 
couÁ
 = 0;

847 
s
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

848 ià(
s
 < 0) {

849 
	`³¼Ü
("socket");

853 
	`mem£t
(&
iäbuf
, 0, (ifrbuf));

855 ià(
deviû
.
Çme
) {

856 
	`¡ºıy
(
iäbuf
.
iä_Çme
, 
deviû
.
Çme
, (ifrbuf.ifr_name) - 1);

857 ià(
	`check_deviû_by_ioùl
(
s
, &
iäbuf
))

858 
out
;

859 
couÁ
++;

862 
rc
;

863 
iä0
 = 
	`m®loc
(
iäsize
);

864 ià(!
iä0
) {

865 
	`³¼Ü
("malloc");

866 
out
;

869 
ifc
.
ifc_buf
 = (*)
iä0
;

870 
ifc
.
ifc_Ën
 = 
iäsize
;

872 
rc
 = 
	`ioùl
(
s
, 
SIOCGIFCONF
, &
ifc
);

873 ià(
rc
 < 0) {

874 
	`³¼Ü
("ioctl(SIOCFIFCONF");

875 
out
;

878 ià(
ifc
.
ifc_Ën
 + (*
iä0
è+ (
sockaddr_¡Üage
è- (
sockaddr
è<ğ
iäsize
)

880 
iäsize
 *= 2;

881 
	`ä“
(
iä0
);

882 
iä0
 = 
NULL
;

883 } 
iäsize
 < 
INT_MAX
 / 2);

885 ià(!
iä0
) {

886 
	`årštf
(
¡d”r
, "arping:oo many interfaces!?\n");

887 
out
;

890 
iä_’d
 = (
iäeq
 *)(((*)
iä0
è+ 
ifc
.
ifc_Ën
 - (*ifr0));

891 
iä
 = 
iä0
; iä <ğ
iä_’d
; ifr++) {

892 ià(
	`check_deviû_by_ioùl
(
s
, &
iäbuf
))

894 
	`memıy
(&
iäbuf
.
iä_Çme
, 
iä
->ifr_name, (ifrbuf.ifr_name));

895 ià(
couÁ
++)

900 
	`şo£
(
s
);

902 ià(
couÁ
 == 1) {

903 
deviû
.
ifšdex
 = 
iäbuf
.
iä_ifšdex
;

904 
deviû
.
Çme
 = 
iäbuf
.
iä_Çme
;

906  !
deviû
.
ifšdex
;

907 
out
:

908 
	`şo£
(
s
);

910 
	}
}

912 
	$fšd_deviû
()

914 
rc
;

915 
rc
 = 
	`fšd_deviû_by_içddrs
();

916 ià(
rc
 >= 0)

917 
out
;

918 
rc
 = 
	`fšd_deviû_by_sysfs
();

919 ià(
rc
 >= 0)

920 
out
;

921 
rc
 = 
	`fšd_deviû_by_ioùl
();

922 
out
:

923  
rc
;

924 
	}
}

932 
	$£t_deviû_brßdÿ¡_içddrs_Úe
(
deviû
 *deviû, *
ba
, 
size_t
 
b®’
, 
çl
)

934 #iâdeà
WITHOUT_IFADDRS


935 
içddrs
 *
iç
;

936 
sockaddr_Î
 *
¦l
;

938 ià(!
deviû
)

941 
iç
 = 
deviû
->ifa;

942 ià(!
iç
)

945 
¦l
 = (
sockaddr_Î
 *)
iç
->
iç_brßdaddr
;

947 ià(
¦l
->
¦l_h®’
 !ğ
b®’
) {

948 ià(
çl
) {

949 ià(!
qu›t
)

950 
	`´štf
("Address†ength does‚ot match...\n");

951 
	`ex™
(2);

955 
	`memıy
(
ba
, 
¦l
->
¦l_addr
, sÎ->
¦l_h®’
);

960 
	}
}

961 
	$£t_deviû_brßdÿ¡_sysfs
(
deviû
 *deviû, *
ba
, 
size_t
 
b®’
)

963 #ifdeà
USE_SYSFS


964 
sysfs_dev©Œ_v®ues
 *
v
;

965 ià(!
deviû
)

967 
v
 = 
deviû
->
sysfs
;

968 ià(!
v
)

970 ià(
v
->
v®ue
[
SYSFS_DEVATTR_ADDR_LEN
].
ulÚg
 !ğ
b®’
)

972 
	`memıy
(
ba
, 
v
->
v®ue
[
SYSFS_DEVATTR_BROADCAST
].
±r
, 
b®’
);

977 
	}
}

979 
	$£t_deviû_brßdÿ¡_çÎback
(
deviû
 *deviû, *
ba
, 
size_t
 
b®’
)

981 ià(!
qu›t
)

982 
	`årštf
(
¡d”r
, "WARNING: using default broadcast‡ddress.\n");

983 
	`mem£t
(
ba
, -1, 
b®’
);

985 
	}
}

987 
	$£t_deviû_brßdÿ¡
(
deviû
 *
dev
, *
ba
, 
size_t
 
b®’
)

989 ià(!
	`£t_deviû_brßdÿ¡_içddrs_Úe
(
dev
, 
ba
, 
b®’
, 0))

991 ià(!
	`£t_deviû_brßdÿ¡_sysfs
(
dev
, 
ba
, 
b®’
))

993 
	`£t_deviû_brßdÿ¡_çÎback
(
dev
, 
ba
, 
b®’
);

994 
	}
}

997 
	$maš
(
¬gc
, **
¬gv
)

999 
sock‘_”ºo
;

1000 
ch
;

1002 
	`lim™_ÿ·b™›s
();

1004 #ifdeà
USE_IDN


1005 
	`£oÿË
(
LC_ALL
, "");

1008 
	`’abË_ÿ·b™y_¿w
();

1010 
s
 = 
	`sock‘
(
PF_PACKET
, 
SOCK_DGRAM
, 0);

1011 
sock‘_”ºo
 = 
”ºo
;

1013 
	`di§bË_ÿ·b™y_¿w
();

1015 (
ch
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "h?bfDUAqc:w:s:I:V")è!ğ
EOF
) {

1016 
ch
) {

1018 
brßdÿ¡_Úly
=1;

1021 
dad
++;

1022 
qu™_Ú_»¶y
=1;

1025 
unsŞic™ed
++;

1028 
adv”t
++;

1029 
unsŞic™ed
++;

1032 
qu›t
++;

1035 
couÁ
 = 
	`©oi
(
İrg
);

1038 
timeout
 = 
	`©oi
(
İrg
);

1041 
deviû
.
Çme
 = 
İrg
;

1044 
qu™_Ú_»¶y
=1;

1047 
sourû
 = 
İrg
;

1050 
	`´štf
("¬pšg ut™y, iputs-%s\n", 
SNAPSHOT
);

1051 
	`ex™
(0);

1055 
	`u§ge
();

1058 
¬gc
 -ğ
İtšd
;

1059 
¬gv
 +ğ
İtšd
;

1061 ià(
¬gc
 != 1)

1062 
	`u§ge
();

1064 
rg‘
 = *
¬gv
;

1066 ià(
deviû
.
Çme
 && !*device.name)

1067 
deviû
.
Çme
 = 
NULL
;

1069 ià(
s
 < 0) {

1070 
”ºo
 = 
sock‘_”ºo
;

1071 
	`³¼Ü
("arping: socket");

1072 
	`ex™
(2);

1075 ià(
	`fšd_deviû
() < 0)

1076 
	`ex™
(2);

1078 ià(!
deviû
.
ifšdex
) {

1079 ià(
deviû
.
Çme
) {

1080 
	`årštf
(
¡d”r
, "¬pšg: Deviû % nÙ‡vaabË.\n", 
deviû
.
Çme
);

1081 
	`ex™
(2);

1083 
	`årštf
(
¡d”r
, "arping: device (option -I) is„equired.\n");

1084 
	`u§ge
();

1087 ià(
	`š‘_©Ú
(
rg‘
, &
d¡
) != 1) {

1088 
ho¡’t
 *
hp
;

1089 *
idn
 = 
rg‘
;

1090 #ifdeà
USE_IDN


1091 
rc
;

1093 
rc
 = 
	`idÇ_to_ascii_lz
(
rg‘
, &
idn
, 0);

1095 ià(
rc
 !ğ
IDNA_SUCCESS
) {

1096 
	`årštf
(
¡d”r
, "¬pšg: IDNƒncodšg faed: %s\n", 
	`idÇ_¡»¼Ü
(
rc
));

1097 
	`ex™
(2);

1101 
hp
 = 
	`g‘ho¡byÇme2
(
idn
, 
AF_INET
);

1102 ià(!
hp
) {

1103 
	`årštf
(
¡d”r
, "¬pšg: unknowÀho¡ %s\n", 
rg‘
);

1104 
	`ex™
(2);

1107 #ifdeà
USE_IDN


1108 
	`ä“
(
idn
);

1111 
	`memıy
(&
d¡
, 
hp
->
h_addr
, 4);

1114 ià(
sourû
 && 
	`š‘_©Ú
(sourû, &
¤c
) != 1) {

1115 
	`årštf
(
¡d”r
, "¬pšg: inv®id sourû %s\n", 
sourû
);

1116 
	`ex™
(2);

1119 ià(!
dad
 && 
unsŞic™ed
 && 
¤c
.
s_addr
 == 0)

1120 
¤c
 = 
d¡
;

1122 ià(!
dad
 || 
¤c
.
s_addr
) {

1123 
sockaddr_š
 
§ddr
;

1124 
´obe_fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

1126 ià(
´obe_fd
 < 0) {

1127 
	`³¼Ü
("socket");

1128 
	`ex™
(2);

1130 ià(
deviû
.
Çme
) {

1131 
	`’abË_ÿ·b™y_¿w
();

1133 ià(
	`£tsockİt
(
´obe_fd
, 
SOL_SOCKET
, 
SO_BINDTODEVICE
, 
deviû
.
Çme
, 
	`¡¾’
(device.name)+1) == -1)

1134 
	`³¼Ü
("WARNING: interface is ignored");

1136 
	`di§bË_ÿ·b™y_¿w
();

1138 
	`mem£t
(&
§ddr
, 0, (saddr));

1139 
§ddr
.
sš_çmy
 = 
AF_INET
;

1140 ià(
¤c
.
s_addr
) {

1141 
§ddr
.
sš_addr
 = 
¤c
;

1142 ià(
	`bšd
(
´obe_fd
, (
sockaddr
*)&
§ddr
, (saddr)) == -1) {

1143 
	`³¼Ü
("bind");

1144 
	`ex™
(2);

1146 } ià(!
dad
) {

1147 
Ú
 = 1;

1148 
sockËn_t
 
®’
 = (
§ddr
);

1150 
§ddr
.
sš_pÜt
 = 
	`htÚs
(1025);

1151 
§ddr
.
sš_addr
 = 
d¡
;

1153 ià(
	`£tsockİt
(
´obe_fd
, 
SOL_SOCKET
, 
SO_DONTROUTE
, (*)&
Ú
, (on)) == -1)

1154 
	`³¼Ü
("WARNING: setsockopt(SO_DONTROUTE)");

1155 ià(
	`cÚÃù
(
´obe_fd
, (
sockaddr
*)&
§ddr
, (saddr)) == -1) {

1156 
	`³¼Ü
("connect");

1157 
	`ex™
(2);

1159 ià(
	`g‘sockÇme
(
´obe_fd
, (
sockaddr
*)&
§ddr
, &
®’
) == -1) {

1160 
	`³¼Ü
("getsockname");

1161 
	`ex™
(2);

1163 
¤c
 = 
§ddr
.
sš_addr
;

1165 
	`şo£
(
´obe_fd
);

1168 ((
sockaddr_Î
 *)&
me
)->
¦l_çmy
 = 
AF_PACKET
;

1169 ((
sockaddr_Î
 *)&
me
)->
¦l_ifšdex
 = 
deviû
.
ifšdex
;

1170 ((
sockaddr_Î
 *)&
me
)->
¦l_´ÙocŞ
 = 
	`htÚs
(
ETH_P_ARP
);

1171 ià(
	`bšd
(
s
, (
sockaddr
*)&
me
, (me)) == -1) {

1172 
	`³¼Ü
("bind");

1173 
	`ex™
(2);

1177 
sockËn_t
 
®’
 = (
me
);

1178 ià(
	`g‘sockÇme
(
s
, (
sockaddr
*)&
me
, &
®’
) == -1) {

1179 
	`³¼Ü
("getsockname");

1180 
	`ex™
(2);

1183 ià(((
sockaddr_Î
 *)&
me
)->
¦l_h®’
 == 0) {

1184 ià(!
qu›t
)

1185 
	`´štf
("IÁ”çû \"%s\" i nÙ ARPabË (nØÎ‡dd»ss)\n", 
deviû
.
Çme
);

1186 
	`ex™
(
dad
?0:2);

1189 
he
 = 
me
;

1191 
	`£t_deviû_brßdÿ¡
(&
deviû
, ((
sockaddr_Î
 *)&
he
)->
¦l_addr
,

1192 ((
sockaddr_Î
 *)&
he
)->
¦l_h®’
);

1194 ià(!
qu›t
) {

1195 
	`´štf
("ARPING % ", 
	`š‘_Áß
(
d¡
));

1196 
	`´štf
("äom % %s\n", 
	`š‘_Áß
(
¤c
), 
deviû
.
Çme
 ? : "");

1199 ià(!
¤c
.
s_addr
 && !
dad
) {

1200 
	`årštf
(
¡d”r
, "arping:‚o source‡ddress in‚ot-DAD mode\n");

1201 
	`ex™
(2);

1204 
	`drİ_ÿ·b™›s
();

1206 
	`£t_sigÇl
(
SIGINT
, 
fšish
);

1207 
	`£t_sigÇl
(
SIGALRM
, 
ÿtch”
);

1209 
	`ÿtch”
();

1212 
sig£t_t
 
s£t
, 
os£t
;

1213 
·ck‘
[4096];

1214 
sockaddr_¡Üage
 
äom
;

1215 
sockËn_t
 
®’
 = (
äom
);

1216 
cc
;

1218 ià((
cc
 = 
	`»cväom
(
s
, 
·ck‘
, (packet), 0,

1219 (
sockaddr
 *)&
äom
, &
®’
)) < 0) {

1220 
	`³¼Ü
("arping:„ecvfrom");

1224 
	`sigem±y£t
(&
s£t
);

1225 
	`sigadd£t
(&
s£t
, 
SIGALRM
);

1226 
	`sigadd£t
(&
s£t
, 
SIGINT
);

1227 
	`sig´ocmask
(
SIG_BLOCK
, &
s£t
, &
os£t
);

1228 
	`»cv_·ck
(
·ck‘
, 
cc
, (
sockaddr_Î
 *)&
äom
);

1229 
	`sig´ocmask
(
SIG_SETMASK
, &
os£t
, 
NULL
);

1231 
	}
}

	@clockdiff.c

1 
	~<time.h
>

2 
	~<sys/ty³s.h
>

3 
	~<sys/·¿m.h
>

4 
	~<¡dio.h
>

5 
	~<uni¡d.h
>

6 
	~<¡dlib.h
>

7 
	~<m©h.h
>

8 
	~<¡ršg.h
>

9 
	~<sys/time.h
>

10 
	~<sys/timex.h
>

11 
	~<”ºo.h
>

12 
	~<sys/sock‘.h
>

13 
	~<Ãtš‘/š.h
>

14 
	~<Ãtš‘/.h
>

15 
	~<Ãtš‘/_icmp.h
>

16 
	#TSPTYPES


	)

17 
	~<´ÙocŞs/timed.h
>

18 
	~<fú.h
>

19 
	~<Ãtdb.h
>

20 
	~<¬·/š‘.h
>

21 
	~<”ºo.h
>

22 
	~<lšux/ty³s.h
>

23 #ifdeà
CAPABILITIES


24 
	~<sys/ÿ·b™y.h
>

27 
	$u§ge
(è
	`__©Œibu‹__
((
nÜ‘uº
));

29 
	#MAX_HOSTNAMELEN
 
NI_MAXHOST


	)

40 #undeà
ADDCARRY


41 
	#ADDCARRY
(
sum
) { \

42 ià(
sum
 & 0xffff0000) { \

43 
sum
 &= 0xffff; \

44 
sum
++; \

46 
	}

	)
}

48 
	$š_cksum
(
u_shÜt
 *
addr
, 
Ën
)

50 
	uwÜd
 {

51 
c
[2];

52 
u_shÜt
 
s
;

53 } 
u
;

54 
sum
 = 0;

56 
Ën
 > 0) {

60 (
Ën
 -= 2) >= 0) {

61 ià(()
addr
 & 0x1) {

63 
u
.
c
[0] = *(*)
addr
;

64 
u
.
c
[1] = *((*)
addr
+1);

65 
sum
 +ğ
u
.
s
;

66 
addr
++;

68 
sum
 +ğ*
addr
++;

69 
	`ADDCARRY
(
sum
);

71 ià(
Ën
 == -1)

75 
u
.
c
[0] = *(
u_ch¬
 *)
addr
;

77 ià(
Ën
 == -1) {

80 
u
.
c
[1] = 0;

81 
sum
 +ğ
u
.
s
;

82 
	`ADDCARRY
(
sum
);

84  (~
sum
 & 0xffff);

85 
	}
}

87 
	#ON
 1

	)

88 
	#OFF
 0

	)

90 
	#RANGE
 1

	)

91 
	#MSGS
 50

	)

92 
	#TRIALS
 10

	)

94 
	#GOOD
 0

	)

95 
	#UNREACHABLE
 2

	)

96 
	#NONSTDTIME
 3

	)

97 
	#HOSTDOWN
 0x7fffffff

	)

100 
	gš‹¿ùive
 = 0;

101 
ušt16_t
 
	gid
;

102 
	gsock
;

103 
	gsock_¿w
;

104 
sockaddr_š
 
	g£rv”
;

105 
	g_İt_Ën
 = 0;

107 
	#BIASP
 43199999

	)

108 
	#BIASN
 -43200000

	)

109 
	#MODULO
 86400000

	)

110 
	#PROCESSING_TIME
 0

	)

112 
	#PACKET_IN
 1024

	)

114 
	gm—su»_d–
;

115 
	gm—su»_d–1
;

116 
u_shÜt
 
	g£qno
, 
	g£qno0
, 
	gacked
;

117 
	g¹t
 = 1000;

118 
	gmš_¹t
;

119 
	g¹t_sigma
 = 0;

126 
	$m—su»
(
sockaddr_š
 * 
addr
)

128 
sockËn_t
 
Ëngth
;

129 
msgcouÁ
;

130 
cc
, 
couÁ
;

131 
fd_£t
 
»ady
;

132 
£ndtime
, 
»cvtime
, 
hi¡ime
;

133 
mš1
, 
mš2
, 
diff
;

134 
d–1
, 
d–2
;

135 
timev®
 
tv1
, 
tout
;

136 
u_ch¬
 
·ck‘
[
PACKET_IN
], 
İack‘
[64];

137 
icmphdr
 *
iı
 = (icmphd¸*è
·ck‘
;

138 
icmphdr
 *
oiı
 = (icmphd¸*è
İack‘
;

139 
hdr
 *

 = (hd¸*è
·ck‘
;

141 
mš1
 = 
mš2
 = 0x7fffffff;

142 
mš_¹t
 = 0x7fffffff;

143 
m—su»_d–
 = 
HOSTDOWN
;

144 
m—su»_d–1
 = 
HOSTDOWN
;

147 
	`FD_ZERO
(&
»ady
);

149 
em±y
:

150 
tout
.
tv_£c
 =out.
tv_u£c
 = 0;

151 
	`FD_SET
(
sock_¿w
, &
»ady
);

152 ià(
	`£Ëù
(
FD_SETSIZE
, &
»ady
, (
fd_£t
 *)0, (fd_£ˆ*)0, &
tout
)) {

153 
Ëngth
 = (
sockaddr_š
);

154 
cc
 = 
	`»cväom
(
sock_¿w
, (*)
·ck‘
, 
PACKET_IN
, 0,

155 (
sockaddr
 *)
NULL
, &
Ëngth
);

156 ià(
cc
 < 0)

158 
em±y
;

170 
Ëngth
 = (
sockaddr_š
);

171 
oiı
->
ty³
 = 
ICMP_TIMESTAMP
;

172 
oiı
->
code
 = 0;

173 
oiı
->
checksum
 = 0;

174 
oiı
->
un
.
echo
.
id
 = id;

175 ((
__u32
*)(
oiı
+1))[0] = 0;

176 ((
__u32
*)(
oiı
+1))[1] = 0;

177 ((
__u32
*)(
oiı
+1))[2] = 0;

178 
	`FD_ZERO
(&
»ady
);

179 
msgcouÁ
 = 0;

181 
acked
 = 
£qno
 = 
£qno0
 = 0;

183 
msgcouÁ
 = 0; msgcouÁ < 
MSGS
; ) {

189 ià(
£qno
 - 
acked
 > 
TRIALS
)

190  
HOSTDOWN
;

192 
oiı
->
un
.
echo
.
£qu’û
 = ++
£qno
;

193 
oiı
->
checksum
 = 0;

195 ()
	`g‘timeofday
 (&
tv1
, (
timezÚe
 *)0);

196 *(
__u32
*)(
oiı
+1èğ
	`htÚl
((
tv1
.
tv_£c
 % (24*60*60)) * 1000

197 + 
tv1
.
tv_u£c
 / 1000);

198 
oiı
->
checksum
 = 
	`š_cksum
((
u_shÜt
 *)oicp, (*oicp) + 12);

200 
couÁ
 = 
	`£ndto
(
sock_¿w
, (*)
İack‘
, (*
oiı
)+12, 0,

201 (
sockaddr
 *)
addr
, (
sockaddr_š
));

203 ià(
couÁ
 < 0)

204  
UNREACHABLE
;

207 
	`FD_ZERO
(&
»ady
);

208 
	`FD_SET
(
sock_¿w
, &
»ady
);

210 
tmo
 = 
¹t
 + 
¹t_sigma
;

211 
tout
.
tv_£c
 = 
tmo
/1000;

212 
tout
.
tv_u£c
 = (
tmo
 - (tmo/1000)*1000)*1000;

215 ià((
couÁ
 = 
	`£Ëù
(
FD_SETSIZE
, &
»ady
, (
fd_£t
 *)0,

216 (
fd_£t
 *)0, &
tout
)) <= 0)

219 ()
	`g‘timeofday
(&
tv1
, (
timezÚe
 *)0);

220 
cc
 = 
	`»cväom
(
sock_¿w
, (*)
·ck‘
, 
PACKET_IN
, 0,

221 (
sockaddr
 *)
NULL
, &
Ëngth
);

223 ià(
cc
 < 0)

226 
iı
 = (
icmphdr
 *)(
·ck‘
 + (

->
ihl
 << 2));

227 ifĞ
iı
->
ty³
 =ğ
ICMP_TIMESTAMPREPLY
 &&

228 
iı
->
un
.
echo
.
id
 =ğid && iı->un.echo.
£qu’û
 >ğ
£qno0
 &&

229 
iı
->
un
.
echo
.
£qu’û
 <ğ
£qno
) {

230 ià(
acked
 < 
iı
->
un
.
echo
.
£qu’û
)

231 
acked
 = 
iı
->
un
.
echo
.
£qu’û
;

233 
»cvtime
 = (
tv1
.
tv_£c
 % (24*60*60)) * 1000 +

234 
tv1
.
tv_u£c
 / 1000;

235 
£ndtime
 = 
	`Áohl
(*(
__u32
*)(
iı
+1));

236 
diff
 = 
»cvtime
 - 
£ndtime
;

240 ià(
diff
 < 0)

242 
¹t
 = (¹ˆ* 3 + 
diff
)/4;

243 
¹t_sigma
 = (¹t_sigm¨*3 + 
	`abs
(
diff
-
¹t
))/4;

244 
msgcouÁ
++;

245 
hi¡ime
 = 
	`Áohl
(((
__u32
*)(
iı
+1))[1]);

252 ià((
hi¡ime
 & 0x80000000) != 0)

253  
NONSTDTIME
;

255 ià(
š‹¿ùive
) {

256 
	`´štf
(".");

257 
	`fæush
(
¡dout
);

260 
d–1
 = 
hi¡ime
 - 
£ndtime
;

267 ià(
d–1
 < 
BIASN
)

268 
d–1
 +ğ
MODULO
;

269 ià(
d–1
 > 
BIASP
)

270 
d–1
 -ğ
MODULO
;

272 
d–2
 = 
»cvtime
 - 
hi¡ime
;

273 ià(
d–2
 < 
BIASN
)

274 
d–2
 +ğ
MODULO
;

275 ià(
d–2
 > 
BIASP
)

276 
d–2
 -ğ
MODULO
;

278 ià(
d–1
 < 
mš1
)

279 
mš1
 = 
d–1
;

280 ià(
d–2
 < 
mš2
)

281 
mš2
 = 
d–2
;

282 ià(
d–1
 + 
d–2
 < 
mš_¹t
) {

283 
mš_¹t
 = 
d–1
 + 
d–2
;

284 
m—su»_d–1
 = (
d–1
 - 
d–2
)/2 + 
PROCESSING_TIME
;

286 ià(
diff
 < 
RANGE
) {

287 
mš1
 = 
d–1
;

288 
mš2
 = 
d–2
;

289 
good_ex™
;

295 
good_ex™
:

296 
m—su»_d–
 = (
mš1
 - 
mš2
)/2 + 
PROCESSING_TIME
;

297  
GOOD
;

298 
	}
}

300 *
	gmyÇme
, *
	ghi¢ame
;

303 
	$m—su»_İt
(
sockaddr_š
 * 
addr
)

305 
sockËn_t
 
Ëngth
;

306 
msgcouÁ
;

307 
cc
, 
couÁ
;

308 
fd_£t
 
»ady
;

309 
£ndtime
, 
»cvtime
, 
hi¡ime
, 
hi¡ime1
;

310 
mš1
, 
mš2
, 
diff
;

311 
d–1
, 
d–2
;

312 
timev®
 
tv1
, 
tout
;

313 
u_ch¬
 
·ck‘
[
PACKET_IN
], 
İack‘
[64];

314 
icmphdr
 *
iı
 = (icmphd¸*è
·ck‘
;

315 
icmphdr
 *
oiı
 = (icmphd¸*è
İack‘
;

316 
hdr
 *

 = (hd¸*è
·ck‘
;

318 
mš1
 = 
mš2
 = 0x7fffffff;

319 
mš_¹t
 = 0x7fffffff;

320 
m—su»_d–
 = 
HOSTDOWN
;

321 
m—su»_d–1
 = 
HOSTDOWN
;

324 
	`FD_ZERO
(&
»ady
);

325 
em±y
:

326 
tout
.
tv_£c
 =out.
tv_u£c
 = 0;

327 
	`FD_SET
(
sock_¿w
, &
»ady
);

328 ià(
	`£Ëù
(
FD_SETSIZE
, &
»ady
, (
fd_£t
 *)0, (fd_£ˆ*)0, &
tout
)) {

329 
Ëngth
 = (
sockaddr_š
);

330 
cc
 = 
	`»cväom
(
sock_¿w
, (*)
·ck‘
, 
PACKET_IN
, 0,

331 (
sockaddr
 *)
NULL
, &
Ëngth
);

332 ià(
cc
 < 0)

334 
em±y
;

346 
Ëngth
 = (
sockaddr_š
);

347 
oiı
->
ty³
 = 
ICMP_ECHO
;

348 
oiı
->
code
 = 0;

349 
oiı
->
checksum
 = 0;

350 
oiı
->
un
.
echo
.
id
 = id;

351 ((
__u32
*)(
oiı
+1))[0] = 0;

352 ((
__u32
*)(
oiı
+1))[1] = 0;

353 ((
__u32
*)(
oiı
+1))[2] = 0;

355 
	`FD_ZERO
(&
»ady
);

356 
msgcouÁ
 = 0;

358 
acked
 = 
£qno
 = 
£qno0
 = 0;

360 
msgcouÁ
 = 0; msgcouÁ < 
MSGS
; ) {

366 iàĞ
£qno
 - 
acked
 > 
TRIALS
) {

367 
”ºo
 = 
EHOSTDOWN
;

368  
HOSTDOWN
;

370 
oiı
->
un
.
echo
.
£qu’û
 = ++
£qno
;

371 
oiı
->
checksum
 = 0;

373 
	`g‘timeofday
 (&
tv1
, 
NULL
);

374 ((
__u32
*)(
oiı
+1))[0] = 
	`htÚl
((
tv1
.
tv_£c
 % (24*60*60)) * 1000

375 + 
tv1
.
tv_u£c
 / 1000);

376 
oiı
->
checksum
 = 
	`š_cksum
((
u_shÜt
 *)oicp, (*oicp)+12);

378 
couÁ
 = 
	`£ndto
(
sock_¿w
, (*)
İack‘
, (*
oiı
)+12, 0,

379 (
sockaddr
 *)
addr
, (
sockaddr_š
));

381 ià(
couÁ
 < 0) {

382 
”ºo
 = 
EHOSTUNREACH
;

383  
UNREACHABLE
;

387 
	`FD_ZERO
(&
»ady
);

388 
	`FD_SET
(
sock_¿w
, &
»ady
);

390 
tmo
 = 
¹t
 + 
¹t_sigma
;

391 
tout
.
tv_£c
 = 
tmo
/1000;

392 
tout
.
tv_u£c
 = (
tmo
 - (tmo/1000)*1000)*1000;

395 ià((
couÁ
 = 
	`£Ëù
(
FD_SETSIZE
, &
»ady
, (
fd_£t
 *)0,

396 (
fd_£t
 *)0, &
tout
)) <= 0)

399 ()
	`g‘timeofday
(&
tv1
, (
timezÚe
 *)0);

400 
cc
 = 
	`»cväom
(
sock_¿w
, (*)
·ck‘
, 
PACKET_IN
, 0,

401 (
sockaddr
 *)
NULL
, &
Ëngth
);

403 ià(
cc
 < 0)

406 
iı
 = (
icmphdr
 *)(
·ck‘
 + (

->
ihl
 << 2));

407 ià(
iı
->
ty³
 =ğ
ICMP_ECHOREPLY
 &&

408 
·ck‘
[20] =ğ
IPOPT_TIMESTAMP
 &&

409 
iı
->
un
.
echo
.
id
 == id &&

410 
iı
->
un
.
echo
.
£qu’û
 >ğ
£qno0
 &&

411 
iı
->
un
.
echo
.
£qu’û
 <ğ
£qno
) {

412 
i
;

413 
__u8
 *
İt
 = 
·ck‘
+20;

415 ià(
acked
 < 
iı
->
un
.
echo
.
£qu’û
)

416 
acked
 = 
iı
->
un
.
echo
.
£qu’û
;

417 ià((
İt
[3]&0xFè!ğ
IPOPT_TS_PRESPEC
) {

418 
	`årštf
(
¡d”r
, "WrÚgime¡am°%d\n", 
İt
[3]&0xF);

419  
NONSTDTIME
;

421 ià(
İt
[3]>>4) {

422 ià((
İt
[3]>>4è!ğ1 || 
_İt_Ën
 != 4+3*8)

423 
	`årštf
(
¡d”r
, "Ov”æow %d hİs\n", 
İt
[3]>>4);

425 
£ndtime
 = 
»cvtime
 = 
hi¡ime
 = 
hi¡ime1
 = 0;

426 
i
=0; i < (
İt
[2]-5)/8; i++) {

427 
__u32
 *
tim•
 = (__u32*)(
İt
+4+
i
*8+4);

428 
__u32
 
t
 = 
	`Áohl
(*
tim•
);

430 ià(
t
 & 0x80000000)

431  
NONSTDTIME
;

433 ià(
i
 == 0)

434 
£ndtime
 = 
t
;

435 ià(
i
 == 1)

436 
hi¡ime
 = 
hi¡ime1
 = 
t
;

437 ià(
i
 == 2) {

438 ià(
_İt_Ën
 == 4+4*8)

439 
hi¡ime1
 = 
t
;

441 
»cvtime
 = 
t
;

443 ià(
i
 == 3)

444 
»cvtime
 = 
t
;

447 ià(!(
£ndtime
&
hi¡ime
&
hi¡ime1
&
»cvtime
)) {

448 
	`årštf
(
¡d”r
, "wrongimestamps\n");

452 
diff
 = 
»cvtime
 - 
£ndtime
;

456 ià(
diff
 < 0)

458 
¹t
 = (¹ˆ* 3 + 
diff
)/4;

459 
¹t_sigma
 = (¹t_sigm¨*3 + 
	`abs
(
diff
-
¹t
))/4;

460 
msgcouÁ
++;

462 ià(
š‹¿ùive
) {

463 
	`´štf
(".");

464 
	`fæush
(
¡dout
);

467 
d–1
 = 
hi¡ime
 - 
£ndtime
;

474 ià(
d–1
 < 
BIASN
)

475 
d–1
 +ğ
MODULO
;

476 ià(
d–1
 > 
BIASP
)

477 
d–1
 -ğ
MODULO
;

479 
d–2
 = 
»cvtime
 - 
hi¡ime1
;

480 ià(
d–2
 < 
BIASN
)

481 
d–2
 +ğ
MODULO
;

482 ià(
d–2
 > 
BIASP
)

483 
d–2
 -ğ
MODULO
;

485 ià(
d–1
 < 
mš1
)

486 
mš1
 = 
d–1
;

487 ià(
d–2
 < 
mš2
)

488 
mš2
 = 
d–2
;

489 ià(
d–1
 + 
d–2
 < 
mš_¹t
) {

490 
mš_¹t
 = 
d–1
 + 
d–2
;

491 
m—su»_d–1
 = (
d–1
 - 
d–2
)/2 + 
PROCESSING_TIME
;

493 ià(
diff
 < 
RANGE
) {

494 
mš1
 = 
d–1
;

495 
mš2
 = 
d–2
;

496 
good_ex™
;

502 
good_ex™
:

503 
m—su»_d–
 = (
mš1
 - 
mš2
)/2 + 
PROCESSING_TIME
;

504  
GOOD
;

505 
	}
}

530 
	$u§ge
() {

531 
	`årštf
(
¡d”r
, "Usage: clockdiff [-o] <host>\n");

532 
	`ex™
(1);

533 
	}
}

535 
	$drİ_rights
() {

536 #ifdeà
CAPABILITIES


537 
ÿp_t
 
ÿps
 = 
	`ÿp_š™
();

538 ià(
	`ÿp_£t_´oc
(
ÿps
)) {

539 
	`³¼Ü
("clockdiff: cap_set_proc");

540 
	`ex™
(-1);

542 
	`ÿp_ä“
(
ÿps
);

544 ià(
	`£tuid
(
	`g‘uid
())) {

545 
	`³¼Ü
("clockdiff: setuid");

546 
	`ex™
(-1);

548 
	}
}

551 
	$maš
(
¬gc
, *
¬gv
[])

553 
m—su»_¡©us
;

554 
ho¡’t
 * 
hp
;

555 
ho¡Çme
[
MAX_HOSTNAMELEN
];

556 
s_”ºo
 = 0;

557 
n_”ºo
 = 0;

559 ià(
¬gc
 < 2) {

560 
	`drİ_rights
();

561 
	`u§ge
();

564 
sock_¿w
 = 
	`sock‘
(
AF_INET
, 
SOCK_RAW
, 
IPPROTO_ICMP
);

565 
s_”ºo
 = 
”ºo
;

567 
”ºo
 = 0;

568 ià(
	`niû
(-16) == -1)

569 
n_”ºo
 = 
”ºo
;

570 
	`drİ_rights
();

572 ià(
¬gc
 == 3) {

573 ià(
	`¡rcmp
(
¬gv
[1], "-o") == 0) {

574 
_İt_Ën
 = 4 + 4*8;

575 
¬gv
++;

576 } ià(
	`¡rcmp
(
¬gv
[1], "-o1") == 0) {

577 
_İt_Ën
 = 4 + 3*8;

578 
¬gv
++;

580 
	`u§ge
();

581 } ià(
¬gc
 != 2)

582 
	`u§ge
();

584 ià(
sock_¿w
 < 0) {

585 
”ºo
 = 
s_”ºo
;

586 
	`³¼Ü
("clockdiff: socket");

587 
	`ex™
(1);

590 ià(
n_”ºo
 < 0) {

591 
”ºo
 = 
n_”ºo
;

592 
	`³¼Ü
("clockdiff:‚ice");

593 
	`ex™
(1);

596 ià(
	`i§‰y
(
	`f’o
(
¡dš
)è&& i§‰y(f’o(
¡dout
)))

597 
š‹¿ùive
 = 1;

599 
id
 = 
	`g‘pid
();

601 ()
	`g‘ho¡Çme
(
ho¡Çme
,(hostname));

602 
hp
 = 
	`g‘ho¡byÇme
(
ho¡Çme
);

603 ià(
hp
 =ğ
NULL
) {

604 
	`årštf
(
¡d”r
, "şockdiff: %s: my ho¡‚Ù found\n", 
ho¡Çme
);

605 
	`ex™
(1);

607 
myÇme
 = 
	`¡rdup
(
hp
->
h_Çme
);

609 
hp
 = 
	`g‘ho¡byÇme
(
¬gv
[1]);

610 ià(
hp
 =ğ
NULL
) {

611 
	`årštf
(
¡d”r
, "şockdiff: %s: ho¡‚Ù found\n", 
¬gv
[1]);

612 
	`ex™
(1);

614 
hi¢ame
 = 
	`¡rdup
(
hp
->
h_Çme
);

616 
	`mem£t
(&
£rv”
, 0, (server));

617 
£rv”
.
sš_çmy
 = 
hp
->
h_add¹y³
;

618 
	`memıy
(&(
£rv”
.
sš_addr
.
s_addr
), 
hp
->
h_addr
, 4);

620 ià(
	`cÚÃù
(
sock_¿w
, (
sockaddr
*)&
£rv”
, (server)) == -1) {

621 
	`³¼Ü
("connect");

622 
	`ex™
(1);

624 ià(
_İt_Ën
) {

625 
sockaddr_š
 
myaddr
;

626 
sockËn_t
 
add¾’
 = (
myaddr
);

627 
r¥aû
[
_İt_Ën
];

629 
	`mem£t
(
r¥aû
, 0, (rspace));

630 
r¥aû
[0] = 
IPOPT_TIMESTAMP
;

631 
r¥aû
[1] = 
_İt_Ën
;

632 
r¥aû
[2] = 5;

633 
r¥aû
[3] = 
IPOPT_TS_PRESPEC
;

634 ià(
	`g‘sockÇme
(
sock_¿w
, (
sockaddr
*)&
myaddr
, &
add¾’
) == -1) {

635 
	`³¼Ü
("getsockname");

636 
	`ex™
(1);

638 ((
__u32
*)(
r¥aû
+4))[0*2] = 
myaddr
.
sš_addr
.
s_addr
;

639 ((
__u32
*)(
r¥aû
+4))[1*2] = 
£rv”
.
sš_addr
.
s_addr
;

640 ((
__u32
*)(
r¥aû
+4))[2*2] = 
myaddr
.
sš_addr
.
s_addr
;

641 ià(
_İt_Ën
 == 4+4*8) {

642 ((
__u32
*)(
r¥aû
+4))[2*2] = 
£rv”
.
sš_addr
.
s_addr
;

643 ((
__u32
*)(
r¥aû
+4))[3*2] = 
myaddr
.
sš_addr
.
s_addr
;

646 ià(
	`£tsockİt
(
sock_¿w
, 
IPPROTO_IP
, 
IP_OPTIONS
, 
r¥aû
, 
_İt_Ën
) < 0) {

647 
	`³¼Ü
("ping: IP_OPTIONS (fallbacko icmpstamps)");

648 
_İt_Ën
 = 0;

652 ià((
m—su»_¡©us
 = (
_İt_Ën
 ? 
m—su»_İt
 : 
m—su»
)(&
£rv”
)) < 0) {

653 ià(
”ºo
)

654 
	`³¼Ü
("measure");

656 
	`årštf
(
¡d”r
, "measure: unknown failure\n");

657 
	`ex™
(1);

660 
m—su»_¡©us
) {

661 
HOSTDOWN
:

662 
	`årštf
(
¡d”r
, "% i down\n", 
hi¢ame
);

663 
	`ex™
(1);

664 
NONSTDTIME
:

665 
	`årštf
(
¡d”r
, "% timŒªsm™‹d iÀ¨nÚ-¡ªd¬d fÜm©\n", 
hi¢ame
);

666 
	`ex™
(1);

667 
UNREACHABLE
:

668 
	`årštf
(
¡d”r
, "% i uÄ—chabË\n", 
hi¢ame
);

669 
	`ex™
(1);

676 
time_t
 
now
 = 
	`time
(
NULL
);

678 ià(
š‹¿ùive
)

679 
	`´štf
("\nho¡=% ¹t=%ld(%ld)ms/%ldm d–=%dms/%dm %s", 
hi¢ame
,

680 
¹t
, 
¹t_sigma
, 
mš_¹t
,

681 
m—su»_d–
, 
m—su»_d–1
,

682 
	`ùime
(&
now
));

684 
	`´štf
("%ld %d %d\n", 
now
, 
m—su»_d–
, 
m—su»_d–1
);

686 
	`ex™
(0);

687 
	}
}

	@in6_flowlabel.h

9 
	sš6_æowÏb–_»q


11 
š6_addr
 
	mær_d¡
;

12 
__u32
 
	mær_Ïb–
;

13 
__u8
 
	mær_aùiÚ
;

14 
__u8
 
	mær_sh¬e
;

15 
__u16
 
	mær_æags
;

16 
__u16
 
	mær_expœes
;

17 
__u16
 
	mær_lšg”
;

18 
__u32
 
	m__ær_·d
;

22 
	#IPV6_FL_A_GET
 0

	)

23 
	#IPV6_FL_A_PUT
 1

	)

24 
	#IPV6_FL_A_RENEW
 2

	)

26 
	#IPV6_FL_F_CREATE
 1

	)

27 
	#IPV6_FL_F_EXCL
 2

	)

29 
	#IPV6_FL_S_NONE
 0

	)

30 
	#IPV6_FL_S_EXCL
 1

	)

31 
	#IPV6_FL_S_PROCESS
 2

	)

32 
	#IPV6_FL_S_USER
 3

	)

33 
	#IPV6_FL_S_ANY
 255

	)

35 
	#IPV6_FLOWINFO_FLOWLABEL
 0x000fffff

	)

36 
	#IPV6_FLOWINFO_PRIORITY
 0x0ff00000

	)

38 
	#IPV6_FLOWLABEL_MGR
 32

	)

39 
	#IPV6_FLOWINFO_SEND
 33

	)

	@ping.c

37 #iâdeà
lšt


38 
	gcİyright
[] =

61 
	~"pšg_commÚ.h
"

63 
	~<Ãtš‘/.h
>

64 
	~<Ãtš‘/_icmp.h
>

65 #iâdeà
WITHOUT_IFADDRS


66 
	~<içddrs.h
>

69 #iâdeà
ICMP_FILTER


70 
	#ICMP_FILTER
 1

	)

71 
	sicmp_f‹r
 {

72 
__u32
 
	md©a
;

77 
	#MAXIPLEN
 60

	)

78 
	#MAXICMPLEN
 76

	)

79 
	#NROUTES
 9

	)

80 
	#TOS_MAX
 255

	)

81 
	#MAX_HOSTNAMELEN
 
NI_MAXHOST


	)

84 
	gts_ty³
;

85 
	gÄou‹
 = 0;

86 
__u32
 
	grou‹
[10];

90 
sockaddr_š
 
	gwh”‘o
;

91 
	gİ’
 = 0;

92 
	g£‰os
 = 0;

93 
	gicmp_sock
;

94 
u_ch¬
 
	gouack
[0x10000];

95 
	gmax·ck‘
 = (
ouack
);

97 
	gbrßdÿ¡_pšgs
 = 0;

99 *
´_addr
(
__u32
);

100 
´_İtiÚs
(* 
ı
, 
hËn
);

101 
´_h
(
hdr
 *

);

102 
	$u§ge
(è
	`__©Œibu‹__
((
nÜ‘uº
));

103 
u_shÜt
 
	`š_cksum
(cÚ¡ u_shÜˆ*
addr
, 
Ën
, u_shÜˆ
§É
);

104 
	`´_icmph
(
__u8
 
ty³
, __u8 
code
, 
__u32
 
šfo
, 
icmphdr
 *
iı
);

105 
	`·r£tos
(*
¡r
);

108 
cmsghdr
 
cm
;

109 
š_pktšfo
 
i
;

110 } 
cmsg
 = { {(
cmsghdr
è+ (
š_pktšfo
), 
SOL_IP
, 
IP_PKTINFO
},

111 {0, }
	}
};

112 
	gcmsg_Ën
;

114 
sockaddr_š
 
	gsourû
;

115 *
	gdeviû
;

116 
	gpmtudisc
 = -1;

120 
	$maš
(
¬gc
, **
¬gv
)

122 
ho¡’t
 *
hp
;

123 
ch
, 
hŞd
, 
·ckËn
;

124 
sock‘_”ºo
;

125 
u_ch¬
 *
·ck‘
;

126 *
rg‘
;

127 #ifdeà
USE_IDN


128 *
hÇmebuf
 = 
NULL
;

130 
hÇmebuf
[
MAX_HOSTNAMELEN
];

132 
r¥aû
[3 + 4 * 
NROUTES
 + 1];

134 
	`lim™_ÿ·b™›s
();

136 #ifdeà
USE_IDN


137 
	`£oÿË
(
LC_ALL
, "");

140 
	`’abË_ÿ·b™y_¿w
();

142 
icmp_sock
 = 
	`sock‘
(
AF_INET
, 
SOCK_RAW
, 
IPPROTO_ICMP
);

143 
sock‘_”ºo
 = 
”ºo
;

145 
	`di§bË_ÿ·b™y_¿w
();

147 
sourû
.
sš_çmy
 = 
AF_INET
;

149 
´–ßd
 = 1;

150 (
ch
 = 
	`g‘İt
(
¬gc
, 
¬gv
, 
COMMON_OPTSTR
 "bRT:")è!ğ
EOF
) {

151 
ch
) {

153 
brßdÿ¡_pšgs
 = 1;

156 
£‰os
 = 
	`·r£tos
(
İrg
);

157 ià(
£‰os
 &&

158 (
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IP
, 
IP_TOS
,

159 (*)&
£‰os
, ()) < 0)) {

160 
	`³¼Ü
("ping:ƒrror setting QOS sockopts");

161 
	`ex™
(2);

165 ià(
İtiÚs
 & 
F_TIMESTAMP
) {

166 
	`årštf
(
¡d”r
, "Only one of -T or -R may be used\n");

167 
	`ex™
(2);

169 
İtiÚs
 |ğ
F_RROUTE
;

172 ià(
İtiÚs
 & 
F_RROUTE
) {

173 
	`årštf
(
¡d”r
, "Only one of -T or -R may be used\n");

174 
	`ex™
(2);

176 
İtiÚs
 |ğ
F_TIMESTAMP
;

177 ià(
	`¡rcmp
(
İrg
, "tsonly") == 0)

178 
ts_ty³
 = 
IPOPT_TS_TSONLY
;

179 ià(
	`¡rcmp
(
İrg
, "tsandaddr") == 0)

180 
ts_ty³
 = 
IPOPT_TS_TSANDADDR
;

181 ià(
	`¡rcmp
(
İrg
, "tsprespec") == 0)

182 
ts_ty³
 = 
IPOPT_TS_PRESPEC
;

184 
	`årštf
(
¡d”r
, "Invalidimestampype\n");

185 
	`ex™
(2);

191 
dummy
;

192 
i1
, 
i2
, 
i3
, 
i4
;

194 ià(
	`ssÿnf
(
İrg
, "%u.%u.%u.%u%c",

195 &
i1
, &
i2
, &
i3
, &
i4
, &
dummy
) == 4) {

196 
__u8
 *
±r
;

197 
±r
 = (
__u8
*)&
sourû
.
sš_addr
;

198 
±r
[0] = 
i1
;

199 
±r
[1] = 
i2
;

200 
±r
[2] = 
i3
;

201 
±r
[3] = 
i4
;

202 
İtiÚs
 |ğ
F_STRICTSOURCE
;

204 
deviû
 = 
İrg
;

207 ià(
	`š‘_±Ú
(
AF_INET
, 
İrg
, &
sourû
.
sš_addr
) > 0)

208 
İtiÚs
 |ğ
F_STRICTSOURCE
;

210 
deviû
 = 
İrg
;

215 ià(
	`¡rcmp
(
İrg
, "do") == 0)

216 
pmtudisc
 = 
IP_PMTUDISC_DO
;

217 ià(
	`¡rcmp
(
İrg
, "dont") == 0)

218 
pmtudisc
 = 
IP_PMTUDISC_DONT
;

219 ià(
	`¡rcmp
(
İrg
, "want") == 0)

220 
pmtudisc
 = 
IP_PMTUDISC_WANT
;

222 
	`årštf
(
¡d”r
, "ping: wrong value for -M: do, dont, want‡re valid ones.\n");

223 
	`ex™
(2);

227 
	`´štf
("pšg ut™y, iputs-%s\n", 
SNAPSHOT
);

228 
	`ex™
(0);

229 
COMMON_OPTIONS


230 
	`commÚ_İtiÚs
(
ch
);

233 
	`u§ge
();

236 
¬gc
 -ğ
İtšd
;

237 
¬gv
 +ğ
İtšd
;

239 ià(
¬gc
 == 0)

240 
	`u§ge
();

241 ià(
¬gc
 > 1) {

242 ià(
İtiÚs
 & 
F_RROUTE
)

243 
	`u§ge
();

244 ià(
İtiÚs
 & 
F_TIMESTAMP
) {

245 ià(
ts_ty³
 !ğ
IPOPT_TS_PRESPEC
)

246 
	`u§ge
();

247 ià(
¬gc
 > 5)

248 
	`u§ge
();

250 ià(
¬gc
 > 10)

251 
	`u§ge
();

252 
İtiÚs
 |ğ
F_SOURCEROUTE
;

255 
¬gc
 > 0) {

256 
rg‘
 = *
¬gv
;

258 
	`mem£t
((*)&
wh”‘o
, 0, (whereto));

259 
wh”‘o
.
sš_çmy
 = 
AF_INET
;

260 ià(
	`š‘_©Ú
(
rg‘
, &
wh”‘o
.
sš_addr
) == 1) {

261 
ho¡Çme
 = 
rg‘
;

262 ià(
¬gc
 == 1)

263 
İtiÚs
 |ğ
F_NUMERIC
;

265 *
idn
;

266 #ifdeà
USE_IDN


267 
rc
;

269 ià(
hÇmebuf
) {

270 
	`ä“
(
hÇmebuf
);

271 
hÇmebuf
 = 
NULL
;

274 
rc
 = 
	`idÇ_to_ascii_lz
(
rg‘
, &
idn
, 0);

275 ià(
rc
 !ğ
IDNA_SUCCESS
) {

276 
	`årštf
(
¡d”r
, "pšg: IDNƒncodšg faed: %s\n", 
	`idÇ_¡»¼Ü
(
rc
));

277 
	`ex™
(2);

280 
idn
 = 
rg‘
;

282 
hp
 = 
	`g‘ho¡byÇme
(
idn
);

283 ià(!
hp
) {

284 
	`årštf
(
¡d”r
, "pšg: unknowÀho¡ %s\n", 
rg‘
);

285 
	`ex™
(2);

287 #ifdeà
USE_IDN


288 
	`ä“
(
idn
);

290 
	`memıy
(&
wh”‘o
.
sš_addr
, 
hp
->
h_addr
, 4);

291 #ifdeà
USE_IDN


292 ià(
	`idÇ_to_unicode_lzlz
(
hp
->
h_Çme
, &
hÇmebuf
, 0è!ğ
IDNA_SUCCESS
) {

293 
hÇmebuf
 = 
	`¡rdup
(
hp
->
h_Çme
);

294 ià(!
hÇmebuf
) {

295 
	`³¼Ü
("ping: strdup");

296 
	`ex™
(-1);

300 
	`¡ºıy
(
hÇmebuf
, 
hp
->
h_Çme
, (hnamebuf) - 1);

301 
hÇmebuf
[(hnamebuf) - 1] = 0;

303 
ho¡Çme
 = 
hÇmebuf
;

305 ià(
¬gc
 > 1)

306 
rou‹
[
Äou‹
++] = 
wh”‘o
.
sš_addr
.
s_addr
;

307 
¬gc
--;

308 
¬gv
++;

311 ià(
sourû
.
sš_addr
.
s_addr
 == 0) {

312 
sockËn_t
 
®’
;

313 
sockaddr_š
 
d¡
 = 
wh”‘o
;

314 
´obe_fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

316 ià(
´obe_fd
 < 0) {

317 
	`³¼Ü
("socket");

318 
	`ex™
(2);

320 ià(
deviû
) {

321 
iäeq
 
iä
;

322 
rc
;

324 
	`mem£t
(&
iä
, 0, (ifr));

325 
	`¡ºıy
(
iä
.
iä_Çme
, 
deviû
, 
IFNAMSIZ
-1);

327 
	`’abË_ÿ·b™y_¿w
();

328 
rc
 = 
	`£tsockİt
(
´obe_fd
, 
SOL_SOCKET
, 
SO_BINDTODEVICE
, 
deviû
, 
	`¡¾’
(device)+1);

329 
	`di§bË_ÿ·b™y_¿w
();

331 ià(
rc
 == -1) {

332 ià(
	`IN_MULTICAST
(
	`Áohl
(
d¡
.
sš_addr
.
s_addr
))) {

333 
_m»qn
 
imr
;

334 ià(
	`ioùl
(
´obe_fd
, 
SIOCGIFINDEX
, &
iä
) < 0) {

335 
	`årštf
(
¡d”r
, "pšg: unknowÀiçû %s\n", 
deviû
);

336 
	`ex™
(2);

338 
	`mem£t
(&
imr
, 0, (imr));

339 
imr
.
imr_ifšdex
 = 
iä
.
iä_ifšdex
;

340 ià(
	`£tsockİt
(
´obe_fd
, 
SOL_IP
, 
IP_MULTICAST_IF
, &
imr
, (imr)) == -1) {

341 
	`³¼Ü
("ping: IP_MULTICAST_IF");

342 
	`ex™
(2);

345 
	`³¼Ü
("ping: SO_BINDTODEVICE");

346 
	`ex™
(2);

351 ià(
£‰os
 &&

352 
	`£tsockİt
(
´obe_fd
, 
IPPROTO_IP
, 
IP_TOS
, (*)&
£‰os
, ()) < 0)

353 
	`³¼Ü
("Warning:ƒrror setting QOS sockopts");

355 
d¡
.
sš_pÜt
 = 
	`htÚs
(1025);

356 ià(
Äou‹
)

357 
d¡
.
sš_addr
.
s_addr
 = 
rou‹
[0];

358 ià(
	`cÚÃù
(
´obe_fd
, (
sockaddr
*)&
d¡
, (dst)) == -1) {

359 ià(
”ºo
 =ğ
EACCES
) {

360 ià(
brßdÿ¡_pšgs
 == 0) {

361 
	`årštf
(
¡d”r
, "Do you wanto…ing broadcast? Then -b\n");

362 
	`ex™
(2);

364 
	`årštf
(
¡d”r
, "WARNING:…inging broadcast‡ddress\n");

365 ià(
	`£tsockİt
(
´obe_fd
, 
SOL_SOCKET
, 
SO_BROADCAST
,

366 &
brßdÿ¡_pšgs
, (broadcast_pings)) < 0) {

367 
	`³¼Ü
 ("can't set broadcasting");

368 
	`ex™
(2);

370 ià(
	`cÚÃù
(
´obe_fd
, (
sockaddr
*)&
d¡
, (dst)) == -1) {

371 
	`³¼Ü
("connect");

372 
	`ex™
(2);

375 
	`³¼Ü
("connect");

376 
	`ex™
(2);

379 
®’
 = (
sourû
);

380 ià(
	`g‘sockÇme
(
´obe_fd
, (
sockaddr
*)&
sourû
, &
®’
) == -1) {

381 
	`³¼Ü
("getsockname");

382 
	`ex™
(2);

384 
sourû
.
sš_pÜt
 = 0;

386 #iâdeà
WITHOUT_IFADDRS


387 ià(
deviû
) {

388 
içddrs
 *
iç0
, *
iç
;

389 
»t
;

391 
»t
 = 
	`g‘içddrs
(&
iç0
);

392 ià(
»t
) {

393 
	`årštf
(
¡d”r
, "gatifaddrs() failed.\n");

394 
	`ex™
(2);

396 
iç
 = 
iç0
; iç; iç = iç->
iç_Ãxt
) {

397 ià(!
iç
->
iç_addr
 || iç->iç_addr->
§_çmy
 !ğ
AF_INET
)

399 ià(!
	`¡ºcmp
(
iç
->
iç_Çme
, 
deviû
, (device) - 1) &&

400 !
	`memcmp
(&((
sockaddr_š
 *)
iç
->
iç_addr
)->
sš_addr
,

401 &
sourû
.
sš_addr
, (source.sin_addr)))

404 
	`ä“içddrs
(
iç0
);

405 ià(!
iç
)

406 
	`årštf
(
¡d”r
, "pšg: W¬nšg: sourû‡dd»s mighˆb£Ëùed oÀdeviû oth”hª %s.\n", 
deviû
);

409 
	`şo£
(
´obe_fd
);

412 ià(
wh”‘o
.
sš_addr
.
s_addr
 == 0)

413 
wh”‘o
.
sš_addr
.
s_addr
 = 
sourû
.sin_addr.s_addr;

415 ià(
icmp_sock
 < 0) {

416 
”ºo
 = 
sock‘_”ºo
;

417 
	`³¼Ü
("ping: icmp open socket");

418 
	`ex™
(2);

421 ià(
deviû
) {

422 
iäeq
 
iä
;

424 
	`mem£t
(&
iä
, 0, (ifr));

425 
	`¡ºıy
(
iä
.
iä_Çme
, 
deviû
, 
IFNAMSIZ
-1);

426 ià(
	`ioùl
(
icmp_sock
, 
SIOCGIFINDEX
, &
iä
) < 0) {

427 
	`årštf
(
¡d”r
, "pšg: unknowÀiçû %s\n", 
deviû
);

428 
	`ex™
(2);

430 
cmsg
.
i
.
i_ifšdex
 = 
iä
.
iä_ifšdex
;

431 
cmsg_Ën
 = (
cmsg
);

434 ià(
brßdÿ¡_pšgs
 || 
	`IN_MULTICAST
(
	`Áohl
(
wh”‘o
.
sš_addr
.
s_addr
))) {

435 ià(
uid
) {

436 ià(
š‹rv®
 < 1000) {

437 
	`årštf
(
¡d”r
, "ping: broadcast…ing withoo short interval.\n");

438 
	`ex™
(2);

440 ià(
pmtudisc
 >ğ0 &&…mtudisø!ğ
IP_PMTUDISC_DO
) {

441 
	`årštf
(
¡d”r
, "ping: broadcast…ing does‚ot fragment.\n");

442 
	`ex™
(2);

445 ià(
pmtudisc
 < 0)

446 
pmtudisc
 = 
IP_PMTUDISC_DO
;

449 ià(
pmtudisc
 >= 0) {

450 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_IP
, 
IP_MTU_DISCOVER
, &
pmtudisc
, (pmtudisc)) == -1) {

451 
	`³¼Ü
("ping: IP_MTU_DISCOVER");

452 
	`ex™
(2);

456 ià((
İtiÚs
&
F_STRICTSOURCE
) &&

457 
	`bšd
(
icmp_sock
, (
sockaddr
*)&
sourû
, (source)) == -1) {

458 
	`³¼Ü
("bind");

459 
	`ex™
(2);

463 
icmp_f‹r
 
ft
;

464 
ft
.
d©a
 = ~((1<<
ICMP_SOURCE_QUENCH
)|

465 (1<<
ICMP_DEST_UNREACH
)|

466 (1<<
ICMP_TIME_EXCEEDED
)|

467 (1<<
ICMP_PARAMETERPROB
)|

468 (1<<
ICMP_REDIRECT
)|

469 (1<<
ICMP_ECHOREPLY
));

470 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_RAW
, 
ICMP_FILTER
, (*)&
ft
, (filt)) == -1)

471 
	`³¼Ü
("WARNING: setsockopt(ICMP_FILTER)");

474 
hŞd
 = 1;

475 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_IP
, 
IP_RECVERR
, (*)&
hŞd
, (hold)))

476 
	`årštf
(
¡d”r
, "WARNING: your kernel is veeery old. No…roblems.\n");

479 ià(
İtiÚs
 & 
F_RROUTE
) {

480 
	`mem£t
(
r¥aû
, 0, (rspace));

481 
r¥aû
[0] = 
IPOPT_NOP
;

482 
r¥aû
[1+
IPOPT_OPTVAL
] = 
IPOPT_RR
;

483 
r¥aû
[1+
IPOPT_OLEN
] = (rspace)-1;

484 
r¥aû
[1+
IPOPT_OFFSET
] = 
IPOPT_MINOFF
;

485 
İ’
 = 40;

486 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IP
, 
IP_OPTIONS
, 
r¥aû
, (rspace)) < 0) {

487 
	`³¼Ü
("ping:„ecord„oute");

488 
	`ex™
(2);

491 ià(
İtiÚs
 & 
F_TIMESTAMP
) {

492 
	`mem£t
(
r¥aû
, 0, (rspace));

493 
r¥aû
[0] = 
IPOPT_TIMESTAMP
;

494 
r¥aû
[1] = (
ts_ty³
==
IPOPT_TS_TSONLY
 ? 40 : 36);

495 
r¥aû
[2] = 5;

496 
r¥aû
[3] = 
ts_ty³
;

497 ià(
ts_ty³
 =ğ
IPOPT_TS_PRESPEC
) {

498 
i
;

499 
r¥aû
[1] = 4+
Äou‹
*8;

500 
i
=0; i<
Äou‹
; i++)

501 *(
__u32
*)&
r¥aû
[4+
i
*8] = 
rou‹
[i];

503 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IP
, 
IP_OPTIONS
, 
r¥aû
,„space[1]) < 0) {

504 
r¥aû
[3] = 2;

505 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IP
, 
IP_OPTIONS
, 
r¥aû
,„space[1]) < 0) {

506 
	`³¼Ü
("ping:s option");

507 
	`ex™
(2);

510 
İ’
 = 40;

512 ià(
İtiÚs
 & 
F_SOURCEROUTE
) {

513 
i
;

514 
	`mem£t
(
r¥aû
, 0, (rspace));

515 
r¥aû
[0] = 
IPOPT_NOOP
;

516 
r¥aû
[1+
IPOPT_OPTVAL
] = (
İtiÚs
 & 
F_SO_DONTROUTE
è? 
IPOPT_SSRR


517 : 
IPOPT_LSRR
;

518 
r¥aû
[1+
IPOPT_OLEN
] = 3 + 
Äou‹
*4;

519 
r¥aû
[1+
IPOPT_OFFSET
] = 
IPOPT_MINOFF
;

520 
i
=0; i<
Äou‹
; i++)

521 *(
__u32
*)&
r¥aû
[4+
i
*4] = 
rou‹
[i];

523 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IP
, 
IP_OPTIONS
, 
r¥aû
, 4 + 
Äou‹
*4) < 0) {

524 
	`³¼Ü
("ping:„ecord„oute");

525 
	`ex™
(2);

527 
İ’
 = 40;

532 
hŞd
 = 
d©®’
 + 8;

533 
hŞd
 +ğ((hŞd+511)/512)*(
İ’
 + 20 + 16 + 64 + 160);

534 
	`sock_£tbufs
(
icmp_sock
, 
hŞd
);

536 ià(
brßdÿ¡_pšgs
) {

537 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_BROADCAST
,

538 &
brßdÿ¡_pšgs
, (broadcast_pings)) < 0) {

539 
	`³¼Ü
 ("ping: can't set broadcasting");

540 
	`ex™
(2);

544 ià(
İtiÚs
 & 
F_NOLOOP
) {

545 
loİ
 = 0;

546 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IP
, 
IP_MULTICAST_LOOP
,

547 &
loİ
, 1) == -1) {

548 
	`³¼Ü
 ("ping: can't disable multicast†oopback");

549 
	`ex™
(2);

552 ià(
İtiÚs
 & 
F_TTL
) {

553 
™
 = 
‰l
;

554 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IP
, 
IP_MULTICAST_TTL
,

555 &
‰l
, 1) == -1) {

556 
	`³¼Ü
 ("ping: can't set multicastime-to-live");

557 
	`ex™
(2);

559 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IP
, 
IP_TTL
,

560 &
™
, (ittl)) == -1) {

561 
	`³¼Ü
 ("ping: can't set unicastime-to-live");

562 
	`ex™
(2);

566 ià(
d©®’
 > 0xFFFF - 8 - 
İ’
 - 20) {

567 ià(
uid
 || 
d©®’
 > (
ouack
)-8) {

568 
	`årštf
(
¡d”r
, "E¼Ü:…ack‘ siz%d i toØÏrge. Maximum i %d\n", 
d©®’
, 0xFFFF-8-20-
İ’
);

569 
	`ex™
(2);

572 
	`årštf
(
¡d”r
, "WARNING:…ack‘ siz%d i toØÏrge. Maximum i %d\n", 
d©®’
, 0xFFFF-8-20-
İ’
);

575 ià(
d©®’
 >ğ(
timev®
))

576 
timšg
 = 1;

577 
·ckËn
 = 
d©®’
 + 
MAXIPLEN
 + 
MAXICMPLEN
;

578 ià(!(
·ck‘
 = (
u_ch¬
 *)
	`m®loc
((
u_št
)
·ckËn
))) {

579 
	`årštf
(
¡d”r
, "ping: out of memory.\n");

580 
	`ex™
(2);

583 
	`´štf
("PING % (%sè", 
ho¡Çme
, 
	`š‘_Áß
(
wh”‘o
.
sš_addr
));

584 ià(
deviû
 || (
İtiÚs
&
F_STRICTSOURCE
))

585 
	`´štf
("äom % %s: ", 
	`š‘_Áß
(
sourû
.
sš_addr
), 
deviû
 ?: "");

586 
	`´štf
("%d(%dèby‹ oàd©a.\n", 
d©®’
, d©®’+8+
İ’
+20);

588 
	`£tup
(
icmp_sock
);

590 
	`maš_loİ
(
icmp_sock
, 
·ck‘
, 
·ckËn
);

591 
	}
}

594 
	$»ûive_”rÜ_msg
()

596 
»s
;

597 
cbuf
[512];

598 
iovec
 
iov
;

599 
msghdr
 
msg
;

600 
cmsghdr
 *
cmsg
;

601 
sock_ex‹nded_”r
 *
e
;

602 
icmphdr
 
icmph
;

603 
sockaddr_š
 
rg‘
;

604 
Ãt_”rÜs
 = 0;

605 
loÿl_”rÜs
 = 0;

606 
§ved_”ºo
 = 
”ºo
;

608 
iov
.
iov_ba£
 = &
icmph
;

609 
iov
.
iov_Ën
 = (
icmph
);

610 
msg
.
msg_Çme
 = (*)&
rg‘
;

611 
msg
.
msg_Çm–’
 = (
rg‘
);

612 
msg
.
msg_iov
 = &
iov
;

613 
msg
.
msg_iovËn
 = 1;

614 
msg
.
msg_æags
 = 0;

615 
msg
.
msg_cÚŒŞ
 = 
cbuf
;

616 
msg
.
msg_cÚŒŞËn
 = (
cbuf
);

618 
»s
 = 
	`»cvmsg
(
icmp_sock
, &
msg
, 
MSG_ERRQUEUE
|
MSG_DONTWAIT
);

619 ià(
»s
 < 0)

620 
out
;

622 
e
 = 
NULL
;

623 
cmsg
 = 
	`CMSG_FIRSTHDR
(&
msg
); cmsg; cmsg = 
	`CMSG_NXTHDR
(&msg, cmsg)) {

624 ià(
cmsg
->
cmsg_Ëv–
 =ğ
SOL_IP
) {

625 ià(
cmsg
->
cmsg_ty³
 =ğ
IP_RECVERR
)

626 
e
 = (
sock_ex‹nded_”r
 *)
	`CMSG_DATA
(
cmsg
);

629 ià(
e
 =ğ
NULL
)

630 
	`abÜt
();

632 ià(
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_LOCAL
) {

633 
loÿl_”rÜs
++;

634 ià(
İtiÚs
 & 
F_QUIET
)

635 
out
;

636 ià(
İtiÚs
 & 
F_FLOOD
)

637 
	`wr™e_¡dout
("E", 1);

638 ià(
e
->
“_”ºo
 !ğ
EMSGSIZE
)

639 
	`årštf
(
¡d”r
, "pšg:†oÿÈ”rÜ: %s\n", 
	`¡»¼Ü
(
e
->
“_”ºo
));

641 
	`årštf
(
¡d”r
, "pšg:†oÿÈ”rÜ: Mes§gtoØlÚg, mtu=%u\n", 
e
->
“_šfo
);

642 
Ã¼Üs
++;

643 } ià(
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_ICMP
) {

644 
sockaddr_š
 *
sš
 = (sockaddr_š*)(
e
+1);

646 ià(
»s
 < (
icmph
) ||

647 
rg‘
.
sš_addr
.
s_addr
 !ğ
wh”‘o
.sin_addr.s_addr ||

648 
icmph
.
ty³
 !ğ
ICMP_ECHO
 ||

649 
icmph
.
un
.
echo
.
id
 !ğ
id’t
) {

651 
§ved_”ºo
 = 0;

652 
out
;

655 
	`acknowËdge
(
	`Áohs
(
icmph
.
un
.
echo
.
£qu’û
));

657 ià(!
wÜkšg_»cv”r
) {

658 
icmp_f‹r
 
ft
;

659 
wÜkšg_»cv”r
 = 1;

661 
ft
.
d©a
 = ~((1<<
ICMP_SOURCE_QUENCH
)|

662 (1<<
ICMP_REDIRECT
)|

663 (1<<
ICMP_ECHOREPLY
));

664 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_RAW
, 
ICMP_FILTER
, (*)&
ft
, (filt)) == -1)

665 
	`³¼Ü
("\rWARNING: setsockopt(ICMP_FILTER)");

668 
Ãt_”rÜs
++;

669 
Ã¼Üs
++;

670 ià(
İtiÚs
 & 
F_QUIET
)

671 
out
;

672 ià(
İtiÚs
 & 
F_FLOOD
) {

673 
	`wr™e_¡dout
("\bE", 2);

675 
	`´št_time¡amp
();

676 
	`´štf
("From % icmp_£q=%u ", 
	`´_addr
(
sš
->
sš_addr
.
s_addr
), 
	`Áohs
(
icmph
.
un
.
echo
.
£qu’û
));

677 
	`´_icmph
(
e
->
“_ty³
,ƒ->
“_code
,ƒ->
“_šfo
, 
NULL
);

678 
	`fæush
(
¡dout
);

682 
out
:

683 
”ºo
 = 
§ved_”ºo
;

684  
Ãt_”rÜs
 ? : -
loÿl_”rÜs
;

685 
	}
}

695 
	$£nd_´obe
()

697 
icmphdr
 *
iı
;

698 
cc
;

699 
i
;

701 
iı
 = (
icmphdr
 *)
ouack
;

702 
iı
->
ty³
 = 
ICMP_ECHO
;

703 
iı
->
code
 = 0;

704 
iı
->
checksum
 = 0;

705 
iı
->
un
.
echo
.
£qu’û
 = 
	`htÚs
(
Á¿nsm™‹d
+1);

706 
iı
->
un
.
echo
.
id
 = 
id’t
;

708 
	`rcvd_ş—r
(
Á¿nsm™‹d
+1);

710 ià(
timšg
) {

711 ià(
İtiÚs
&
F_LATENCY
) {

712 
timev®
 
tmp_tv
;

713 
	`g‘timeofday
(&
tmp_tv
, 
NULL
);

714 
	`memıy
(
iı
+1, &
tmp_tv
, (tmp_tv));

716 
	`mem£t
(
iı
+1, 0, (
timev®
));

720 
cc
 = 
d©®’
 + 8;

723 
iı
->
checksum
 = 
	`š_cksum
((
u_shÜt
 *)iı, 
cc
, 0);

725 ià(
timšg
 && !(
İtiÚs
&
F_LATENCY
)) {

726 
timev®
 
tmp_tv
;

727 
	`g‘timeofday
(&
tmp_tv
, 
NULL
);

728 
	`memıy
(
iı
+1, &
tmp_tv
, (tmp_tv));

729 
iı
->
checksum
 = 
	`š_cksum
((
u_shÜt
 *)&
tmp_tv
, (tmp_tv), ~icp->checksum);

733 
iovec
 
iov
 = {
ouack
, 0};

734 
msghdr
 
m
 = { &
wh”‘o
, (whereto),

735 &
iov
, 1, &
cmsg
, 0, 0 };

736 
m
.
msg_cÚŒŞËn
 = 
cmsg_Ën
;

737 
iov
.
iov_Ën
 = 
cc
;

739 
i
 = 
	`£ndmsg
(
icmp_sock
, &
m
, 
cÚfœm
);

740 
cÚfœm
 = 0;

743  (
cc
 =ğ
i
 ? 0 : i);

744 
	}
}

753 
	$´_echo_»¶y
(
__u8
 *
_iı
, 
Ën
)

755 
icmphdr
 *
iı
 = (icmphd¸*)
_iı
;

756 
	`´štf
(" icmp_£q=%u", 
	`Áohs
(
iı
->
un
.
echo
.
£qu’û
));

757 
	}
}

760 
	$·r£_»¶y
(
msghdr
 *
msg
, 
cc
, *
addr
, 
timev®
 *
tv
)

762 
sockaddr_š
 *
äom
 = 
addr
;

763 
__u8
 *
buf
 = 
msg
->
msg_iov
->
iov_ba£
;

764 
icmphdr
 *
iı
;

765 
hdr
 *

;

766 
hËn
;

767 
csçed
;

770 

 = (
hdr
 *)
buf
;

771 
hËn
 = 

->
ihl
*4;

772 ià(
cc
 < 
hËn
 + 8 || 

->
ihl
 < 5) {

773 ià(
İtiÚs
 & 
F_VERBOSE
)

774 
	`årštf
(
¡d”r
, "pšg:…ack‘oØshÜˆ(%d by‹sèäom %s\n", 
cc
,

775 
	`´_addr
(
äom
->
sš_addr
.
s_addr
));

780 
cc
 -ğ
hËn
;

781 
iı
 = (
icmphdr
 *)(
buf
 + 
hËn
);

782 
csçed
 = 
	`š_cksum
((
u_shÜt
 *)
iı
, 
cc
, 0);

784 ià(
iı
->
ty³
 =ğ
ICMP_ECHOREPLY
) {

785 ià(
iı
->
un
.
echo
.
id
 !ğ
id’t
)

787 ià(
	`g©h”_¡©i¡ics
((
__u8
*)
iı
, (*iı), 
cc
,

788 
	`Áohs
(
iı
->
un
.
echo
.
£qu’û
),

789 

->
‰l
, 0, 
tv
, 
	`´_addr
(
äom
->
sš_addr
.
s_addr
),

790 
´_echo_»¶y
))

797 
iı
->
ty³
) {

798 
ICMP_ECHO
:

801 
ICMP_SOURCE_QUENCH
:

802 
ICMP_REDIRECT
:

803 
ICMP_DEST_UNREACH
:

804 
ICMP_TIME_EXCEEDED
:

805 
ICMP_PARAMETERPROB
:

807 
hdr
 * 
h
 = (hd¸*)(&
iı
[1]);

808 
icmphdr
 *
iı1
 = (icmphdr*)((*)
h
 + iph->
ihl
*4);

809 
”rÜ_pkt
;

810 ià(
cc
 < 8+(
hdr
)+8 ||

811 
cc
 < 8+
h
->
ihl
*4+8)

813 ià(
iı1
->
ty³
 !ğ
ICMP_ECHO
 ||

814 
h
->
daddr
 !ğ
wh”‘o
.
sš_addr
.
s_addr
 ||

815 
iı1
->
un
.
echo
.
id
 !ğ
id’t
)

817 
”rÜ_pkt
 = (
iı
->
ty³
 !ğ
ICMP_REDIRECT
 &&

818 
iı
->
ty³
 !ğ
ICMP_SOURCE_QUENCH
);

819 ià(
”rÜ_pkt
) {

820 
	`acknowËdge
(
	`Áohs
(
iı1
->
un
.
echo
.
£qu’û
));

821 ià(
wÜkšg_»cv”r
) {

824 
Úû
;

829 ià(
Úû
++ == 1)

830 
	`årštf
(
¡d”r
, "\rWARNING: kernel is‚ot very fresh, upgrade is„ecommended.\n");

831 ià(
Úû
 == 1)

835 
Ã¼Üs
+=
”rÜ_pkt
;

836 ià(
İtiÚs
&
F_QUIET
)

837  !
”rÜ_pkt
;

838 ià(
İtiÚs
 & 
F_FLOOD
) {

839 ià(
”rÜ_pkt
)

840 
	`wr™e_¡dout
("\bE", 2);

841  !
”rÜ_pkt
;

843 
	`´št_time¡amp
();

844 
	`´štf
("From %s: icmp_seq=%u ",

845 
	`´_addr
(
äom
->
sš_addr
.
s_addr
),

846 
	`Áohs
(
iı1
->
un
.
echo
.
£qu’û
));

847 ià(
csçed
)

848 
	`´štf
("(BAD CHECKSUM)");

849 
	`´_icmph
(
iı
->
ty³
, iı->
code
, 
	`Áohl
(iı->
un
.
g©eway
), icp);

850  !
”rÜ_pkt
;

856 ià((
İtiÚs
 & 
F_FLOOD
è&& !(İtiÚ & (
F_VERBOSE
|
F_QUIET
))) {

857 ià(!
csçed
)

858 
	`wr™e_¡dout
("!E", 2);

860 
	`wr™e_¡dout
("!EC", 3);

863 ià(!(
İtiÚs
 & 
F_VERBOSE
è|| 
uid
)

865 ià(
İtiÚs
 & 
F_PTIMEOFDAY
) {

866 
timev®
 
»cv_time
;

867 
	`g‘timeofday
(&
»cv_time
, 
NULL
);

868 
	`´štf
("%lu.%06lu ", ()
»cv_time
.
tv_£c
, (ìecv_time.
tv_u£c
);

870 
	`´štf
("From %s: ", 
	`´_addr
(
äom
->
sš_addr
.
s_addr
));

871 ià(
csçed
) {

872 
	`´štf
("(BAD CHECKSUM)\n");

875 
	`´_icmph
(
iı
->
ty³
, iı->
code
, 
	`Áohl
(iı->
un
.
g©eway
), icp);

879 ià(!(
İtiÚs
 & 
F_FLOOD
)) {

880 
	`´_İtiÚs
(
buf
 + (
hdr
), 
hËn
);

882 ià(
İtiÚs
 & 
F_AUDIBLE
)

883 
	`putch¬
('\a');

884 
	`putch¬
('\n');

885 
	`fæush
(
¡dout
);

887 
	`putch¬
('\a');

888 
	`fæush
(
¡dout
);

891 
	}
}

894 #ià
BYTE_ORDER
 =ğ
LITTLE_ENDIAN


895 
	#ODDBYTE
(
v
è(v)

	)

896 #–ià
BYTE_ORDER
 =ğ
BIG_ENDIAN


897 
	#ODDBYTE
(
v
è((
u_shÜt
)(vè<< 8)

	)

899 
	#ODDBYTE
(
v
è
	`htÚs
((
u_shÜt
)(vè<< 8)

	)

902 
u_shÜt


903 
	$š_cksum
(cÚ¡ 
u_shÜt
 *
addr
, 
Ën
, u_shÜˆ
csum
)

905 
Æeá
 = 
Ën
;

906 cÚ¡ 
u_shÜt
 *
w
 = 
addr
;

907 
u_shÜt
 
ªsw”
;

908 
sum
 = 
csum
;

916 
Æeá
 > 1) {

917 
sum
 +ğ*
w
++;

918 
Æeá
 -= 2;

922 ià(
Æeá
 == 1)

923 
sum
 +ğ
	`ODDBYTE
(*(
u_ch¬
 *)
w
);

928 
sum
 = (sum >> 16) + (sum & 0xffff);

929 
sum
 += (sum >> 16);

930 
ªsw”
 = ~
sum
;

931  (
ªsw”
);

932 
	}
}

938 
	$´_icmph
(
__u8
 
ty³
, __u8 
code
, 
__u32
 
šfo
, 
icmphdr
 *
iı
)

940 
ty³
) {

941 
ICMP_ECHOREPLY
:

942 
	`´štf
("Echo Reply\n");

945 
ICMP_DEST_UNREACH
:

946 
code
) {

947 
ICMP_NET_UNREACH
:

948 
	`´štf
("Destination Net Unreachable\n");

950 
ICMP_HOST_UNREACH
:

951 
	`´štf
("Destination Host Unreachable\n");

953 
ICMP_PROT_UNREACH
:

954 
	`´štf
("Destination Protocol Unreachable\n");

956 
ICMP_PORT_UNREACH
:

957 
	`´štf
("Destination Port Unreachable\n");

959 
ICMP_FRAG_NEEDED
:

960 
	`´štf
("F¿g‚“ded‡nd DF s‘ (mtu = %u)\n", 
šfo
);

962 
ICMP_SR_FAILED
:

963 
	`´štf
("Source Route Failed\n");

965 
ICMP_NET_UNKNOWN
:

966 
	`´štf
("Destination Net Unknown\n");

968 
ICMP_HOST_UNKNOWN
:

969 
	`´štf
("Destination Host Unknown\n");

971 
ICMP_HOST_ISOLATED
:

972 
	`´štf
("Source Host Isolated\n");

974 
ICMP_NET_ANO
:

975 
	`´štf
("Destination Net Prohibited\n");

977 
ICMP_HOST_ANO
:

978 
	`´štf
("Destination Host Prohibited\n");

980 
ICMP_NET_UNR_TOS
:

981 
	`´štf
("Destination Net Unreachable for Type of Service\n");

983 
ICMP_HOST_UNR_TOS
:

984 
	`´štf
("Destination Host Unreachable for Type of Service\n");

986 
ICMP_PKT_FILTERED
:

987 
	`´štf
("Packet filtered\n");

989 
ICMP_PREC_VIOLATION
:

990 
	`´štf
("Precedence Violation\n");

992 
ICMP_PREC_CUTOFF
:

993 
	`´štf
("Precedence Cutoff\n");

996 
	`´štf
("De¡ UÄ—chabË, Bad Code: %d\n", 
code
);

999 ià(
iı
 && (
İtiÚs
 & 
F_VERBOSE
))

1000 
	`´_h
((
hdr
*)(
iı
 + 1));

1002 
ICMP_SOURCE_QUENCH
:

1003 
	`´štf
("Source Quench\n");

1004 ià(
iı
 && (
İtiÚs
 & 
F_VERBOSE
))

1005 
	`´_h
((
hdr
*)(
iı
 + 1));

1007 
ICMP_REDIRECT
:

1008 
code
) {

1009 
ICMP_REDIR_NET
:

1010 
	`´štf
("Redirect Network");

1012 
ICMP_REDIR_HOST
:

1013 
	`´štf
("Redirect Host");

1015 
ICMP_REDIR_NETTOS
:

1016 
	`´štf
("Redirect Type of Service‡nd Network");

1018 
ICMP_REDIR_HOSTTOS
:

1019 
	`´štf
("Redirect Type of Service‡nd Host");

1022 
	`´štf
("Redœeù, Bad Code: %d", 
code
);

1025 ià(
iı
)

1026 
	`´štf
("(New‚exthİ: %s)\n", 
	`´_addr
(
iı
->
un
.
g©eway
));

1027 ià(
iı
 && (
İtiÚs
 & 
F_VERBOSE
))

1028 
	`´_h
((
hdr
*)(
iı
 + 1));

1030 
ICMP_ECHO
:

1031 
	`´štf
("Echo Request\n");

1034 
ICMP_TIME_EXCEEDED
:

1035 
code
) {

1036 
ICMP_EXC_TTL
:

1037 
	`´štf
("Timeo†iveƒxceeded\n");

1039 
ICMP_EXC_FRAGTIME
:

1040 
	`´štf
("Frag„eassemblyimeƒxceeded\n");

1043 
	`´štf
("Timexûeded, Bad Code: %d\n", 
code
);

1046 ià(
iı
 && (
İtiÚs
 & 
F_VERBOSE
))

1047 
	`´_h
((
hdr
*)(
iı
 + 1));

1049 
ICMP_PARAMETERPROB
:

1050 
	`´štf
("P¬am‘”…robËm:…oš‹¸ğ%u\n", 
iı
 ? (
	`Áohl
(iı->
un
.
g©eway
)>>24è: 
šfo
);

1051 ià(
iı
 && (
İtiÚs
 & 
F_VERBOSE
))

1052 
	`´_h
((
hdr
*)(
iı
 + 1));

1054 
ICMP_TIMESTAMP
:

1055 
	`´štf
("Timestamp\n");

1058 
ICMP_TIMESTAMPREPLY
:

1059 
	`´štf
("Timestamp Reply\n");

1062 
ICMP_INFO_REQUEST
:

1063 
	`´štf
("Information Request\n");

1066 
ICMP_INFO_REPLY
:

1067 
	`´štf
("Information Reply\n");

1070 #ifdeà
ICMP_MASKREQ


1071 
ICMP_MASKREQ
:

1072 
	`´štf
("Address Mask Request\n");

1075 #ifdeà
ICMP_MASKREPLY


1076 
ICMP_MASKREPLY
:

1077 
	`´štf
("Address Mask Reply\n");

1081 
	`´štf
("Bad ICMPy³: %d\n", 
ty³
);

1083 
	}
}

1085 
	$´_İtiÚs
(* 
ı
, 
hËn
)

1087 
i
, 
j
;

1088 
İ’
, 
tÙËn
;

1089 * 
İŒ
;

1090 
Şd_¼Ën
;

1091 
Şd_¼
[
MAX_IPOPTLEN
];

1093 
tÙËn
 = 
hËn
-(
hdr
);

1094 
İŒ
 = 
ı
;

1096 
tÙËn
 > 0) {

1097 ià(*
İŒ
 =ğ
IPOPT_EOL
)

1099 ià(*
İŒ
 =ğ
IPOPT_NOP
) {

1100 
tÙËn
--;

1101 
İŒ
++;

1102 
	`´štf
("\nNOP");

1105 
ı
 = 
İŒ
;

1106 
İ’
 = 
İŒ
[1];

1107 ià(
İ’
 < 2 || o±ËÀ> 
tÙËn
)

1110 *
ı
) {

1111 
IPOPT_SSRR
:

1112 
IPOPT_LSRR
:

1113 
	`´štf
("\n%cSRR: ", *
ı
==
IPOPT_SSRR
 ? 'S' : 'L');

1114 
j
 = *++
ı
;

1115 
i
 = *++
ı
;

1116 
i
 -= 4;

1117 
ı
++;

1118 ià(
j
 > 
IPOPT_MINOFF
) {

1120 
__u32
 
add»ss
;

1121 
	`memıy
(&
add»ss
, 
ı
, 4);

1122 
ı
 += 4;

1123 ià(
add»ss
 == 0)

1124 
	`´štf
("\t0.0.0.0");

1126 
	`´štf
("\t%s", 
	`´_addr
(
add»ss
));

1127 
j
 -= 4;

1128 
	`putch¬
('\n');

1129 ià(
j
 <ğ
IPOPT_MINOFF
)

1134 
IPOPT_RR
:

1135 
j
 = *++
ı
;

1136 
i
 = *++
ı
;

1137 ià(
i
 > 
j
)

1138 
i
 = 
j
;

1139 
i
 -ğ
IPOPT_MINOFF
;

1140 ià(
i
 <= 0)

1142 ià(
i
 =ğ
Şd_¼Ën


1143 && !
	`memcmp
(
ı
, 
Şd_¼
, 
i
)

1144 && !(
İtiÚs
 & 
F_FLOOD
)) {

1145 
	`´štf
("\t(same„oute)");

1146 
i
 = ((i + 3) / 4) * 4;

1147 
ı
 +ğ
i
;

1150 
Şd_¼Ën
 = 
i
;

1151 
	`memıy
(
Şd_¼
, (*)
ı
, 
i
);

1152 
	`´štf
("\nRR: ");

1153 
ı
++;

1155 
__u32
 
add»ss
;

1156 
	`memıy
(&
add»ss
, 
ı
, 4);

1157 
ı
 += 4;

1158 ià(
add»ss
 == 0)

1159 
	`´štf
("\t0.0.0.0");

1161 
	`´štf
("\t%s", 
	`´_addr
(
add»ss
));

1162 
i
 -= 4;

1163 
	`putch¬
('\n');

1164 ià(
i
 <= 0)

1168 
IPOPT_TS
:

1170 
¡dtime
 = 0, 
nÚ¡dtime
 = 0;

1171 
__u8
 
æags
;

1172 
j
 = *++
ı
;

1173 
i
 = *++
ı
;

1174 ià(
i
 > 
j
)

1175 
i
 = 
j
;

1176 
i
 -= 5;

1177 ià(
i
 <= 0)

1179 
æags
 = *++
ı
;

1180 
	`´štf
("\nTS: ");

1181 
ı
++;

1183 
l
;

1185 ià((
æags
&0xFè!ğ
IPOPT_TS_TSONLY
) {

1186 
__u32
 
add»ss
;

1187 
	`memıy
(&
add»ss
, 
ı
, 4);

1188 
ı
 += 4;

1189 ià(
add»ss
 == 0)

1190 
	`´štf
("\t0.0.0.0");

1192 
	`´štf
("\t%s", 
	`´_addr
(
add»ss
));

1193 
i
 -= 4;

1194 ià(
i
 <= 0)

1197 
l
 = *
ı
++;

1198 
l
 = (l<<8è+ *
ı
++;

1199 
l
 = (l<<8è+ *
ı
++;

1200 
l
 = (l<<8è+ *
ı
++;

1202 ià(
l
 & 0x80000000) {

1203 ià(
nÚ¡dtime
==0)

1204 
	`´štf
("\t%ld‡bsŞu‹‚Ù-¡ªd¬d", 
l
&0x7fffffff);

1206 
	`´štf
("\t%ld‚Ù-¡ªd¬d", (
l
&0x7fffffffè- 
nÚ¡dtime
);

1207 
nÚ¡dtime
 = 
l
&0x7fffffff;

1209 ià(
¡dtime
==0)

1210 
	`´štf
("\t%ld‡bsŞu‹", 
l
);

1212 
	`´štf
("\t%ld", 
l
 - 
¡dtime
);

1213 
¡dtime
 = 
l
;

1215 
i
 -= 4;

1216 
	`putch¬
('\n');

1217 ià(
i
 <= 0)

1220 ià(
æags
>>4)

1221 
	`´štf
("UÄecÜded hİs: %d\n", 
æags
>>4);

1225 
	`´štf
("\nunknowÀİtiÚ %x", *
ı
);

1228 
tÙËn
 -ğ
İ’
;

1229 
İŒ
 +ğ
İ’
;

1231 
	}
}

1238 
	$´_h
(
hdr
 *

)

1240 
hËn
;

1241 
u_ch¬
 *
ı
;

1243 
hËn
 = 

->
ihl
 << 2;

1244 
ı
 = (
u_ch¬
 *)

 + 20;

1246 
	`´štf
("Vr HL TOS Len ID Flg off TTL Pro cks Src Dst Data\n");

1247 
	`´štf
(" %1x %1x %02x %04x %04x",

1248 

->
v”siÚ
, ip->
ihl
, ip->
tos
, ip->
tÙ_Ën
, ip->
id
);

1249 
	`´štf
(" %1x %04x", ((

->
äag_off
) & 0xe000) >> 13,

1250 (

->
äag_off
) & 0x1fff);

1251 
	`´štf
(" %02x %02x %04x", 

->
‰l
, ip->
´ÙocŞ
, ip->
check
);

1252 
	`´štf
(" % ", 
	`š‘_Áß
(*(
š_addr
 *)&

->
§ddr
));

1253 
	`´štf
(" % ", 
	`š‘_Áß
(*(
š_addr
 *)&

->
daddr
));

1254 
	`´štf
("\n");

1255 
	`´_İtiÚs
(
ı
, 
hËn
);

1256 
	}
}

1264 
	$´_addr
(
__u32
 
addr
)

1266 
ho¡’t
 *
hp
;

1267 
buf
[4096];

1269 
š_´_addr
 = !
	`£tjmp
(
´_addr_jmp
);

1271 ià(
ex™šg
 || (
İtiÚs
 & 
F_NUMERIC
) ||

1272 !(
hp
 = 
	`g‘ho¡byaddr
((*)&
addr
, 4, 
AF_INET
)))

1273 
	`¥rštf
(
buf
, "%s", 
	`š‘_Áß
(*(
š_addr
 *)&
addr
));

1275 *
s
;

1276 #ià
USE_IDN


1277 ià(
	`idÇ_to_unicode_lzlz
(
hp
->
h_Çme
, &
s
, 0è!ğ
IDNA_SUCCESS
)

1278 
s
 = 
NULL
;

1280 
s
 = 
NULL
;

1282 
	`¢´štf
(
buf
, (buf), "% (%s)", 
s
 ? s : 
hp
->
h_Çme
,

1283 
	`š‘_Áß
(*(
š_addr
 *)&
addr
));

1284 #ià
USE_IDN


1285 
	`ä“
(
s
);

1289 
š_´_addr
 = 0;

1291 (
buf
);

1292 
	}
}

1296 
	$·r£tos
(*
¡r
)

1298 cÚ¡ *
ı
;

1299 
tos
;

1300 *
•
;

1303 ià(
¡r
[0] == '0' && (str[1] == 'x' || str[1] == 'X')) {

1304 
ı
 = 
¡r
 + 2;

1305 
tos
 = ()
	`¡¹Ş
(
ı
, &
•
, 16);

1307 
tos
 = ()
	`¡¹Ş
(
¡r
, &
•
, 10);

1310 ià(*
•
 != '\0') {

1311 
	`årštf
(
¡d”r
, "pšg: \"%s\" bad v®ufÜ TOS\n", 
¡r
);

1312 
	`ex™
(2);

1315 ià(
tos
 > 
TOS_MAX
) {

1316 
	`årštf
(
¡d”r
, "ping:he decimal value of TOS bits must be 0-254 (or zero)\n");

1317 
	`ex™
(2);

1319 (
tos
);

1320 
	}
}

1322 
	~<lšux/f‹r.h
>

1324 
	$š¡®l_f‹r
()

1326 
Úû
;

1327 
sock_f‹r
 
š¢s
[] = {

1328 
	`BPF_STMT
(
BPF_LDX
|
BPF_B
|
BPF_MSH
, 0),

1329 
	`BPF_STMT
(
BPF_LD
|
BPF_H
|
BPF_IND
, 4),

1330 
	`BPF_JUMP
(
BPF_JMP
|
BPF_JEQ
|
BPF_K
, 0xAAAA, 0, 1),

1331 
	`BPF_STMT
(
BPF_RET
|
BPF_K
, ~0U),

1332 
	`BPF_STMT
(
BPF_LD
|
BPF_B
|
BPF_IND
, 0),

1333 
	`BPF_JUMP
(
BPF_JMP
|
BPF_JEQ
|
BPF_K
, 
ICMP_ECHOREPLY
, 1, 0),

1334 
	`BPF_STMT
(
BPF_RET
|
BPF_K
, 0xFFFFFFF),

1335 
	`BPF_STMT
(
BPF_RET
|
BPF_K
, 0)

1337 
sock_årog
 
f‹r
 = {

1338  
š¢s
 / (insns[0]),

1339 
š¢s


1342 ià(
Úû
)

1344 
Úû
 = 1;

1347 
š¢s
[2] = (
sock_f‹r
)
	`BPF_JUMP
(
BPF_JMP
|
BPF_JEQ
|
BPF_K
, 
	`htÚs
(
id’t
), 0, 1);

1349 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_ATTACH_FILTER
, &
f‹r
, (filter)))

1350 
	`³¼Ü
("WARNING: failedo install socket filter\n");

1351 
	}
}

1353 
	#USAGE_NEWLINE
 "\À "

	)

1355 
	$u§ge
()

1357 
	`årštf
(
¡d”r
,

1365 
USAGE_NEWLINE


1371 
USAGE_NEWLINE


1376 
USAGE_NEWLINE


1382 
	`ex™
(2);

1383 
	}
}

	@ping6.c

46 #iâdeà
lšt


47 
	gcİyright
[] =

69 
	~"pšg_commÚ.h
"

71 
	~<lšux/f‹r.h
>

72 
	~<Ãtš‘/6.h
>

73 
	~<Ãtš‘/icmp6.h
>

74 
	~<»sŞv.h
>

75 #iâdeà
WITHOUT_IFADDRS


76 
	~<içddrs.h
>

79 #ifdeà
USE_IDN


80 
	~<¡ršg´•.h
>

83 
	~"pšg6_niqu”y.h
"

84 
	~"š6_æowÏb–.h
"

86 #iâdeà
SOL_IPV6


87 
	#SOL_IPV6
 
IPPROTO_IPV6


	)

90 #iâdeà
SOL_ICMPV6


91 
	#SOL_ICMPV6
 
IPPROTO_ICMPV6


	)

95 #iâdeà
ICMP6_DST_UNREACH_BEYONDSCOPE


96 
	#ICMP6_DST_UNREACH_BEYONDSCOPE
 
ICMP6_DST_UNREACH_NOTNEIGHBOR


	)

99 #ià
defšed
(
ENABLE_PING6_RTHDR
è&& !defšed(
ENABLE_PING6_RTHDR_RFC3542
)

100 #iâdeà
IPV6_SRCRT_TYPE_0


101 
	#IPV6_SRCRT_TYPE_0
 0

	)

105 #iâdeà
MLD_LISTENER_QUERY


106 
	#MLD_LISTENER_QUERY
 130

	)

107 
	#MLD_LISTENER_REPORT
 131

	)

108 
	#MLD_LISTENER_REDUCTION
 132

	)

111 
	#BIT_CLEAR
(
Ä
, 
addr
èdØ{ ((
__u32
 *)×ddr))[Òrè>> 5] &ğ~(1U << (Òrè& 31)); } 0)

	)

112 
	#BIT_SET
(
Ä
, 
addr
èdØ{ ((
__u32
 *)×ddr))[Òrè>> 5] |ğ(1U << (Òrè& 31)); } 0)

	)

113 
	#BIT_TEST
(
Ä
, 
addr
èdØ{ (
__u32
 *)×ddr))[Òrè>> 5] & (1U << (Òrè& 31)); } 0)

	)

115 #iâdeà
ICMP6_FILTER_WILLPASS


116 
	#ICMP6_FILTER_WILLPASS
(
ty³
, 
f‹½
) \

117 (
	`BIT_TEST
((
ty³
), 
f‹½
è=ğ0)

	)

119 
	#ICMP6_FILTER_WILLBLOCK
(
ty³
, 
f‹½
) \

120 
	`BIT_TEST
((
ty³
), 
f‹½
)

	)

122 
	#ICMP6_FILTER_SETPASS
(
ty³
, 
f‹½
) \

123 
	`BIT_CLEAR
((
ty³
), 
f‹½
)

	)

125 
	#ICMP6_FILTER_SETBLOCK
(
ty³
, 
f‹½
) \

126 
	`BIT_SET
((
ty³
), 
f‹½
)

	)

128 
	#ICMP6_FILTER_SETPASSALL
(
f‹½
) \

129 
	`mem£t
(
f‹½
, 0, (
icmp6_f‹r
));

	)

131 
	#ICMP6_FILTER_SETBLOCKALL
(
f‹½
) \

132 
	`mem£t
(
f‹½
, 0xFF, (
icmp6_f‹r
));

	)

135 
	#MAXPACKET
 128000

	)

137 #ifdeà
SO_TIMESTAMP


138 
	#HAVE_SIN6_SCOPEID
 1

	)

141 #iâdeà
SCOPE_DELIMITER


142 
	#SCOPE_DELIMITER
 '%'

	)

145 
__u32
 
	gæowÏb–
;

146 
__u32
 
	gtşass
;

147 #ifdeà
ENABLE_PING6_RTHDR


148 
cmsghdr
 *
	g¤üt
;

151 
sockaddr_š6
 
	gwh”‘o
;

152 
u_ch¬
 
	gouack
[
MAXPACKET
];

153 
	gmax·ck‘
 = (
ouack
);

155 
	gcmsgbuf
[4096];

156 
	gcmsgËn
 = 0;

158 * 
´_addr
(
š6_addr
 *
addr
);

159 * 
´_addr_n
(
š6_addr
 *
addr
);

160 
´_icmph
(
__u8
 
ty³
, __u8 
code
, 
__u32
 
šfo
);

161 
	$u§ge
(è
	`__©Œibu‹
((
nÜ‘uº
));

163 
sockaddr_š6
 
sourû
;

164 *
deviû
;

165 
pmtudisc
=-1;

167 
icmp_sock
;

169 #ifdeà
USE_GNUTLS


170 
	~<gnus/İ’s¦.h
>

172 
	~<İ’s¦/md5.h
>

176 
ni_qu”y
 = -1;

177 
ni_æag
 = 0;

178 *
ni_subjeù
 = 
NULL
;

179 
ni_subjeù_Ën
 = 0;

180 
ni_subjeù_ty³
 = -1;

181 *
ni_group
;

183 
šlše
 
	$Áoh¥
(
__u16
 *
p
)

185 
__u16
 
v
;

186 
	`memıy
(&
v
, 
p
, (v));

187  
	`Áohs
(
v
);

188 
	}
}

190 #ià
defšed
(
ENABLE_PING6_RTHDR
è&& !defšed(
ENABLE_PING6_RTHDR_RFC3542
)

191 
size_t
 
	$š‘6_¤üt_¥aû
(
ty³
, 
£gm’ts
)

193 ià(
ty³
 !ğ0 || 
£gm’ts
 > 24)

196  ((
cmsghdr
è+ (
6_¹hdr0
) +

197 
£gm’ts
 * (
š6_addr
));

198 
	}
}

200 
cmsghdr
 * 
	$š‘6_¤üt_š™
(*
bp
, 
ty³
)

202 
cmsghdr
 *
cmsg
;

204 ià(
ty³
)

205  
NULL
;

207 
	`mem£t
(
bp
, 0, (
cmsghdr
è+ (
6_¹hdr0
));

208 
cmsg
 = (
cmsghdr
 *è
bp
;

210 
cmsg
->
cmsg_Ën
 = (
cmsghdr
è+ (
6_¹hdr0
);

211 
cmsg
->
cmsg_Ëv–
 = 
SOL_IPV6
;

212 
cmsg
->
cmsg_ty³
 = 
IPV6_RTHDR
;

214  
cmsg
;

215 
	}
}

217 
	$š‘6_¤üt_add
(
cmsghdr
 *
cmsg
, cÚ¡ 
š6_addr
 *
addr
)

219 
6_¹hdr0
 *
hdr
;

221 
hdr
 = (
6_¹hdr0
 *è
	`CMSG_DATA
(
cmsg
);

223 
cmsg
->
cmsg_Ën
 +ğ(
š6_addr
);

224 
hdr
->
6r0_Ën
 +ğ(
š6_addr
) / 8;

226 
	`memıy
(&
hdr
->
6r0_addr
[hdr->
6r0_£gËá
++], 
addr
,

227 (
š6_addr
));

230 
	}
}

233 
	$if_Çme2šdex
(cÚ¡ *
iâame
)

235 
i
 = 
	`if_Çm‘ošdex
(
iâame
);

236 ià(!
i
) {

237 
	`årštf
(
¡d”r
, "pšg: unknowÀiçû %s\n", 
iâame
);

238 
	`ex™
(2);

240  
i
;

241 
	}
}

243 
	sniqu”y_İtiÚ
 {

244 *
Çme
;

245 
Çm–’
;

246 
has_¬g
;

247 
d©a
;

248 (*
hªdËr
)(
šdex
, cÚ¡ *
¬g
);

251 
	#NIQUERY_OPTION
(
_Çme
, 
_has_¬g
, 
_d©a
, 
_hªdËr
) \

253 .
Çme
 = 
_Çme
, \

254 .
Çm–’
 = (
_Çme
) - 1, \

255 .
has_¬g
 = 
_has_¬g
, \

256 .
d©a
 = 
_d©a
, \

257 .
hªdËr
 = 
_hªdËr
 \

258 }

	)

260 
niqu”y_İtiÚ_Çme_hªdËr
(
šdex
, cÚ¡ *
¬g
);

261 
niqu”y_İtiÚ_v6_hªdËr
(
šdex
, cÚ¡ *
¬g
);

262 
niqu”y_İtiÚ_v6_æag_hªdËr
(
šdex
, cÚ¡ *
¬g
);

263 
niqu”y_İtiÚ_v4_hªdËr
(
šdex
, cÚ¡ *
¬g
);

264 
niqu”y_İtiÚ_v4_æag_hªdËr
(
šdex
, cÚ¡ *
¬g
);

265 
niqu”y_İtiÚ_subjeù_addr_hªdËr
(
šdex
, cÚ¡ *
¬g
);

266 
niqu”y_İtiÚ_subjeù_Çme_hªdËr
(
šdex
, cÚ¡ *
¬g
);

267 
niqu”y_İtiÚ_h–p_hªdËr
(
šdex
, cÚ¡ *
¬g
);

269 
niqu”y_İtiÚ
 
	gniqu”y_İtiÚs
[] = {

270 
NIQUERY_OPTION
("Çme", 0, 0, 
niqu”y_İtiÚ_Çme_hªdËr
),

271 
NIQUERY_OPTION
("fqdn", 0, 0, 
niqu”y_İtiÚ_Çme_hªdËr
),

272 
NIQUERY_OPTION
("v6", 0, 0, 
niqu”y_İtiÚ_v6_hªdËr
),

273 
NIQUERY_OPTION
("v6-®l", 0, 
NI_IPV6ADDR_F_ALL
, 
niqu”y_İtiÚ_v6_æag_hªdËr
),

274 
NIQUERY_OPTION
("v6-com·tibË", 0, 
NI_IPV6ADDR_F_COMPAT
, 
niqu”y_İtiÚ_v6_æag_hªdËr
),

275 
NIQUERY_OPTION
("v6-lškloÿl", 0, 
NI_IPV6ADDR_F_LINKLOCAL
, 
niqu”y_İtiÚ_v6_æag_hªdËr
),

276 
NIQUERY_OPTION
("v6-s™–oÿl", 0, 
NI_IPV6ADDR_F_SITELOCAL
, 
niqu”y_İtiÚ_v6_æag_hªdËr
),

277 
NIQUERY_OPTION
("v6-glob®", 0, 
NI_IPV6ADDR_F_GLOBAL
, 
niqu”y_İtiÚ_v6_æag_hªdËr
),

278 
NIQUERY_OPTION
("v4", 0, 0, 
niqu”y_İtiÚ_v4_hªdËr
),

279 
NIQUERY_OPTION
("v4-®l", 0, 
NI_IPV4ADDR_F_ALL
, 
niqu”y_İtiÚ_v4_æag_hªdËr
),

280 
NIQUERY_OPTION
("subjeù-v6", 1, 
NI_SUBJ_IPV6
, 
niqu”y_İtiÚ_subjeù_addr_hªdËr
),

281 
NIQUERY_OPTION
("subjeù-v4", 1, 
NI_SUBJ_IPV4
, 
niqu”y_İtiÚ_subjeù_addr_hªdËr
),

282 
NIQUERY_OPTION
("subjeù-Çme", 1, 0, 
niqu”y_İtiÚ_subjeù_Çme_hªdËr
),

283 
NIQUERY_OPTION
("subjeù-fqdn", 1, -1, 
niqu”y_İtiÚ_subjeù_Çme_hªdËr
),

284 
NIQUERY_OPTION
("h–p", 0, 0, 
niqu”y_İtiÚ_h–p_hªdËr
),

288 
šlše
 
	$niqu”y_is_’abËd
()

290  
ni_qu”y
 >= 0;

291 
	}
}

293 #ià
PING6_NONCE_MEMORY


294 
__u8
 *
	gni_nÚû_±r
;

297 
timev®
 
	mtv
;

298 
pid_t
 
	mpid
;

299 } 
	gni_nÚû_£ü‘
;

302 
	$niqu”y_š™_nÚû
()

304 #ià
PING6_NONCE_MEMORY


305 
timev®
 
tv
;

306 
£ed
;

308 
£ed
 = ()
	`g‘pid
();

309 ià(!
	`g‘timeofday
(&
tv
, 
NULL
))

310 
£ed
 ^ğ
tv
.
tv_u£c
;

311 
	`¤ªd
(
£ed
);

313 
ni_nÚû_±r
 = 
	`ÿÎoc
(
NI_NONCE_SIZE
, 
MAX_DUP_CHK
);

314 ià(!
ni_nÚû_±r
) {

315 
	`³¼Ü
("ping6: calloc");

316 
	`ex™
(2);

319 
ni_nÚû_±r
[0] = ~0;

321 
	`g‘timeofday
(&
ni_nÚû_£ü‘
.
tv
, 
NULL
);

322 
ni_nÚû_£ü‘
.
pid
 = 
	`g‘pid
();

324 
	}
}

326 #ià!
PING6_NONCE_MEMORY


327 
	$niqu”y_nÚû
(
__u8
 *
nÚû
, 
fl
)

329 
__u8
 
dige¡
[
MD5_DIGEST_LENGTH
];

330 
£q
 = -1;

332 ià(
fl
 || 
£q
 !ğ*(
__u16
 *)
nÚû
 || seq < 0) {

333 
MD5_CTX
 
ùxt
;

335 
	`MD5_In™
(&
ùxt
);

336 
	`MD5_Upd©e
(&
ùxt
, &
ni_nÚû_£ü‘
, (ni_nonce_secret));

337 
	`MD5_Upd©e
(&
ùxt
, 
nÚû
, (
__u16
));

338 
	`MD5_Fš®
(
dige¡
, &
ùxt
);

340 
£q
 = *(
__u16
 *)
nÚû
;

343 ià(
fl
) {

344 
	`memıy
(
nÚû
 + (
__u16
), 
dige¡
, 
NI_NONCE_SIZE
 - (__u16));

347 ià(
	`memcmp
(
nÚû
 + (
__u16
), 
dige¡
, 
NI_NONCE_SIZE
 - (__u16)))

349  
	`Áoh¥
((
__u16
 *)
nÚû
);

351 
	}
}

354 
šlše
 
	$niqu”y_fl_nÚû
(
__u16
 
£q
, 
__u8
 *
nÚû
)

356 
__u16
 
v
 = 
	`htÚs
(
£q
);

357 #ià
PING6_NONCE_MEMORY


358 
i
;

360 
	`memıy
(&
ni_nÚû_±r
[
NI_NONCE_SIZE
 * (
£q
 % 
MAX_DUP_CHK
)], &
v
, (v));

362 
i
 = (
v
); i < 
NI_NONCE_SIZE
; i++)

363 
ni_nÚû_±r
[
NI_NONCE_SIZE
 * (
£q
 % 
MAX_DUP_CHK
è+ 
i
] = 0x100 * (
	`¿nd
(è/ (
RAND_MAX
 + 1.0));

365 
	`memıy
(
nÚû
, &
ni_nÚû_±r
[
NI_NONCE_SIZE
 * (
£q
 % 
MAX_DUP_CHK
)], NI_NONCE_SIZE);

367 
	`memıy
(
nÚû
, &
v
, (v));

368 
	`niqu”y_nÚû
(
nÚû
, 1);

370 
	}
}

372 
šlše
 
	$niqu”y_check_nÚû
(
__u8
 *
nÚû
)

374 #ià
PING6_NONCE_MEMORY


375 
__u16
 
£q
 = 
	`Áoh¥
((__u16 *)
nÚû
);

376 ià(
	`memcmp
(
nÚû
, &
ni_nÚû_±r
[
NI_NONCE_SIZE
 * (
£q
 % 
MAX_DUP_CHK
)], NI_NONCE_SIZE))

378  
£q
;

380  
	`niqu”y_nÚû
(
nÚû
, 0);

382 
	}
}

384 
	$niqu”y_£t_qty³
(
ty³
)

386 ià(
	`niqu”y_is_’abËd
(è&& 
ni_qu”y
 !ğ
ty³
) {

387 
	`´štf
("Qtype conflict\n");

390 
ni_qu”y
 = 
ty³
;

392 
	}
}

394 
	$niqu”y_İtiÚ_Çme_hªdËr
(
šdex
, cÚ¡ *
¬g
)

396 ià(
	`niqu”y_£t_qty³
(
NI_QTYPE_NAME
) < 0)

399 
	}
}

401 
	$niqu”y_İtiÚ_v6_hªdËr
(
šdex
, cÚ¡ *
¬g
)

403 ià(
	`niqu”y_£t_qty³
(
NI_QTYPE_IPV6ADDR
) < 0)

406 
	}
}

408 
	$niqu”y_İtiÚ_v6_æag_hªdËr
(
šdex
, cÚ¡ *
¬g
)

410 ià(
	`niqu”y_£t_qty³
(
NI_QTYPE_IPV6ADDR
) < 0)

412 
ni_æag
 |ğ
niqu”y_İtiÚs
[
šdex
].
d©a
;

414 
	}
}

416 
	$niqu”y_İtiÚ_v4_hªdËr
(
šdex
, cÚ¡ *
¬g
)

418 ià(
	`niqu”y_£t_qty³
(
NI_QTYPE_IPV4ADDR
) < 0)

421 
	}
}

423 
	$niqu”y_İtiÚ_v4_æag_hªdËr
(
šdex
, cÚ¡ *
¬g
)

425 ià(
	`niqu”y_£t_qty³
(
NI_QTYPE_IPV4ADDR
) < 0)

427 
ni_æag
 |ğ
niqu”y_İtiÚs
[
šdex
].
d©a
;

429 
	}
}

431 
šlše
 
	$niqu”y_is_subjeù_v®id
()

433  
ni_subjeù_ty³
 >ğ0 && 
ni_subjeù
;

434 
	}
}

436 
	$niqu”y_£t_subjeù_ty³
(
ty³
)

438 ià(
	`niqu”y_is_subjeù_v®id
(è&& 
ni_subjeù_ty³
 !ğ
ty³
) {

439 
	`´štf
("Subjectype conflict\n");

442 
ni_subjeù_ty³
 = 
ty³
;

444 
	}
}

446 
	#ARRAY_SIZE
(
¬¿y
è(×¼ayè/ ×¼ay[0]))

	)

447 
	#OFFSET_OF
(
ty³
,
–em
è((
size_t
)&(Ñy³ *)0)->–em)

	)

449 
	$niqu”y_İtiÚ_subjeù_addr_hªdËr
(
šdex
, cÚ¡ *
¬g
)

451 
addršfo
 
hšts
, *
ai0
, *
ai
;

452 
off£t
;

453 
gai
;

455 ià(
	`niqu”y_£t_subjeù_ty³
(
niqu”y_İtiÚs
[
šdex
].
d©a
) < 0)

458 
ni_subjeù_ty³
 = 
niqu”y_İtiÚs
[
šdex
].
d©a
;

460 
	`mem£t
(&
hšts
, 0, (hints));

462 
niqu”y_İtiÚs
[
šdex
].
d©a
) {

463 
NI_SUBJ_IPV6
:

464 
ni_subjeù_Ën
 = (
š6_addr
);

465 
off£t
 = 
	`OFFSET_OF
(
sockaddr_š6
, 
sš6_addr
);

466 
hšts
.
ai_çmy
 = 
AF_INET6
;

468 
NI_SUBJ_IPV4
:

469 
ni_subjeù_Ën
 = (
š_addr
);

470 
off£t
 = 
	`OFFSET_OF
(
sockaddr_š
, 
sš_addr
);

471 
hšts
.
ai_çmy
 = 
AF_INET
;

475 
off£t
 = -1;

478 
hšts
.
ai_sockty³
 = 
SOCK_DGRAM
;

479 #ifdeà
USE_IDN


480 
hšts
.
ai_æags
 = 
AI_IDN
;

483 
gai
 = 
	`g‘addršfo
(
¬g
, 0, &
hšts
, &
ai0
);

484 ià(
gai
) {

485 
	`årštf
(
¡d”r
, "UnknowÀho¡: %s\n", 
¬g
);

489 
ai
 = 
ai0
;‡i;‡˜ğai->
ai_Ãxt
) {

490 *
p
 = 
	`m®loc
(
ni_subjeù_Ën
);

491 ià(!
p
)

493 
	`memıy
(
p
, (
__u8
 *)
ai
->
ai_addr
 + 
off£t
, 
ni_subjeù_Ën
);

494 
	`ä“
(
ni_subjeù
);

495 
ni_subjeù
 = 
p
;

498 
	`ä“addršfo
(
ai0
);

501 
	}
}

503 
	$niqu”y_İtiÚ_subjeù_Çme_hªdËr
(
šdex
, cÚ¡ *
¬g
)

505 
nigroup_buf
[
INET6_ADDRSTRLEN
 + 1 + 
IFNAMSIZ
];

506 *
dÅŒs
[2], **
dµ
, **
Ï¡dÅŒ
;

507 
n
;

508 
i
;

509 *
Çme
, *
p
;

510 *
ÿnÚÇme
 = 
NULL
, *
idn
 = NULL;

511 *
buf
 = 
NULL
;

512 
size_t
 
Çm–’
;

513 
size_t
 
buæ’
;

514 
dÙs
, 
fqdn
 = 
niqu”y_İtiÚs
[
šdex
].
d©a
;

515 
MD5_CTX
 
ùxt
;

516 
__u8
 
dige¡
[
MD5_DIGEST_LENGTH
];

517 #ifdeà
USE_IDN


518 
rc
;

521 ià(
	`niqu”y_£t_subjeù_ty³
(
NI_SUBJ_NAME
) < 0)

524 #ifdeà
USE_IDN


525 
Çme
 = 
	`¡ršg´•_loÿË_to_utf8
(
¬g
);

526 ià(!
Çme
) {

527 
	`årštf
(
¡d”r
, "ping6: IDN support failed.\n");

528 
	`ex™
(2);

531 
Çme
 = 
	`¡rdup
(
¬g
);

532 ià(!
Çme
)

533 
oomex™
;

536 
p
 = 
	`¡rchr
(
Çme
, 
SCOPE_DELIMITER
);

537 ià(
p
) {

538 *
p
 = '\0';

539 ià(
	`¡¾’
(
p
 + 1è>ğ
IFNAMSIZ
) {

540 
	`årštf
(
¡d”r
, "ping6:oo†ong scope‚ame.\n");

541 
	`ex™
(1);

545 #ifdeà
USE_IDN


546 
rc
 = 
	`idÇ_to_ascii_8z
(
Çme
, &
idn
, 0);

547 ià(
rc
) {

548 
	`årštf
(
¡d”r
, "ping6: IDNƒncodingƒrror: %s\n",

549 
	`idÇ_¡»¼Ü
(
rc
));

550 
	`ex™
(2);

553 
idn
 = 
	`¡rdup
(
Çme
);

554 ià(!
idn
)

555 
oomex™
;

558 
Çm–’
 = 
	`¡¾’
(
idn
);

559 
ÿnÚÇme
 = 
	`m®loc
(
Çm–’
 + 1);

560 ià(!
ÿnÚÇme
)

561 
oomex™
;

563 
dÙs
 = 0;

564 
i
 = 0; i < 
Çm–’
 + 1; i++) {

565 
ÿnÚÇme
[
i
] = 
	`isuµ”
(
idn
[i]è? 
	`tŞow”
(idn[i]) : idn[i];

566 ià(
idn
[
i
] == '.')

567 
dÙs
++;

570 ià(
fqdn
 == 0) {

572 
fqdn
 = 
dÙs
 ? 1 : -1;

575 
buæ’
 = 
Çm–’
 + 3 + 1;

577 
buf
 = 
	`m®loc
(
buæ’
);

578 ià(!
buf
) {

579 
	`årštf
(
¡d”r
, "ping6: out of memory.\n");

580 
”»x™
;

583 
dµ
 = 
dÅŒs
;

584 
Ï¡dÅŒ
 = &
dÅŒs
[
	`ARRAY_SIZE
(dnptrs)];

586 *
dµ
++ = (*)
buf
;

587 *
dµ
++ = 
NULL
;

589 
n
 = 
	`dn_comp
(
ÿnÚÇme
, (*)
buf
, 
buæ’
, 
dÅŒs
, 
Ï¡dÅŒ
);

590 ià(
n
 < 0) {

591 
	`årštf
(
¡d”r
, "pšg6: IÇµrİrŸ‹ subjeù‚ame: %s\n", 
ÿnÚÇme
);

592 
”»x™
;

593 } ià(
n
 >ğ
buæ’
) {

594 
	`årštf
(
¡d”r
, "ping6: dn_comp()„eturnedoo†ong„esult.\n");

595 
”»x™
;

598 
	`MD5_In™
(&
ùxt
);

599 
	`MD5_Upd©e
(&
ùxt
, 
buf
, buf[0]);

600 
	`MD5_Fš®
(
dige¡
, &
ùxt
);

602 
	`¥rštf
(
nigroup_buf
, "ff02::2:%02x%02x:%02x%02x%s%s",

603 
dige¡
[0], digest[1], digest[2], digest[3],

604 
p
 ? "%" : "",

605 
p
 ?… + 1 : "");

607 ià(
fqdn
 < 0)

608 
buf
[
n
] = 0;

610 
	`ä“
(
ni_subjeù
);

612 
ni_group
 = 
nigroup_buf
;

613 
ni_subjeù
 = 
buf
;

614 
ni_subjeù_Ën
 = 
n
 + (
fqdn
 < 0);

615 
ni_group
 = 
nigroup_buf
;

617 
	`ä“
(
ÿnÚÇme
);

618 
	`ä“
(
idn
);

619 
	`ä“
(
Çme
);

622 
oomex™
:

623 
	`årštf
(
¡d”r
, "ping6: out of memory.\n");

624 
”»x™
:

625 
	`ä“
(
buf
);

626 
	`ä“
(
ÿnÚÇme
);

627 
	`ä“
(
idn
);

628 
	`ä“
(
Çme
);

629 
	`ex™
(1);

630 
	}
}

632 
	$niqu”y_İtiÚ_h–p_hªdËr
(
šdex
, cÚ¡ *
¬g
)

634 
	`årštf
(
¡d”r
, "ping6 -N suboptions\n"

644 
	`ex™
(2);

645 
	}
}

647 
	$niqu”y_İtiÚ_hªdËr
(cÚ¡ *
İt_¬g
)

649 
niqu”y_İtiÚ
 *
p
;

650 
i
;

651 
»t
 = -1;

652 
i
 = 0, 
p
 = 
niqu”y_İtiÚs
;…->
Çme
; i++,…++) {

653 ià(
	`¡ºcmp
(
p
->
Çme
, 
İt_¬g
,…->
Çm–’
))

655 ià(!
p
->
has_¬g
) {

656 ià(
İt_¬g
[
p
->
Çm–’
] == '\0') {

657 
»t
 = 
p
->
	`hªdËr
(
i
, 
NULL
);

658 ià(
»t
 >= 0)

662 ià(
İt_¬g
[
p
->
Çm–’
] == '=') {

663 
»t
 = 
p
->
	`hªdËr
(
i
, &
İt_¬g
[p->
Çm–’
] + 1);

664 ià(
»t
 >= 0)

669 ià(!
p
->
Çme
)

670 
»t
 = 
	`niqu”y_İtiÚ_h–p_hªdËr
(0, 
NULL
);

671  
»t
;

672 
	}
}

674 
	$hextoui
(cÚ¡ *
¡r
)

676 
v®
;

677 *
•
;

679 
”ºo
 = 0;

680 
v®
 = 
	`¡¹oul
(
¡r
, &
•
, 16);

681 ià(*
•
) {

682 ià(!
”ºo
)

683 
”ºo
 = 
EINVAL
;

687 ià(
v®
 > 
UINT_MAX
) {

688 
”ºo
 = 
ERANGE
;

689  
UINT_MAX
;

692  
v®
;

693 
	}
}

695 
	$maš
(
¬gc
, *
¬gv
[])

697 
ch
, 
hŞd
, 
·ckËn
;

698 
u_ch¬
 *
·ck‘
;

699 *
rg‘
;

700 
addršfo
 
hšts
, *
ai
;

701 
gai
;

702 
sockaddr_š6
 
fœ¡hİ
;

703 
sock‘_”ºo
;

704 
icmp6_f‹r
 
f‹r
;

705 
”r
;

706 #ifdeà
__lšux__


707 
csum_off£t
, 
sz_İt
;

709 
ušt32_t
 
scİe_id
 = 0;

711 
	`lim™_ÿ·b™›s
();

713 #ifdeà
USE_IDN


714 
	`£oÿË
(
LC_ALL
, "");

717 
	`’abË_ÿ·b™y_¿w
();

719 
icmp_sock
 = 
	`sock‘
(
AF_INET6
, 
SOCK_RAW
, 
IPPROTO_ICMPV6
);

720 
sock‘_”ºo
 = 
”ºo
;

722 
	`di§bË_ÿ·b™y_¿w
();

724 
sourû
.
sš6_çmy
 = 
AF_INET6
;

725 
	`mem£t
(&
fœ¡hİ
, 0, (firsthop));

726 
fœ¡hİ
.
sš6_çmy
 = 
AF_INET6
;

728 
´–ßd
 = 1;

729 (
ch
 = 
	`g‘İt
(
¬gc
, 
¬gv
, 
COMMON_OPTSTR
 "F:N:")è!ğ
EOF
) {

730 
ch
) {

732 
æowÏb–
 = 
	`hextoui
(
İrg
);

733 ià(
”ºo
 || (
æowÏb–
 & ~
IPV6_FLOWINFO_FLOWLABEL
)) {

734 
	`årštf
(
¡d”r
, "pšg: Inv®id flowšfØ%s\n", 
İrg
);

735 
	`ex™
(2);

737 
İtiÚs
 |ğ
F_FLOWINFO
;

740 
tşass
 = 
	`hextoui
(
İrg
);

741 ià(
”ºo
 || (
tşass
 & ~0xff)) {

742 
	`årštf
(
¡d”r
, "pšg: Inv®idşas %s\n", 
İrg
);

743 
	`ex™
(2);

745 
İtiÚs
 |ğ
F_TCLASS
;

748 ià(
	`¡rchr
(
İrg
, ':')) {

749 *
p
, *
addr
 = 
	`¡rdup
(
İrg
);

751 ià(!
addr
) {

752 
	`årštf
(
¡d”r
, "ping: out of memory\n");

753 
	`ex™
(2);

756 
p
 = 
	`¡rchr
(
addr
, 
SCOPE_DELIMITER
);

757 ià(
p
) {

758 *
p
 = '\0';

759 
deviû
 = 
İrg
 + (
p
 - 
addr
) + 1;

762 ià(
	`š‘_±Ú
(
AF_INET6
, 
addr
, (*)&
sourû
.
sš6_addr
) <= 0) {

763 
	`årštf
(
¡d”r
, "pšg: inv®id sourû‡dd»s %s\n", 
İrg
);

764 
	`ex™
(2);

767 
İtiÚs
 |ğ
F_STRICTSOURCE
;

769 
	`ä“
(
addr
);

771 
deviû
 = 
İrg
;

775 ià(
	`¡rcmp
(
İrg
, "do") == 0)

776 
pmtudisc
 = 
IPV6_PMTUDISC_DO
;

777 ià(
	`¡rcmp
(
İrg
, "dont") == 0)

778 
pmtudisc
 = 
IPV6_PMTUDISC_DONT
;

779 ià(
	`¡rcmp
(
İrg
, "want") == 0)

780 
pmtudisc
 = 
IPV6_PMTUDISC_WANT
;

782 
	`årštf
(
¡d”r
, "ping: wrong value for -M: do, dont, want‡re valid ones.\n");

783 
	`ex™
(2);

787 
	`´štf
("pšg6 ut™y, iputs-%s\n", 
SNAPSHOT
);

788 
	`ex™
(0);

790 ià(
	`niqu”y_İtiÚ_hªdËr
(
İrg
) < 0) {

791 
	`u§ge
();

795 
COMMON_OPTIONS


796 
	`commÚ_İtiÚs
(
ch
);

799 
	`u§ge
();

802 
¬gc
 -ğ
İtšd
;

803 
¬gv
 +ğ
İtšd
;

805 #ifdeà
ENABLE_PING6_RTHDR


806 
¬gc
 > 1) {

807 
š6_addr
 *
addr
;

809 ià(
¤üt
 =ğ
NULL
) {

810 
¥aû
;

812 
	`årštf
(
¡d”r
, "ping6: Warning: "

815 #ifdeà
ENABLE_PING6_RTHDR_RFC3542


816 
¥aû
 = 
	`š‘6_¹h_¥aû
(
IPV6_RTHDR_TYPE_0
, 
¬gc
 - 1);

818 
¥aû
 = 
	`š‘6_¤üt_¥aû
(
IPV6_SRCRT_TYPE_0
, 
¬gc
 - 1);

820 ià(
¥aû
 == 0) {

821 
	`årštf
(
¡d”r
, "srcrt_space failed\n");

822 
	`ex™
(2);

824 #ifdeà
ENABLE_PING6_RTHDR_RFC3542


825 ià(
cmsgËn
 + 
	`CMSG_SPACE
(
¥aû
è> (
cmsgbuf
)) {

826 
	`årštf
(
¡d”r
, "no„oom for options\n");

827 
	`ex™
(2);

830 ià(
¥aû
 + 
cmsgËn
 > (
cmsgbuf
)) {

831 
	`årštf
(
¡d”r
, "no„oom for options\n");

832 
	`ex™
(2);

835 
¤üt
 = (
cmsghdr
*)(
cmsgbuf
+
cmsgËn
);

836 #ifdeà
ENABLE_PING6_RTHDR_RFC3542


837 
	`mem£t
(
¤üt
, 0, 
	`CMSG_SPACE
(0));

838 
¤üt
->
cmsg_Ën
 = 
	`CMSG_LEN
(
¥aû
);

839 
¤üt
->
cmsg_Ëv–
 = 
IPPROTO_IPV6
;

840 
¤üt
->
cmsg_ty³
 = 
IPV6_RTHDR
;

841 
	`š‘6_¹h_š™
(
	`CMSG_DATA
(
¤üt
), 
¥aû
, 
IPV6_RTHDR_TYPE_0
, 
¬gc
 - 1);

842 
cmsgËn
 +ğ
	`CMSG_SPACE
(
¥aû
);

844 
cmsgËn
 +ğ
	`CMSG_ALIGN
(
¥aû
);

845 
	`š‘6_¤üt_š™
(
¤üt
, 
IPV6_SRCRT_TYPE_0
);

849 
rg‘
 = *
¬gv
;

851 
	`mem£t
(&
hšts
, 0, (hints));

852 
hšts
.
ai_çmy
 = 
AF_INET6
;

853 #ifdeà
USE_IDN


854 
hšts
.
ai_æags
 = 
AI_IDN
;

856 
gai
 = 
	`g‘addršfo
(
rg‘
, 
NULL
, &
hšts
, &
ai
);

857 ià(
gai
) {

858 
	`årštf
(
¡d”r
, "unknown host\n");

859 
	`ex™
(2);

861 
addr
 = &((
sockaddr_š6
 *)(
ai
->
ai_addr
))->
sš6_addr
;

862 #ifdeà
ENABLE_PING6_RTHDR_RFC3542


863 
	`š‘6_¹h_add
(
	`CMSG_DATA
(
¤üt
), 
addr
);

865 
	`š‘6_¤üt_add
(
¤üt
, 
addr
);

867 ià(
	`IN6_IS_ADDR_UNSPECIFIED
(&
fœ¡hİ
.
sš6_addr
)) {

868 
	`memıy
(&
fœ¡hİ
.
sš6_addr
, 
addr
, 16);

869 #ifdeà
HAVE_SIN6_SCOPEID


870 
fœ¡hİ
.
sš6_scİe_id
 = ((
sockaddr_š6
 *)(
ai
->
ai_addr
))->sin6_scope_id;

872 ià(
fœ¡hİ
.
sš6_scİe_id
 && 
scİe_id
 && firsthop.sin6_scope_id != scope_id) {

873 
	`årštf
(
¡d”r
, "scope discrepancy‡monghe‚odes\n");

874 
	`ex™
(2);

875 } ià(!
scİe_id
) {

876 
scİe_id
 = 
fœ¡hİ
.
sš6_scİe_id
;

880 
	`ä“addršfo
(
ai
);

882 
¬gv
++;

883 
¬gc
--;

887 ià(
	`niqu”y_is_’abËd
()) {

888 
	`niqu”y_š™_nÚû
();

890 ià(!
	`niqu”y_is_subjeù_v®id
()) {

891 
ni_subjeù
 = &
wh”‘o
.
sš6_addr
;

892 
ni_subjeù_Ën
 = (
wh”‘o
.
sš6_addr
);

893 
ni_subjeù_ty³
 = 
NI_SUBJ_IPV6
;

897 ià(
¬gc
 > 1) {

898 #iâdeà
ENABLE_PING6_RTHDR


899 
	`årštf
(
¡d”r
, "ping6: Source„outing is deprecated by RFC5095.\n");

901 
	`u§ge
();

902 } ià(
¬gc
 == 1) {

903 
rg‘
 = *
¬gv
;

905 ià(
ni_qu”y
 < 0 && 
ni_subjeù_ty³
 !ğ
NI_SUBJ_NAME
)

906 
	`u§ge
();

907 
rg‘
 = 
ni_group
;

910 
	`mem£t
(&
hšts
, 0, (hints));

911 
hšts
.
ai_çmy
 = 
AF_INET6
;

912 #ifdeà
USE_IDN


913 
hšts
.
ai_æags
 = 
AI_IDN
;

915 
gai
 = 
	`g‘addršfo
(
rg‘
, 
NULL
, &
hšts
, &
ai
);

916 ià(
gai
) {

917 
	`årštf
(
¡d”r
, "unknown host\n");

918 
	`ex™
(2);

921 
	`memıy
(&
wh”‘o
, 
ai
->
ai_addr
, (whereto));

922 
wh”‘o
.
sš6_pÜt
 = 
	`htÚs
(
IPPROTO_ICMPV6
);

924 ià(
	`memchr
(
rg‘
, ':', 
	`¡¾’
(target)))

925 
İtiÚs
 |ğ
F_NUMERIC
;

927 
	`ä“addršfo
(
ai
);

929 ià(
	`IN6_IS_ADDR_UNSPECIFIED
(&
fœ¡hİ
.
sš6_addr
)) {

930 
	`memıy
(&
fœ¡hİ
.
sš6_addr
, &
wh”‘o
.sin6_addr, 16);

931 #ifdeà
HAVE_SIN6_SCOPEID


932 
fœ¡hİ
.
sš6_scİe_id
 = 
wh”‘o
.sin6_scope_id;

934 ià(
fœ¡hİ
.
sš6_scİe_id
 && 
scİe_id
 && firsthop.sin6_scope_id != scope_id) {

935 
	`årštf
(
¡d”r
, "scope discrepancy‡monghe‚odes\n");

936 
	`ex™
(2);

937 } ià(!
scİe_id
) {

938 
scİe_id
 = 
fœ¡hİ
.
sš6_scİe_id
;

943 
ho¡Çme
 = 
rg‘
;

945 ià(
	`IN6_IS_ADDR_UNSPECIFIED
(&
sourû
.
sš6_addr
)) {

946 
sockËn_t
 
®’
;

947 
´obe_fd
 = 
	`sock‘
(
AF_INET6
, 
SOCK_DGRAM
, 0);

949 ià(
´obe_fd
 < 0) {

950 
	`³¼Ü
("socket");

951 
	`ex™
(2);

953 ià(
deviû
) {

954 #ià
	`defšed
(
IPV6_RECVPKTINFO
è|| defšed(
HAVE_SIN6_SCOPEID
)

955 
içû
 = 
	`if_Çme2šdex
(
deviû
);

957 #ifdeà
IPV6_RECVPKTINFO


958 
š6_pktšfo
 
i
;

960 
	`mem£t
(&
i
, 0, (ipi));

961 
i
.
i6_ifšdex
 = 
içû
;

964 #ifdeà
HAVE_SIN6_SCOPEID


965 ià(
	`IN6_IS_ADDR_LINKLOCAL
(&
fœ¡hİ
.
sš6_addr
) ||

966 
	`IN6_IS_ADDR_MC_LINKLOCAL
(&
fœ¡hİ
.
sš6_addr
))

967 
fœ¡hİ
.
sš6_scİe_id
 = 
içû
;

969 
	`’abË_ÿ·b™y_¿w
();

971 #ifdeà
IPV6_RECVPKTINFO


972 
	`£tsockİt
(
´obe_fd
, 
IPPROTO_IPV6
, 
IPV6_PKTINFO
, &
i
, (ipi)) == -1 &&

974 
	`£tsockİt
(
´obe_fd
, 
SOL_SOCKET
, 
SO_BINDTODEVICE
, 
deviû
, 
	`¡¾’
(device)+1) == -1) {

975 
	`³¼Ü
("setsockopt(SO_BINDTODEVICE)");

976 
	`ex™
(2);

978 
	`di§bË_ÿ·b™y_¿w
();

980 
fœ¡hİ
.
sš6_pÜt
 = 
	`htÚs
(1025);

981 ià(
	`cÚÃù
(
´obe_fd
, (
sockaddr
*)&
fœ¡hİ
, (firsthop)) == -1) {

982 
	`³¼Ü
("connect");

983 
	`ex™
(2);

985 
®’
 = (
sourû
);

986 ià(
	`g‘sockÇme
(
´obe_fd
, (
sockaddr
*)&
sourû
, &
®’
) == -1) {

987 
	`³¼Ü
("getsockname");

988 
	`ex™
(2);

990 
sourû
.
sš6_pÜt
 = 0;

991 
	`şo£
(
´obe_fd
);

993 #iâdeà
WITHOUT_IFADDRS


994 ià(
deviû
) {

995 
içddrs
 *
iç0
, *
iç
;

997 ià(
	`g‘içddrs
(&
iç0
)) {

998 
	`³¼Ü
("getifaddrs");

999 
	`ex™
(2);

1002 
iç
 = 
iç0
; iç; iç = iç->
iç_Ãxt
) {

1003 ià(!
iç
->
iç_addr
 || iç->iç_addr->
§_çmy
 !ğ
AF_INET6
)

1005 ià(!
	`¡ºcmp
(
iç
->
iç_Çme
, 
deviû
, (device) - 1) &&

1006 
	`IN6_ARE_ADDR_EQUAL
(&((
sockaddr_š6
 *)
iç
->
iç_addr
)->
sš6_addr
,

1007 &
sourû
.
sš6_addr
))

1010 ià(!
iç
)

1011 
	`årštf
(
¡d”r
, "pšg6: W¬nšg: sourû‡dd»s mighˆb£Ëùed oÀdeviû oth”hª %s.\n", 
deviû
);

1013 
	`ä“içddrs
(
iç0
);

1017 #ifdeà
HAVE_SIN6_SCOPEID


1018 ià(
deviû
 && (
	`IN6_IS_ADDR_LINKLOCAL
(&
sourû
.
sš6_addr
) ||

1019 
	`IN6_IS_ADDR_MC_LINKLOCAL
(&
sourû
.
sš6_addr
)))

1020 
sourû
.
sš6_scİe_id
 = 
	`if_Çme2šdex
(
deviû
);

1023 ià(
icmp_sock
 < 0) {

1024 
”ºo
 = 
sock‘_”ºo
;

1025 
	`³¼Ü
("ping: icmp open socket");

1026 
	`ex™
(2);

1029 ià(
deviû
) {

1030 
cmsghdr
 *
cmsg
;

1031 
š6_pktšfo
 *
i
;

1033 
cmsg
 = (
cmsghdr
*)(
cmsgbuf
+
cmsgËn
);

1034 
cmsgËn
 +ğ
	`CMSG_SPACE
((*
i
));

1035 
cmsg
->
cmsg_Ën
 = 
	`CMSG_LEN
((*
i
));

1036 
cmsg
->
cmsg_Ëv–
 = 
SOL_IPV6
;

1037 
cmsg
->
cmsg_ty³
 = 
IPV6_PKTINFO
;

1039 
i
 = (
š6_pktšfo
*)
	`CMSG_DATA
(
cmsg
);

1040 
	`mem£t
(
i
, 0, (*ipi));

1041 
i
->
i6_ifšdex
 = 
	`if_Çme2šdex
(
deviû
);

1044 ià((
wh”‘o
.
sš6_addr
.
s6_addr16
[0]&
	`htÚs
(0xff00)) == htons (0xff00)) {

1045 ià(
uid
) {

1046 ià(
š‹rv®
 < 1000) {

1047 
	`årštf
(
¡d”r
, "ping: multicast…ing withoo short interval.\n");

1048 
	`ex™
(2);

1050 ià(
pmtudisc
 >ğ0 &&…mtudisø!ğ
IPV6_PMTUDISC_DO
) {

1051 
	`årštf
(
¡d”r
, "ping: multicast…ing does‚ot fragment.\n");

1052 
	`ex™
(2);

1055 ià(
pmtudisc
 < 0)

1056 
pmtudisc
 = 
IPV6_PMTUDISC_DO
;

1059 ià(
pmtudisc
 >= 0) {

1060 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_IPV6
, 
IPV6_MTU_DISCOVER
, &
pmtudisc
, (pmtudisc)) == -1) {

1061 
	`³¼Ü
("ping: IPV6_MTU_DISCOVER");

1062 
	`ex™
(2);

1066 ià((
İtiÚs
&
F_STRICTSOURCE
) &&

1067 
	`bšd
(
icmp_sock
, (
sockaddr
*)&
sourû
, (source)) == -1) {

1068 
	`³¼Ü
("ping: bind icmp socket");

1069 
	`ex™
(2);

1072 ià(
d©®’
 >ğ(
timev®
è&& (
ni_qu”y
 < 0)) {

1074 
timšg
 = 1;

1076 
·ckËn
 = 
d©®’
 + 8 + 4096 + 40 + 8;

1077 ià(!(
·ck‘
 = (
u_ch¬
 *)
	`m®loc
((
u_št
)
·ckËn
))) {

1078 
	`årštf
(
¡d”r
, "ping: out of memory.\n");

1079 
	`ex™
(2);

1082 
wÜkšg_»cv”r
 = 1;

1083 
hŞd
 = 1;

1084 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_IPV6
, 
IPV6_RECVERR
, (*)&
hŞd
, (hold))) {

1085 
	`årštf
(
¡d”r
, "WARNING: your kernel is veeery old. No…roblems.\n");

1086 
wÜkšg_»cv”r
 = 0;

1091 
hŞd
 = 
d©®’
+8;

1092 
hŞd
 += ((hold+511)/512)*(40+16+64+160);

1093 
	`sock_£tbufs
(
icmp_sock
, 
hŞd
);

1095 #ifdeà
__lšux__


1096 
csum_off£t
 = 2;

1097 
sz_İt
 = ();

1099 
”r
 = 
	`£tsockİt
(
icmp_sock
, 
SOL_RAW
, 
IPV6_CHECKSUM
, &
csum_off£t
, 
sz_İt
);

1100 ià(
”r
 < 0) {

1104 
	`årštf
(
¡d”r
, "setsockopt(RAW_CHECKSUM) failed -ryo continue.");

1112 
	`ICMP6_FILTER_SETBLOCKALL
(&
f‹r
);

1114 ià(!
wÜkšg_»cv”r
) {

1115 
	`ICMP6_FILTER_SETPASS
(
ICMP6_DST_UNREACH
, &
f‹r
);

1116 
	`ICMP6_FILTER_SETPASS
(
ICMP6_PACKET_TOO_BIG
, &
f‹r
);

1117 
	`ICMP6_FILTER_SETPASS
(
ICMP6_TIME_EXCEEDED
, &
f‹r
);

1118 
	`ICMP6_FILTER_SETPASS
(
ICMP6_PARAM_PROB
, &
f‹r
);

1121 ià(
	`niqu”y_is_’abËd
())

1122 
	`ICMP6_FILTER_SETPASS
(
ICMPV6_NI_REPLY
, &
f‹r
);

1124 
	`ICMP6_FILTER_SETPASS
(
ICMP6_ECHO_REPLY
, &
f‹r
);

1126 
”r
 = 
	`£tsockİt
(
icmp_sock
, 
IPPROTO_ICMPV6
, 
ICMP6_FILTER
, &
f‹r
,

1127 (
icmp6_f‹r
));

1129 ià(
”r
 < 0) {

1130 
	`³¼Ü
("setsockopt(ICMP6_FILTER)");

1131 
	`ex™
(2);

1134 ià(
İtiÚs
 & 
F_NOLOOP
) {

1135 
loİ
 = 0;

1136 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IPV6
, 
IPV6_MULTICAST_LOOP
,

1137 &
loİ
, (loop)) == -1) {

1138 
	`³¼Ü
 ("can't disable multicast†oopback");

1139 
	`ex™
(2);

1142 ià(
İtiÚs
 & 
F_TTL
) {

1143 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IPV6
, 
IPV6_MULTICAST_HOPS
,

1144 &
‰l
, (ttl)) == -1) {

1145 
	`³¼Ü
 ("can't set multicast hop†imit");

1146 
	`ex™
(2);

1148 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IPV6
, 
IPV6_UNICAST_HOPS
,

1149 &
‰l
, (ttl)) == -1) {

1150 
	`³¼Ü
 ("can't set unicast hop†imit");

1151 
	`ex™
(2);

1156 
Ú
 = 1;

1158 #ifdeà
IPV6_RECVHOPLIMIT


1159 
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IPV6
, 
IPV6_RECVHOPLIMIT
,

1160 &
Ú
, (on)) == -1 &&

1161 
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IPV6
, 
IPV6_2292HOPLIMIT
,

1162 &
Ú
, (on)) == -1

1164 
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IPV6
, 
IPV6_HOPLIMIT
,

1165 &
Ú
, (on)) == -1

1168 
	`³¼Ü
 ("can't„eceive hop†imit");

1169 
	`ex™
(2);

1173 ià(
İtiÚs
 & 
F_TCLASS
) {

1174 #ifdeà
IPV6_TCLASS


1175 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IPV6
, 
IPV6_TCLASS
,

1176 &
tşass
, (tclass)) == -1) {

1177 
	`³¼Ü
 ("setsockopt(IPV6_TCLASS)");

1178 
	`ex™
(2);

1181 
	`årštf
(
¡d”r
, "Traffic class is‚ot supported.\n");

1185 ià(
İtiÚs
&
F_FLOWINFO
) {

1186 #ifdeà
IPV6_FLOWINFO_SEND


1187 
Ú
 = 1;

1189 #ifdeà
IPV6_FLOWLABEL_MGR


1190 
äeq_buf
[
	`CMSG_ALIGN
((
š6_æowÏb–_»q
)è+ 
cmsgËn
];

1191 
š6_æowÏb–_»q
 *
äeq
 = (š6_æowÏb–_»q *)
äeq_buf
;

1192 
äeq_Ën
 = (*
äeq
);

1193 #ifdeà
ENABLE_PING6_RTHDR


1194 ià(
¤üt
)

1195 
äeq_Ën
 = 
	`CMSG_ALIGN
((*
äeq
)è+ 
¤üt
->
cmsg_Ën
;

1197 
	`mem£t
(
äeq
, 0, (*freq));

1198 
äeq
->
ær_Ïb–
 = 
	`htÚl
(
æowÏb–
 & 
IPV6_FLOWINFO_FLOWLABEL
);

1199 
äeq
->
ær_aùiÚ
 = 
IPV6_FL_A_GET
;

1200 
äeq
->
ær_æags
 = 
IPV6_FL_F_CREATE
;

1201 
äeq
->
ær_sh¬e
 = 
IPV6_FL_S_EXCL
;

1202 
	`memıy
(&
äeq
->
ær_d¡
, &
wh”‘o
.
sš6_addr
, 16);

1203 #ifdeà
ENABLE_PING6_RTHDR


1204 ià(
¤üt
)

1205 
	`memıy
(
äeq_buf
 + 
	`CMSG_ALIGN
((*
äeq
)), 
¤üt
, srüt->
cmsg_Ën
);

1207 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IPV6
, 
IPV6_FLOWLABEL_MGR
,

1208 
äeq
, 
äeq_Ën
) == -1) {

1209 
	`³¼Ü
 ("can't set flowlabel");

1210 
	`ex™
(2);

1212 
æowÏb–
 = 
äeq
->
ær_Ïb–
;

1213 #ifdeà
ENABLE_PING6_RTHDR


1214 ià(
¤üt
) {

1215 
cmsgËn
 = (*)
¤üt
 - (*)
cmsgbuf
;

1216 
¤üt
 = 
NULL
;

1220 
	`årštf
(
¡d”r
, "Flow†abels‡re‚ot supported.\n");

1221 
	`ex™
(2);

1224 #ifdeà
IPV6_FLOWINFO_SEND


1225 
wh”‘o
.
sš6_æowšfo
 = 
æowÏb–
;

1226 ià(
	`£tsockİt
(
icmp_sock
, 
IPPROTO_IPV6
, 
IPV6_FLOWINFO_SEND
,

1227 &
Ú
, (on)) == -1) {

1228 
	`³¼Ü
 ("can't send flowinfo");

1229 
	`ex™
(2);

1232 
	`årštf
(
¡d”r
, "Flowinfo is‚ot supported.\n");

1233 
	`ex™
(2);

1237 
	`´štf
("PING %s(%sè", 
ho¡Çme
, 
	`´_addr
(&
wh”‘o
.
sš6_addr
));

1238 ià(
æowÏb–
)

1239 
	`´štf
(", flow 0x%05x, ", ()
	`Áohl
(
æowÏb–
));

1240 ià(
deviû
 || (
İtiÚs
&
F_STRICTSOURCE
)) {

1241 
	`´štf
("from %s %s: ",

1242 
	`´_addr_n
(&
sourû
.
sš6_addr
), 
deviû
 ? : "");

1244 
	`´štf
("%d d©¨by‹s\n", 
d©®’
);

1246 
	`£tup
(
icmp_sock
);

1248 
	`drİ_ÿ·b™›s
();

1250 
	`maš_loİ
(
icmp_sock
, 
·ck‘
, 
·ckËn
);

1251 
	}
}

1253 
	$»ûive_”rÜ_msg
()

1255 
»s
;

1256 
cbuf
[512];

1257 
iovec
 
iov
;

1258 
msghdr
 
msg
;

1259 
cmsghdr
 *
cmsg
;

1260 
sock_ex‹nded_”r
 *
e
;

1261 
icmp6_hdr
 
icmph
;

1262 
sockaddr_š6
 
rg‘
;

1263 
Ãt_”rÜs
 = 0;

1264 
loÿl_”rÜs
 = 0;

1265 
§ved_”ºo
 = 
”ºo
;

1267 
iov
.
iov_ba£
 = &
icmph
;

1268 
iov
.
iov_Ën
 = (
icmph
);

1269 
msg
.
msg_Çme
 = (*)&
rg‘
;

1270 
msg
.
msg_Çm–’
 = (
rg‘
);

1271 
msg
.
msg_iov
 = &
iov
;

1272 
msg
.
msg_iovËn
 = 1;

1273 
msg
.
msg_æags
 = 0;

1274 
msg
.
msg_cÚŒŞ
 = 
cbuf
;

1275 
msg
.
msg_cÚŒŞËn
 = (
cbuf
);

1277 
»s
 = 
	`»cvmsg
(
icmp_sock
, &
msg
, 
MSG_ERRQUEUE
|
MSG_DONTWAIT
);

1278 ià(
»s
 < 0)

1279 
out
;

1281 
e
 = 
NULL
;

1282 
cmsg
 = 
	`CMSG_FIRSTHDR
(&
msg
); cmsg; cmsg = 
	`CMSG_NXTHDR
(&msg, cmsg)) {

1283 ià(
cmsg
->
cmsg_Ëv–
 =ğ
SOL_IPV6
) {

1284 ià(
cmsg
->
cmsg_ty³
 =ğ
IPV6_RECVERR
)

1285 
e
 = (
sock_ex‹nded_”r
 *)
	`CMSG_DATA
(
cmsg
);

1288 ià(
e
 =ğ
NULL
)

1289 
	`abÜt
();

1291 ià(
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_LOCAL
) {

1292 
loÿl_”rÜs
++;

1293 ià(
İtiÚs
 & 
F_QUIET
)

1294 
out
;

1295 ià(
İtiÚs
 & 
F_FLOOD
)

1296 
	`wr™e_¡dout
("E", 1);

1297 ià(
e
->
“_”ºo
 !ğ
EMSGSIZE
)

1298 
	`årštf
(
¡d”r
, "pšg:†oÿÈ”rÜ: %s\n", 
	`¡»¼Ü
(
e
->
“_”ºo
));

1300 
	`årštf
(
¡d”r
, "pšg:†oÿÈ”rÜ: Mes§gtoØlÚg, mtu=%u\n", 
e
->
“_šfo
);

1301 
Ã¼Üs
++;

1302 } ià(
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_ICMP6
) {

1303 
sockaddr_š6
 *
sš6
 = (sockaddr_š6*)(
e
+1);

1305 ià(
»s
 < (
icmph
) ||

1306 
	`memcmp
(&
rg‘
.
sš6_addr
, &
wh”‘o
.sin6_addr, 16) ||

1307 
icmph
.
icmp6_ty³
 !ğ
ICMP6_ECHO_REQUEST
 ||

1308 
icmph
.
icmp6_id
 !ğ
id’t
) {

1310 
§ved_”ºo
 = 0;

1311 
out
;

1314 
Ãt_”rÜs
++;

1315 
Ã¼Üs
++;

1316 ià(
İtiÚs
 & 
F_QUIET
)

1317 
out
;

1318 ià(
İtiÚs
 & 
F_FLOOD
) {

1319 
	`wr™e_¡dout
("\bE", 2);

1321 
	`´št_time¡amp
();

1322 
	`´štf
("From % icmp_£q=%u ", 
	`´_addr
(&
sš6
->
sš6_addr
), 
	`Áohs
(
icmph
.
icmp6_£q
));

1323 
	`´_icmph
(
e
->
“_ty³
,ƒ->
“_code
,ƒ->
“_šfo
);

1324 
	`putch¬
('\n');

1325 
	`fæush
(
¡dout
);

1329 
out
:

1330 
”ºo
 = 
§ved_”ºo
;

1331  
Ãt_”rÜs
 ? : -
loÿl_”rÜs
;

1332 
	}
}

1342 
	$bud_echo
(
__u8
 *
_icmph
)

1344 
icmp6_hdr
 *
icmph
;

1345 
cc
;

1347 
icmph
 = (
icmp6_hdr
 *)
_icmph
;

1348 
icmph
->
icmp6_ty³
 = 
ICMP6_ECHO_REQUEST
;

1349 
icmph
->
icmp6_code
 = 0;

1350 
icmph
->
icmp6_cksum
 = 0;

1351 
icmph
->
icmp6_£q
 = 
	`htÚs
(
Á¿nsm™‹d
+1);

1352 
icmph
->
icmp6_id
 = 
id’t
;

1354 ià(
timšg
)

1355 
	`g‘timeofday
((
timev®
 *)&
ouack
[8],

1356 (
timezÚe
 *)
NULL
);

1358 
cc
 = 
d©®’
 + 8;

1360  
cc
;

1361 
	}
}

1364 
	$bud_niqu”y
(
__u8
 *
_nih
)

1366 
ni_hdr
 *
nih
;

1367 
cc
;

1369 
nih
 = (
ni_hdr
 *)
_nih
;

1370 
nih
->
ni_cksum
 = 0;

1372 
nih
->
ni_ty³
 = 
ICMPV6_NI_QUERY
;

1373 
cc
 = (*
nih
);

1374 
d©®’
 = 0;

1376 
	`niqu”y_fl_nÚû
(
Á¿nsm™‹d
 + 1, 
nih
->
ni_nÚû
);

1377 
nih
->
ni_code
 = 
ni_subjeù_ty³
;

1378 
nih
->
ni_qty³
 = 
	`htÚs
(
ni_qu”y
);

1379 
nih
->
ni_æags
 = 
ni_æag
;

1380 
	`memıy
(
nih
 + 1, 
ni_subjeù
, 
ni_subjeù_Ën
);

1381 
cc
 +ğ
ni_subjeù_Ën
;

1383  
cc
;

1384 
	}
}

1386 
	$£nd_´obe
()

1388 
Ën
, 
cc
;

1390 
	`rcvd_ş—r
(
Á¿nsm™‹d
 + 1);

1392 ià(
	`niqu”y_is_’abËd
())

1393 
Ën
 = 
	`bud_niqu”y
(
ouack
);

1395 
Ën
 = 
	`bud_echo
(
ouack
);

1397 ià(
cmsgËn
 == 0) {

1398 
cc
 = 
	`£ndto
(
icmp_sock
, (*)
ouack
, 
Ën
, 
cÚfœm
,

1399 (
sockaddr
 *è&
wh”‘o
,

1400 (
sockaddr_š6
));

1402 
msghdr
 
mhdr
;

1403 
iovec
 
iov
;

1405 
iov
.
iov_Ën
 = 
Ën
;

1406 
iov
.
iov_ba£
 = 
ouack
;

1408 
	`mem£t
(&
mhdr
, 0, (mhdr));

1409 
mhdr
.
msg_Çme
 = &
wh”‘o
;

1410 
mhdr
.
msg_Çm–’
 = (
sockaddr_š6
);

1411 
mhdr
.
msg_iov
 = &
iov
;

1412 
mhdr
.
msg_iovËn
 = 1;

1413 
mhdr
.
msg_cÚŒŞ
 = 
cmsgbuf
;

1414 
mhdr
.
msg_cÚŒŞËn
 = 
cmsgËn
;

1416 
cc
 = 
	`£ndmsg
(
icmp_sock
, &
mhdr
, 
cÚfœm
);

1418 
cÚfœm
 = 0;

1420  (
cc
 =ğ
Ën
 ? 0 : cc);

1421 
	}
}

1423 
	$´_echo_»¶y
(
__u8
 *
_icmph
, 
cc
)

1425 
icmp6_hdr
 *
icmph
 = (icmp6_hd¸*è
_icmph
;

1426 
	`´štf
(" icmp_£q=%u", 
	`Áohs
(
icmph
->
icmp6_£q
));

1427 
	}
};

1429 
	$putch¬_§ã
(
c
)

1431 ià(
	`i¥ršt
(
c
))

1432 
	`putch¬
(
c
);

1434 
	`´štf
("\\%03o", 
c
);

1435 
	}
}

1437 
	$´_niqu”y_»¶y_Çme
(
ni_hdr
 *
nih
, 
Ën
)

1439 
__u8
 *
h
 = (__u8 *)(
nih
 + 1);

1440 
__u8
 *
p
 = 
h
 + 4;

1441 
__u8
 *
’d
 = (__u8 *)
nih
 + 
Ën
;

1442 
cÚtšued
 = 0;

1443 
buf
[1024];

1444 
»t
;

1446 
Ën
 -ğ(
ni_hdr
) + 4;

1448 ià(
Ën
 < 0) {

1449 
	`´štf
("…arseƒrror (too short)");

1452 
p
 < 
’d
) {

1453 
fqdn
 = 1;

1454 
i
;

1456 
	`mem£t
(
buf
, 0xff, (buf));

1458 ià(
cÚtšued
)

1459 
	`putch¬
(',');

1461 
»t
 = 
	`dn_ex·nd
(
h
, 
’d
, 
p
, 
buf
, (buf));

1462 ià(
»t
 < 0) {

1463 
	`´štf
("…arseƒrror (truncated)");

1466 ià(
p
 + 
»t
 < 
’d
 && *(p +„et) == '\0')

1467 
fqdn
 = 0;

1469 
	`putch¬
(' ');

1470 
i
 = 0; i < 
	`¡¾’
(
buf
); i++)

1471 
	`putch¬_§ã
(
buf
[
i
]);

1472 ià(
fqdn
)

1473 
	`putch¬
('.');

1475 
p
 +ğ
»t
 + !
fqdn
;

1477 
cÚtšued
 = 1;

1479 
	}
}

1481 
	$´_niqu”y_»¶y_addr
(
ni_hdr
 *
nih
, 
Ën
)

1483 
__u8
 *
h
 = (__u8 *)(
nih
 + 1);

1484 
__u8
 *
p
 = 
h
 + 4;

1485 
__u8
 *
’d
 = (__u8 *)
nih
 + 
Ën
;

1486 
af
;

1487 
aæ’
;

1488 
cÚtšued
 = 0;

1489 
Œunÿ‹d
;

1490 
buf
[1024];

1492 
	`Áohs
(
nih
->
ni_qty³
)) {

1493 
NI_QTYPE_IPV4ADDR
:

1494 
af
 = 
AF_INET
;

1495 
aæ’
 = (
š_addr
);

1496 
Œunÿ‹d
 = 
nih
->
ni_æags
 & 
NI_IPV6ADDR_F_TRUNCATE
;

1498 
NI_QTYPE_IPV6ADDR
:

1499 
af
 = 
AF_INET6
;

1500 
aæ’
 = (
š6_addr
);

1501 
Œunÿ‹d
 = 
nih
->
ni_æags
 & 
NI_IPV4ADDR_F_TRUNCATE
;

1505 
af
 = 
aæ’
 = 
Œunÿ‹d
 = 0;

1507 
p
 = 
h
;

1508 ià(
Ën
 < 0) {

1509 
	`´štf
("…arseƒrror (too short)");

1513 
p
 < 
’d
) {

1514 ià(
cÚtšued
)

1515 
	`putch¬
(',');

1517 ià(
p
 + (
__u32
è+ 
aæ’
 > 
’d
) {

1518 
	`´štf
("…arseƒrror (truncated)");

1521 ià(!
	`š‘_Áİ
(
af
, 
p
 + (
__u32
), 
buf
, (buf)))

1522 
	`´štf
(" unexpecedƒrror in inet_ntop(%s)",

1523 
	`¡»¼Ü
(
”ºo
));

1525 
	`´štf
(" %s", 
buf
);

1526 
p
 +ğ(
__u32
è+ 
aæ’
;

1528 
cÚtšued
 = 1;

1530 ià(
Œunÿ‹d
)

1531 
	`´štf
(" (truncated)");

1532 
	}
}

1534 
	$´_niqu”y_»¶y
(
__u8
 *
_nih
, 
Ën
)

1536 
ni_hdr
 *
nih
 = (ni_hd¸*)
_nih
;

1538 
nih
->
ni_code
) {

1539 
NI_SUCCESS
:

1540 
	`Áohs
(
nih
->
ni_qty³
)) {

1541 
NI_QTYPE_NAME
:

1542 
	`´_niqu”y_»¶y_Çme
(
nih
, 
Ën
);

1544 
NI_QTYPE_IPV4ADDR
:

1545 
NI_QTYPE_IPV6ADDR
:

1546 
	`´_niqu”y_»¶y_addr
(
nih
, 
Ën
);

1549 
	`´štf
(" unknowÀqty³(0x%02x)", 
	`Áohs
(
nih
->
ni_qty³
));

1552 
NI_REFUSED
:

1553 
	`´štf
("„efused");

1555 
NI_UNKNOWN
:

1556 
	`´štf
(" unknown");

1559 
	`´štf
(" unknowÀcode(%02x)", 
	`Áohs
(
nih
->
ni_code
));

1561 
	`´štf
("; seq=%u;", 
	`Áoh¥
((
__u16
*)
nih
->
ni_nÚû
));

1562 
	}
}

1572 
	$·r£_»¶y
(
msghdr
 *
msg
, 
cc
, *
addr
, 
timev®
 *
tv
)

1574 
sockaddr_š6
 *
äom
 = 
addr
;

1575 
__u8
 *
buf
 = 
msg
->
msg_iov
->
iov_ba£
;

1576 
cmsghdr
 *
c
;

1577 
icmp6_hdr
 *
icmph
;

1578 
hİs
 = -1;

1580 
c
 = 
	`CMSG_FIRSTHDR
(
msg
); c; c = 
	`CMSG_NXTHDR
(msg, c)) {

1581 ià(
c
->
cmsg_Ëv–
 !ğ
SOL_IPV6
)

1583 
c
->
cmsg_ty³
) {

1584 
IPV6_HOPLIMIT
:

1585 #ifdeà
IPV6_2292HOPLIMIT


1586 
IPV6_2292HOPLIMIT
:

1588 ià(
c
->
cmsg_Ën
 < 
	`CMSG_LEN
(()))

1590 
	`memıy
(&
hİs
, 
	`CMSG_DATA
(
c
), (hops));

1597 
icmph
 = (
icmp6_hdr
 *è
buf
;

1598 ià(
cc
 < 8) {

1599 ià(
İtiÚs
 & 
F_VERBOSE
)

1600 
	`årštf
(
¡d”r
, "pšg:…ack‘oØshÜˆ(%d by‹s)\n", 
cc
);

1604 ià(
icmph
->
icmp6_ty³
 =ğ
ICMP6_ECHO_REPLY
) {

1605 ià(
icmph
->
icmp6_id
 !ğ
id’t
)

1607 ià(
	`g©h”_¡©i¡ics
((
__u8
*)
icmph
, (*icmph), 
cc
,

1608 
	`Áohs
(
icmph
->
icmp6_£q
),

1609 
hİs
, 0, 
tv
, 
	`´_addr
(&
äom
->
sš6_addr
),

1610 
´_echo_»¶y
))

1612 } ià(
icmph
->
icmp6_ty³
 =ğ
ICMPV6_NI_REPLY
) {

1613 
ni_hdr
 *
nih
 = (ni_hd¸*)
icmph
;

1614 
£q
 = 
	`niqu”y_check_nÚû
(
nih
->
ni_nÚû
);

1615 ià(
£q
 < 0)

1617 ià(
	`g©h”_¡©i¡ics
((
__u8
*)
icmph
, (*icmph), 
cc
,

1618 
£q
,

1619 
hİs
, 0, 
tv
, 
	`´_addr
(&
äom
->
sš6_addr
),

1620 
´_niqu”y_»¶y
))

1623 
Ãxthdr
;

1624 
6_hdr
 *
h1
 = (6_hdr*)(
icmph
+1);

1625 
icmp6_hdr
 *
icmph1
 = (icmp6_hd¸*)(
h1
+1);

1634 ià(
cc
 < 8+(
6_hdr
)+8)

1637 ià(
	`memcmp
(&
h1
->
6_d¡
, &
wh”‘o
.
sš6_addr
, 16))

1640 
Ãxthdr
 = 
h1
->
6_nxt
;

1642 ià(
Ãxthdr
 == 44) {

1643 
Ãxthdr
 = *(
__u8
*)
icmph1
;

1644 
icmph1
++;

1646 ià(
Ãxthdr
 =ğ
IPPROTO_ICMPV6
) {

1647 ià(
icmph1
->
icmp6_ty³
 !ğ
ICMP6_ECHO_REQUEST
 ||

1648 
icmph1
->
icmp6_id
 !ğ
id’t
)

1650 
	`acknowËdge
(
	`Áohs
(
icmph1
->
icmp6_£q
));

1651 ià(
wÜkšg_»cv”r
)

1653 
Ã¼Üs
++;

1654 ià(
İtiÚs
 & 
F_FLOOD
) {

1655 
	`wr™e_¡dout
("\bE", 2);

1658 
	`´št_time¡amp
();

1659 
	`´štf
("From %s: icmp_£q=%u ", 
	`´_addr
(&
äom
->
sš6_addr
), 
	`Áohs
(
icmph1
->
icmp6_£q
));

1662 ià(!(
İtiÚs
 & 
F_VERBOSE
è|| 
uid
)

1664 
	`´št_time¡amp
();

1665 
	`´štf
("From %s: ", 
	`´_addr
(&
äom
->
sš6_addr
));

1667 
	`´_icmph
(
icmph
->
icmp6_ty³
, icmph->
icmp6_code
, 
	`Áohl
(icmph->
icmp6_mtu
));

1670 ià(!(
İtiÚs
 & 
F_FLOOD
)) {

1671 ià(
İtiÚs
 & 
F_AUDIBLE
)

1672 
	`putch¬
('\a');

1673 
	`putch¬
('\n');

1674 
	`fæush
(
¡dout
);

1676 
	`putch¬
('\a');

1677 
	`fæush
(
¡dout
);

1680 
	}
}

1683 
	$´_icmph
(
__u8
 
ty³
, __u8 
code
, 
__u32
 
šfo
)

1685 
ty³
) {

1686 
ICMP6_DST_UNREACH
:

1687 
	`´štf
("Destination unreachable: ");

1688 
code
) {

1689 
ICMP6_DST_UNREACH_NOROUTE
:

1690 
	`´štf
("No„oute");

1692 
ICMP6_DST_UNREACH_ADMIN
:

1693 
	`´štf
("Administratively…rohibited");

1695 
ICMP6_DST_UNREACH_BEYONDSCOPE
:

1696 
	`´štf
("Beyond scope of source‡ddress");

1698 
ICMP6_DST_UNREACH_ADDR
:

1699 
	`´štf
("Address unreachable");

1701 
ICMP6_DST_UNREACH_NOPORT
:

1702 
	`´štf
("Port unreachable");

1705 
	`´štf
("UnknowÀcod%d", 
code
);

1709 
ICMP6_PACKET_TOO_BIG
:

1710 
	`´štf
("Pack‘oØbig: mtu=%u", 
šfo
);

1711 ià(
code
)

1712 
	`´štf
(", code=%d", 
code
);

1714 
ICMP6_TIME_EXCEEDED
:

1715 
	`´štf
("Timeƒxceeded: ");

1716 ià(
code
 =ğ
ICMP6_TIME_EXCEED_TRANSIT
)

1717 
	`´štf
("Hop†imit");

1718 ià(
code
 =ğ
ICMP6_TIME_EXCEED_REASSEMBLY
)

1719 
	`´štf
("Defragmentation failure");

1721 
	`´štf
("cod%d", 
code
);

1723 
ICMP6_PARAM_PROB
:

1724 
	`´štf
("Parameter…roblem: ");

1725 ià(
code
 =ğ
ICMP6_PARAMPROB_HEADER
)

1726 
	`´štf
("Wrong header field ");

1727 ià(
code
 =ğ
ICMP6_PARAMPROB_NEXTHEADER
)

1728 
	`´štf
("Unknown header ");

1729 ià(
code
 =ğ
ICMP6_PARAMPROB_OPTION
)

1730 
	`´štf
("Unknown option ");

1732 
	`´štf
("cod%d ", 
code
);

1733 
	`´štf
 ("© %u", 
šfo
);

1735 
ICMP6_ECHO_REQUEST
:

1736 
	`´štf
("Echo„equest");

1738 
ICMP6_ECHO_REPLY
:

1739 
	`´štf
("Echo„eply");

1741 
MLD_LISTENER_QUERY
:

1742 
	`´štf
("MLD Query");

1744 
MLD_LISTENER_REPORT
:

1745 
	`´štf
("MLD Report");

1747 
MLD_LISTENER_REDUCTION
:

1748 
	`´štf
("MLD Reduction");

1751 
	`´štf
("unknowÀicm°ty³: %u", 
ty³
);

1755 
	}
}

1757 
	~<lšux/f‹r.h
>

1759 
	$š¡®l_f‹r
()

1761 
Úû
;

1762 
sock_f‹r
 
š¢s
[] = {

1763 
	`BPF_STMT
(
BPF_LD
|
BPF_H
|
BPF_ABS
, 4),

1764 
	`BPF_JUMP
(
BPF_JMP
|
BPF_JEQ
|
BPF_K
, 0xAAAA, 0, 1),

1765 
	`BPF_STMT
(
BPF_RET
|
BPF_K
, ~0U),

1766 
	`BPF_STMT
(
BPF_LD
|
BPF_B
|
BPF_ABS
, 0),

1767 
	`BPF_JUMP
(
BPF_JMP
|
BPF_JEQ
|
BPF_K
, 
ICMP6_ECHO_REPLY
, 1, 0),

1768 
	`BPF_STMT
(
BPF_RET
|
BPF_K
, ~0U),

1769 
	`BPF_STMT
(
BPF_RET
|
BPF_K
, 0),

1771 
sock_årog
 
f‹r
 = {

1772  
š¢s
 / (insns[0]),

1773 
š¢s


1776 ià(
Úû
)

1778 
Úû
 = 1;

1781 
š¢s
[1] = (
sock_f‹r
)
	`BPF_JUMP
(
BPF_JMP
|
BPF_JEQ
|
BPF_K
, 
	`htÚs
(
id’t
), 0, 1);

1783 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_ATTACH_FILTER
, &
f‹r
, (filter)))

1784 
	`³¼Ü
("WARNING: failedo install socket filter\n");

1785 
	}
}

1793 * 
	$´_addr
(
š6_addr
 *
addr
)

1795 
ho¡’t
 *
hp
 = 
NULL
;

1796 *
s
;

1798 #ifdeà
USE_IDN


1799 
	`ä“
(
s
);

1802 
š_´_addr
 = !
	`£tjmp
(
´_addr_jmp
);

1804 ià(!(
ex™šg
 || 
İtiÚs
&
F_NUMERIC
))

1805 
hp
 = 
	`g‘ho¡byaddr
((
__u8
*)
addr
, (
š6_addr
), 
AF_INET6
);

1807 
š_´_addr
 = 0;

1809 ià(!
hp


1810 #ifdeà
USE_IDN


1811 || 
	`idÇ_to_unicode_lzlz
(
hp
->
h_Çme
, &
s
, 0è!ğ
IDNA_SUCCESS


1814 
s
 = 
NULL
;

1816  
hp
 ? (
s
 ? s : hp->
h_Çme
è: 
	`´_addr_n
(
addr
);

1817 
	}
}

1819 * 
	$´_addr_n
(
š6_addr
 *
addr
)

1821 
¡r
[64];

1822 
	`š‘_Áİ
(
AF_INET6
, 
addr
, 
¡r
, (str));

1823  
¡r
;

1824 
	}
}

1826 
	#USAGE_NEWLINE
 "\À "

	)

1828 
	$u§ge
()

1830 
	`årštf
(
¡d”r
,

1838 
USAGE_NEWLINE


1842 
USAGE_NEWLINE


1847 
USAGE_NEWLINE


1852 
USAGE_NEWLINE


1854 #ifdeà
ENABLE_PING6_RTHDR


1860 
	`ex™
(2);

1861 
	}
}

	@ping6_niquery.h

1 
	~<asm/by‹Üd”.h
>

3 
	#NI_NONCE_SIZE
 8

	)

6 
	sni_hdr
 {

7 
icmp6_hdr
 
	mni_u
;

8 
__u8
 
	mni_nÚû
[
NI_NONCE_SIZE
];

11 
	#ni_ty³
 
ni_u
.
icmp6_ty³


	)

12 
	#ni_code
 
ni_u
.
icmp6_code


	)

13 
	#ni_cksum
 
ni_u
.
icmp6_cksum


	)

14 
	#ni_qty³
 
ni_u
.
icmp6_d©a16
[0]

	)

15 
	#ni_æags
 
ni_u
.
icmp6_d©a16
[1]

	)

18 #iâdeà
ICMPV6_NI_QUERY


19 
	#ICMPV6_NI_QUERY
 139

	)

20 
	#ICMPV6_NI_REPLY
 140

	)

24 
	#NI_SUBJ_IPV6
 0

	)

25 
	#NI_SUBJ_NAME
 1

	)

26 
	#NI_SUBJ_IPV4
 2

	)

29 
	#NI_SUCCESS
 0

	)

30 
	#NI_REFUSED
 1

	)

31 
	#NI_UNKNOWN
 2

	)

34 
	#NI_QTYPE_NOOP
 0

	)

35 
	#NI_QTYPE_NAME
 2

	)

36 
	#NI_QTYPE_IPV6ADDR
 3

	)

37 
	#NI_QTYPE_IPV4ADDR
 4

	)

40 
	#NI_IPV6ADDR_F_TRUNCATE
 
	`__cÚ¡ªt_ıu_to_be16
(0x0001)

	)

41 
	#NI_IPV6ADDR_F_ALL
 
	`__cÚ¡ªt_ıu_to_be16
(0x0002)

	)

42 
	#NI_IPV6ADDR_F_COMPAT
 
	`__cÚ¡ªt_ıu_to_be16
(0x0004)

	)

43 
	#NI_IPV6ADDR_F_LINKLOCAL
 
	`__cÚ¡ªt_ıu_to_be16
(0x0008)

	)

44 
	#NI_IPV6ADDR_F_SITELOCAL
 
	`__cÚ¡ªt_ıu_to_be16
(0x0010)

	)

45 
	#NI_IPV6ADDR_F_GLOBAL
 
	`__cÚ¡ªt_ıu_to_be16
(0x0020)

	)

47 
	#NI_IPV4ADDR_F_TRUNCATE
 
NI_IPV6ADDR_F_TRUNCATE


	)

48 
	#NI_IPV4ADDR_F_ALL
 
NI_IPV6ADDR_F_ALL


	)

	@ping_common.c

1 
	~"pšg_commÚ.h
"

2 
	~<ùy³.h
>

3 
	~<sched.h
>

4 
	~<m©h.h
>

6 
	gİtiÚs
;

8 
	gm¬k
;

9 
	g¢dbuf
;

10 
	g‰l
;

11 
	g¹t
;

12 
	g¹t_add’d
;

13 
__u16
 
	gacked
;

15 
rcvd_bË
 
	grcvd_tbl
;

19 
	gÅack‘s
;

20 
	gÄeûived
;

21 
	gÄ•—ts
;

22 
	gÁ¿nsm™‹d
;

23 
	gnchecksum
;

24 
	gÃ¼Üs
;

25 
	gš‹rv®
 = 1000;

26 
	g´–ßd
;

27 
	gd—dlše
 = 0;

28 
	glšg”time
 = 
MAXWAIT
*1000;

29 
timev®
 
	g¡¬t_time
, 
	gcur_time
;

30 vŞ©
	gex™šg
;

31 vŞ©
	g¡©us_¢­shÙ
;

32 
	gcÚfœm
 = 0;

33 vŞ©
	gš_´_addr
 = 0;

34 
jmp_buf
 
	g´_addr_jmp
;

39 
	gcÚfœm_æag
 = 
MSG_CONFIRM
;

42 
	gwÜkšg_»cv”r
;

45 
	gtimšg
;

46 
	gtmš
 = 
LONG_MAX
;

47 
	gtmax
;

53 
	gtsum
;

54 
	gtsum2
;

55 
	gpesize
 = -1;

57 
	gd©®’
 = 
DEFDATALEN
;

59 *
	gho¡Çme
;

60 
	guid
;

61 
uid_t
 
	geuid
;

62 
	gid’t
;

64 
	gsü“n_width
 = 
INT_MAX
;

66 
	#ARRAY_SIZE
(
a
è(×è/ ×[0]))

	)

68 #ifdeà
CAPABILITIES


69 
ÿp_v®ue_t
 
	gÿp_¿w
 = 
CAP_NET_RAW
;

70 
ÿp_v®ue_t
 
	gÿp_admš
 = 
CAP_NET_ADMIN
;

73 
	$lim™_ÿ·b™›s
()

75 #ifdeà
CAPABILITIES


76 
ÿp_t
 
ÿp_cur_p
;

77 
ÿp_t
 
ÿp_p
;

78 
ÿp_æag_v®ue_t
 
ÿp_ok
;

80 
ÿp_cur_p
 = 
	`ÿp_g‘_´oc
();

81 ià(!
ÿp_cur_p
) {

82 
	`³¼Ü
("ping: cap_get_proc");

83 
	`ex™
(-1);

86 
ÿp_p
 = 
	`ÿp_š™
();

87 ià(!
ÿp_p
) {

88 
	`³¼Ü
("ping: cap_init");

89 
	`ex™
(-1);

92 
ÿp_ok
 = 
CAP_CLEAR
;

93 
	`ÿp_g‘_æag
(
ÿp_cur_p
, 
CAP_NET_ADMIN
, 
CAP_PERMITTED
, &
ÿp_ok
);

95 ià(
ÿp_ok
 !ğ
CAP_CLEAR
)

96 
	`ÿp_£t_æag
(
ÿp_p
, 
CAP_PERMITTED
, 1, &
ÿp_admš
, 
CAP_SET
);

98 
ÿp_ok
 = 
CAP_CLEAR
;

99 
	`ÿp_g‘_æag
(
ÿp_cur_p
, 
CAP_NET_RAW
, 
CAP_PERMITTED
, &
ÿp_ok
);

101 ià(
ÿp_ok
 !ğ
CAP_CLEAR
)

102 
	`ÿp_£t_æag
(
ÿp_p
, 
CAP_PERMITTED
, 1, &
ÿp_¿w
, 
CAP_SET
);

104 ià(
	`ÿp_£t_´oc
(
ÿp_p
) < 0) {

105 
	`³¼Ü
("ping: cap_set_proc");

106 
	`ex™
(-1);

109 ià(
	`´ùl
(
PR_SET_KEEPCAPS
, 1) < 0) {

110 
	`³¼Ü
("ping:…rctl");

111 
	`ex™
(-1);

114 ià(
	`£tuid
(
	`g‘uid
()) < 0) {

115 
	`³¼Ü
("setuid");

116 
	`ex™
(-1);

119 ià(
	`´ùl
(
PR_SET_KEEPCAPS
, 0) < 0) {

120 
	`³¼Ü
("ping:…rctl");

121 
	`ex™
(-1);

124 
	`ÿp_ä“
(
ÿp_p
);

125 
	`ÿp_ä“
(
ÿp_cur_p
);

127 
uid
 = 
	`g‘uid
();

128 
euid
 = 
	`g‘euid
();

129 #iâdeà
CAPABILITIES


130 ià(
	`£‹uid
(
uid
)) {

131 
	`³¼Ü
("ping: setuid");

132 
	`ex™
(-1);

135 
	}
}

137 #ifdeà
CAPABILITIES


138 
	$modify_ÿ·b™y
(
ÿp_v®ue_t
 
ÿp
, 
ÿp_æag_v®ue_t
 
Ú
)

140 
ÿp_t
 
ÿp_p
 = 
	`ÿp_g‘_´oc
();

141 
ÿp_æag_v®ue_t
 
ÿp_ok
;

142 
rc
 = -1;

144 ià(!
ÿp_p
) {

145 
	`³¼Ü
("ping: cap_get_proc");

146 
out
;

149 
ÿp_ok
 = 
CAP_CLEAR
;

150 
	`ÿp_g‘_æag
(
ÿp_p
, 
ÿp
, 
CAP_PERMITTED
, &
ÿp_ok
);

151 ià(
ÿp_ok
 =ğ
CAP_CLEAR
) {

152 
rc
 = 
Ú
 ? -1 : 0;

153 
out
;

156 
	`ÿp_£t_æag
(
ÿp_p
, 
CAP_EFFECTIVE
, 1, &
ÿp
, 
Ú
);

158 ià(
	`ÿp_£t_´oc
(
ÿp_p
) < 0) {

159 
	`³¼Ü
("ping: cap_set_proc");

160 
out
;

163 
	`ÿp_ä“
(
ÿp_p
);

165 
rc
 = 0;

166 
out
:

167 ià(
ÿp_p
)

168 
	`ÿp_ä“
(
ÿp_p
);

169  
rc
;

170 
	}
}

172 
	$modify_ÿ·b™y
(
Ú
)

174 ià(
	`£‹uid
(
Ú
 ? 
euid
 : 
	`g‘uid
())) {

175 
	`³¼Ü
("seteuid");

180 
	}
}

183 
	$drİ_ÿ·b™›s
()

185 #ifdeà
CAPABILITIES


186 
ÿp_t
 
ÿp
 = 
	`ÿp_š™
();

187 ià(
	`ÿp_£t_´oc
(
ÿp
) < 0) {

188 
	`³¼Ü
("ping: cap_set_proc");

189 
	`ex™
(-1);

191 
	`ÿp_ä“
(
ÿp
);

193 ià(
	`£tuid
(
	`g‘uid
())) {

194 
	`³¼Ü
("ping: setuid");

195 
	`ex™
(-1);

198 
	}
}

203 
	$fl
(*
·
)

205 
ii
, 
jj
, 
kk
;

206 
·t
[16];

207 *
ı
;

208 
u_ch¬
 *
bp
 = 
ouack
+8;

210 #ifdeà
USE_IDN


211 
	`£oÿË
(
LC_ALL
, "C");

214 
ı
 = 
·
; *cp; cp++) {

215 ià(!
	`isxdig™
(*
ı
)) {

216 
	`årštf
(
¡d”r
,

218 
	`ex™
(2);

221 
ii
 = 
	`ssÿnf
(
·
,

223 &
·t
[0], &pat[1], &pat[2], &pat[3], &pat[4], &pat[5], &pat[6],

224 &
·t
[7], &pat[8], &pat[9], &pat[10], &pat[11], &pat[12],

225 &
·t
[13], &pat[14], &pat[15]);

227 ià(
ii
 > 0) {

228 
kk
 = 0; kk <ğ
max·ck‘
 - (8 + 
ii
); kk += ii)

229 
jj
 = 0; jj < 
ii
; ++jj)

230 
bp
[
jj
 + 
kk
] = 
·t
[jj];

232 ià(!(
İtiÚs
 & 
F_QUIET
)) {

233 
	`´štf
("PATTERN: 0x");

234 
jj
 = 0; jj < 
ii
; ++jj)

235 
	`´štf
("%02x", 
bp
[
jj
] & 0xFF);

236 
	`´štf
("\n");

239 #ifdeà
USE_IDN


240 
	`£oÿË
(
LC_ALL
, "");

242 
	}
}

244 
	$commÚ_İtiÚs
(
ch
)

246 
ch
) {

248 
İtiÚs
 |ğ
F_AUDIBLE
;

251 
İtiÚs
 |ğ
F_ADAPTIVE
;

254 
Åack‘s
 = 
	`©oi
(
İrg
);

255 ià(
Åack‘s
 <= 0) {

256 
	`årštf
(
¡d”r
, "ping: bad‚umber of…acketsoransmit.\n");

257 
	`ex™
(2);

261 
İtiÚs
 |ğ
F_SO_DEBUG
;

264 
İtiÚs
 |ğ
F_PTIMEOFDAY
;

268 
dbl
;

269 *
•
;

271 
”ºo
 = 0;

272 
dbl
 = 
	`¡¹od
(
İrg
, &
•
);

274 ià(
”ºo
 || *
•
 != '\0' ||

275 !
	`fš™e
(
dbl
è|| dbÈ< 0.0 || dbÈ>ğ()
INT_MAX
 / 1000 - 1.0) {

276 
	`årštf
(
¡d”r
, "ping: badiming interval\n");

277 
	`ex™
(2);

280 
š‹rv®
 = ()(
dbl
 * 1000);

282 
İtiÚs
 |ğ
F_INTERVAL
;

287 *
’dp
;

288 
m¬k
 = ()
	`¡¹oul
(
İrg
, &
’dp
, 10);

289 ià(
m¬k
 < 0 || *
’dp
 != '\0') {

290 
	`årštf
(
¡d”r
, "mark cannot be‚egative\n");

291 
	`ex™
(2);

293 
İtiÚs
 |ğ
F_MARK
;

297 
d—dlše
 = 
	`©oi
(
İrg
);

298 ià(
d—dlše
 < 0) {

299 
	`årštf
(
¡d”r
, "ping: bad waitime.\n");

300 
	`ex™
(2);

304 
´–ßd
 = 
	`©oi
(
İrg
);

305 ià(
´–ßd
 <= 0) {

306 
	`årštf
(
¡d”r
, "pšg: bad…»lßd v®ue, should b1..%d\n", 
MAX_DUP_CHK
);

307 
	`ex™
(2);

309 ià(
´–ßd
 > 
MAX_DUP_CHK
)

310 
´–ßd
 = 
MAX_DUP_CHK
;

311 ià(
uid
 && 
´–ßd
 > 3) {

312 
	`årštf
(
¡d”r
, "ping: cannot set…reloado value > 3\n");

313 
	`ex™
(2);

317 
İtiÚs
 |ğ
F_OUTSTANDING
;

320 
¢dbuf
 = 
	`©oi
(
İrg
);

321 ià(
¢dbuf
 <= 0) {

322 
	`årštf
(
¡d”r
, "ping: bad sndbuf value.\n");

323 
	`ex™
(2);

327 
İtiÚs
 |ğ
F_FLOOD
;

328 
	`£tbuf
(
¡dout
, (*)
NULL
);

331 
İtiÚs
 |ğ
F_NUMERIC
;

334 
İtiÚs
 |ğ
F_PINGFILLED
;

335 
	`fl
(
İrg
);

338 
İtiÚs
 |ğ
F_QUIET
;

341 
İtiÚs
 |ğ
F_SO_DONTROUTE
;

344 
d©®’
 = 
	`©oi
(
İrg
);

345 ià(
d©®’
 < 0) {

346 
	`årštf
(
¡d”r
, "pšg: iÎeg®‚eg©iv·ck‘ siz%d.\n", 
d©®’
);

347 
	`ex™
(2);

349 ià(
d©®’
 > 
max·ck‘
 - 8) {

350 
	`årštf
(
¡d”r
, "ping:…acket sizeoo†arge: %d\n",

351 
d©®’
);

352 
	`ex™
(2);

356 
İtiÚs
 |ğ
F_VERBOSE
;

359 
İtiÚs
 |ğ
F_NOLOOP
;

362 
İtiÚs
 |ğ
F_TTL
;

363 
‰l
 = 
	`©oi
(
İrg
);

364 ià(
‰l
 < 0 ||tl > 255) {

365 
	`årštf
(
¡d”r
, "pšg: %u ouˆoà¿nge\n", 
‰l
);

366 
	`ex™
(2);

370 
İtiÚs
 |ğ
F_LATENCY
;

373 
İtiÚs
 |ğ
F_STRICTSOURCE
;

376 
lšg”time
 = 
	`©oi
(
İrg
);

377 ià(
lšg”time
 < 0 ||†šg”tim> 
INT_MAX
/1000000) {

378 
	`årštf
(
¡d”r
, "ping: bad†ingerime.\n");

379 
	`ex™
(2);

381 
lšg”time
 *= 1000;

384 
	`´štf
("pšg ut™y, iputs-%s\n", 
SNAPSHOT
);

385 
	`ex™
(0);

387 
	`abÜt
();

389 
	}
}

392 
	$sigex™
(
signo
)

394 
ex™šg
 = 1;

395 ià(
š_´_addr
)

396 
	`lÚgjmp
(
´_addr_jmp
, 0);

397 
	}
}

399 
	$sig¡©us
(
signo
)

401 
¡©us_¢­shÙ
 = 1;

402 
	}
}

405 
	$__scheduË_ex™
(
Ãxt
)

407 
wa™time
;

408 
™im”v®
 
™
;

410 ià(
wa™time
)

411  
Ãxt
;

413 ià(
Äeûived
) {

414 
wa™time
 = 2 * 
tmax
;

415 ià(
wa™time
 < 1000*
š‹rv®
)

416 
wa™time
 = 1000*
š‹rv®
;

418 
wa™time
 = 
lšg”time
*1000;

420 ià(
Ãxt
 < 0 ||‚exˆ< 
wa™time
/1000)

421 
Ãxt
 = 
wa™time
/1000;

423 
™
.
™_š‹rv®
.
tv_£c
 = 0;

424 
™
.
™_š‹rv®
.
tv_u£c
 = 0;

425 
™
.
™_v®ue
.
tv_£c
 = 
wa™time
/1000000;

426 
™
.
™_v®ue
.
tv_u£c
 = 
wa™time
%1000000;

427 
	`£t™im”
(
ITIMER_REAL
, &
™
, 
NULL
);

428  
Ãxt
;

429 
	}
}

431 
šlše
 
	$upd©e_š‹rv®
()

433 
e¡
 = 
¹t
 ?„‰/8 : 
š‹rv®
*1000;

435 
š‹rv®
 = (
e¡
+
¹t_add’d
+500)/1000;

436 ià(
uid
 && 
š‹rv®
 < 
MINUSERINTERVAL
)

437 
š‹rv®
 = 
MINUSERINTERVAL
;

438 
	}
}

443 
	$´št_time¡amp
()

445 ià(
İtiÚs
 & 
F_PTIMEOFDAY
) {

446 
timev®
 
tv
;

447 
	`g‘timeofday
(&
tv
, 
NULL
);

448 
	`´štf
("[%lu.%06lu] ",

449 ()
tv
.
tv_£c
, (év.
tv_u£c
);

451 
	}
}

461 
	$pšg”
()

463 
oom_couÁ
;

464 
tok’s
;

465 
i
;

468 ià(
ex™šg
 || (
Åack‘s
 && 
Á¿nsm™‹d
 >ğÅack‘ && !
d—dlše
))

472 ià(
cur_time
.
tv_£c
 == 0) {

473 
	`g‘timeofday
(&
cur_time
, 
NULL
);

474 
tok’s
 = 
š‹rv®
*(
´–ßd
-1);

476 
Áok’s
;

477 
timev®
 
tv
;

479 
	`g‘timeofday
(&
tv
, 
NULL
);

480 
Áok’s
 = (
tv
.
tv_£c
 - 
cur_time
.tv_sec)*1000 +

481 (
tv
.
tv_u£c
-
cur_time
.tv_usec)/1000;

482 ià(!
š‹rv®
) {

485 ià(
Áok’s
 < 
MININTERVAL
 && 
	`š_æight
(è>ğ
´–ßd
)

486  
MININTERVAL
-
Áok’s
;

488 
Áok’s
 +ğ
tok’s
;

489 ià(
Áok’s
 > 
š‹rv®
*
´–ßd
)

490 
Áok’s
 = 
š‹rv®
*
´–ßd
;

491 ià(
Áok’s
 < 
š‹rv®
)

492  
š‹rv®
 - 
Áok’s
;

494 
cur_time
 = 
tv
;

495 
tok’s
 = 
Áok’s
 - 
š‹rv®
;

498 ià(
İtiÚs
 & 
F_OUTSTANDING
) {

499 ià(
Á¿nsm™‹d
 > 0 && !
	`rcvd_‹¡
(ntransmitted)) {

500 
	`´št_time¡amp
();

501 
	`´štf
("nØªsw” y‘ fÜ icmp_£q=%lu\n", (
Á¿nsm™‹d
 % 
MAX_DUP_CHK
));

502 
	`fæush
(
¡dout
);

506 
»£nd
:

507 
i
 = 
	`£nd_´obe
();

509 ià(
i
 == 0) {

510 
oom_couÁ
 = 0;

511 
	`advªû_Á¿nsm™‹d
();

512 ià(!(
İtiÚs
 & 
F_QUIET
è&& (İtiÚ & 
F_FLOOD
)) {

515 ià((
´–ßd
 < 
sü“n_width
 && 
pesize
 < screen_width) ||

516 
	`š_æight
(è< 
sü“n_width
)

517 
	`wr™e_¡dout
(".", 1);

519  
š‹rv®
 - 
tok’s
;

523 ià(
i
 > 0) {

525 
	`abÜt
();

526 } ià(
”ºo
 =ğ
ENOBUFS
 ||ƒ¼nØ=ğ
ENOMEM
) {

527 
nÜes_š‹rv®
;

530 
tok’s
 = 0;

532 
¹t_add’d
 +ğ(
¹t
 < 8*50000 ?„tt/8 : 50000);

533 ià(
İtiÚs
&
F_ADAPTIVE
)

534 
	`upd©e_š‹rv®
();

535 
nÜes_š‹rv®
 = 
	`SCHINT
(
š‹rv®
/2);

536 ià(
nÜes_š‹rv®
 > 500)

537 
nÜes_š‹rv®
 = 500;

538 
oom_couÁ
++;

539 ià(
oom_couÁ
*
nÜes_š‹rv®
 < 
lšg”time
)

540  
nÜes_š‹rv®
;

541 
i
 = 0;

546 } ià(
”ºo
 =ğ
EAGAIN
) {

548 
tok’s
 +ğ
š‹rv®
;

549  
MININTERVAL
;

551 ià((
i
=
	`»ûive_”rÜ_msg
()) > 0) {

553 
tok’s
 +ğ
š‹rv®
;

554  
MININTERVAL
;

557 ià(
i
 =ğ0 && 
cÚfœm_æag
 && 
”ºo
 =ğ
EINVAL
) {

558 
cÚfœm_æag
 = 0;

559 
”ºo
 = 0;

561 ià(!
”ºo
)

562 
»£nd
;

566 
	`advªû_Á¿nsm™‹d
();

568 ià(
i
 =ğ0 && !(
İtiÚs
 & 
F_QUIET
)) {

569 ià(
İtiÚs
 & 
F_FLOOD
)

570 
	`wr™e_¡dout
("E", 1);

572 
	`³¼Ü
("ping: sendmsg");

574 
tok’s
 = 0;

575  
	`SCHINT
(
š‹rv®
);

576 
	}
}

580 
	$sock_£tbufs
(
icmp_sock
, 
®loc
)

582 
rcvbuf
, 
hŞd
;

583 
sockËn_t
 
tm¶’
 = (
hŞd
);

585 ià(!
¢dbuf
)

586 
¢dbuf
 = 
®loc
;

587 
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_SNDBUF
, (*)&
¢dbuf
, (sndbuf));

589 
rcvbuf
 = 
hŞd
 = 
®loc
 * 
´–ßd
;

590 ià(
hŞd
 < 65536)

591 
hŞd
 = 65536;

592 
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_RCVBUF
, (*)&
hŞd
, (hold));

593 ià(
	`g‘sockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_RCVBUF
, (*)&
hŞd
, &
tm¶’
) == 0) {

594 ià(
hŞd
 < 
rcvbuf
)

595 
	`årštf
(
¡d”r
, "WARNING:…robably,„cvbuf is‚otƒnougho hold…reload.\n");

597 
	}
}

601 
	$£tup
(
icmp_sock
)

603 
hŞd
;

604 
timev®
 
tv
;

605 
sig£t_t
 
s£t
;

607 ià((
İtiÚs
 & 
F_FLOOD
è&& !(İtiÚ & 
F_INTERVAL
))

608 
š‹rv®
 = 0;

610 ià(
uid
 && 
š‹rv®
 < 
MINUSERINTERVAL
) {

611 
	`årštf
(
¡d”r
, "pšg: cªnÙ flood; mšim® iÁ”v®,‡Îowed fÜ u£r, i %dms\n", 
MINUSERINTERVAL
);

612 
	`ex™
(2);

615 ià(
š‹rv®
 >ğ
INT_MAX
/
´–ßd
) {

616 
	`årštf
(
¡d”r
, "ping: illegal…reload‡nd/or interval\n");

617 
	`ex™
(2);

620 
hŞd
 = 1;

621 ià(
İtiÚs
 & 
F_SO_DEBUG
)

622 
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_DEBUG
, (*)&
hŞd
, (hold));

623 ià(
İtiÚs
 & 
F_SO_DONTROUTE
)

624 
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_DONTROUTE
, (*)&
hŞd
, (hold));

626 #ifdeà
SO_TIMESTAMP


627 ià(!(
İtiÚs
&
F_LATENCY
)) {

628 
Ú
 = 1;

629 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_TIMESTAMP
, &
Ú
, (on)))

630 
	`årštf
(
¡d”r
, "Warning:‚o SO_TIMESTAMP support, falling backo SIOCGSTAMP\n");

633 ià(
İtiÚs
 & 
F_MARK
) {

634 
»t
;

636 
	`’abË_ÿ·b™y_admš
();

637 
»t
 = 
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_MARK
, &
m¬k
, (mark));

638 
	`di§bË_ÿ·b™y_admš
();

640 ià(
»t
 == -1) {

644 
	`årštf
(
¡d”r
, "W¬nšg: FaedØ£ˆm¬k %d\n", 
m¬k
);

652 
tv
.
tv_£c
 = 1;

653 
tv
.
tv_u£c
 = 0;

654 ià(
š‹rv®
 < 1000) {

655 
tv
.
tv_£c
 = 0;

656 
tv
.
tv_u£c
 = 1000 * 
	`SCHINT
(
š‹rv®
);

658 
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_SNDTIMEO
, (*)&
tv
, (tv));

662 
tv
.
tv_£c
 = 
	`SCHINT
(
š‹rv®
)/1000;

663 
tv
.
tv_u£c
 = 1000*(
	`SCHINT
(
š‹rv®
)%1000);

664 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_RCVTIMEO
, (*)&
tv
, (tv)))

665 
İtiÚs
 |ğ
F_FLOOD_POLL
;

667 ià(!(
İtiÚs
 & 
F_PINGFILLED
)) {

668 
i
;

669 
u_ch¬
 *
p
 = 
ouack
+8;

674 
i
 = 0; i < 
d©®’
; ++i)

675 *
p
++ = 
i
;

678 
id’t
 = 
	`htÚs
(
	`g‘pid
() & 0xFFFF);

680 
	`£t_sigÇl
(
SIGINT
, 
sigex™
);

681 
	`£t_sigÇl
(
SIGALRM
, 
sigex™
);

682 
	`£t_sigÇl
(
SIGQUIT
, 
sig¡©us
);

684 
	`sigem±y£t
(&
s£t
);

685 
	`sig´ocmask
(
SIG_SETMASK
, &
s£t
, 
NULL
);

687 
	`g‘timeofday
(&
¡¬t_time
, 
NULL
);

689 ià(
d—dlše
) {

690 
™im”v®
 
™
;

692 
™
.
™_š‹rv®
.
tv_£c
 = 0;

693 
™
.
™_š‹rv®
.
tv_u£c
 = 0;

694 
™
.
™_v®ue
.
tv_£c
 = 
d—dlše
;

695 
™
.
™_v®ue
.
tv_u£c
 = 0;

696 
	`£t™im”
(
ITIMER_REAL
, &
™
, 
NULL
);

699 ià(
	`i§‰y
(
STDOUT_FILENO
)) {

700 
wšsize
 
w
;

702 ià(
	`ioùl
(
STDOUT_FILENO
, 
TIOCGWINSZ
, &
w
) != -1) {

703 ià(
w
.
ws_cŞ
 > 0)

704 
sü“n_width
 = 
w
.
ws_cŞ
;

707 
	}
}

709 
	$maš_loİ
(
icmp_sock
, 
__u8
 *
·ck‘
, 
·ckËn
)

711 
addrbuf
[128];

712 
ªs_d©a
[4096];

713 
iovec
 
iov
;

714 
msghdr
 
msg
;

715 
cmsghdr
 *
c
;

716 
cc
;

717 
Ãxt
;

718 
pŞlšg
;

720 
iov
.
iov_ba£
 = (*)
·ck‘
;

724 ià(
ex™šg
)

726 ià(
Åack‘s
 && 
Äeûived
 + 
Ã¼Üs
 >=‚packets)

728 ià(
d—dlše
 && 
Ã¼Üs
)

731 ià(
¡©us_¢­shÙ
)

732 
	`¡©us
();

736 
Ãxt
 = 
	`pšg”
();

737 
Ãxt
 = 
	`scheduË_ex™
(next);

738 } 
Ãxt
 <= 0);

750 
pŞlšg
 = 0;

751 ià((
İtiÚs
 & (
F_ADAPTIVE
|
F_FLOOD_POLL
)è|| 
Ãxt
<
	`SCHINT
(
š‹rv®
)) {

752 
»cv_ex³ùed
 = 
	`š_æight
();

756 ià(1000 % 
HZ
 =ğ0 ? 
Ãxt
 <ğ1000 / HZ : (Ãxˆ< 
INT_MAX
 / HZ &&‚ext * HZ <= 1000)) {

760 ià(
»cv_ex³ùed
) {

761 
Ãxt
 = 
MININTERVAL
;

763 
Ãxt
 = 0;

766 
pŞlšg
 = 
MSG_DONTWAIT
;

768 
	`sched_y›ld
();

772 ià(!
pŞlšg
 &&

773 ((
İtiÚs
 & (
F_ADAPTIVE
|
F_FLOOD_POLL
)è|| 
š‹rv®
)) {

774 
pŞlfd
 
p£t
;

775 
p£t
.
fd
 = 
icmp_sock
;

776 
p£t
.
ev’ts
 = 
POLLIN
|
POLLERR
;

777 
p£t
.
»v’ts
 = 0;

778 ià(
	`pŞl
(&
p£t
, 1, 
Ãxt
) < 1 ||

779 !(
p£t
.
»v’ts
&(
POLLIN
|
POLLERR
)))

781 
pŞlšg
 = 
MSG_DONTWAIT
;

786 
timev®
 *
»cv_tim•
 = 
NULL
;

787 
timev®
 
»cv_time
;

788 
nÙ_ours
 = 0;

791 
iov
.
iov_Ën
 = 
·ckËn
;

792 
	`mem£t
(&
msg
, 0, (msg));

793 
msg
.
msg_Çme
 = 
addrbuf
;

794 
msg
.
msg_Çm–’
 = (
addrbuf
);

795 
msg
.
msg_iov
 = &
iov
;

796 
msg
.
msg_iovËn
 = 1;

797 
msg
.
msg_cÚŒŞ
 = 
ªs_d©a
;

798 
msg
.
msg_cÚŒŞËn
 = (
ªs_d©a
);

800 
cc
 = 
	`»cvmsg
(
icmp_sock
, &
msg
, 
pŞlšg
);

801 
pŞlšg
 = 
MSG_DONTWAIT
;

803 ià(
cc
 < 0) {

804 ià(
”ºo
 =ğ
EAGAIN
 ||ƒ¼nØ=ğ
EINTR
)

806 ià(!
	`»ûive_”rÜ_msg
()) {

807 ià(
”ºo
) {

808 
	`³¼Ü
("ping:„ecvmsg");

811 
nÙ_ours
 = 1;

826 ià((
İtiÚs
&
F_LATENCY
è|| 
»cv_tim•
 =ğ
NULL
) {

827 ià((
İtiÚs
&
F_LATENCY
) ||

828 
	`ioùl
(
icmp_sock
, 
SIOCGSTAMP
, &
»cv_time
))

829 
	`g‘timeofday
(&
»cv_time
, 
NULL
);

830 
»cv_tim•
 = &
»cv_time
;

831 
	`´štf
("[maš†oİ]„ecv_time[%ld.%ld]\n", 
»cv_tim•
->
tv_£c
,„ecv_tim•->
tv_u£c
);

834 
nÙ_ours
 = 
	`·r£_»¶y
(&
msg
, 
cc
, 
addrbuf
, 
»cv_tim•
);

838 ià(
nÙ_ours
)

839 
	`š¡®l_f‹r
();

842 ià(
	`š_æight
() == 0)

851 
	`fšish
();

852 
	}
}

854 
g©h”_¡©i¡ics
(
__u8
 *
icmph
, 
icm¶’
,

855 
cc
, 
__u16
 
£q
, 
hİs
,

856 
csçed
, 
timev®
 *
tv
, *
äom
,

857 (*
´_»¶y
)(
__u8
 *
icmph
, 
cc
))

859 
dupæag
 = 0;

860 
Œtime
 = 0;

861 
__u8
 *
±r
 = 
icmph
 + 
icm¶’
;

863 ++
Äeûived
;

864 ià(!
csçed
)

865 
	`acknowËdge
(
£q
);

867 ià(
timšg
 && 
cc
 >ğ8+(
timev®
)) {

868 
timev®
 
tmp_tv
;

869 
	`memıy
(&
tmp_tv
, 
±r
, (tmp_tv));

870 
timev®
 
Œy_tv
;

871 
	`g‘timeofday
(&
Œy_tv
, 
NULL
);

872 
»¡amp
:

873 
	`´štf
("[g©h”_¡©i¡ics] s’d_time[%ld.%ld]s\n", 
tmp_tv
.
tv_£c
,mp_tv.
tv_u£c
);

874 
	`´štf
("[g©h”_¡©i¡ics]„ecv_time[%ld.%ld]s\n", 
tv
->
tv_£c
,v->
tv_u£c
);

875 
	`´štf
("[g©h”_¡©i¡ics]ry_»cv_time[%ld.%ld]s\n", 
Œy_tv
.
tv_£c
,ry_tv.
tv_u£c
);

876 
	`tvsub
(
tv
, &
tmp_tv
);

877 
Œtime
 = 
tv
->
tv_£c
 * 1000000 +v->
tv_u£c
;

878 
	`´štf
("[g©h”_¡©i¡ics]rtime[%ld.%ld]s\n", 
tv
->
tv_£c
,v->
tv_u£c
);

879 ià(
Œtime
 < 0) {

880 
	`årštf
(
¡d”r
, "W¬nšg:imoàday gÛ back (%ldus),akšg couÁ”m—su»s.\n", 
Œtime
);

881 
Œtime
 = 0;

882 ià(!(
İtiÚs
 & 
F_LATENCY
)) {

883 
	`g‘timeofday
(
tv
, 
NULL
);

884 
İtiÚs
 |ğ
F_LATENCY
;

885 
»¡amp
;

888 ià(!
csçed
) {

889 
tsum
 +ğ
Œtime
;

890 
tsum2
 +ğ()
Œtime
 * ()triptime;

891 ià(
Œtime
 < 
tmš
)

892 
tmš
 = 
Œtime
;

893 ià(
Œtime
 > 
tmax
)

894 
tmax
 = 
Œtime
;

895 ià(!
¹t
)

896 
¹t
 = 
Œtime
*8;

898 
¹t
 +ğ
Œtime
-rtt/8;

899 ià(
İtiÚs
&
F_ADAPTIVE
)

900 
	`upd©e_š‹rv®
();

904 ià(
csçed
) {

905 ++
nchecksum
;

906 --
Äeûived
;

907 } ià(
	`rcvd_‹¡
(
£q
)) {

908 ++
Ä•—ts
;

909 --
Äeûived
;

910 
dupæag
 = 1;

912 
	`rcvd_£t
(
£q
);

913 
dupæag
 = 0;

915 
cÚfœm
 = 
cÚfœm_æag
;

917 ià(
İtiÚs
 & 
F_QUIET
)

920 ià(
İtiÚs
 & 
F_FLOOD
) {

921 ià(!
csçed
)

922 
	`wr™e_¡dout
("\b \b", 3);

924 
	`wr™e_¡dout
("\bC", 2);

926 
i
;

927 
__u8
 *
ı
, *
dp
;

929 
	`´št_time¡amp
();

930 
	`´štf
("%d by‹ äom %s:", 
cc
, 
äom
);

932 ià(
´_»¶y
)

933 
	`´_»¶y
(
icmph
, 
cc
);

935 ià(
hİs
 >= 0)

936 
	`´štf
("=%d", 
hİs
);

938 ià(
cc
 < 
d©®’
+8) {

939 
	`´štf
(" (truncated)\n");

942 ià(
timšg
) {

943 ià(
Œtime
 >= 100000)

944 
	`´štf
("ime=%ld ms", 
Œtime
/1000);

945 ià(
Œtime
 >= 10000)

946 
	`´štf
("ime=%ld.%01ld ms", 
Œtime
/1000,

947 (
Œtime
%1000)/100);

948 ià(
Œtime
 >= 1000)

949 
	`´štf
("ime=%ld.%02ld ms", 
Œtime
/1000,

950 (
Œtime
%1000)/10);

952 
	`´štf
("ime=%ld.%03ld ms", 
Œtime
/1000,

953 
Œtime
%1000);

955 ià(
dupæag
)

956 
	`´štf
(" (DUP!)");

957 ià(
csçed
)

958 
	`´štf
(" (BAD CHECKSUM!)");

961 
ı
 = ((
u_ch¬
*)
±r
è+ (
timev®
);

962 
dp
 = &
ouack
[8 + (
timev®
)];

963 
i
 = (
timev®
); i < 
d©®’
; ++i, ++
ı
, ++
dp
) {

964 ià(*
ı
 !ğ*
dp
) {

965 
	`´štf
("\nwrong data byte #%d should be 0x%x but was 0x%x",

966 
i
, *
dp
, *
ı
);

967 
ı
 = (
u_ch¬
*)
±r
 + (
timev®
);

968 
i
 = (
timev®
); i < 
d©®’
; ++i, ++
ı
) {

969 ià((
i
 % 32è=ğ(
timev®
))

970 
	`´štf
("\n#%d\t", 
i
);

971 
	`´štf
("%x ", *
ı
);

978 
	}
}

980 
	$Îsq¹
(
a
)

982 
´ev
 = ~(()1 << 63);

983 
x
 = 
a
;

985 ià(
x
 > 0) {

986 
x
 < 
´ev
) {

987 
´ev
 = 
x
;

988 
x
 = (x+(
a
/x))/2;

992  ()
x
;

993 
	}
}

999 
	$fšish
()

1001 
timev®
 
tv
 = 
cur_time
;

1002 *
comma
 = "";

1004 
	`tvsub
(&
tv
, &
¡¬t_time
);

1006 
	`putch¬
('\n');

1007 
	`fæush
(
¡dout
);

1008 
	`´štf
("--- % pšg sti¡ic ---\n", 
ho¡Çme
);

1009 
	`´štf
("%ld…ack‘ Œªsm™‹d, ", 
Á¿nsm™‹d
);

1010 
	`´štf
("%ld„eûived", 
Äeûived
);

1011 ià(
Ä•—ts
)

1012 
	`´štf
(", +%ld du¶iÿ‹s", 
Ä•—ts
);

1013 ià(
nchecksum
)

1014 
	`´štf
(", +%ld cÜru±ed", 
nchecksum
);

1015 ià(
Ã¼Üs
)

1016 
	`´štf
(", +%ldƒ¼Üs", 
Ã¼Üs
);

1017 ià(
Á¿nsm™‹d
) {

1018 
	`´štf
(", %d%%…acket†oss",

1019 (è(((()(
Á¿nsm™‹d
 - 
Äeûived
)) * 100) /

1020 
Á¿nsm™‹d
));

1021 
	`´štf
(",im%ldms", 1000*
tv
.
tv_£c
+tv.
tv_u£c
/1000);

1023 
	`putch¬
('\n');

1025 ià(
Äeûived
 && 
timšg
) {

1026 
tmdev
;

1028 
tsum
 /ğ
Äeûived
 + 
Ä•—ts
;

1029 
tsum2
 /ğ
Äeûived
 + 
Ä•—ts
;

1030 
tmdev
 = 
	`Îsq¹
(
tsum2
 - 
tsum
 *sum);

1032 
	`´štf
("rtt min/avg/max/mdev = %ld.%03ld/%lu.%03ld/%ld.%03ld/%ld.%03ld ms",

1033 ()
tmš
/1000, ()tmin%1000,

1034 ()(
tsum
/1000), ()(tsum%1000),

1035 ()
tmax
/1000, ()tmax%1000,

1036 ()
tmdev
/1000, ()tmdev%1000

1038 
comma
 = ", ";

1040 ià(
pesize
 > 1) {

1041 
	`´štf
("%¥%d", 
comma
, 
pesize
);

1042 
comma
 = ", ";

1044 ià(
Äeûived
 && (!
š‹rv®
 || (
İtiÚs
&(
F_FLOOD
|
F_ADAPTIVE
))è&& 
Á¿nsm™‹d
 > 1) {

1045 
g
 = (1000000*()
tv
.
tv_£c
+tv.
tv_u£c
)/(
Á¿nsm™‹d
-1);

1046 
	`´štf
("%sipg/ewma %d.%03d/%d.%03d ms",

1047 
comma
, 
g
/1000, ipg%1000, 
¹t
/8000, (rtt/8)%1000);

1049 
	`putch¬
('\n');

1050 
	`ex™
(!
Äeûived
 || (
d—dlše
 &&‚»ûived < 
Åack‘s
));

1051 
	}
}

1054 
	$¡©us
()

1056 
loss
 = 0;

1057 
vg
 = 0;

1059 
¡©us_¢­shÙ
 = 0;

1061 ià(
Á¿nsm™‹d
)

1062 
loss
 = ((()(
Á¿nsm™‹d
 - 
Äeûived
)) * 100) /‚transmitted;

1064 
	`årštf
(
¡d”r
, "\r%ld/%ld…ack‘s, %d%%†oss", 
Á¿nsm™‹d
, 
Äeûived
, 
loss
);

1066 ià(
Äeûived
 && 
timšg
) {

1067 
vg
 = 
tsum
 / (
Äeûived
 + 
Ä•—ts
);

1069 
	`årštf
(
¡d”r
, ", min/avg/ewma/max = %ld.%03ld/%lu.%03ld/%d.%03d/%ld.%03ld ms",

1070 ()
tmš
/1000, ()tmin%1000,

1071 
vg
/1000,avg%1000,

1072 
¹t
/8000, (rtt/8)%1000,

1073 ()
tmax
/1000, ()tmax%1000

1076 
	`årštf
(
¡d”r
, "\n");

1077 
	}
}

	@ping_common.h

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<uni¡d.h
>

4 
	~<time.h
>

5 
	~<sys/·¿m.h
>

6 
	~<sys/sock‘.h
>

7 
	~<lšux/sockios.h
>

8 
	~<sys/fe.h
>

9 
	~<sys/time.h
>

10 
	~<sys/sigÇl.h
>

11 
	~<sys/ioùl.h
>

12 
	~<Ãt/if.h
>

13 
	~<sys/uio.h
>

14 
	~<sys/pŞl.h
>

15 
	~<ùy³.h
>

16 
	~<”ºo.h
>

17 
	~<¡ršg.h
>

18 
	~<Ãtdb.h
>

19 
	~<£tjmp.h
>

21 #ifdeà
CAPABILITIES


22 
	~<sys/´ùl.h
>

23 
	~<sys/ÿ·b™y.h
>

26 #ifdeà
USE_IDN


27 
	~<loÿË.h
>

28 
	~<idÇ.h
>

31 
	~<Ãtš‘/š.h
>

32 
	~<¬·/š‘.h
>

33 
	~<lšux/ty³s.h
>

34 
	~<lšux/”rqueue.h
>

36 
	~"SNAPSHOT.h
"

38 
	#DEFDATALEN
 (64 - 8è

	)

40 
	#MAXWAIT
 10

	)

41 
	#MININTERVAL
 10

	)

42 
	#MINUSERINTERVAL
 200

	)

44 
	#SCHINT
(
a
è((×è<ğ
MININTERVAL
è? MININTERVAL : (a))

	)

47 
İtiÚs
;

48 
	#F_FLOOD
 0x001

	)

49 
	#F_INTERVAL
 0x002

	)

50 
	#F_NUMERIC
 0x004

	)

51 
	#F_PINGFILLED
 0x008

	)

52 
	#F_QUIET
 0x010

	)

53 
	#F_RROUTE
 0x020

	)

54 
	#F_SO_DEBUG
 0x040

	)

55 
	#F_SO_DONTROUTE
 0x080

	)

56 
	#F_VERBOSE
 0x100

	)

57 
	#F_TIMESTAMP
 0x200

	)

58 
	#F_FLOWINFO
 0x200

	)

59 
	#F_SOURCEROUTE
 0x400

	)

60 
	#F_TCLASS
 0x400

	)

61 
	#F_FLOOD_POLL
 0x800

	)

62 
	#F_LATENCY
 0x1000

	)

63 
	#F_AUDIBLE
 0x2000

	)

64 
	#F_ADAPTIVE
 0x4000

	)

65 
	#F_STRICTSOURCE
 0x8000

	)

66 
	#F_NOLOOP
 0x10000

	)

67 
	#F_TTL
 0x20000

	)

68 
	#F_MARK
 0x40000

	)

69 
	#F_PTIMEOFDAY
 0x80000

	)

70 
	#F_OUTSTANDING
 0x100000

	)

76 
	#MAX_DUP_CHK
 0x10000

	)

78 #ià
defšed
(
__WORDSIZE
) && __WORDSIZE == 64

79 
	#USE_BITMAP64


	)

82 #ifdeà
USE_BITMAP64


83 
__u64
 
	tb™m­_t
;

84 
	#BITMAP_SHIFT
 6

	)

86 
__u32
 
	tb™m­_t
;

87 
	#BITMAP_SHIFT
 5

	)

90 #ià((
MAX_DUP_CHK
 >> (
BITMAP_SHIFT
 + 3)) << (BITMAP_SHIFT + 3)) != MAX_DUP_CHK

91 #”rÜ 
PËa£
 
MAX_DUP_CHK
 
ªd
/
Ü
 
BITMAP_SHIFT


94 
	srcvd_bË
 {

95 
b™m­_t
 
	mb™m­
[
MAX_DUP_CHK
 / ((bitmap_t) * 8)];

98 
rcvd_bË
 
rcvd_tbl
;

100 
	#A
(
b™
è(
rcvd_tbl
.
b™m­
[(b™è>> 
BITMAP_SHIFT
]è

	)

101 
	#B
(
b™
è(((
b™m­_t
)1è<< ((b™è& ((1 << 
BITMAP_SHIFT
è- 1))è

	)

103 
šlše
 
	$rcvd_£t
(
__u16
 
£q
)

105 
b™
 = 
£q
 % 
MAX_DUP_CHK
;

106 
	`A
(
b™
è|ğ
	`B
(bit);

107 
	}
}

109 
šlše
 
	$rcvd_ş—r
(
__u16
 
£q
)

111 
b™
 = 
£q
 % 
MAX_DUP_CHK
;

112 
	`A
(
b™
è&ğ~
	`B
(bit);

113 
	}
}

115 
šlše
 
b™m­_t
 
	$rcvd_‹¡
(
__u16
 
£q
)

117 
b™
 = 
£q
 % 
MAX_DUP_CHK
;

118  
	`A
(
b™
è& 
	`B
(bit);

119 
	}
}

121 
u_ch¬
 
ouack
[];

122 
max·ck‘
;

124 
d©®’
;

125 *
ho¡Çme
;

126 
uid
;

127 
id’t
;

129 
¢dbuf
;

130 
‰l
;

132 
Åack‘s
;

133 
Äeûived
;

134 
Ä•—ts
;

135 
Á¿nsm™‹d
;

136 
nchecksum
;

137 
Ã¼Üs
;

138 
š‹rv®
;

139 
´–ßd
;

140 
d—dlše
;

141 
lšg”time
;

142 
timev®
 
¡¬t_time
, 
cur_time
;

143 vŞ©
ex™šg
;

144 vŞ©
¡©us_¢­shÙ
;

145 
cÚfœm
;

146 
cÚfœm_æag
;

147 
wÜkšg_»cv”r
;

149 vŞ©
š_´_addr
;

150 
jmp_buf
 
´_addr_jmp
;

152 #iâdeà
MSG_CONFIRM


153 
	#MSG_CONFIRM
 0

	)

158 
timšg
;

159 
tmš
;

160 
tmax
;

161 
tsum
;

162 
tsum2
;

163 
¹t
;

164 
__u16
 
acked
;

165 
pesize
;

167 
	#COMMON_OPTIONS
 \

173 'D': 'O':

	)

175 
	#COMMON_OPTSTR
 "h?VQ:I:M:aUc:dfi:w:l:S:Å:qrs:vLt:AW:Bm:DO"

	)

180 
šlše
 
	$wr™e_¡dout
(cÚ¡ *
¡r
, 
size_t
 
Ën
)

182 
size_t
 
o
 = 0;

183 
ssize_t
 
cc
;

185 
cc
 = 
	`wr™e
(
STDOUT_FILENO
, 
¡r
 + 
o
, 
Ën
 - o);

186 
o
 +ğ
cc
;

187 } 
Ën
 > 
o
 || 
cc
 < 0);

188 
	}
}

195 
šlše
 
	$tvsub
(
timev®
 *
out
, timev® *
š
)

197 ià((
out
->
tv_u£c
 -ğ
š
->tv_usec) < 0) {

198 --
out
->
tv_£c
;

199 
out
->
tv_u£c
 += 1000000;

201 
out
->
tv_£c
 -ğ
š
->tv_sec;

202 
	}
}

204 
šlše
 
£t_sigÇl
(
signo
, (*
hªdËr
)())

206 
sigaùiÚ
 
§
;

208 
	`mem£t
(&
§
, 0, (sa));

210 
§
.
§_hªdËr
 = ((*)())
hªdËr
;

211 #ifdeà
SA_INTERRUPT


212 
§
.
§_æags
 = 
SA_INTERRUPT
;

214 
	`sigaùiÚ
(
signo
, &
§
, 
NULL
);

215 
	}
}

217 
__scheduË_ex™
(
Ãxt
);

219 
šlše
 
	$scheduË_ex™
(
Ãxt
)

221 ià(
Åack‘s
 && 
Á¿nsm™‹d
 >ğÅack‘ && !
d—dlše
)

222 
Ãxt
 = 
	`__scheduË_ex™
(next);

223  
Ãxt
;

224 
	}
}

226 
šlše
 
	$š_æight
()

228 
__u16
 
diff
 = (__u16)
Á¿nsm™‹d
 - 
acked
;

229  (
diff
<=0x7FFFè? difà: 
Á¿nsm™‹d
-
Äeûived
-
Ã¼Üs
;

230 
	}
}

232 
šlše
 
	$acknowËdge
(
__u16
 
£q
)

234 
__u16
 
diff
 = (__u16)
Á¿nsm™‹d
 - 
£q
;

235 ià(
diff
 <= 0x7FFF) {

236 ià(()
diff
+1 > 
pesize
)

237 
pesize
 = ()
diff
+1;

238 ià((
__s16
)(
£q
 - 
acked
) > 0 ||

239 (
__u16
)
Á¿nsm™‹d
 - 
acked
 > 0x7FFF)

240 
acked
 = 
£q
;

242 
	}
}

244 
šlše
 
	$advªû_Á¿nsm™‹d
()

246 
Á¿nsm™‹d
++;

248 ià((
__u16
)
Á¿nsm™‹d
 - 
acked
 > 0x7FFF)

249 
acked
 = (
__u16
)
Á¿nsm™‹d
 + 1;

250 
	}
}

252 
lim™_ÿ·b™›s
();

253 
’abË_ÿ·b™y_¿w
();

254 
di§bË_ÿ·b™y_¿w
();

255 
’abË_ÿ·b™y_admš
();

256 
di§bË_ÿ·b™y_admš
();

257 #ifdeà
CAPABILITIES


258 
modify_ÿ·b™y
(
ÿp_v®ue_t
, 
ÿp_æag_v®ue_t
);

259 
šlše
 
	$’abË_ÿ·b™y_¿w
(è{  
	`modify_ÿ·b™y
(
CAP_NET_RAW
, 
CAP_SET
); 
	}
};

260 
šlše
 
	$di§bË_ÿ·b™y_¿w
(è{  
	`modify_ÿ·b™y
(
CAP_NET_RAW
, 
CAP_CLEAR
); 
	}
};

261 
šlše
 
	$’abË_ÿ·b™y_admš
(è{  
	`modify_ÿ·b™y
(
CAP_NET_ADMIN
, 
CAP_SET
); 
	}
};

262 
šlše
 
	$di§bË_ÿ·b™y_admš
(è{  
	`modify_ÿ·b™y
(
CAP_NET_ADMIN
, 
CAP_CLEAR
); 
	}
};

264 
modify_ÿ·b™y
();

265 
šlše
 
	$’abË_ÿ·b™y_¿w
(è{  
	`modify_ÿ·b™y
(1); 
	}
};

266 
šlše
 
	$di§bË_ÿ·b™y_¿w
(è{  
	`modify_ÿ·b™y
(0); 
	}
};

267 
šlše
 
	$’abË_ÿ·b™y_admš
(è{  
	`modify_ÿ·b™y
(1); 
	}
};

268 
šlše
 
	$di§bË_ÿ·b™y_admš
(è{  
	`modify_ÿ·b™y
(0); 
	}
};

270 
drİ_ÿ·b™›s
();

272 
£nd_´obe
();

273 
»ûive_”rÜ_msg
();

274 
·r£_»¶y
(
msghdr
 *
msg
, 
Ën
, *
addr
, 
timev®
 *);

275 
š¡®l_f‹r
();

277 
pšg”
();

278 
sock_£tbufs
(
icmp_sock
, 
®loc
);

279 
£tup
(
icmp_sock
);

280 
	$maš_loİ
(
icmp_sock
, 
__u8
 *
buf
, 
buæ’
è
	`__©Œibu‹__
((
nÜ‘uº
));

281 
	$fšish
(è
	`__©Œibu‹__
((
nÜ‘uº
));

282 
	`¡©us
();

283 
	`commÚ_İtiÚs
(
ch
);

284 
	`g©h”_¡©i¡ics
(
__u8
 *
±r
, 
icm¶’
,

285 
cc
, 
__u16
 
£q
, 
hİs
,

286 
csçed
, 
timev®
 *
tv
, *
äom
,

287 (*
´_»¶y
)(
__u8
 *
±r
, 
cc
));

288 
	`´št_time¡amp
();

	@rarpd.c

12 
	~<¡dio.h
>

13 
	~<sy¦og.h
>

14 
	~<dœ’t.h
>

15 
	~<m®loc.h
>

16 
	~<¡ršg.h
>

17 
	~<uni¡d.h
>

18 
	~<¡dlib.h
>

19 
	~<Ãtdb.h
>

20 
	~<¬·/š‘.h
>

21 
	~<sys/ioùl.h
>

22 
	~<sys/pŞl.h
>

23 
	~<sys/”ºo.h
>

24 
	~<sys/fú.h
>

25 
	~<sys/sock‘.h
>

26 
	~<sys/sigÇl.h
>

27 
	~<lšux/if.h
>

28 
	~<lšux/if_¬p.h
>

29 
	~<Ãtš‘/š.h
>

30 
	~<lšux/if_·ck‘.h
>

31 
	~<lšux/f‹r.h
>

33 
	gdo_»lßd
 = 1;

35 
	gdebug
;

36 
	gv”bo£
;

37 
	gifidx
;

38 
	g®low_ofæšk
;

39 
	gÚly_‘h”s
;

40 
	g®l_içûs
;

41 
	gli¡’_¬p
;

42 *
	giâame
;

43 *
	gtáp_dœ
 = "/etc/tftpboot";

45 
‘h”_Áoho¡
(*
Çme
, *
—
);

46 
	$u§ge
(è
	`__©Œibu‹__
((
nÜ‘uº
));

48 
	siæšk


50 
iæšk
 *
Ãxt
;

51 
šdex
;

52 
h©y³
;

53 
Îaddr
[16];

54 
Çme
[
IFNAMSIZ
];

55 
içddr
 *
iç_li¡
;

56 } *
iæ_li¡
;

58 
	siçddr


60 
içddr
 *
Ãxt
;

61 
__u32
 
´efix
;

62 
__u32
 
mask
;

63 
__u32
 
loÿl
;

66 
	s¿½_m­


68 
¿½_m­
 *
Ãxt
;

70 
ifšdex
;

71 
¬p_ty³
;

72 
Îaddr_Ën
;

73 
Îaddr
[16];

74 
__u32
 
addr
;

75 } *
¿½_db
;

77 
	$u§ge
()

79 
	`årštf
(
¡d”r
, "Usage:„arpd [ -dveaA ] [ -bftpdir ] [ interface]\n");

80 
	`ex™
(1);

81 
	}
}

83 
	$lßd_db
()

85 
	}
}

87 
	$lßd_if
()

89 
fd
;

90 
iäeq
 *
iäp
, *
iãnd
;

91 
iæšk
 *
iæ
;

92 
içddr
 *
iç
;

93 
ifcÚf
 
ifc
;

94 
iäeq
 
ibuf
[256];

96 ià((
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

97 
	`sy¦og
(
LOG_ERR
, "socket: %m");

101 
ifc
.
ifc_Ën
 =  
ibuf
;

102 
ifc
.
ifc_buf
 = (
ÿddr_t
)
ibuf
;

103 ià(
	`ioùl
(
fd
, 
SIOCGIFCONF
, (*)&
ifc
) < 0 ||

104 
ifc
.
ifc_Ën
 < ()(
iäeq
)) {

105 
	`sy¦og
(
LOG_ERR
, "SIOCGIFCONF: %m");

106 
	`şo£
(
fd
);

110 (
iæ
 = 
iæ_li¡
è!ğ
NULL
) {

111 (
iç
 = 
iæ
->
iç_li¡
è!ğ
NULL
) {

112 
iæ
->
iç_li¡
 = 
iç
->
Ãxt
;

113 
	`ä“
(
iç
);

115 
iæ_li¡
 = 
iæ
->
Ãxt
;

116 
	`ä“
(
iæ
);

119 
iãnd
 = (
iäeq
 *)((*)
ibuf
 + 
ifc
.
ifc_Ën
);

120 
iäp
 = 
ibuf
; iä°< 
iãnd
; ifrp++) {

121 
__u32
 
addr
;

122 
__u32
 
mask
;

123 
__u32
 
´efix
;

125 ià(
iäp
->
iä_addr
.
§_çmy
 !ğ
AF_INET
)

127 
addr
 = ((
sockaddr_š
*)&
iäp
->
iä_addr
)->
sš_addr
.
s_addr
;

128 ià(
addr
 == 0)

130 ià(
	`ioùl
(
fd
, 
SIOCGIFINDEX
, 
iäp
)) {

131 
	`sy¦og
(
LOG_ERR
, "ioctl(SIOCGIFNAME): %m");

134 ià(
ifidx
 && 
iäp
->
iä_ifšdex
 != ifidx)

136 
iæ
 = 
iæ_li¡
; iæ; iæ = iæ->
Ãxt
)

137 ià(
iæ
->
šdex
 =ğ
iäp
->
iä_ifšdex
)

139 ià(
iæ
 =ğ
NULL
) {

140 *
p
;

141 
šdex
 = 
iäp
->
iä_ifšdex
;

143 ià(
	`ioùl
(
fd
, 
SIOCGIFHWADDR
, 
iäp
)) {

144 
	`sy¦og
(
LOG_ERR
, "ioctl(SIOCGIFHWADDR): %m");

148 
iæ
 = (
iæšk
*)
	`m®loc
((*ifl));

149 ià(
iæ
 =ğ
NULL
)

151 
	`mem£t
(
iæ
, 0, (*ifl));

152 
iæ
->
Ãxt
 = 
iæ_li¡
;

153 
iæ_li¡
 = 
iæ
;

154 
iæ
->
šdex
 = index;

155 
iæ
->
h©y³
 = 
iäp
->
iä_hwaddr
.
§_çmy
;

156 
	`memıy
(
iæ
->
Îaddr
, 
iäp
->
iä_hwaddr
.
§_d©a
, 14);

157 
	`¡ºıy
(
iæ
->
Çme
, 
iäp
->
iä_Çme
, 
IFNAMSIZ
);

158 
p
 = 
	`¡rchr
(
iæ
->
Çme
, ':');

159 ià(
p
)

160 *
p
 = 0;

161 ià(
v”bo£
)

162 
	`sy¦og
(
LOG_INFO
, "lšk %s", 
iæ
->
Çme
);

164 ià(
	`ioùl
(
fd
, 
SIOCGIFNETMASK
, 
iäp
)) {

165 
	`sy¦og
(
LOG_ERR
, "ioctl(SIOCGIFMASK): %m");

168 
mask
 = ((
sockaddr_š
*)&
iäp
->
iä_Ãtmask
)->
sš_addr
.
s_addr
;

169 ià(
	`ioùl
(
fd
, 
SIOCGIFDSTADDR
, 
iäp
)) {

170 
	`sy¦og
(
LOG_ERR
, "ioctl(SIOCGIFDSTADDR): %m");

173 
´efix
 = ((
sockaddr_š
*)&
iäp
->
iä_d¡addr
)->
sš_addr
.
s_addr
;

174 
iç
 = 
iæ
->
iç_li¡
; iç; iç = iç->
Ãxt
) {

175 ià(
iç
->
loÿl
 =ğ
addr
 &&

176 
iç
->
´efix
 ==…refix &&

177 
iç
->
mask
 == mask)

180 ià(
iç
 =ğ
NULL
) {

181 ià(
mask
 =ğ0 || 
´efix
 == 0)

183 
iç
 = (
içddr
*)
	`m®loc
((*ifa));

184 
	`mem£t
(
iç
, 0, (*ifa));

185 
iç
->
loÿl
 = 
addr
;

186 
iç
->
´efix
 =…refix;

187 
iç
->
mask
 = mask;

188 
iç
->
Ãxt
 = 
iæ
->
iç_li¡
;

189 
iæ
->
iç_li¡
 = 
iç
;

191 ià(
v”bo£
) {

192 
i
;

193 
__u32
 
m
 = ~0U;

194 
i
=32; i>=0; i--) {

195 ià(
	`htÚl
(
m
è=ğ
mask
)

197 
m
 <<= 1;

199 ià(
addr
 =ğ
´efix
) {

200 
	`sy¦og
(
LOG_INFO
, "‡ddr %s/%d on %s\n",

201 
	`š‘_Áß
(*(
š_addr
*)&
addr
), 
i
, 
iæ
->
Çme
);

203 
tm·
[64];

204 
	`¥rštf
(
tm·
, "%s", 
	`š‘_Áß
(*(
š_addr
*)&
addr
));

205 
	`sy¦og
(
LOG_INFO
, "‡dd¸% %s/%d oÀ%s\n", 
tm·
,

206 
	`š‘_Áß
(*(
š_addr
*)&
´efix
), 
i
, 
iæ
->
Çme
);

211 
	}
}

213 
	$cÚfigu»
()

215 
	`lßd_if
();

216 
	`lßd_db
();

217 
	}
}

219 
	$boÙabË
(
__u32
 
addr
)

221 
dœ’t
 *
d’t
;

222 
DIR
 *
d
;

223 
Çme
[9];

225 
	`¥rštf
(
Çme
, "%08X", (
__u32
)
	`Áohl
(
addr
));

226 
d
 = 
	`İ’dœ
(
táp_dœ
);

227 ià(
d
 =ğ
NULL
) {

228 
	`sy¦og
(
LOG_ERR
, "opendir: %m");

231 (
d’t
 = 
	`»addœ
(
d
)è!ğ
NULL
) {

232 ià(
	`¡ºcmp
(
d’t
->
d_Çme
, 
Çme
, 8) == 0)

235 
	`şo£dœ
(
d
);

236  
d’t
 !ğ
NULL
;

237 
	}
}

239 
içddr
 *
	$£Ëù_addr
(
ifšdex
, 
__u32
 *
£l_addr
, __u32 **
®i¡
)

241 
iæšk
 *
iæ
;

242 
içddr
 *
iç
;

243 
»Œy
 = 0;

244 
i
;

246 
»Œy
:

247 
iæ
=
iæ_li¡
; iæ; iæ=iæ->
Ãxt
)

248 ià(
iæ
->
šdex
 =ğ
ifšdex
)

250 ià(
iæ
 =ğ
NULL
 && !
»Œy
) {

251 
»Œy
++;

252 
	`lßd_if
();

253 
»Œy
;

255 ià(
iæ
 =ğ
NULL
)

256  
NULL
;

258 
i
=0; 
®i¡
[i]; i++) {

259 
__u32
 
addr
 = *(
®i¡
[
i
]);

260 
iç
=
iæ
->
iç_li¡
; iç; iç=iç->
Ãxt
) {

261 ià(!((
iç
->
´efix
^
addr
)&iç->
mask
)) {

262 *
£l_addr
 = 
addr
;

263  
iç
;

266 ià(
iç
 =ğ
NULL
 && 
»Œy
==0) {

267 
»Œy
++;

268 
	`lßd_if
();

269 
»Œy
;

272 ià(
i
==1 && 
®low_ofæšk
) {

273 *
£l_addr
 = *(
®i¡
[0]);

274  
iæ
->
iç_li¡
;

276 
	`sy¦og
(
LOG_ERR
, "Off-lšk„eque¡ oÀ%s", 
iæ
->
Çme
);

277  
NULL
;

278 
	}
}

280 
¿½_m­
 *
	$¿½_lookup
(
ifšdex
, 
h©y³
,

281 
h®’
, *
Îaddr
)

283 
¿½_m­
 *
r
;

285 
r
=
¿½_db
;„;„ô->
Ãxt
) {

286 ià(
r
->
¬p_ty³
 !ğ
h©y³
 &&„->arp_type != -1)

288 ià(
r
->
Îaddr_Ën
 !ğ
h®’
)

290 ià(
r
->
ifšdex
 != ifindex &&„->ifindex != 0)

292 ià(
	`memcmp
(
r
->
Îaddr
,†Ïddr, 
h®’
) == 0)

296 ià(
r
 =ğ
NULL
) {

297 ià(
h©y³
 =ğ
ARPHRD_ETHER
 && 
h®’
 == 6) {

298 
içddr
 *
iç
;

299 
ho¡’t
 *
hp
;

300 
’ame
[256];

301 
¿½_m­
 
em­
 = {

302 
NULL
,

304 
ARPHRD_ETHER
,

308 ià(
	`‘h”_Áoho¡
(
’ame
, 
Îaddr
) != 0 ||

309 (
hp
 = 
	`g‘ho¡byÇme
(
’ame
)è=ğ
NULL
) {

310 ià(
v”bo£
)

311 
	`sy¦og
(
LOG_INFO
, "not found in /etc/ethers");

312  
NULL
;

314 ià(
hp
->
h_add¹y³
 !ğ
AF_INET
) {

315 
	`sy¦og
(
LOG_ERR
, "no IP‡ddress");

316  
NULL
;

318 
iç
 = 
	`£Ëù_addr
(
ifšdex
, &
em­
.
addr
, (
__u32
 **)
hp
->
h_addr_li¡
);

319 ià(
iç
) {

320 
	`memıy
(
em­
.
Îaddr
,†laddr, 6);

321 ià(
Úly_‘h”s
 || 
	`boÙabË
(
em­
.
addr
))

322  &
em­
;

323 ià(
v”bo£
)

324 
	`sy¦og
(
LOG_INFO
, "not bootable");

328  
r
;

329 
	}
}

331 
	$lßd_¬p_bpæ‘
(
fd
)

333 
sock_f‹r
 
š¢s
[] = {

334 
	`BPF_STMT
(
BPF_LD
|
BPF_H
|
BPF_ABS
, 6),

335 
	`BPF_JUMP
(
BPF_JMP
|
BPF_JEQ
|
BPF_K
, 
ARPOP_RREQUEST
, 0, 1),

336 
	`BPF_STMT
(
BPF_RET
|
BPF_K
, 1024),

337 
	`BPF_STMT
(
BPF_RET
|
BPF_K
, 0),

339 
sock_årog
 
f‹r
 = {

340  
š¢s
 / (insns[0]),

341 
š¢s


344  
	`£tsockİt
(
fd
, 
SOL_SOCKET
, 
SO_ATTACH_FILTER
, &
f‹r
, (filter));

345 
	}
}

347 
	$put_myÎaddr
(**
±r_p
, 
ifšdex
, 
®’
)

349 
iæšk
 *
iæ
;

351 
iæ
=
iæ_li¡
; iæ; iæ = iæ->
Ãxt
)

352 ià(
iæ
->
šdex
 =ğ
ifšdex
)

355 ià(
iæ
==
NULL
)

358 
	`memıy
(*
±r_p
, 
iæ
->
Îaddr
, 
®’
);

359 *
±r_p
 +ğ
®’
;

361 
	}
}

363 
	$put_myaddr
(**
±r_p
, 
ifšdex
, 
__u32
 
hisaddr
)

365 
__u32
 
Ïddr
 = 0;

366 
iæšk
 *
iæ
;

367 
içddr
 *
iç
;

369 
iæ
=
iæ_li¡
; iæ; iæ = iæ->
Ãxt
)

370 ià(
iæ
->
šdex
 =ğ
ifšdex
)

373 ià(
iæ
==
NULL
)

376 
iç
=
iæ
->
iç_li¡
; iç; iç=iç->
Ãxt
) {

377 ià(!((
iç
->
´efix
^
hisaddr
)&iç->
mask
)) {

378 
Ïddr
 = 
iç
->
loÿl
;

382 
	`memıy
(*
±r_p
, &
Ïddr
, 4);

383 *
±r_p
 += 4;

385 
	}
}

387 
	$¬p_advi£
(
ifšdex
, *
Îaddr
, 
ÎËn
, 
__u32
 
addr
)

389 
fd
;

390 
¬´eq
 
»q
;

391 
sockaddr_š
 *
sš
;

392 
iæšk
 *
iæ
;

394 
iæ
=
iæ_li¡
; iæ; iæ = iæ->
Ãxt
)

395 ià(
iæ
->
šdex
 =ğ
ifšdex
)

398 ià(
iæ
 =ğ
NULL
)

401 
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

402 
	`mem£t
(&
»q
, 0, (req));

403 
»q
.
¬p_æags
 = 
ATF_COM
;

404 
sš
 = (
sockaddr_š
 *)&
»q
.
¬p_·
;

405 
sš
->
sš_çmy
 = 
AF_INET
;

406 
sš
->
sš_addr
.
s_addr
 = 
addr
;

407 
»q
.
¬p_ha
.
§_çmy
 = 
iæ
->
h©y³
;

408 
	`memıy
(
»q
.
¬p_ha
.
§_d©a
, 
Îaddr
, 
ÎËn
);

409 
	`memıy
(
»q
.
¬p_dev
, 
iæ
->
Çme
, 
IFNAMSIZ
);

411 ià(
	`ioùl
(
fd
, 
SIOCSARP
, &
»q
))

412 
	`sy¦og
(
LOG_ERR
, "SIOCSARP: %m");

413 
	`şo£
(
fd
);

414 
	}
}

416 
	$£rve_™
(
fd
)

418 
buf
[1024];

419 
sockaddr_Î
 
¦l
;

420 
sockËn_t
 
¦l_Ën
 = (
¦l
);

421 
¬phdr
 *
a
 = (¬phdr*)
buf
;

422 
¿½_m­
 *
rm­
;

423 *
±r
;

424 
n
;

426 
n
 = 
	`»cväom
(
fd
, 
buf
, (buf), 
MSG_DONTWAIT
, (
sockaddr
*)&
¦l
, &
¦l_Ën
);

427 ià(
n
<0) {

428 ià(
”ºo
 !ğ
EINTR
 &&ƒ¼nØ!ğ
EAGAIN
)

429 
	`sy¦og
(
LOG_ERR
, "recvfrom: %m");

434 ià(
¦l
.
¦l_pk‰y³
 !ğ
PACKET_BROADCAST
 &&

435 
¦l
.
¦l_pk‰y³
 !ğ
PACKET_MULTICAST
 &&

436 
¦l
.
¦l_pk‰y³
 !ğ
PACKET_HOST
)

439 ià(
ifidx
 && 
¦l
.
¦l_ifšdex
 != ifidx)

442 ià(
n
<(*
a
)) {

443 
	`sy¦og
(
LOG_ERR
, "Œunÿ‹d‡½…ack‘;†’=%d", 
n
);

448 ià(
a
->
¬_İ
 !ğ
	`htÚs
(
ARPOP_RREQUEST
))

451 ià(
v”bo£
) {

452 
i
;

453 
tmpbuf
[16*3];

454 *
±r
 = 
tmpbuf
;

455 
i
=0; i<
¦l
.
¦l_h®’
; i++) {

456 ià(
i
) {

457 
	`¥rštf
(
±r
, ":%02x", 
¦l
.
¦l_addr
[
i
]);

458 
±r
++;

460 
	`¥rštf
(
±r
, "%02x", 
¦l
.
¦l_addr
[
i
]);

461 
±r
 += 2;

463 
	`sy¦og
(
LOG_INFO
, "RARP„eque¡ from % Ú if%d", 
tmpbuf
, 
¦l
.
¦l_ifšdex
);

469 ià(
a
->
¬_¶n
 != 4) {

470 
	`sy¦og
(
LOG_ERR
, "š‹»¡šg„¬p_»q…Ën=%d", 
a
->
¬_¶n
);

474 ià(
a
->
¬_´o
 !ğ
	`htÚs
(
ETH_P_IP
)) {

475 
	`sy¦og
(
LOG_ERR
, "¿½…rÙocŞ i nÙ IP %04x", 
	`Áohs
(
a
->
¬_´o
));

479 ià(
	`htÚs
(
¦l
.
¦l_h©y³
è!ğ
a
->
¬_hrd
) {

480 
¦l
.
¦l_h©y³
) {

481 
ARPHRD_FDDI
:

482 ià(
a
->
¬_hrd
 =ğ
	`htÚs
(
ARPHRD_ETHER
) ||

483 
a
->
¬_hrd
 =ğ
	`htÚs
(
ARPHRD_IEEE802
))

486 
	`sy¦og
(
LOG_ERR
, "rarp htype mismatch");

491 ià(
a
->
¬_hÊ
 !ğ
¦l
.
¦l_h®’
) {

492 
	`sy¦og
(
LOG_ERR
, "rarp hlen mismatch");

496 ià((*
a
è+ 2*4 + 2*a->
¬_hÊ
 > 
n
) {

497 
	`sy¦og
(
LOG_ERR
, "Œunÿ‹d„¬°»que¡;†’=%d", 
n
);

503 ià(
	`memcmp
(
¦l
.
¦l_addr
, 
a
+1, sÎ.
¦l_h®’
)) {

504 
	`sy¦og
(
LOG_ERR
, "this guy set different his†laddrs in‡rp‡nd header");

510 
rm­
 = 
	`¿½_lookup
(
¦l
.
¦l_ifšdex
, sÎ.
¦l_h©y³
,

511 
¦l
.
¦l_h®’
, (*)(
a
+1) + sll.sll_halen + 4);

512 ià(
rm­
 =ğ
NULL
)

520 
a
->
¬_İ
 = 
	`htÚs
(
ARPOP_RREPLY
);

521 
±r
 = (*)(
a
+1);

522 ià(
	`put_myÎaddr
(&
±r
, 
¦l
.
¦l_ifšdex
, 
rm­
->
Îaddr_Ën
))

524 ià(
	`put_myaddr
(&
±r
, 
¦l
.
¦l_ifšdex
, 
rm­
->
addr
))

527 
±r
 +ğ
rm­
->
Îaddr_Ën
;

528 
	`memıy
(
±r
, &
rm­
->
addr
, 4);

529 
±r
 += 4;

534 
	`¬p_advi£
(
¦l
.
¦l_ifšdex
, 
rm­
->
Îaddr
,„m­->
Îaddr_Ën
,„m­->
addr
);

537 
	`®¬m
(5);

538 
	`£ndto
(
fd
, 
buf
, 
±r
 - buf, 0, (
sockaddr
*)&
¦l
, (sll));

539 
	`®¬m
(0);

540 
	}
}

542 
ÿtch_sigÇl
(
sig
, (*
hªdËr
)())

544 
sigaùiÚ
 
§
;

546 
	`mem£t
(&
§
, 0, (sa));

547 
§
.
§_hªdËr
 = 
hªdËr
;

548 #ifdeà
SA_INTERRUPT


549 
§
.
§_æags
 = 
SA_INTERRUPT
;

551 
	`sigaùiÚ
(
sig
, &
§
, 
NULL
);

552 
	}
}

554 
	$sig_®¬m
(
signo
)

556 
	}
}

558 
	$sig_hup
(
signo
)

560 
do_»lßd
 = 1;

561 
	}
}

563 
	$maš
(
¬gc
, **
¬gv
)

565 
pŞlfd
 
p£t
[2];

566 
psize
;

567 
İt
;

570 
İ‹¼
 = 0;

571 (
İt
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "aAb:dvÛ")è!ğ
EOF
) {

572 
İt
) {

574 ++
®l_içûs
;

578 ++
li¡’_¬p
;

582 ++
debug
;

586 ++
v”bo£
;

590 ++
®low_ofæšk
;

594 ++
Úly_‘h”s
;

598 
táp_dœ
 = 
İrg
;

602 
	`u§ge
();

605 ià(
¬gc
 > 
İtšd
) {

606 ià(
¬gc
 > 
İtšd
+1)

607 
	`u§ge
();

608 
iâame
 = 
¬gv
[
İtšd
];

611 
psize
 = 1;

612 
p£t
[0].
fd
 = 
	`sock‘
(
PF_PACKET
, 
SOCK_DGRAM
, 0);

614 ià(
iâame
) {

615 
iäeq
 
iä
;

616 
	`mem£t
(&
iä
, 0, (ifr));

617 
	`¡ºıy
(
iä
.
iä_Çme
, 
iâame
, 
IFNAMSIZ
);

618 ià(
	`ioùl
(
p£t
[0].
fd
, 
SIOCGIFINDEX
, &
iä
)) {

619 
	`³¼Ü
("ioctl(SIOCGIFINDEX)");

620 
	`u§ge
();

622 
ifidx
 = 
iä
.
iä_ifšdex
;

625 
p£t
[1].
fd
 = -1;

626 ià(
li¡’_¬p
) {

627 
p£t
[1].
fd
 = 
	`sock‘
(
PF_PACKET
, 
SOCK_DGRAM
, 0);

628 ià(
p£t
[1].
fd
 >= 0) {

629 
	`lßd_¬p_bpæ‘
(
p£t
[1].
fd
);

630 
psize
 = 1;

634 ià(
p£t
[1].
fd
 >= 0) {

635 
sockaddr_Î
 
¦l
;

636 
	`mem£t
(&
¦l
, 0, (sll));

637 
¦l
.
¦l_çmy
 = 
AF_PACKET
;

638 
¦l
.
¦l_´ÙocŞ
 = 
	`htÚs
(
ETH_P_ARP
);

639 
¦l
.
¦l_ifšdex
 = 
®l_içûs
 ? 0 : 
ifidx
;

640 ià(
	`bšd
(
p£t
[1].
fd
, (
sockaddr
*)&
¦l
, (sll)) < 0) {

641 
	`şo£
(
p£t
[1].
fd
);

642 
p£t
[1].
fd
 = -1;

643 
psize
 = 1;

646 ià(
p£t
[0].
fd
 >= 0) {

647 
sockaddr_Î
 
¦l
;

648 
	`mem£t
(&
¦l
, 0, (sll));

649 
¦l
.
¦l_çmy
 = 
AF_PACKET
;

650 
¦l
.
¦l_´ÙocŞ
 = 
	`htÚs
(
ETH_P_RARP
);

651 
¦l
.
¦l_ifšdex
 = 
®l_içûs
 ? 0 : 
ifidx
;

652 ià(
	`bšd
(
p£t
[0].
fd
, (
sockaddr
*)&
¦l
, (sll)) < 0) {

653 
	`şo£
(
p£t
[0].
fd
);

654 
p£t
[0].
fd
 = -1;

657 ià(
p£t
[0].
fd
 < 0) {

658 
p£t
[0] =…set[1];

659 
psize
--;

661 ià(
psize
 == 0) {

662 
	`årštf
(
¡d”r
, "failedo bind‡ny socket. Aborting.\n");

663 
	`ex™
(1);

666 ià(!
debug
) {

667 
fd
;

668 
pid_t
 
pid
 = 
	`fÜk
();

670 ià(
pid
 > 0)

671 
	`ex™
(0);

672 ià(
pid
 == -1) {

673 
	`³¼Ü
("rarpd: fork");

674 
	`ex™
(1);

677 ià(
	`chdœ
("/") < 0) {

678 
	`³¼Ü
("rarpd: chdir");

679 
	`ex™
(1);

682 
fd
 = 
	`İ’
("/dev/nuÎ", 
O_RDWR
);

683 ià(
fd
 >= 0) {

684 
	`dup2
(
fd
, 0);

685 
	`dup2
(
fd
, 1);

686 
	`dup2
(
fd
, 2);

687 ià(
fd
 > 2)

688 
	`şo£
(
fd
);

690 
	`£tsid
();

693 
	`İ’log
("¿½d", 
LOG_PID
 | 
LOG_CONS
, 
LOG_DAEMON
);

694 
	`ÿtch_sigÇl
(
SIGALRM
, 
sig_®¬m
);

695 
	`ÿtch_sigÇl
(
SIGHUP
, 
sig_hup
);

698 
i
;

700 ià(
do_»lßd
) {

701 
	`cÚfigu»
();

702 
do_»lßd
 = 0;

705 
	#EVENTS
 (
POLLIN
|
POLLPRI
|
POLLERR
|
POLLHUP
)

	)

706 
p£t
[0].
ev’ts
 = 
EVENTS
;

707 
p£t
[0].
»v’ts
 = 0;

708 
p£t
[1].
ev’ts
 = 
EVENTS
;

709 
p£t
[1].
»v’ts
 = 0;

711 
i
 = 
	`pŞl
(
p£t
, 
psize
, -1);

712 ià(
i
 <= 0) {

713 ià(
”ºo
 !ğ
EINTR
 && 
i
<0) {

714 
	`sy¦og
(
LOG_ERR
, "poll„eturned some crap: %m\n");

715 
	`¦“p
(10);

719 
i
=0; i<
psize
; i++) {

720 ià(
p£t
[
i
].
»v’ts
&
EVENTS
)

721 
	`£rve_™
(
p£t
[
i
].
fd
);

724 
	}
}

	@rdisc.c

28 
	~<¡dio.h
>

29 
	~<”ºo.h
>

30 
	~<sigÇl.h
>

31 
	~<uni¡d.h
>

32 
	~<¡dlib.h
>

33 
	~<sys/ty³s.h
>

34 
	~<sys/time.h
>

36 
	~<lšux/lim™s.h
>

38 
	~<sys/·¿m.h
>

39 
	~<sys/sock‘.h
>

40 
	~<sys/fe.h
>

41 
	~<m®loc.h
>

43 
	~<sys/ioùl.h
>

44 
	~<lšux/if.h
>

45 
	~<lšux/rou‹.h
>

47 
	~<Ãtš‘/š.h
>

48 
	~<Ãtš‘/.h
>

49 
	~<Ãtš‘/_icmp.h
>

58 
	~<Ãtdb.h
>

59 
	~<¬·/š‘.h
>

61 
	~<¡ršg.h
>

62 
	~<sy¦og.h
>

64 
	~"SNAPSHOT.h
"

66 
	sš‹rçû


68 
š_addr
 
	madd»ss
;

69 
š_addr
 
	mloÿÏddr
;

70 
	m´eã»nû
;

71 
	mæags
;

72 
š_addr
 
	mbÿ¡addr
;

73 
š_addr
 
	m»mÙ—ddr
;

74 
š_addr
 
	mÃtmask
;

75 
	mifšdex
;

76 
	mÇme
[
IFNAMSIZ
];

85 
	#ALLIGN
(
±r
èÕŒ)

	)

87 
još
(
sock
, 
sockaddr_š
 *
sš
);

88 
sŞic™Ü
(
sockaddr_š
 *);

89 #ifdeà
RDISC_SERVER


90 
adv”ti£
(
sockaddr_š
 *, 
lá
);

92 *
´_Çme
(
š_addr
 
addr
);

93 
´_·ck
(*
buf
, 
cc
, 
sockaddr_š
 *
äom
);

94 
age_bË
(
time
);

95 
»cÜd_rou‹r
(
š_addr
 
rou‹r
, 
´eã»nû
, 
‰l
);

96 
add_rou‹
(
š_addr
 
addr
);

97 
d–_rou‹
(
š_addr
 
addr
);

98 
¹ioùl
(
š_addr
 
addr
, 
İ
);

99 
suµÜt_muÉiÿ¡
();

100 
£ndbÿ¡
(
s
, *
·ck‘
, 
·ck‘Ën
);

101 
£ndmÿ¡
(
s
, *
·ck‘
, 
·ck‘Ën
, 
sockaddr_š
 *);

102 
£ndbÿ¡if
(
s
, *
·ck‘
, 
·ck‘Ën
, 
š‹rçû
 *
iå
);

103 
£ndmÿ¡if
(
s
, *
·ck‘
, 
·ck‘Ën
, 
sockaddr_š
 *
sš
, 
š‹rçû
 *
iå
);

104 
is_dœeùly_cÚÃùed
(
š_addr
 
š
);

105 
š™log
();

106 
disÿrd_bË
();

107 
š™
();

109 
	#ICMP_ROUTER_ADVERTISEMENT
 9

	)

110 
	#ICMP_ROUTER_SOLICITATION
 10

	)

112 
	#ALL_HOSTS_ADDRESS
 "224.0.0.1"

	)

113 
	#ALL_ROUTERS_ADDRESS
 "224.0.0.2"

	)

115 
	#MAXIFS
 32

	)

117 #ià!
defšed
(
__GLIBC__
) || __GLIBC__ < 2

119 
	sicmp_¿


121 
u_ch¬
 
	micmp_ty³
;

122 
u_ch¬
 
	micmp_code
;

123 
u_shÜt
 
	micmp_cksum
;

124 
u_ch¬
 
	micmp_num_addrs
;

125 
u_ch¬
 
	micmp_w·
;

126 
	micmp_liãtime
;

129 
	sicmp_¿_addr


131 
__u32
 
	mœa_addr
;

132 
__u32
 
	mœa_´eã»nû
;

135 
	#icmp_¿
 
icmp


	)

139 
	#MAX_INITIAL_ADVERT_INTERVAL
 16

	)

140 
	#MAX_INITIAL_ADVERTISEMENTS
 3

	)

141 
	#MAX_RESPONSE_DELAY
 2

	)

144 
	#MAX_SOLICITATIONS
 3

	)

145 
	#SOLICITATION_INTERVAL
 3

	)

146 
	#MAX_SOLICITATION_DELAY
 1

	)

148 
	#INELIGIBLE_PREF
 0x80000000

	)

150 
	#MAX_ADV_INT
 600

	)

153 
	gnum_š‹rçûs
;

155 
š‹rçû
 *
	gš‹rçûs
;

156 
	gš‹rçûs_size
;

159 
	#MAXPACKET
 4096

	)

162 
	gdebugfe
;

164 cÚ¡ 
	gu§ge
[] =

166 #ifdeà
RDISC_SERVER


173 
	gs
;

174 
sockaddr_š
 
	gwh”‘o
;

177 
	gv”bo£
 = 0;

178 
	gdebug
 = 0;

179 
	gŒaû
 = 0;

180 
	gsŞic™
 = 0;

181 
	gÁ¿nsm™‹d
 = 0;

182 
	gÄeûived
 = 0;

183 
	gfÜev”
 = 0;

187 #ifdeà
RDISC_SERVER


189 
	g»¥Úd”
;

190 
	gmax_adv_št
 = 
MAX_ADV_INT
;

191 
	gmš_adv_št
;

192 
	gliãtime
;

193 
	gš™Ÿl_adv”t_š‹rv®
 = 
MAX_INITIAL_ADVERT_INTERVAL
;

194 
	gš™Ÿl_adv”ti£m’ts
 = 
MAX_INITIAL_ADVERTISEMENTS
;

195 
	g´eã»nû
 = 0;

199 
	gmax_sŞic™©iÚs
 = 
MAX_SOLICITATIONS
;

200 
	gsŞic™©iÚ_š‹rv®
 = 
SOLICITATION_INTERVAL
;

201 
	gbe¡_´eã»nû
 = 1;

206 
g¿ûful_fšish
();

207 
fšish
();

208 
tim”
();

209 
š™ifs
();

210 
u_shÜt
 
š_cksum
(u_shÜˆ*
addr
, 
Ën
);

212 
	gloggšg
 = 0;

214 
	#log”r
(
fmt
...è({ ià(
loggšg
è
	`sy¦og
(
LOG_ERR
, fmt); \

215 
	`årštf
(
¡d”r
, 
fmt
); })

	)

216 
	#logŒaû
(
fmt
...è({ ià(
loggšg
è
	`sy¦og
(
LOG_INFO
, fmt); \

217 
	`årštf
(
¡d”r
, 
fmt
); })

	)

218 
	#logdebug
(
fmt
...è({ ià(
loggšg
è
	`sy¦og
(
LOG_DEBUG
, fmt); \

219 
	`årštf
(
¡d”r
, 
fmt
); })

	)

220 
log³¼Ü
(*
¡r
);

222 
__šlše__
 
	$isbrßdÿ¡
(
sockaddr_š
 *
sš
)

224  (
sš
->
sš_addr
.
s_addr
 =ğ
INADDR_BROADCAST
);

225 
	}
}

227 
__šlše__
 
	$ismuÉiÿ¡
(
sockaddr_š
 *
sš
)

229  
	`IN_CLASSD
(
	`Áohl
(
sš
->
sš_addr
.
s_addr
));

230 
	}
}

232 
	$´u§ge
()

234 
	`åuts
(
u§ge
, 
¡d”r
);

235 
	`ex™
(1);

236 
	}
}

238 
	$do_fÜk
()

240 
t
;

241 
pid_t
 
pid
;

242 
İ’_max
;

244 ià(
Œaû
)

246 ià((
İ’_max
 = 
	`syscÚf
(
_SC_OPEN_MAX
)) == -1) {

247 ià(
”ºo
 == 0) {

248 (è
	`årštf
(
¡d”r
, "OPEN_MAX is‚ot supported\n");

251 (è
	`årštf
(
¡d”r
, "sysconf()ƒrror\n");

253 
	`ex™
(1);

257 ià((
pid
=
	`fÜk
()) != 0)

258 
	`ex™
(0);

260 
t
 = 0; < 
İ’_max
;++)

261 ià(
t
 !ğ
s
)

262 
	`şo£
(
t
);

264 
	`£tsid
();

265 
	`š™log
();

266 
	}
}

268 
sigÇl_£tup
(
signo
, (*
hªdËr
)())

270 
sigaùiÚ
 
§
;

272 
	`mem£t
(&
§
, 0, (sa));

274 
§
.
§_hªdËr
 = ((*)())
hªdËr
;

275 #ifdeà
SA_INTERRUPT


276 
§
.
§_æags
 = 
SA_INTERRUPT
;

278 
	`sigaùiÚ
(
signo
, &
§
, 
NULL
);

279 
	}
}

284 *
	g£ndadd»ss
, *
	g»cvadd»ss
;

286 
	$maš
(
¬gc
, **
¬gv
)

288 
sockaddr_š
 
äom
;

289 **
av
 = 
¬gv
;

290 
sockaddr_š
 *
to
 = &
wh”‘o
;

291 
sockaddr_š
 
jošaddr
;

292 
sig£t_t
 
s£t
, 
s£t_em±y
;

293 #ifdeà
RDISC_SERVER


294 
v®
;

296 
mš_adv_št
 =Ğ
max_adv_št
 * 3 / 4);

297 
liãtime
 = (3*
max_adv_št
);

300 
¬gc
--, 
av
++;

301 
¬gc
 > 0 && *
av
[0] == '-') {

302 *++
av
[0]) {

303 *
av
[0]) {

305 
debug
 = 1;

308 
Œaû
 = 1;

311 
v”bo£
++;

314 
sŞic™
 = 1;

316 #ifdeà
RDISC_SERVER


318 
»¥Úd”
 = 1;

322 
be¡_´eã»nû
 = 0;

325 
be¡_´eã»nû
 = 1;

328 
fÜev”
 = 1;

331 
	`´štf
("rdisøut™y, iputs-%s\n", 
SNAPSHOT
);

332 
	`ex™
(0);

333 #ifdeà
RDISC_SERVER


335 
¬gc
--, 
av
++;

336 ià(
¬gc
 != 0) {

337 
v®
 = 
	`¡¹Ş
(
av
[0], (**)
NULL
, 0);

338 ià(
v®
 < 4 || val > 1800) {

339 (è
	`årštf
(
¡d”r
,

341 
	`ex™
(1);

343 
max_adv_št
 = 
v®
;

344 
mš_adv_št
 =Ğ
max_adv_št
 * 3 / 4);

345 
liãtime
 = (3*
max_adv_št
);

347 
	`´u§ge
();

350 
Ãxt
;

352 
¬gc
--, 
av
++;

353 ià(
¬gc
 != 0) {

354 
v®
 = 
	`¡¹Ş
(
av
[0], (**)
NULL
, 0);

355 
´eã»nû
 = 
v®
;

357 
	`´u§ge
();

360 
Ãxt
;

363 
	`´u§ge
();

367 #ifdeà
RDISC_SERVER


368 
Ãxt
:

370 
¬gc
--, 
av
++;

372 ifĞ
¬gc
 < 1) {

373 ià(
	`suµÜt_muÉiÿ¡
()) {

374 
£ndadd»ss
 = 
ALL_ROUTERS_ADDRESS
;

375 #ifdeà
RDISC_SERVER


376 ià(
»¥Úd”
)

377 
£ndadd»ss
 = 
ALL_HOSTS_ADDRESS
;

380 
£ndadd»ss
 = "255.255.255.255";

382 
£ndadd»ss
 = 
av
[0];

383 
¬gc
--;

386 ià(
¬gc
 < 1) {

387 ià(
	`suµÜt_muÉiÿ¡
()) {

388 
»cvadd»ss
 = 
ALL_HOSTS_ADDRESS
;

389 #ifdeà
RDISC_SERVER


390 ià(
»¥Úd”
)

391 
»cvadd»ss
 = 
ALL_ROUTERS_ADDRESS
;

394 
»cvadd»ss
 = "255.255.255.255";

396 
»cvadd»ss
 = 
av
[0];

397 
¬gc
--;

399 ià(
¬gc
 != 0) {

400 (è
	`årštf
(
¡d”r
, "Extra…arameters\n");

401 
	`´u§ge
();

405 #ifdeà
RDISC_SERVER


406 ià(
sŞic™
 && 
»¥Úd”
) {

407 
	`´u§ge
();

412 ià(!(
sŞic™
 && !
fÜev”
)) {

413 
	`do_fÜk
();

418 
fÜev”
 = 1;

421 
	`mem£t
Ğ(*)&
wh”‘o
, 0, (
sockaddr_š
) );

422 
to
->
sš_çmy
 = 
AF_INET
;

423 
to
->
sš_addr
.
s_addr
 = 
	`š‘_addr
(
£ndadd»ss
);

425 
	`mem£t
Ğ(*)&
jošaddr
, 0, (
sockaddr_š
) );

426 
jošaddr
.
sš_çmy
 = 
AF_INET
;

427 
jošaddr
.
sš_addr
.
s_addr
 = 
	`š‘_addr
(
»cvadd»ss
);

429 #ifdeà
RDISC_SERVER


430 ià(
»¥Úd”
)

431 
	`¤ªdom
(()
	`g‘ho¡id
());

434 ià((
s
 = 
	`sock‘
(
AF_INET
, 
SOCK_RAW
, 
IPPROTO_ICMP
)) < 0) {

435 
	`log³¼Ü
("socket");

436 
	`ex™
(5);

439 
	`£šebuf
Ğ
¡dout
 );

441 
	`sigÇl_£tup
(
SIGINT
, 
fšish
 );

442 
	`sigÇl_£tup
(
SIGTERM
, 
g¿ûful_fšish
 );

443 
	`sigÇl_£tup
(
SIGHUP
, 
š™ifs
 );

444 
	`sigÇl_£tup
(
SIGALRM
, 
tim”
 );

446 
	`sigem±y£t
(&
s£t
);

447 
	`sigem±y£t
(&
s£t_em±y
);

448 
	`sigadd£t
(&
s£t
, 
SIGALRM
);

449 
	`sigadd£t
(&
s£t
, 
SIGHUP
);

450 
	`sigadd£t
(&
s£t
, 
SIGTERM
);

451 
	`sigadd£t
(&
s£t
, 
SIGINT
);

453 
	`š™
();

454 ià(
	`još
(
s
, &
jošaddr
) < 0) {

455 
	`log”r
("Failed joining‡ddresses\n");

456 
	`ex™
 (2);

459 
	`tim”
();

462 
u_ch¬
 
·ck‘
[
MAXPACKET
];

463 
Ën
 =  (
·ck‘
);

464 
sockËn_t
 
äomËn
 =  (
äom
);

465 
cc
;

467 
cc
=
	`»cväom
(
s
, (*)
·ck‘
, 
Ën
, 0,

468 (
sockaddr
 *)&
äom
, &
äomËn
);

469 ià(
cc
<0) {

470 ià(
”ºo
 =ğ
EINTR
)

472 
	`log³¼Ü
("recvfrom");

476 
	`sig´ocmask
(
SIG_SETMASK
, &
s£t
, 
NULL
);

477 
	`´_·ck
Ğ(*)
·ck‘
, 
cc
, &
äom
 );

478 
	`sig´ocmask
(
SIG_SETMASK
, &
s£t_em±y
, 
NULL
);

481 
	}
}

483 
	#TIMER_INTERVAL
 3

	)

484 
	#GETIFCONF_TIMER
 30

	)

486 
	gËá_uÁ_adv”ti£
;

489 
	$tim”
()

491 
time
;

492 
Ëá_uÁ_g‘ifcÚf
;

493 
Ëá_uÁ_sŞic™
;

496 
time
 +ğ
TIMER_INTERVAL
;

498 
Ëá_uÁ_g‘ifcÚf
 -ğ
TIMER_INTERVAL
;

499 
Ëá_uÁ_adv”ti£
 -ğ
TIMER_INTERVAL
;

500 
Ëá_uÁ_sŞic™
 -ğ
TIMER_INTERVAL
;

502 ià(
Ëá_uÁ_g‘ifcÚf
 < 0) {

503 
	`š™ifs
();

504 
Ëá_uÁ_g‘ifcÚf
 = 
GETIFCONF_TIMER
;

506 #ifdeà
RDISC_SERVER


507 ià(
»¥Úd”
 && 
Ëá_uÁ_adv”ti£
 <= 0) {

508 
Á¿nsm™‹d
++;

509 
	`adv”ti£
(&
wh”‘o
, 
liãtime
);

510 ià(
Á¿nsm™‹d
 < 
š™Ÿl_adv”ti£m’ts
)

511 
Ëá_uÁ_adv”ti£
 = 
š™Ÿl_adv”t_š‹rv®
;

513 
Ëá_uÁ_adv”ti£
 = 
mš_adv_št
 +

514 ((
max_adv_št
 - 
mš_adv_št
) *

515 (
	`¿ndom
() % 1000)/1000);

518 ià(
sŞic™
 && 
Ëá_uÁ_sŞic™
 <= 0) {

519 
Á¿nsm™‹d
++;

520 
	`sŞic™Ü
(&
wh”‘o
);

521 ià(
Á¿nsm™‹d
 < 
max_sŞic™©iÚs
)

522 
Ëá_uÁ_sŞic™
 = 
sŞic™©iÚ_š‹rv®
;

524 
sŞic™
 = 0;

525 ià(!
fÜev”
 && 
Äeûived
 == 0)

526 
	`ex™
(5);

529 
	`age_bË
(
TIMER_INTERVAL
);

530 
	`®¬m
(
TIMER_INTERVAL
);

531 
	}
}

540 
	$sŞic™Ü
(
sockaddr_š
 *
sš
)

542 
u_ch¬
 
ouack
[
MAXPACKET
];

543 
icmphdr
 *
iı
 = (icmphd¸*è
	`ALLIGN
(
ouack
);

544 
·ck‘Ën
, 
i
;

546 ià(
v”bo£
) {

547 
	`logŒaû
("Sending solicitationo %s\n",

548 
	`´_Çme
(
sš
->
sš_addr
));

550 
iı
->
ty³
 = 
ICMP_ROUTER_SOLICITATION
;

551 
iı
->
code
 = 0;

552 
iı
->
checksum
 = 0;

553 
iı
->
un
.
g©eway
 = 0;

554 
·ck‘Ën
 = 8;

557 
iı
->
checksum
 = 
	`š_cksum
Ğ(
u_shÜt
 *)iı, 
·ck‘Ën
 );

559 ià(
	`isbrßdÿ¡
(
sš
))

560 
i
 = 
	`£ndbÿ¡
(
s
, (*)
ouack
, 
·ck‘Ën
);

561 ià(
	`ismuÉiÿ¡
(
sš
))

562 
i
 = 
	`£ndmÿ¡
(
s
, (*)
ouack
, 
·ck‘Ën
, 
sš
);

564 
i
 = 
	`£ndto
Ğ
s
, (*)
ouack
, 
·ck‘Ën
, 0,

565 (
sockaddr
 *)
sš
, (sockaddr));

567 ifĞ
i
 < 0 || i !ğ
·ck‘Ën
 ) {

568 ifĞ
i
<0 ) {

569 
	`log³¼Ü
("solicitor:sendto");

571 
	`log”r
("wrote %s %d chars,„et=%d\n",

572 
£ndadd»ss
, 
·ck‘Ën
, 
i
 );

574 
	}
}

576 #ifdeà
RDISC_SERVER


584 
	$adv”ti£
(
sockaddr_š
 *
sš
, 
lá
)

586 
u_ch¬
 
ouack
[
MAXPACKET
];

587 
icmp_¿
 *
¿p
 = (icmp_¿ *è
	`ALLIGN
(
ouack
);

588 
icmp_¿_addr
 *
­
;

589 
·ck‘Ën
, 
i
, 
cc
;

591 ià(
v”bo£
) {

592 
	`logŒaû
("Sending‡dvertisemento %s\n",

593 
	`´_Çme
(
sš
->
sš_addr
));

596 
i
 = 0; i < 
num_š‹rçûs
; i++) {

597 
¿p
->
icmp_ty³
 = 
ICMP_ROUTER_ADVERTISEMENT
;

598 
¿p
->
icmp_code
 = 0;

599 
¿p
->
icmp_cksum
 = 0;

600 
¿p
->
icmp_num_addrs
 = 0;

601 
¿p
->
icmp_w·
 = 2;

602 
¿p
->
icmp_liãtime
 = 
	`htÚs
(
lá
);

603 
·ck‘Ën
 = 8;

610 
­
 = (
icmp_¿_addr
 *)
	`ALLIGN
(
ouack
 + 
ICMP_MINLEN
);

611 
­
->
œa_addr
 = 
š‹rçûs
[
i
].
loÿÏddr
.
s_addr
;

612 
­
->
œa_´eã»nû
 = 
	`htÚl
(
š‹rçûs
[
i
].
´eã»nû
);

613 
·ck‘Ën
 +ğ
¿p
->
icmp_w·
 * 4;

614 
¿p
->
icmp_num_addrs
++;

617 
¿p
->
icmp_cksum
 = 
	`š_cksum
Ğ(
u_shÜt
 *ì­, 
·ck‘Ën
 );

619 ià(
	`isbrßdÿ¡
(
sš
))

620 
cc
 = 
	`£ndbÿ¡if
(
s
, (*)
ouack
, 
·ck‘Ën
,

621 &
š‹rçûs
[
i
]);

622 ià(
	`ismuÉiÿ¡
(
sš
))

623 
cc
 = 
	`£ndmÿ¡if
Ğ
s
, (*)
ouack
, 
·ck‘Ën
, 
sš
,

624 &
š‹rçûs
[
i
]);

626 
š‹rçû
 *
iå
 = &
š‹rçûs
[
i
];

631 ià((
sš
->
sš_addr
.
s_addr
 & 
iå
->
Ãtmask
.s_addr) ==

632 (
iå
->
add»ss
.
s_addr
 & iå->
Ãtmask
.s_addr)) {

633 ià(
debug
) {

634 
	`logdebug
("Unicasto %s ",

635 
	`´_Çme
(
sš
->
sš_addr
));

636 
	`logdebug
("on interface %s, %s\n",

637 
iå
->
Çme
,

638 
	`´_Çme
(
iå
->
add»ss
));

640 
cc
 = 
	`£ndto
Ğ
s
, (*)
ouack
, 
·ck‘Ën
, 0,

641 (
sockaddr
 *)
sš
,

642 (
sockaddr
));

644 
cc
 = 
·ck‘Ën
;

646 ifĞ
cc
 < 0 || cø!ğ
·ck‘Ën
 ) {

647 ià(
cc
 < 0) {

648 
	`log³¼Ü
("sendto");

650 
	`log”r
("wrote %s %d chars,„et=%d\n",

651 
£ndadd»ss
, 
·ck‘Ën
, 
cc
 );

655 
	}
}

664 
	$´_ty³
(
t
)

666 *
‰ab
[] = {

688 iàĞ
t
 < 0 || > 16 )

691 (
‰ab
[
t
]);

692 
	}
}

699 *
	$´_Çme
(
š_addr
 
addr
)

701 
ho¡’t
 *
phe
;

702 
buf
[80];

704 
phe
 = 
	`g‘ho¡byaddr
((*)&
addr
.
s_addr
, 4, 
AF_INET
);

705 ià(
phe
 =ğ
NULL
)

706 Ğ
	`š‘_Áß
(
addr
));

707 
	`¢´štf
(
buf
, (buf), "% (%s)", 
phe
->
h_Çme
, 
	`š‘_Áß
(
addr
));

708 (
buf
);

709 
	}
}

720 
	$´_·ck
(*
buf
, 
cc
, 
sockaddr_š
 *
äom
)

722 
hdr
 *

;

723 
icmphdr
 *
iı
;

724 
i
;

725 
hËn
;

727 

 = (
hdr
 *è
	`ALLIGN
(
buf
);

728 
hËn
 = 

->
ihl
 << 2;

729 ià(
cc
 < 
hËn
 + 8) {

730 ià(
v”bo£
)

731 
	`logŒaû
("·ck‘oØshÜˆ(%d by‹sèäom %s\n", 
cc
,

732 
	`´_Çme
(
äom
->
sš_addr
));

735 
cc
 -ğ
hËn
;

736 
iı
 = (
icmphdr
 *)
	`ALLIGN
(
buf
 + 
hËn
);

738 
iı
->
ty³
) {

739 
ICMP_ROUTER_ADVERTISEMENT
:

741 
icmp_¿
 *
¿p
 = (icmp_¿ *)
	`ALLIGN
(
iı
);

742 
icmp_¿_addr
 *
­
;

744 #ifdeà
RDISC_SERVER


745 ià(
»¥Úd”
)

751 ià(
	`š_cksum
((
u_shÜt
 *)
	`ALLIGN
(
buf
+
hËn
), 
cc
)) {

752 ià(
v”bo£
)

753 
	`logŒaû
("ICMP %s from %s: Bad checksum\n",

754 
	`´_ty³
(()
¿p
->
icmp_ty³
),

755 
	`´_Çme
(
äom
->
sš_addr
));

758 ià(
¿p
->
icmp_code
 != 0) {

759 ià(
v”bo£
)

760 
	`logŒaû
("ICMP %s from %s: Code = %d\n",

761 
	`´_ty³
(()
¿p
->
icmp_ty³
),

762 
	`´_Çme
(
äom
->
sš_addr
),

763 
¿p
->
icmp_code
);

766 ià(
¿p
->
icmp_num_addrs
 < 1) {

767 ià(
v”bo£
)

768 
	`logŒaû
("ICMP %s from %s: No‡ddresses\n",

769 
	`´_ty³
(()
¿p
->
icmp_ty³
),

770 
	`´_Çme
(
äom
->
sš_addr
));

773 ià(
¿p
->
icmp_w·
 < 2) {

774 ià(
v”bo£
)

775 
	`logŒaû
("ICMP %s from %s: Words/addr = %d\n",

776 
	`´_ty³
(()
¿p
->
icmp_ty³
),

777 
	`´_Çme
(
äom
->
sš_addr
),

778 
¿p
->
icmp_w·
);

781 ià(()
cc
 <

782 8 + 
¿p
->
icmp_num_addrs
 *„­->
icmp_w·
 * 4) {

783 ià(
v”bo£
)

784 
	`logŒaû
("ICMP %s from %s: Too short %d, %d\n",

785 
	`´_ty³
(()
¿p
->
icmp_ty³
),

786 
	`´_Çme
(
äom
->
sš_addr
),

787 
cc
,

788 8 + 
¿p
->
icmp_num_addrs
 *„­->
icmp_w·
 * 4);

792 ià(
v”bo£
)

793 
	`logŒaû
("ICMP %s from %s,†ifetime %d\n",

794 
	`´_ty³
(()
¿p
->
icmp_ty³
),

795 
	`´_Çme
(
äom
->
sš_addr
),

796 
	`Áohs
(
¿p
->
icmp_liãtime
));

801 
i
 = 0; ()˜< 
¿p
->
icmp_num_addrs
; i++) {

802 
š_addr
 
ša
;

803 
­
 = (
icmp_¿_addr
 *)

804 
	`ALLIGN
(
buf
 + 
hËn
 + 8 +

805 
i
 * 
¿p
->
icmp_w·
 * 4);

806 
ša
.
s_addr
 = 
­
->
œa_addr
;

807 ià(
v”bo£
)

808 
	`logŒaû
("\taddress %s,…reference 0x%x\n",

809 
	`´_Çme
(
ša
),

810 ()
	`Áohl
(
­
->
œa_´eã»nû
));

811 ià(
	`is_dœeùly_cÚÃùed
(
ša
))

812 
	`»cÜd_rou‹r
(
ša
,

813 
	`Áohl
(
­
->
œa_´eã»nû
),

814 
	`Áohs
(
¿p
->
icmp_liãtime
));

816 
Äeûived
++;

817 ià(!
fÜev”
) {

818 
	`do_fÜk
();

819 
fÜev”
 = 1;

824 (è
	`®¬m
(
TIMER_INTERVAL
);

829 #ifdeà
RDISC_SERVER


830 
ICMP_ROUTER_SOLICITATION
:

832 
sockaddr_š
 
sš
;

834 ià(!
»¥Úd”
)

840 ià(
	`š_cksum
((
u_shÜt
 *)
	`ALLIGN
(
buf
+
hËn
), 
cc
)) {

841 ià(
v”bo£
)

842 
	`logŒaû
("ICMP %s from %s: Bad checksum\n",

843 
	`´_ty³
(()
iı
->
ty³
),

844 
	`´_Çme
(
äom
->
sš_addr
));

847 ià(
iı
->
code
 != 0) {

848 ià(
v”bo£
)

849 
	`logŒaû
("ICMP %s from %s: Code = %d\n",

850 
	`´_ty³
(()
iı
->
ty³
),

851 
	`´_Çme
(
äom
->
sš_addr
),

852 
iı
->
code
);

856 ià(
cc
 < 
ICMP_MINLEN
) {

857 ià(
v”bo£
)

858 
	`logŒaû
("ICMP %s from %s: Too short %d, %d\n",

859 
	`´_ty³
(()
iı
->
ty³
),

860 
	`´_Çme
(
äom
->
sš_addr
),

861 
cc
,

862 
ICMP_MINLEN
);

866 ià(
v”bo£
)

867 
	`logŒaû
("ICMP %s from %s\n",

868 
	`´_ty³
(()
iı
->
ty³
),

869 
	`´_Çme
(
äom
->
sš_addr
));

874 
sš
.
sš_çmy
 = 
AF_INET
;

875 ià(

->
§ddr
 == 0) {

879 ià(
	`IN_CLASSD
(
	`Áohl
(

->
daddr
)))

880 
sš
.
sš_addr
.
s_addr
 = 
	`htÚl
(0xe0000001);

882 
sš
.
sš_addr
.
s_addr
 = 
INADDR_BROADCAST
;

884 
Ëá_uÁ_adv”ti£
 = 
mš_adv_št
 +

885 ((
max_adv_št
 - 
mš_adv_št
)

886 * (
	`¿ndom
() % 1000)/1000);

888 
sš
.
sš_addr
.
s_addr
 = 

->
§ddr
;

889 ià(!
	`is_dœeùly_cÚÃùed
(
sš
.
sš_addr
)) {

890 ià(
v”bo£
)

891 
	`logŒaû
("ICMP %s from %s: source‚ot directly connected\n",

892 
	`´_ty³
(()
iı
->
ty³
),

893 
	`´_Çme
(
äom
->
sš_addr
));

897 
Äeûived
++;

898 
Á¿nsm™‹d
++;

899 
	`adv”ti£
(&
sš
, 
liãtime
);

904 
	}
}

913 #ià
BYTE_ORDER
 =ğ
LITTLE_ENDIAN


914 
	#ODDBYTE
(
v
è(v)

	)

915 #–ià
BYTE_ORDER
 =ğ
BIG_ENDIAN


916 
	#ODDBYTE
(
v
è((
u_shÜt
)(vè<< 8)

	)

918 
	#ODDBYTE
(
v
è
	`htÚs
((
u_shÜt
)(vè<< 8)

	)

921 
u_shÜt
 
	$š_cksum
(
u_shÜt
 *
addr
, 
Ën
)

923 
Æeá
 = 
Ën
;

924 
u_shÜt
 *
w
 = 
addr
;

925 
u_shÜt
 
ªsw”
;

926 
sum
 = 0;

934  
Æeá
 > 1 ) {

935 
sum
 +ğ*
w
++;

936 
Æeá
 -= 2;

940 ifĞ
Æeá
 == 1 )

941 
sum
 +ğ
	`ODDBYTE
(*(
u_ch¬
 *)
w
);

946 
sum
 = (sum >> 16) + (sum & 0xffff);

947 
sum
 += (sum >> 16);

948 
ªsw”
 = ~
sum
;

949  (
ªsw”
);

950 
	}
}

962 
	$fšish
()

964 #ifdeà
RDISC_SERVER


965 ià(
»¥Úd”
) {

972 
	`log”r
("terminated\n");

973 
Á¿nsm™‹d
++;

974 
	`adv”ti£
(&
wh”‘o
, 0);

977 
	`logŒaû
("\n----% rdisøSti¡ics----\n", 
£ndadd»ss
 );

978 
	`logŒaû
("%d…ack‘ Œªsm™‹d, ", 
Á¿nsm™‹d
 );

979 
	`logŒaû
("%d…ack‘ »ûived, ", 
Äeûived
 );

980 
	`logŒaû
("\n");

981 (è
	`fæush
(
¡dout
);

982 
	`ex™
(0);

983 
	}
}

986 
	$g¿ûful_fšish
()

988 
	`disÿrd_bË
();

989 
	`fšish
();

990 
	`ex™
(0);

991 
	}
}

997 
	$£ndbÿ¡
(
s
, *
·ck‘
, 
·ck‘Ën
)

999 
i
, 
cc
;

1001 
i
 = 0; i < 
num_š‹rçûs
; i++) {

1002 ià((
š‹rçûs
[
i
].
æags
 & (
IFF_BROADCAST
|
IFF_POINTOPOINT
)) == 0)

1004 
cc
 = 
	`£ndbÿ¡if
(
s
, 
·ck‘
, 
·ck‘Ën
, &
š‹rçûs
[
i
]);

1005 ià(
cc
!ğ
·ck‘Ën
) {

1006  (
cc
);

1009  (
·ck‘Ën
);

1010 
	}
}

1013 
	$£ndbÿ¡if
(
s
, *
·ck‘
, 
·ck‘Ën
, 
š‹rçû
 *
iå
)

1015 
Ú
;

1016 
cc
;

1017 
sockaddr_š
 
baddr
;

1019 
baddr
.
sš_çmy
 = 
AF_INET
;

1020 
baddr
.
sš_addr
 = 
iå
->
bÿ¡addr
;

1021 ià(
debug
)

1022 
	`logdebug
("Broadcasto %s\n",

1023 
	`´_Çme
(
baddr
.
sš_addr
));

1024 
Ú
 = 1;

1025 
	`£tsockİt
(
s
, 
SOL_SOCKET
, 
SO_BROADCAST
, (*)&
Ú
, (on));

1026 
cc
 = 
	`£ndto
(
s
, 
·ck‘
, 
·ck‘Ën
, 0,

1027 (
sockaddr
 *)&
baddr
,  (sockaddr));

1028 ià(
cc
!ğ
·ck‘Ën
) {

1029 
	`log³¼Ü
("sendbcast: sendto");

1030 
	`log”r
("Cannot send broadcast…acketo %s\n",

1031 
	`´_Çme
(
baddr
.
sš_addr
));

1033 
Ú
 = 0;

1034 
	`£tsockİt
(
s
, 
SOL_SOCKET
, 
SO_BROADCAST
, (*)&
Ú
, (on));

1035  (
cc
);

1036 
	}
}

1039 
	$£ndmÿ¡
(
s
, *
·ck‘
, 
·ck‘Ën
, 
sockaddr_š
 *
sš
)

1041 
i
, 
cc
;

1043 
i
 = 0; i < 
num_š‹rçûs
; i++) {

1044 ià((
š‹rçûs
[
i
].
æags
 & (
IFF_BROADCAST
|
IFF_POINTOPOINT
|
IFF_MULTICAST
)) == 0)

1046 
cc
 = 
	`£ndmÿ¡if
(
s
, 
·ck‘
, 
·ck‘Ën
, 
sš
, &
š‹rçûs
[
i
]);

1047 ià(
cc
!ğ
·ck‘Ën
) {

1048  (
cc
);

1051  (
·ck‘Ën
);

1052 
	}
}

1055 
	$£ndmÿ¡if
(
s
, *
·ck‘
, 
·ck‘Ën
, 
sockaddr_š
 *
sš
,

1056 
š‹rçû
 *
iå
)

1058 
cc
;

1059 
_m»qn
 
m»q
;

1061 
	`mem£t
(&
m»q
, 0, (mreq));

1062 
m»q
.
imr_ifšdex
 = 
iå
->
ifšdex
;

1063 
m»q
.
imr_add»ss
 = 
iå
->
loÿÏddr
;

1064 ià(
debug
)

1065 
	`logdebug
("Multicasto interface %s, %s\n",

1066 
iå
->
Çme
,

1067 
	`´_Çme
(
m»q
.
imr_add»ss
));

1068 ià(
	`£tsockİt
(
s
, 
IPPROTO_IP
, 
IP_MULTICAST_IF
,

1069 (*)&
m»q
,

1070 (
m»q
)) < 0) {

1071 
	`log³¼Ü
("setsockopt (IP_MULTICAST_IF)");

1072 
	`log”r
("Cannot send multicast…acket over interface %s, %s\n",

1073 
iå
->
Çme
,

1074 
	`´_Çme
(
m»q
.
imr_add»ss
));

1077 
cc
 = 
	`£ndto
(
s
, 
·ck‘
, 
·ck‘Ën
, 0,

1078 (
sockaddr
 *)
sš
,  (sockaddr));

1079 ià(
cc
!ğ
·ck‘Ën
) {

1080 
	`log³¼Ü
("sendmcast: sendto");

1081 
	`log”r
("Cannot send multicast…acket over interface %s, %s\n",

1082 
iå
->
Çme
, 
	`´_Çme
(
m»q
.
imr_add»ss
));

1084  (
cc
);

1085 
	}
}

1088 
	$š™
()

1090 
	`š™ifs
();

1091 #ifdeà
RDISC_SERVER


1093 
i
;

1094 
i
 = 0; i < 
š‹rçûs_size
; i++)

1095 
š‹rçûs
[
i
].
´eã»nû
 =…reference;

1098 
	}
}

1101 
	$š™ifs
()

1103 
sock
;

1104 
ifcÚf
 
ifc
;

1105 
iäeq
 iäeq, *
iä
;

1106 
sockaddr_š
 *
sš
;

1107 
n
, 
i
;

1108 *
buf
;

1109 
numifs
;

1110 
bufsize
;

1112 
sock
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

1113 ià(
sock
 < 0) {

1114 
	`log³¼Ü
("initifs: socket");

1117 #ifdeà
SIOCGIFNUM


1118 ià(
	`ioùl
(
sock
, 
SIOCGIFNUM
, (*)&
numifs
) < 0) {

1119 
numifs
 = 
MAXIFS
;

1122 
numifs
 = 
MAXIFS
;

1124 
bufsize
 = 
numifs
 * (
iäeq
);

1125 
buf
 = (*)
	`m®loc
(
bufsize
);

1126 ià(
buf
 =ğ
NULL
) {

1127 
	`log”r
("out of memory\n");

1128 (è
	`şo£
(
sock
);

1131 ià(
š‹rçûs
)

1132 
š‹rçûs
 = (
š‹rçû
 *)
	`ALLIGN
(
	`»®loc
((*)interfaces,

1133 
numifs
 * (
š‹rçû
)));

1135 
š‹rçûs
 = (
š‹rçû
 *)
	`ALLIGN
(
	`m®loc
(
numifs
 *

1136 (
š‹rçû
)));

1137 ià(
š‹rçûs
 =ğ
NULL
) {

1138 
	`log”r
("out of memory\n");

1139 (è
	`şo£
(
sock
);

1140 (è
	`ä“
(
buf
);

1143 
š‹rçûs_size
 = 
numifs
;

1145 
ifc
.
ifc_Ën
 = 
bufsize
;

1146 
ifc
.
ifc_buf
 = 
buf
;

1147 ià(
	`ioùl
(
sock
, 
SIOCGIFCONF
, (*)&
ifc
) < 0) {

1148 
	`log³¼Ü
("initifs: ioctl (get interface configuration)");

1149 (è
	`şo£
(
sock
);

1150 (è
	`ä“
(
buf
);

1153 
iä
 = 
ifc
.
ifc_»q
;

1154 
i
 = 0, 
n
 = 
ifc
.
ifc_Ën
/ (
iäeq
);‚ > 0;‚--, 
iä
++) {

1155 
iäeq
 = *
iä
;

1156 ià(
	`¡¾’
(
iäeq
.
iä_Çme
è>ğ
IFNAMSIZ
)

1158 ià(
	`ioùl
(
sock
, 
SIOCGIFFLAGS
, (*)&
iäeq
) < 0) {

1159 
	`log³¼Ü
("initifs: ioctl (get interface flags)");

1162 ià(
iä
->
iä_addr
.
§_çmy
 !ğ
AF_INET
)

1164 ià((
iäeq
.
iä_æags
 & 
IFF_UP
) == 0)

1166 ià(
iäeq
.
iä_æags
 & 
IFF_LOOPBACK
)

1168 ià((
iäeq
.
iä_æags
 & (
IFF_MULTICAST
|
IFF_BROADCAST
|
IFF_POINTOPOINT
)) == 0)

1170 
	`¡ºıy
(
š‹rçûs
[
i
].
Çme
, 
iä
->
iä_Çme
, 
IFNAMSIZ
-1);

1172 
sš
 = (
sockaddr_š
 *)
	`ALLIGN
(&
iä
->
iä_addr
);

1173 
š‹rçûs
[
i
].
loÿÏddr
 = 
sš
->
sš_addr
;

1174 
š‹rçûs
[
i
].
æags
 = 
iäeq
.
iä_æags
;

1175 
š‹rçûs
[
i
].
Ãtmask
.
s_addr
 = (
__u32
)0xffffffff;

1176 ià(
	`ioùl
(
sock
, 
SIOCGIFINDEX
, (*)&
iäeq
) < 0) {

1177 
	`log³¼Ü
("initifs: ioctl (get ifindex)");

1180 
š‹rçûs
[
i
].
ifšdex
 = 
iäeq
.
iä_ifšdex
;

1181 ià(
iäeq
.
iä_æags
 & 
IFF_POINTOPOINT
) {

1182 ià(
	`ioùl
(
sock
, 
SIOCGIFDSTADDR
, (*)&
iäeq
) < 0) {

1183 
	`log³¼Ü
("initifs: ioctl (get destination‡ddr)");

1186 
sš
 = (
sockaddr_š
 *)
	`ALLIGN
(&
iäeq
.
iä_addr
);

1188 
š‹rçûs
[
i
].
add»ss
 = 
sš
->
sš_addr
;

1189 
š‹rçûs
[
i
].
»mÙ—ddr
 = 
sš
->
sš_addr
;

1191 
š‹rçûs
[
i
].
bÿ¡addr
 = 
sš
->
sš_addr
;

1192 
š‹rçûs
[
i
].
æags
 |ğ
IFF_BROADCAST
;

1195 
š‹rçûs
[
i
].
add»ss
 = iÁ”çûs[i].
loÿÏddr
;

1196 
š‹rçûs
[
i
].
»mÙ—ddr
 = iÁ”çûs[i].
add»ss
;

1197 ià(
	`ioùl
(
sock
, 
SIOCGIFNETMASK
, (*)&
iäeq
) < 0) {

1198 
	`log³¼Ü
("initifs: ioctl (get‚etmask)");

1201 
sš
 = (
sockaddr_š
 *)
	`ALLIGN
(&
iäeq
.
iä_addr
);

1202 
š‹rçûs
[
i
].
Ãtmask
 = 
sš
->
sš_addr
;

1203 ià(
iäeq
.
iä_æags
 & 
IFF_BROADCAST
) {

1204 ià(
	`ioùl
(
sock
, 
SIOCGIFBRDADDR
, (*)&
iäeq
) < 0) {

1205 
	`log³¼Ü
("initifs: ioctl (get broadcast‡ddress)");

1208 
sš
 = (
sockaddr_š
 *)
	`ALLIGN
(&
iäeq
.
iä_addr
);

1209 
š‹rçûs
[
i
].
bÿ¡addr
 = 
sš
->
sš_addr
;

1212 #ifdeà
nÙdef


1213 ià(
debug
)

1214 
	`logdebug
("Found interface %s, flags 0x%x\n",

1215 
	`´_Çme
(
š‹rçûs
[
i
].
loÿÏddr
),

1216 
š‹rçûs
[
i
].
æags
);

1218 
i
++;

1220 
num_š‹rçûs
 = 
i
;

1221 #ifdeà
nÙdef


1222 ià(
debug
)

1223 
	`logdebug
("Found %d iÁ”çûs\n", 
num_š‹rçûs
);

1225 (è
	`şo£
(
sock
);

1226 (è
	`ä“
(
buf
);

1227 
	}
}

1230 
	$još
(
sock
, 
sockaddr_š
 *
sš
)

1232 
i
, 
j
;

1233 
_m»qn
 
m»q
;

1234 
jošed
[
num_š‹rçûs
];

1236 
	`mem£t
(
jošed
, 0, (joined));

1238 ià(
	`isbrßdÿ¡
(
sš
))

1241 
m»q
.
imr_muÉŸddr
 = 
sš
->
sš_addr
;

1242 
i
 = 0; i < 
num_š‹rçûs
; i++) {

1243 
j
 = 0; j < 
i
; j++) {

1244 ià(
jošed
[
j
] =ğ
š‹rçûs
[
i
].
ifšdex
)

1247 ià(
j
 !ğ
i
)

1250 
m»q
.
imr_ifšdex
 = 
š‹rçûs
[
i
].
ifšdex
;

1251 
m»q
.
imr_add»ss
.
s_addr
 = 0;

1253 ià(
	`£tsockİt
(
sock
, 
IPPROTO_IP
, 
IP_ADD_MEMBERSHIP
,

1254 (*)&
m»q
, (mreq)) < 0) {

1255 
	`log³¼Ü
("setsockopt (IP_ADD_MEMBERSHIP)");

1259 
jošed
[
i
] = 
š‹rçûs
[i].
ifšdex
;

1262 
	}
}

1264 
	$suµÜt_muÉiÿ¡
()

1266 
sock
;

1267 
u_ch¬
 
‰l
 = 1;

1269 
sock
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 
IPPROTO_UDP
);

1270 ià(
sock
 < 0) {

1271 
	`log³¼Ü
("support_multicast: socket");

1275 ià(
	`£tsockİt
(
sock
, 
IPPROTO_IP
, 
IP_MULTICAST_TTL
,

1276 (*)&
‰l
, (ttl)) < 0) {

1277 (è
	`şo£
(
sock
);

1280 (è
	`şo£
(
sock
);

1282 
	}
}

1285 
	$is_dœeùly_cÚÃùed
(
š_addr
 
š
)

1287 
i
;

1289 
i
 = 0; i < 
num_š‹rçûs
; i++) {

1292 ià((
š
.
s_addr
 & 
š‹rçûs
[
i
].
Ãtmask
.s_addr ) ==

1293 (
š‹rçûs
[
i
].
»mÙ—ddr
.
s_addr
 & iÁ”çûs[i].
Ãtmask
.s_addr))

1297 
	}
}

1302 
	sbË
 {

1303 
š_addr
 
	mrou‹r
;

1304 
	m´eã»nû
;

1305 
	m»maššg_time
;

1306 
	mš_k”Ãl
;

1307 
bË
 *
	mÃxt
;

1310 
bË
 *
	gbË
;

1312 
bË
 *

1313 
	$fšd_rou‹r
(
š_addr
 
addr
)

1315 
bË
 *

;

1317 

 = 
bË
;

1318 

) {

1319 ià(

->
rou‹r
.
s_addr
 =ğ
addr
.s_addr)

1320  (

);

1321 

 =p->
Ãxt
;

1323  (
NULL
);

1324 
	}
}

1326 
	$max_´eã»nû
()

1328 
bË
 *

;

1329 
max
 = ()
INELIGIBLE_PREF
;

1331 

 = 
bË
;

1332 

) {

1333 ià(

->
´eã»nû
 > 
max
)

1334 
max
 = 

->
´eã»nû
;

1335 

 =p->
Ãxt
;

1337  (
max
);

1338 
	}
}

1343 
	$age_bË
(
time
)

1345 
bË
 **
p
, *

;

1346 
»ÿlcuÏ‹_max
 = 0;

1347 
max
 = 
	`max_´eã»nû
();

1349 
p
 = &
bË
;

1350 *
p
 !ğ
NULL
) {

1351 

 = *
p
;

1352 

->
»maššg_time
 -ğ
time
;

1353 ià(

->
»maššg_time
 <= 0) {

1354 *
p
 = 

->
Ãxt
;

1355 ià(

->
š_k”Ãl
)

1356 
	`d–_rou‹
(

->
rou‹r
);

1357 ià(
be¡_´eã»nû
 &&

1358 

->
´eã»nû
 =ğ
max
)

1359 
»ÿlcuÏ‹_max
++;

1360 
	`ä“
((*)

);

1362 
p
 = &

->
Ãxt
;

1365 ià(
»ÿlcuÏ‹_max
) {

1366 
max
 = 
	`max_´eã»nû
();

1368 ià(
max
 !ğ
INELIGIBLE_PREF
) {

1369 

 = 
bË
;

1370 

) {

1371 ià(

->
´eã»nû
 =ğ
max
 && !->
š_k”Ãl
) {

1372 
	`add_rou‹
(

->
rou‹r
);

1373 

->
š_k”Ãl
++;

1375 

 =p->
Ãxt
;

1379 
	}
}

1381 
	$disÿrd_bË
()

1383 
bË
 **
p
, *

;

1385 
p
 = &
bË
;

1386 *
p
 !ğ
NULL
) {

1387 

 = *
p
;

1388 *
p
 = 

->
Ãxt
;

1389 ià(

->
š_k”Ãl
)

1390 
	`d–_rou‹
(

->
rou‹r
);

1391 
	`ä“
((*)

);

1393 
	}
}

1397 
	$»cÜd_rou‹r
(
š_addr
 
rou‹r
, 
´eã»nû
, 
‰l
)

1399 
bË
 *

;

1400 
Şd_max
 = 
	`max_´eã»nû
();

1401 
chªged_up
 = 0;

1402 
chªged_down
 = 0;

1404 ià(
‰l
 < 4)

1405 
´eã»nû
 = 
INELIGIBLE_PREF
;

1407 ià(
debug
)

1408 
	`logdebug
("Recording %s,tl %d,…reference 0x%x\n",

1409 
	`´_Çme
(
rou‹r
),

1410 
‰l
,

1411 
´eã»nû
);

1412 

 = 
	`fšd_rou‹r
(
rou‹r
);

1413 ià(

) {

1414 ià(

->
´eã»nû
 >…reference &&

1415 

->
´eã»nû
 =ğ
Şd_max
)

1416 
chªged_down
++;

1417 ià(
´eã»nû
 > 

->preference)

1418 
chªged_up
++;

1419 

->
´eã»nû
 =…reference;

1420 

->
»maššg_time
 = 
‰l
;

1422 ià(
´eã»nû
 > 
Şd_max
)

1423 
chªged_up
++;

1424 

 = (
bË
 *)
	`ALLIGN
(
	`m®loc
((table)));

1425 ià(

 =ğ
NULL
) {

1426 
	`log”r
("Out of memory\n");

1429 

->
rou‹r
 =„outer;

1430 

->
´eã»nû
 =…reference;

1431 

->
»maššg_time
 = 
‰l
;

1432 

->
š_k”Ãl
 = 0;

1433 

->
Ãxt
 = 
bË
;

1434 
bË
 = 

;

1436 ià(!

->
š_k”Ãl
 &&

1437 (!
be¡_´eã»nû
 || 

->
´eã»nû
 =ğ
	`max_´eã»nû
()) &&

1438 

->
´eã»nû
 !ğ
INELIGIBLE_PREF
) {

1439 
	`add_rou‹
(

->
rou‹r
);

1440 

->
š_k”Ãl
++;

1442 ià(

->
´eã»nû
 =ğ
INELIGIBLE_PREF
 &&p->
š_k”Ãl
) {

1443 
	`d–_rou‹
(

->
rou‹r
);

1444 

->
š_k”Ãl
 = 0;

1446 ià(
be¡_´eã»nû
 && 
chªged_down
) {

1448 
Ãw_max
 = 
	`max_´eã»nû
();

1449 ià(
Ãw_max
 !ğ
INELIGIBLE_PREF
) {

1450 

 = 
bË
;

1451 

) {

1452 ià(

->
´eã»nû
 =ğ
Ãw_max
 &&

1453 !

->
š_k”Ãl
) {

1454 
	`add_rou‹
(

->
rou‹r
);

1455 

->
š_k”Ãl
++;

1457 

 =p->
Ãxt
;

1461 ià(
be¡_´eã»nû
 && (
chªged_up
 || 
chªged_down
)) {

1463 
Ãw_max
 = 
	`max_´eã»nû
();

1464 

 = 
bË
;

1465 

) {

1466 ià(

->
´eã»nû
 < 
Ãw_max
 &&p->
š_k”Ãl
) {

1467 
	`d–_rou‹
(

->
rou‹r
);

1468 

->
š_k”Ãl
 = 0;

1470 

 =p->
Ãxt
;

1473 
	}
}

1476 
	$add_rou‹
(
š_addr
 
addr
)

1478 ià(
debug
)

1479 
	`logdebug
("Add deçuÉ„ou‹Ø%s\n", 
	`´_Çme
(
addr
));

1480 
	`¹ioùl
(
addr
, 
SIOCADDRT
);

1481 
	}
}

1484 
	$d–_rou‹
(
š_addr
 
addr
)

1486 ià(
debug
)

1487 
	`logdebug
("D–‘deçuÉ„ou‹Ø%s\n", 
	`´_Çme
(
addr
));

1488 
	`¹ioùl
(
addr
, 
SIOCDELRT
);

1489 
	}
}

1492 
	$¹ioùl
(
š_addr
 
addr
, 
İ
)

1494 
sock
;

1495 
¹’Œy
 
¹
;

1496 
sockaddr_š
 *
sš
;

1498 
	`mem£t
((*)&
¹
, 0, (
¹’Œy
));

1499 
¹
.
¹_d¡
.
§_çmy
 = 
AF_INET
;

1500 
¹
.
¹_g©eway
.
§_çmy
 = 
AF_INET
;

1501 
¹
.
¹_g’mask
.
§_çmy
 = 
AF_INET
;

1502 
sš
 = (
sockaddr_š
 *)
	`ALLIGN
(&
¹
.
¹_g©eway
);

1503 
sš
->
sš_addr
 = 
addr
;

1504 
¹
.
¹_æags
 = 
RTF_UP
 | 
RTF_GATEWAY
;

1506 
sock
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 
IPPROTO_UDP
);

1507 ià(
sock
 < 0) {

1508 
	`log³¼Ü
("rtioctl: socket");

1511 ià(
	`ioùl
(
sock
, 
İ
, (*)&
¹
) < 0) {

1512 ià(!(
İ
 =ğ
SIOCADDRT
 && 
”ºo
 =ğ
EEXIST
))

1513 
	`log³¼Ü
("ioctl (add/delete„oute)");

1515 (è
	`şo£
(
sock
);

1516 
	}
}

1522 
	$š™log
()

1524 
loggšg
++;

1525 
	`İ’log
("š.rdiscd", 
LOG_PID
 | 
LOG_CONS
, 
LOG_DAEMON
);

1526 
	}
}

1530 
	$log³¼Ü
(*
¡r
)

1532 ià(
loggšg
)

1533 
	`sy¦og
(
LOG_ERR
, "%s: %m", 
¡r
);

1535 (è
	`årštf
(
¡d”r
, "%s: %s\n", 
¡r
, 
	`¡»¼Ü
(
”ºo
));

1536 
	}
}

	@tftp.h

36 #iâdeà
_ARPA_TFTP_H


37 
	#_ARPA_TFTP_H


	)

41 
	#SEGSIZE
 512

	)

46 
	#RRQ
 01

	)

47 
	#WRQ
 02

	)

48 
	#DATA
 03

	)

49 
	#ACK
 04

	)

50 
	#ERROR
 05

	)

52 
	stáphdr
 {

53 
	mth_İcode
;

55 
	mtu_block
;

56 
	mtu_code
;

57 
	mtu_¡uff
[1];

58 } 
	mth_u
;

59 
	mth_d©a
[1];

62 
	#th_block
 
th_u
.
tu_block


	)

63 
	#th_code
 
th_u
.
tu_code


	)

64 
	#th_¡uff
 
th_u
.
tu_¡uff


	)

65 
	#th_msg
 
th_d©a


	)

70 
	#EUNDEF
 0

	)

71 
	#ENOTFOUND
 1

	)

72 
	#EACCESS
 2

	)

73 
	#ENOSPACE
 3

	)

74 
	#EBADOP
 4

	)

75 
	#EBADID
 5

	)

76 
	#EEXISTS
 6

	)

77 
	#ENOUSER
 7

	)

80 
»ad™
(
FILE
 * 
fe
, 
táphdr
 **
dµ
, 
cÚv”t
);

81 
»ad_ah—d
(
FILE
 *
fe
, 
cÚv”t
);

82 
wr™e™
(
FILE
 *
fe
, 
táphdr
 **
dµ
, 
ù
, 
cÚv”t
);

83 
wr™e_behšd
(
FILE
 *
fe
, 
cÚv”t
);

84 
synchÃt
(
f
);

85 
táphdr
 *
w_š™
();

86 
táphdr
 *
r_š™
();

	@tftpd.c

34 #iâdeà
lšt


35 
	gcİyright
[] =

40 #iâdeà
lšt


51 
	~<sys/ty³s.h
>

52 
	~<sys/ioùl.h
>

53 
	~<sys/¡©.h
>

54 
	~<uni¡d.h
>

55 
	~<sigÇl.h
>

56 
	~<fú.h
>

58 
	~<sys/sock‘.h
>

59 
	~<Ãtš‘/š.h
>

60 
	~<Ãtdb.h
>

62 
	~<£tjmp.h
>

63 
	~<sy¦og.h
>

64 
	~<¡dio.h
>

65 
	~<”ºo.h
>

66 
	~<ùy³.h
>

67 
	~<¡ršg.h
>

68 
	~<¡dlib.h
>

70 
	~"táp.h
"

72 #iâdeà
MSG_CONFIRM


73 
	#MSG_CONFIRM
 0

	)

74 #w¬nšg 
PËa£
, 
upg¿de
 
k”Ãl
, 
Ùh”wi£
 
this
 
tápd
 
has
 
no
 
advªges
.

77 
	#TIMEOUT
 5

	)

79 
	g³”
;

80 
	g»xmtv®
 = 
TIMEOUT
;

81 
	gmaxtimeout
 = 5*
TIMEOUT
;

83 
	#PKTSIZE
 
SEGSIZE
+4

	)

84 
	gbuf
[
PKTSIZE
];

85 
	gackbuf
[
PKTSIZE
];

87 
sockaddr
 
	m§
;

88 
sockaddr_š
 
	msš
;

89 
sockaddr_š6
 
	msš6
;

90 } 
	gäom
;

91 
sockËn_t
 
	gäomËn
;

93 
	#MAXARG
 1

	)

94 *
	gdœs
[
MAXARG
+1];

96 
	$táp
(
táphdr
 *

, 
size
è
	`__©Œibu‹__
((
nÜ‘uº
));

97 
	`Çk
(
”rÜ
);

98 
	`v®id©e_acûss
(*
f’ame
, 
mode
);

100 
fÜm©s
;

102 
	`£ndfe
(
fÜm©s
 *
pf
);

103 
	`»cvfe
(
fÜm©s
 *
pf
);

106 
	$maš
(
ac
, **
av
)

108 
táphdr
 *

;

109 
n
 = 0;

110 
Ú
 = 1;

113 ià(
	`g‘euid
() == 0) {

114 
	`£tgid
(65534);

115 
	`£tuid
(65534);

118 
ac
--; 
av
++;

119 
ac
-- > 0 && 
n
 < 
MAXARG
)

120 
dœs
[
n
++] = *
av
++;

122 
	`İ’log
("tápd", 
LOG_PID
, 
LOG_DAEMON
);

123 ià(
	`ioùl
(0, 
FIONBIO
, &
Ú
) < 0) {

124 
	`sy¦og
(
LOG_ERR
, "ioctl(FIONBIO): %m\n");

125 
	`ex™
(1);

127 
äomËn
 =  (
äom
);

128 
n
 = 
	`»cväom
(0, 
buf
,  (buf), 0,

129 (
sockaddr
 *)&
äom
, &
äomËn
);

130 ià(
n
 < 0) {

131 ià(
”ºo
 !ğ
EAGAIN
)

132 
	`sy¦og
(
LOG_ERR
, "recvfrom: %m\n");

133 
	`ex™
(1);

150 
pid
;

151 
i
;

152 
sockËn_t
 
j
;

154 
i
 = 1; i < 20; i++) {

155 
pid
 = 
	`fÜk
();

156 ià(
pid
 < 0) {

157 
	`¦“p
(
i
);

168 
j
 =  
äom
;

169 
i
 = 
	`»cväom
(0, 
buf
,  (buf), 0,

170 (
sockaddr
 *)&
äom
, &
j
);

171 ià(
i
 > 0) {

172 
n
 = 
i
;

173 
äomËn
 = 
j
;

179 ià(
pid
 < 0) {

180 
	`sy¦og
(
LOG_ERR
, "fork: %m\n");

181 
	`ex™
(1);

182 } ià(
pid
 != 0) {

183 
	`ex™
(0);

186 
	`®¬m
(0);

187 
	`şo£
(0);

188 
	`şo£
(1);

189 
³”
 = 
	`sock‘
(
äom
.
§
.
§_çmy
, 
SOCK_DGRAM
, 0);

190 ià(
³”
 < 0) {

191 
	`sy¦og
(
LOG_ERR
, "socket: %m\n");

192 
	`ex™
(1);

194 ià(
	`cÚÃù
(
³”
, (
sockaddr
 *)&
äom
, (from)) < 0) {

195 
	`sy¦og
(
LOG_ERR
, "connect: %m\n");

196 
	`ex™
(1);

198 

 = (
táphdr
 *)
buf
;

199 

->
th_İcode
 = 
	`Áohs
(tp->th_opcode);

200 ià(

->
th_İcode
 =ğ
RRQ
 ||p->th_İcod=ğ
WRQ
)

201 
	`táp
(

, 
n
);

202 
	`ex™
(1);

203 
	}
}

205 
	sfÜm©s
 {

206 *
	mf_mode
;

207 (*
	mf_v®id©e
)(*
	mf’ame
, 
	mmode
);

208 (*
	mf_£nd
)(
	mfÜm©s
*);

209 (*
	mf_»cv
)(
	mfÜm©s
*);

210 
	mf_cÚv”t
;

211 } 
	gfÜm©s
[] = {

212 { "Ãscii", 
v®id©e_acûss
, 
£ndfe
, 
»cvfe
, 1 },

213 { "où‘", 
v®id©e_acûss
, 
£ndfe
, 
»cvfe
, 0 },

214 #ifdeà
nÙdef


215 { "ma", 
v®id©e_u£r
, 
£ndma
, 
»cvma
, 1 },

223 
	$táp
(
táphdr
 *

, 
size
)

225 *
ı
;

226 
fœ¡
 = 1, 
ecode
;

227 
fÜm©s
 *
pf
;

228 *
f’ame
, *
mode
 = 
NULL
;

230 
f’ame
 = 
ı
 = 

->
th_¡uff
;

231 
agaš
:

232 
ı
 < 
buf
 + 
size
) {

233 ià(*
ı
 == '\0')

235 
ı
++;

237 ià(*
ı
 != '\0') {

238 
	`Çk
(
EBADOP
);

239 
	`ex™
(1);

241 ià(
fœ¡
) {

242 
mode
 = ++
ı
;

243 
fœ¡
 = 0;

244 
agaš
;

246 
ı
 = 
mode
; *cp; cp++)

247 ià(
	`isuµ”
(*
ı
))

248 *
ı
 = 
	`tŞow”
(*cp);

249 
pf
 = 
fÜm©s
;…f->
f_mode
;…f++)

250 ià(
	`¡rcmp
(
pf
->
f_mode
, 
mode
) == 0)

252 ià(
pf
->
f_mode
 == 0) {

253 
	`Çk
(
EBADOP
);

254 
	`ex™
(1);

256 
ecode
 = (*
pf
->
f_v®id©e
)(
f’ame
, 

->
th_İcode
);

257 ià(
ecode
) {

258 
	`Çk
(
ecode
);

259 
	`ex™
(1);

261 ià(

->
th_İcode
 =ğ
WRQ
)

262 (*
pf
->
f_»cv
)(pf);

264 (*
pf
->
f_£nd
)(pf);

265 
	`ex™
(0);

266 
	}
}

269 
FILE
 *
	gfe
;

282 
	$v®id©e_acûss
(*
f’ame
, 
mode
)

284 
¡©
 
¡buf
;

285 
fd
;

286 *
ı
;

287 
âamebuf
[1024+512];

289 
ı
 = 
f’ame
; *cp; cp++) {

290 if(*
ı
 =ğ'.' && (ı =ğ
f’ame
 || 
	`¡ºcmp
(cp-1, "/../", 4) == 0)) {

291 
	`sy¦og
(
LOG_ERR
, "bad…©h %s", 
f’ame
);

292 (
EACCESS
);

296 ià(*
f’ame
 == '/')

297 
f’ame
++;

299 ià(!*
dœs
) {

300 
	`sy¦og
(
LOG_ERR
, "no dirs");

301  
EACCESS
;

303 
	`¢´štf
(
âamebuf
, (âamebuf)-1, "%s/%s", *
dœs
, 
f’ame
);

304 
f’ame
 = 
âamebuf
;

306 ià(
	`¡©
(
f’ame
, &
¡buf
) < 0) {

307 
	`sy¦og
(
LOG_ERR
, "¡© % : %m", 
f’ame
);

308  (
”ºo
 =ğ
ENOENT
 ? 
ENOTFOUND
 : 
EACCESS
);

310 ià(
mode
 =ğ
RRQ
) {

311 ià((
¡buf
.
¡_mode
&(
S_IREAD
 >> 6)) == 0) {

312 
	`sy¦og
(
LOG_ERR
, "nÙ„—dabË %s", 
f’ame
);

313  (
EACCESS
);

316 ià((
¡buf
.
¡_mode
&(
S_IWRITE
 >> 6)) == 0) {

317 
	`sy¦og
(
LOG_ERR
, "nÙ wr™abË %s", 
f’ame
);

318  (
EACCESS
);

321 
fd
 = 
	`İ’
(
f’ame
, 
mode
 =ğ
RRQ
 ? 0 : 1);

322 ià(
fd
 < 0) {

323 
	`sy¦og
(
LOG_ERR
, "ÿÂÙ o³À%s: %m", 
f’ame
);

324  (
”ºo
 + 100);

326 
fe
 = 
	`fdİ’
(
fd
, (
mode
 =ğ
RRQ
)? "r":"w");

327 ià(
fe
 =ğ
NULL
) {

328  
”ºo
+100;

331 
	}
}

333 
	gcÚfœmed
;

334 
	gtimeout
;

335 
jmp_buf
 
	gtimeoutbuf
;

337 
	$tim”
(
signo
)

339 
cÚfœmed
 = 0;

340 
timeout
 +ğ
»xmtv®
;

341 ià(
timeout
 >ğ
maxtimeout
)

342 
	`ex™
(1);

343 
	`lÚgjmp
(
timeoutbuf
, 1);

344 
	}
}

349 
	$£ndfe
(
fÜm©s
 *
pf
)

351 
táphdr
 *
dp
;

352 
táphdr
 *
­
;

353 vŞ©
block
 = 1;

354 
size
, 
n
;

356 
cÚfœmed
 = 0;

357 
	`sigÇl
(
SIGALRM
, 
tim”
);

358 
dp
 = 
	`r_š™
();

359 
­
 = (
táphdr
 *)
ackbuf
;

361 
size
 = 
	`»ad™
(
fe
, &
dp
, 
pf
->
f_cÚv”t
);

362 ià(
size
 < 0) {

363 
	`Çk
(
”ºo
 + 100);

364 
abÜt
;

366 
dp
->
th_İcode
 = 
	`htÚs
((
u_shÜt
)
DATA
);

367 
dp
->
th_block
 = 
	`htÚs
((
u_shÜt
)
block
);

368 
timeout
 = 0;

369 (è
	`£tjmp
(
timeoutbuf
);

371 
£nd_d©a
:

372 ià(
	`£nd
(
³”
, 
dp
, 
size
 + 4, 
cÚfœmed
) != size + 4) {

373 
	`sy¦og
(
LOG_ERR
, "tftpd: write: %m\n");

374 
abÜt
;

376 
cÚfœmed
 = 0;

377 
	`»ad_ah—d
(
fe
, 
pf
->
f_cÚv”t
);

379 
	`®¬m
(
»xmtv®
);

380 
n
 = 
	`»cv
(
³”
, 
ackbuf
,  (ackbuf), 0);

381 
	`®¬m
(0);

382 ià(
n
 < 0) {

383 
	`sy¦og
(
LOG_ERR
, "tftpd:„ead: %m\n");

384 
abÜt
;

386 
­
->
th_İcode
 = 
	`Áohs
((
u_shÜt
)ap->th_opcode);

387 
­
->
th_block
 = 
	`Áohs
((
u_shÜt
)ap->th_block);

389 ià(
­
->
th_İcode
 =ğ
ERROR
)

390 
abÜt
;

392 ià(
­
->
th_İcode
 =ğ
ACK
) {

393 ià(
­
->
th_block
 =ğ
block
) {

394 
cÚfœmed
 = 
MSG_CONFIRM
;

398 
	`synchÃt
(
³”
);

399 ià(
­
->
th_block
 =ğ(
block
 -1)) {

400 
£nd_d©a
;

405 
block
++;

406 } 
size
 =ğ
SEGSIZE
);

407 
abÜt
:

408 (è
	`fşo£
(
fe
);

409 
	}
}

411 
	$ju¡qu™
(
signo
)

413 
	`ex™
(0);

414 
	}
}

420 
	$»cvfe
(
fÜm©s
 *
pf
)

422 
táphdr
 *
dp
;

423 
táphdr
 *
­
;

424 vŞ©
block
 = 0, 
n
, 
size
;

426 
cÚfœmed
 = 0;

427 
	`sigÇl
(
SIGALRM
, 
tim”
);

428 
dp
 = 
	`w_š™
();

429 
­
 = (
táphdr
 *)
ackbuf
;

431 
timeout
 = 0;

432 
­
->
th_İcode
 = 
	`htÚs
((
u_shÜt
)
ACK
);

433 
­
->
th_block
 = 
	`htÚs
((
u_shÜt
)
block
);

434 
block
++;

435 (è
	`£tjmp
(
timeoutbuf
);

436 
£nd_ack
:

437 ià(
	`£nd
(
³”
, 
ackbuf
, 4, 
cÚfœmed
) != 4) {

438 
	`sy¦og
(
LOG_ERR
, "tftpd: write: %m\n");

439 
abÜt
;

441 
cÚfœmed
 = 0;

442 
	`wr™e_behšd
(
fe
, 
pf
->
f_cÚv”t
);

444 
	`®¬m
(
»xmtv®
);

445 
n
 = 
	`»cv
(
³”
, 
dp
, 
PKTSIZE
, 0);

446 
	`®¬m
(0);

447 ià(
n
 < 0) {

448 
	`sy¦og
(
LOG_ERR
, "tftpd:„ead: %m\n");

449 
abÜt
;

451 
dp
->
th_İcode
 = 
	`Áohs
((
u_shÜt
)dp->th_opcode);

452 
dp
->
th_block
 = 
	`Áohs
((
u_shÜt
)dp->th_block);

453 ià(
dp
->
th_İcode
 =ğ
ERROR
)

454 
abÜt
;

455 ià(
dp
->
th_İcode
 =ğ
DATA
) {

456 ià(
dp
->
th_block
 =ğ
block
) {

457 
cÚfœmed
 = 
MSG_CONFIRM
;

461 (è
	`synchÃt
(
³”
);

462 ià(
dp
->
th_block
 =ğ(
block
-1))

463 
£nd_ack
;

467 
size
 = 
	`wr™e™
(
fe
, &
dp
, 
n
 - 4, 
pf
->
f_cÚv”t
);

468 ià(
size
 !ğ(
n
-4)) {

469 ià(
size
 < 0è
	`Çk
(
”ºo
 + 100);

470 
	`Çk
(
ENOSPACE
);

471 
abÜt
;

473 } 
size
 =ğ
SEGSIZE
);

474 
	`wr™e_behšd
(
fe
, 
pf
->
f_cÚv”t
);

475 (è
	`fşo£
(
fe
);

477 
­
->
th_İcode
 = 
	`htÚs
((
u_shÜt
)
ACK
);

478 
­
->
th_block
 = 
	`htÚs
((
u_shÜt
)(
block
));

479 (è
	`£nd
(
³”
, 
ackbuf
, 4, 
cÚfœmed
);

481 
	`sigÇl
(
SIGALRM
, 
ju¡qu™
);

482 
	`®¬m
(
»xmtv®
);

483 
n
 = 
	`»cv
(
³”
, 
buf
,  (buf), 0);

484 
	`®¬m
(0);

485 ià(
n
 >= 4 &&

486 
dp
->
th_İcode
 =ğ
DATA
 &&

487 
block
 =ğ
dp
->
th_block
) {

488 (è
	`£nd
(
³”
, 
ackbuf
, 4, 0);

490 
abÜt
:

492 
	}
}

494 
	s”rmsg
 {

495 
	me_code
;

496 *
	me_msg
;

497 } 
	g”rmsgs
[] = {

498 { 
EUNDEF
, "Undefinedƒrror code" },

499 { 
ENOTFOUND
, "File‚ot found" },

500 { 
EACCESS
, "Access violation" },

501 { 
ENOSPACE
, "Disk full or‡llocationƒxceeded" },

502 { 
EBADOP
, "Illegal TFTP operation" },

503 { 
EBADID
, "Unknownransfer ID" },

504 { 
EEXISTS
, "File‡lreadyƒxists" },

505 { 
ENOUSER
, "No such user" },

515 
	$Çk
(
”rÜ
)

517 
táphdr
 *

;

518 
Ëngth
;

519 
”rmsg
 *
³
;

521 

 = (
táphdr
 *)
buf
;

522 

->
th_İcode
 = 
	`htÚs
((
u_shÜt
)
ERROR
);

523 

->
th_code
 = 
	`htÚs
((
u_shÜt
)
”rÜ
);

524 
³
 = 
”rmsgs
;…e->
e_code
 >= 0;…e++)

525 ià(
³
->
e_code
 =ğ
”rÜ
)

527 ià(
³
->
e_code
 < 0) {

528 
³
->
e_msg
 = 
	`¡»¼Ü
(
”rÜ
 - 100);

529 

->
th_code
 = 
EUNDEF
;

531 
	`¡rıy
(

->
th_msg
, 
³
->
e_msg
);

532 
Ëngth
 = 
	`¡¾’
(
³
->
e_msg
);

533 

->
th_msg
[
Ëngth
] = '\0';

534 
Ëngth
 += 5;

535 ià(
	`£nd
(
³”
, 
buf
, 
Ëngth
, 0) !=†ength)

536 
	`sy¦og
(
LOG_ERR
, "nak: %m\n");

537 
	}
}

	@tftpsubs.c

34 #iâdeà
lšt


50 
	~<sys/ty³s.h
>

51 
	~<sys/sock‘.h
>

52 
	~<sys/ioùl.h
>

53 
	~<Ãtš‘/š.h
>

54 
	~<uni¡d.h
>

55 
	~<¡dio.h
>

57 
	~"táp.h
"

59 
	#PKTSIZE
 
SEGSIZE
+4

	)

61 
	sbf
 {

62 
	mcouÁ”
;

63 
	mbuf
[
PKTSIZE
];

64 } 
	gbfs
[2];

67 
	#BF_ALLOC
 -3

	)

68 
	#BF_FREE
 -2

	)

71 
	gÃxtÚe
;

72 
	gcu¼’t
;

75 
	gÃwlše
 = 0;

76 
	g´evch¬
 = -1;

78 
táphdr
 *
rw_š™
();

80 
táphdr
 *
	$w_š™
(è{  
	`rw_š™
(0); 
	}
}

81 
táphdr
 *
	$r_š™
(è{  
	`rw_š™
(1); 
	}
}

85 
táphdr
 *
	$rw_š™
(
x
)

87 
Ãwlše
 = 0;

88 
´evch¬
 = -1;

89 
bfs
[0].
couÁ”
 = 
BF_ALLOC
;

90 
cu¼’t
 = 0;

91 
bfs
[1].
couÁ”
 = 
BF_FREE
;

92 
ÃxtÚe
 = 
x
;

93  (
táphdr
 *)
bfs
[0].
buf
;

94 
	}
}

100 
	$»ad™
(
FILE
 * 
fe
, 
táphdr
 **
dµ
, 
cÚv”t
)

102 
bf
 *
b
;

104 
bfs
[
cu¼’t
].
couÁ”
 = 
BF_FREE
;

105 
cu¼’t
 = !current;

107 
b
 = &
bfs
[
cu¼’t
];

108 ià(
b
->
couÁ”
 =ğ
BF_FREE
)

109 
	`»ad_ah—d
(
fe
, 
cÚv”t
);

111 
	`as£¹
(
b
->
couÁ”
 !ğ
BF_FREE
);

113 *
dµ
 = (
táphdr
 *)
b
->
buf
;

114  
b
->
couÁ”
;

115 
	}
}

121 
	$»ad_ah—d
(
FILE
 *
fe
, 
cÚv”t
)

123 
i
;

124 *
p
;

125 
c
;

126 
bf
 *
b
;

127 
táphdr
 *
dp
;

129 
b
 = &
bfs
[
ÃxtÚe
];

130 ià(
b
->
couÁ”
 !ğ
BF_FREE
)

132 
ÃxtÚe
 = !nextone;

134 
dp
 = (
táphdr
 *)
b
->
buf
;

136 ià(
cÚv”t
 == 0) {

137 
b
->
couÁ”
 = 
	`»ad
(
	`f’o
(
fe
), 
dp
->
th_d©a
, 
SEGSIZE
);

141 
p
 = 
dp
->
th_d©a
;

142 
i
 = 0 ; i < 
SEGSIZE
; i++) {

143 ià(
Ãwlše
) {

144 ià(
´evch¬
 == '\n')

145 
c
 = '\n';

146 
c
 = '\0';

147 
Ãwlše
 = 0;

150 
c
 = 
	`g‘c
(
fe
);

151 ià(
c
 =ğ
EOF
) ;

152 ià(
c
 == '\n' || c == '\r') {

153 
´evch¬
 = 
c
;

154 
c
 = '\r';

155 
Ãwlše
 = 1;

158 *
p
++ = 
c
;

160 
b
->
couÁ”
 = ()(
p
 - 
dp
->
th_d©a
);

161 
	}
}

167 
	$wr™e™
(
FILE
 *
fe
, 
táphdr
 **
dµ
, 
ù
, 
cÚv”t
)

169 
bfs
[
cu¼’t
].
couÁ”
 = 
ù
;

170 
cu¼’t
 = !current;

171 ià(
bfs
[
cu¼’t
].
couÁ”
 !ğ
BF_FREE
)

172 
	`wr™e_behšd
(
fe
, 
cÚv”t
);

173 
bfs
[
cu¼’t
].
couÁ”
 = 
BF_ALLOC
;

174 *
dµ
 = (
táphdr
 *)
bfs
[
cu¼’t
].
buf
;

175  
ù
;

176 
	}
}

184 
	$wr™e_behšd
(
FILE
 *
fe
, 
cÚv”t
)

186 *
buf
;

187 
couÁ
;

188 
ù
;

189 *
p
;

190 
c
;

191 
bf
 *
b
;

192 
táphdr
 *
dp
;

194 
b
 = &
bfs
[
ÃxtÚe
];

195 ià(
b
->
couÁ”
 < -1)

198 
couÁ
 = 
b
->
couÁ”
;

199 
b
->
couÁ”
 = 
BF_FREE
;

200 
dp
 = (
táphdr
 *)
b
->
buf
;

201 
ÃxtÚe
 = !nextone;

202 
buf
 = 
dp
->
th_d©a
;

204 ià(
couÁ
 <= 0)  -1;

206 ià(
cÚv”t
 == 0)

207  
	`wr™e
(
	`f’o
(
fe
), 
buf
, 
couÁ
);

209 
p
 = 
buf
;

210 
ù
 = 
couÁ
;

211 
ù
--) {

212 
c
 = *
p
++;

213 ià(
´evch¬
 == '\r') {

214 ià(
c
 == '\n')

215 
	`f£ek
(
fe
, -1, 1);

217 ià(
c
 == '\0')

218 
sk™
;

221 
	`putc
(
c
, 
fe
);

222 
sk™
:

223 
´evch¬
 = 
c
;

225  
couÁ
;

226 
	}
}

240 
	$synchÃt
(
f
)

242 
j
 = 0;

243 
dummy
;

246 ià(
	`»cv
(
f
, &
dummy
, 1, 
MSG_DONTWAIT
) < 0)

248 
j
++;

250  
j
;

251 
	}
}

	@tracepath.c

12 
	~<¡dio.h
>

13 
	~<¡dlib.h
>

14 
	~<uni¡d.h
>

15 
	~<sys/sock‘.h
>

16 
	~<lšux/ty³s.h
>

17 
	~<lšux/”rqueue.h
>

18 
	~<”ºo.h
>

19 
	~<¡ršg.h
>

20 
	~<Ãtdb.h
>

21 
	~<Ãtš‘/š.h
>

22 
	~<»sŞv.h
>

23 
	~<sys/time.h
>

24 
	~<sys/uio.h
>

25 
	~<¬·/š‘.h
>

26 #ifdeà
USE_IDN


27 
	~<idÇ.h
>

28 
	~<loÿË.h
>

31 #iâdeà
IP_PMTUDISC_PROBE


32 
	#IP_PMTUDISC_PROBE
 3

	)

35 
	shhi¡Üy


37 
	mhİs
;

38 
timev®
 
	m£ndtime
;

41 
hhi¡Üy
 
	ghis
[64];

42 
	ghi¥Œ
;

44 
sockaddr_š
 
	grg‘
;

45 
__u16
 
	gba£_pÜt
;

47 cÚ¡ 
	gov”h—d
 = 28;

48 
	gmtu
 = 65535;

49 *
	gpktbuf
;

50 
	ghİs_to
 = -1;

51 
	ghİs_äom
 = -1;

52 
	gno_»sŞve
 = 0;

53 
	gshow_bÙh
 = 0;

55 
	#HOST_COLUMN_SIZE
 52

	)

57 
	s´obehdr


59 
__u32
 
	m‰l
;

60 
timev®
 
	mtv
;

63 
	$d©a_wa™
(
fd
)

65 
fd_£t
 
fds
;

66 
timev®
 
tv
;

67 
	`FD_ZERO
(&
fds
);

68 
	`FD_SET
(
fd
, &
fds
);

69 
tv
.
tv_£c
 = 1;

70 
tv
.
tv_u£c
 = 0;

71 
	`£Ëù
(
fd
+1, &
fds
, 
NULL
, NULL, &
tv
);

72 
	}
}

74 
	$´št_ho¡
(cÚ¡ *
a
, cÚ¡ *
b
, 
bÙh
)

76 
¶’
 = 0;

77 
	`´štf
("%s", 
a
);

78 
¶’
 = 
	`¡¾’
(
a
);

79 ià(
bÙh
) {

80 
	`´štf
(" (%s)", 
b
);

81 
¶’
 +ğ
	`¡¾’
(
b
) + 3;

83 ià(
¶’
 >ğ
HOST_COLUMN_SIZE
)

84 
¶’
 = 
HOST_COLUMN_SIZE
 - 1;

85 
	`´štf
("%*s", 
HOST_COLUMN_SIZE
 - 
¶’
, "");

86 
	}
}

88 
	$»cv”r
(
fd
, 
‰l
)

90 
»s
;

91 
´obehdr
 
rcvbuf
;

92 
cbuf
[512];

93 
iovec
 
iov
;

94 
msghdr
 
msg
;

95 
cmsghdr
 *
cmsg
;

96 
sock_ex‹nded_”r
 *
e
;

97 
sockaddr_š
 
addr
;

98 
timev®
 
tv
;

99 
timev®
 *
»‰v
;

100 
¦Ù
;

101 
»thİs
;

102 
¢dhİs
;

103 
´og»ss
 = -1;

104 
brok’_rou‹r
;

106 
»¡¬t
:

107 
	`mem£t
(&
rcvbuf
, -1, (rcvbuf));

108 
iov
.
iov_ba£
 = &
rcvbuf
;

109 
iov
.
iov_Ën
 = (
rcvbuf
);

110 
msg
.
msg_Çme
 = (
__u8
*)&
addr
;

111 
msg
.
msg_Çm–’
 = (
addr
);

112 
msg
.
msg_iov
 = &
iov
;

113 
msg
.
msg_iovËn
 = 1;

114 
msg
.
msg_æags
 = 0;

115 
msg
.
msg_cÚŒŞ
 = 
cbuf
;

116 
msg
.
msg_cÚŒŞËn
 = (
cbuf
);

118 
	`g‘timeofday
(&
tv
, 
NULL
);

119 
»s
 = 
	`»cvmsg
(
fd
, &
msg
, 
MSG_ERRQUEUE
);

120 ià(
»s
 < 0) {

121 ià(
”ºo
 =ğ
EAGAIN
)

122  
´og»ss
;

123 
»¡¬t
;

126 
´og»ss
 = 
mtu
;

128 
»thİs
 = -1;

129 
¢dhİs
 = -1;

130 
e
 = 
NULL
;

131 
»‰v
 = 
NULL
;

132 
¦Ù
 = 
	`Áohs
(
addr
.
sš_pÜt
è- 
ba£_pÜt
;

133 ià(
¦Ù
>=0 && slÙ < 63 && 
his
[¦Ù].
hİs
) {

134 
¢dhİs
 = 
his
[
¦Ù
].
hİs
;

135 
»‰v
 = &
his
[
¦Ù
].
£ndtime
;

136 
his
[
¦Ù
].
hİs
 = 0;

138 
brok’_rou‹r
 = 0;

139 ià(
»s
 =ğ(
rcvbuf
)) {

140 ià(
rcvbuf
.
‰l
 =ğ0 ||„cvbuf.
tv
.
tv_£c
 == 0) {

141 
brok’_rou‹r
 = 1;

143 
¢dhİs
 = 
rcvbuf
.
‰l
;

144 
»‰v
 = &
rcvbuf
.
tv
;

148 
cmsg
 = 
	`CMSG_FIRSTHDR
(&
msg
); cmsg; cmsg = 
	`CMSG_NXTHDR
(&msg, cmsg)) {

149 ià(
cmsg
->
cmsg_Ëv–
 =ğ
SOL_IP
) {

150 ià(
cmsg
->
cmsg_ty³
 =ğ
IP_RECVERR
) {

151 
e
 = (
sock_ex‹nded_”r
 *è
	`CMSG_DATA
(
cmsg
);

152 } ià(
cmsg
->
cmsg_ty³
 =ğ
IP_TTL
) {

153 
	`memıy
(&
»thİs
, 
	`CMSG_DATA
(
cmsg
), (rethops));

155 
	`´štf
("cmsg:%d\À", 
cmsg
->
cmsg_ty³
);

159 ià(
e
 =ğ
NULL
) {

160 
	`´štf
("no info\n");

163 ià(
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_LOCAL
) {

164 
	`´štf
("%2d?: %* ", 
‰l
, -(
HOST_COLUMN_SIZE
 - 1), "[LOCALHOST]");

165 } ià(
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_ICMP
) {

166 
abuf
[128];

167 
sockaddr_š
 *
sš
 = (sockaddr_š*)(
e
+1);

168 
ho¡’t
 *
h
 = 
NULL
;

169 *
idn
 = 
NULL
;

171 
	`š‘_Áİ
(
AF_INET
, &
sš
->
sš_addr
, 
abuf
, (abuf));

173 ià(
¢dhİs
>0)

174 
	`´štf
("%2d: ", 
¢dhİs
);

176 
	`´štf
("%2d?: ", 
‰l
);

178 ià(!
no_»sŞve
 || 
show_bÙh
) {

179 
	`fæush
(
¡dout
);

180 
h
 = 
	`g‘ho¡byaddr
((*è&
sš
->
sš_addr
, (sš->sš_addr), 
AF_INET
);

183 #ifdeà
USE_IDN


184 ià(
h
 && 
	`idÇ_to_unicode_lzlz
(h->
h_Çme
, &
idn
, 0è!ğ
IDNA_SUCCESS
)

185 
idn
 = 
NULL
;

187 ià(
no_»sŞve
)

188 
	`´št_ho¡
(
abuf
, 
h
 ? (
idn
 ? idÀ: h->
h_Çme
è:‡buf, 
show_bÙh
);

190 
	`´št_ho¡
(
h
 ? (
idn
 ? idÀ: h->
h_Çme
è: 
abuf
,‡buf, 
show_bÙh
);

192 #ifdeà
USE_IDN


193 
	`ä“
(
idn
);

197 ià(
»‰v
) {

198 
diff
 = (
tv
.
tv_£c
-
»‰v
->tv_£c)*1000000+Ñv.
tv_u£c
-rettv->tv_usec);

199 
	`´štf
("%3d.%03dm ", 
diff
/1000, diff%1000);

200 ià(
brok’_rou‹r
)

201 
	`´štf
("(This broken„outer„eturned corrupted…ayload) ");

204 
e
->
“_”ºo
) {

205 
ETIMEDOUT
:

206 
	`´štf
("\n");

208 
EMSGSIZE
:

209 
	`´štf
("pmtu %d\n", 
e
->
“_šfo
);

210 
mtu
 = 
e
->
“_šfo
;

211 
´og»ss
 = 
mtu
;

213 
ECONNREFUSED
:

214 
	`´štf
("reached\n");

215 
hİs_to
 = 
¢dhİs
<0 ? 
‰l
 : sndhops;

216 
hİs_äom
 = 
»thİs
;

218 
EPROTO
:

219 
	`´štf
("!P\n");

221 
EHOSTUNREACH
:

222 ià(
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_ICMP
 &&

223 
e
->
“_ty³
 == 11 &&

224 
e
->
“_code
 == 0) {

225 ià(
»thİs
>=0) {

226 ià(
»thİs
<=64)

227 
»thİs
 = 65-rethops;

228 ià(
»thİs
<=128)

229 
»thİs
 = 129-rethops;

231 
»thİs
 = 256-rethops;

232 ià(
¢dhİs
>=0 && 
»thİs
 != sndhops)

233 
	`´štf
("asymm %2d ", 
»thİs
);

234 ià(
¢dhİs
<0 && 
»thİs
 !ğ
‰l
)

235 
	`´štf
("asymm %2d ", 
»thİs
);

237 
	`´štf
("\n");

240 
	`´štf
("!H\n");

242 
ENETUNREACH
:

243 
	`´štf
("!N\n");

245 
EACCES
:

246 
	`´štf
("!A\n");

249 
	`´štf
("\n");

250 
”ºo
 = 
e
->
“_”ºo
;

251 
	`³¼Ü
("NET ERROR");

254 
»¡¬t
;

255 
	}
}

257 
	$´obe_‰l
(
fd
, 
‰l
)

259 
i
;

260 
´obehdr
 *
hdr
 = 
pktbuf
;

262 
	`mem£t
(
pktbuf
, 0, 
mtu
);

263 
»¡¬t
:

264 
i
=0; i<10; i++) {

265 
»s
;

267 
hdr
->
‰l
 =tl;

268 
rg‘
.
sš_pÜt
 = 
	`htÚs
(
ba£_pÜt
 + 
hi¥Œ
);

269 
	`g‘timeofday
(&
hdr
->
tv
, 
NULL
);

270 
his
[
hi¥Œ
].
hİs
 = 
‰l
;

271 
his
[
hi¥Œ
].
£ndtime
 = 
hdr
->
tv
;

272 ià(
	`£ndto
(
fd
, 
pktbuf
, 
mtu
-
ov”h—d
, 0, (
sockaddr
*)&
rg‘
, (target)) > 0)

274 
»s
 = 
	`»cv”r
(
fd
, 
‰l
);

275 
his
[
hi¥Œ
].
hİs
 = 0;

276 ià(
»s
==0)

278 ià(
»s
 > 0)

279 
»¡¬t
;

281 
hi¥Œ
 = (hisptr + 1)&63;

283 ià(
i
<10) {

284 
	`d©a_wa™
(
fd
);

285 ià(
	`»cv
(
fd
, 
pktbuf
, 
mtu
, 
MSG_DONTWAIT
) > 0) {

286 
	`´štf
("%2d?:„•ly„eûived 8)\n", 
‰l
);

289  
	`»cv”r
(
fd
, 
‰l
);

292 
	`´štf
("%2d: s’d faed\n", 
‰l
);

294 
	}
}

296 
	$u§ge
(è
	`__©Œibu‹
((
nÜ‘uº
));

298 
	$u§ge
()

300 
	`årštf
(
¡d”r
, "Usage:racepath [-n] [-b] [-l <len>] [-p…ort] <destination>\n");

301 
	`ex™
(-1);

302 
	}
}

305 
	$maš
(
¬gc
, **
¬gv
)

307 
ho¡’t
 *
he
;

308 
fd
;

309 
Ú
;

310 
‰l
;

311 *
p
;

312 
ch
;

313 #ifdeà
USE_IDN


314 
rc
;

315 
	`£oÿË
(
LC_ALL
, "");

318 (
ch
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "nbh?l:p:")è!ğ
EOF
) {

319 
ch
) {

321 
no_»sŞve
 = 1;

324 
show_bÙh
 = 1;

327 ià((
mtu
 = 
	`©oi
(
İrg
)è<ğ
ov”h—d
) {

328 
	`årštf
(
¡d”r
, "Error:…ktlen must be > %d‡nd <= %d.\n",

329 
ov”h—d
, 
INT_MAX
);

330 
	`ex™
(1);

334 
ba£_pÜt
 = 
	`©oi
(
İrg
);

337 
	`u§ge
();

341 
¬gc
 -ğ
İtšd
;

342 
¬gv
 +ğ
İtšd
;

344 ià(
¬gc
 != 1)

345 
	`u§ge
();

347 
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

348 ià(
fd
 < 0) {

349 
	`³¼Ü
("socket");

350 
	`ex™
(1);

352 
rg‘
.
sš_çmy
 = 
AF_INET
;

355 ià(!
ba£_pÜt
) {

356 
p
 = 
	`¡rchr
(
¬gv
[0], '/');

357 ià(
p
) {

358 *
p
 = 0;

359 
ba£_pÜt
 = 
	`©oi
(
p
+1);

361 
ba£_pÜt
 = 44444;

364 
p
 = 
¬gv
[0];

365 #ifdeà
USE_IDN


366 
rc
 = 
	`idÇ_to_ascii_lz
(
¬gv
[0], &
p
, 0);

367 ià(
rc
 !ğ
IDNA_SUCCESS
) {

368 
	`årštf
(
¡d”r
, "IDNAƒncodšg faed: %s\n", 
	`idÇ_¡»¼Ü
(
rc
));

369 
	`ex™
(2);

373 
he
 = 
	`g‘ho¡byÇme
(
p
);

374 ià(
he
 =ğ
NULL
) {

375 
	`h”rÜ
("gethostbyname");

376 
	`ex™
(1);

379 #ifdeà
USE_IDN


380 
	`ä“
(
p
);

383 
	`memıy
(&
rg‘
.
sš_addr
, 
he
->
h_addr
, 4);

385 
Ú
 = 
IP_PMTUDISC_PROBE
;

386 ià(
	`£tsockİt
(
fd
, 
SOL_IP
, 
IP_MTU_DISCOVER
, &
Ú
, (on)) &&

387 (
Ú
 = 
IP_PMTUDISC_DO
,

388 
	`£tsockİt
(
fd
, 
SOL_IP
, 
IP_MTU_DISCOVER
, &
Ú
, (on)))) {

389 
	`³¼Ü
("IP_MTU_DISCOVER");

390 
	`ex™
(1);

392 
Ú
 = 1;

393 ià(
	`£tsockİt
(
fd
, 
SOL_IP
, 
IP_RECVERR
, &
Ú
, (on))) {

394 
	`³¼Ü
("IP_RECVERR");

395 
	`ex™
(1);

397 ià(
	`£tsockİt
(
fd
, 
SOL_IP
, 
IP_RECVTTL
, &
Ú
, (on))) {

398 
	`³¼Ü
("IP_RECVTTL");

399 
	`ex™
(1);

402 
pktbuf
 = 
	`m®loc
(
mtu
);

403 ià(!
pktbuf
) {

404 
	`³¼Ü
("malloc");

405 
	`ex™
(1);

408 
‰l
=1;tl<32;tl++) {

409 
»s
;

410 
i
;

412 
Ú
 = 
‰l
;

413 ià(
	`£tsockİt
(
fd
, 
SOL_IP
, 
IP_TTL
, &
Ú
, (on))) {

414 
	`³¼Ü
("IP_TTL");

415 
	`ex™
(1);

418 
»¡¬t
:

419 
i
=0; i<3; i++) {

420 
Şd_mtu
;

422 
Şd_mtu
 = 
mtu
;

423 
»s
 = 
	`´obe_‰l
(
fd
, 
‰l
);

424 ià(
mtu
 !ğ
Şd_mtu
)

425 
»¡¬t
;

426 ià(
»s
 == 0)

427 
dÚe
;

428 ià(
»s
 > 0)

432 ià(
»s
 < 0)

433 
	`´štf
("%2d:‚Ø»¶y\n", 
‰l
);

435 
	`´štf
(" ToØmªy hİs:…mtu %d\n", 
mtu
);

436 
dÚe
:

437 
	`´štf
(" Resume:…mtu %d ", 
mtu
);

438 ià(
hİs_to
>=0)

439 
	`´štf
("hİ %d ", 
hİs_to
);

440 ià(
hİs_äom
>=0)

441 
	`´štf
("back %d ", 
hİs_äom
);

442 
	`´štf
("\n");

443 
	`ex™
(0);

444 
	}
}

	@tracepath6.c

12 
	~<¡dio.h
>

13 
	~<¡dlib.h
>

14 
	~<uni¡d.h
>

15 
	~<sys/sock‘.h
>

16 
	~<Ãtš‘/š.h
>

17 
	~<Ãtš‘/icmp6.h
>

19 
	~<lšux/ty³s.h
>

20 
	~<lšux/”rqueue.h
>

21 
	~<”ºo.h
>

22 
	~<¡ršg.h
>

23 
	~<Ãtdb.h
>

24 
	~<»sŞv.h
>

25 
	~<sys/time.h
>

26 
	~<sys/uio.h
>

27 
	~<¬·/š‘.h
>

29 #ifdeà
USE_IDN


30 
	~<idÇ.h
>

31 
	~<loÿË.h
>

34 #iâdeà
SOL_IPV6


35 
	#SOL_IPV6
 
IPPROTO_IPV6


	)

38 #iâdeà
IP_PMTUDISC_DO


39 
	#IP_PMTUDISC_DO
 3

	)

41 #iâdeà
IPV6_PMTUDISC_DO


42 
	#IPV6_PMTUDISC_DO
 3

	)

45 
	shhi¡Üy


47 
	mhİs
;

48 
timev®
 
	m£ndtime
;

51 
hhi¡Üy
 
	ghis
[64];

52 
	ghi¥Œ
;

54 
§_çmy_t
 
	gçmy
 = 
AF_INET6
;

55 
sockaddr_¡Üage
 
	grg‘
;

56 
sockËn_t
 
	grg‘Ën
;

57 
__u16
 
	gba£_pÜt
;

59 
	gov”h—d
;

60 
	gmtu
;

61 *
	gpktbuf
;

62 
	ghİs_to
 = -1;

63 
	ghİs_äom
 = -1;

64 
	gno_»sŞve
 = 0;

65 
	gshow_bÙh
 = 0;

66 
	gm­³d
;

68 
	#HOST_COLUMN_SIZE
 52

	)

70 
	s´obehdr


72 
__u32
 
	m‰l
;

73 
timev®
 
	mtv
;

76 
	$d©a_wa™
(
fd
)

78 
fd_£t
 
fds
;

79 
timev®
 
tv
;

80 
	`FD_ZERO
(&
fds
);

81 
	`FD_SET
(
fd
, &
fds
);

82 
tv
.
tv_£c
 = 1;

83 
tv
.
tv_u£c
 = 0;

84 
	`£Ëù
(
fd
+1, &
fds
, 
NULL
, NULL, &
tv
);

85 
	}
}

87 
	$´št_ho¡
(cÚ¡ *
a
, cÚ¡ *
b
, 
bÙh
)

89 
¶’
 = 0;

90 
	`´štf
("%s", 
a
);

91 
¶’
 = 
	`¡¾’
(
a
);

92 ià(
bÙh
) {

93 
	`´štf
(" (%s)", 
b
);

94 
¶’
 +ğ
	`¡¾’
(
b
) + 3;

96 ià(
¶’
 >ğ
HOST_COLUMN_SIZE
)

97 
¶’
 = 
HOST_COLUMN_SIZE
 - 1;

98 
	`´štf
("%*s", 
HOST_COLUMN_SIZE
 - 
¶’
, "");

99 
	}
}

101 
	$»cv”r
(
fd
, 
‰l
)

103 
»s
;

104 
´obehdr
 
rcvbuf
;

105 
cbuf
[512];

106 
iovec
 
iov
;

107 
msghdr
 
msg
;

108 
cmsghdr
 *
cmsg
;

109 
sock_ex‹nded_”r
 *
e
;

110 
sockaddr_¡Üage
 
addr
;

111 
timev®
 
tv
;

112 
timev®
 *
»‰v
;

113 
¦Ù
 = 0;

114 
»thİs
;

115 
¢dhİs
;

116 
´og»ss
 = -1;

117 
brok’_rou‹r
;

119 
»¡¬t
:

120 
	`mem£t
(&
rcvbuf
, -1, (rcvbuf));

121 
iov
.
iov_ba£
 = &
rcvbuf
;

122 
iov
.
iov_Ën
 = (
rcvbuf
);

123 
msg
.
msg_Çme
 = (
ÿddr_t
)&
addr
;

124 
msg
.
msg_Çm–’
 = (
addr
);

125 
msg
.
msg_iov
 = &
iov
;

126 
msg
.
msg_iovËn
 = 1;

127 
msg
.
msg_æags
 = 0;

128 
msg
.
msg_cÚŒŞ
 = 
cbuf
;

129 
msg
.
msg_cÚŒŞËn
 = (
cbuf
);

131 
	`g‘timeofday
(&
tv
, 
NULL
);

132 
»s
 = 
	`»cvmsg
(
fd
, &
msg
, 
MSG_ERRQUEUE
);

133 ià(
»s
 < 0) {

134 ià(
”ºo
 =ğ
EAGAIN
)

135  
´og»ss
;

136 
»¡¬t
;

139 
´og»ss
 = 
mtu
;

141 
»thİs
 = -1;

142 
¢dhİs
 = -1;

143 
e
 = 
NULL
;

144 
»‰v
 = 
NULL
;

146 
¦Ù
 = -
ba£_pÜt
;

147 
çmy
) {

148 
AF_INET6
:

149 
¦Ù
 +ğ
	`Áohs
(((
sockaddr_š6
 *)&
addr
)->
sš6_pÜt
);

151 
AF_INET
:

152 
¦Ù
 +ğ
	`Áohs
(((
sockaddr_š
 *)&
addr
)->
sš_pÜt
);

156 ià(
¦Ù
 >ğ0 && slÙ < 63 && 
his
[¦Ù].
hİs
) {

157 
¢dhİs
 = 
his
[
¦Ù
].
hİs
;

158 
»‰v
 = &
his
[
¦Ù
].
£ndtime
;

159 
his
[
¦Ù
].
hİs
 = 0;

161 
brok’_rou‹r
 = 0;

162 ià(
»s
 =ğ(
rcvbuf
)) {

163 ià(
rcvbuf
.
‰l
 =ğ0 ||„cvbuf.
tv
.
tv_£c
 == 0)

164 
brok’_rou‹r
 = 1;

166 
¢dhİs
 = 
rcvbuf
.
‰l
;

167 
»‰v
 = &
rcvbuf
.
tv
;

171 
cmsg
 = 
	`CMSG_FIRSTHDR
(&
msg
); cmsg; cmsg = 
	`CMSG_NXTHDR
(&msg, cmsg)) {

172 
cmsg
->
cmsg_Ëv–
) {

173 
SOL_IPV6
:

174 
cmsg
->
cmsg_ty³
) {

175 
IPV6_RECVERR
:

176 
e
 = (
sock_ex‹nded_”r
 *)
	`CMSG_DATA
(
cmsg
);

178 
IPV6_HOPLIMIT
:

179 #ifdeà
IPV6_2292HOPLIMIT


180 
IPV6_2292HOPLIMIT
:

182 
	`memıy
(&
»thİs
, 
	`CMSG_DATA
(
cmsg
), (rethops));

185 
	`´štf
("cmsg6:%d\À", 
cmsg
->
cmsg_ty³
);

188 
SOL_IP
:

189 
cmsg
->
cmsg_ty³
) {

190 
IP_RECVERR
:

191 
e
 = (
sock_ex‹nded_”r
 *)
	`CMSG_DATA
(
cmsg
);

193 
IP_TTL
:

194 
»thİs
 = *(
__u8
*)
	`CMSG_DATA
(
cmsg
);

197 
	`´štf
("cmsg4:%d\À", 
cmsg
->
cmsg_ty³
);

201 ià(
e
 =ğ
NULL
) {

202 
	`´štf
("no info\n");

205 ià(
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_LOCAL
)

206 
	`´štf
("%2d?: %-32 ", 
‰l
, "[LOCALHOST]");

207 ià(
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_ICMP6
 ||

208 
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_ICMP
) {

209 
abuf
[
NI_MAXHOST
], 
hbuf
[NI_MAXHOST];

210 
sockaddr
 *
§
 = (sockadd¸*)(
e
 + 1);

211 
sockËn_t
 
§Ën
;

213 ià(
¢dhİs
>0)

214 
	`´štf
("%2d: ", 
¢dhİs
);

216 
	`´štf
("%2d?: ", 
‰l
);

218 
§
->
§_çmy
) {

219 
AF_INET6
:

220 
§Ën
 = (
sockaddr_š6
);

222 
AF_INET
:

223 
§Ën
 = (
sockaddr_š
);

226 
§Ën
 = 0;

229 ià(
no_»sŞve
 || 
show_bÙh
) {

230 ià(
	`g‘Çmešfo
(
§
, 
§Ën
,

231 
abuf
, ×buf), 
NULL
, 0,

232 
NI_NUMERICHOST
))

233 
	`¡rıy
(
abuf
, "???");

235 
abuf
[0] = 0;

237 ià(!
no_»sŞve
 || 
show_bÙh
) {

238 
	`fæush
(
¡dout
);

239 ià(
	`g‘Çmešfo
(
§
, 
§Ën
,

240 
hbuf
, (hbuf), 
NULL
, 0,

242 #ifdeà
USE_IDN


243 | 
NI_IDN


246 
	`¡rıy
(
hbuf
, "???");

248 
hbuf
[0] = 0;

250 ià(
no_»sŞve
)

251 
	`´št_ho¡
(
abuf
, 
hbuf
, 
show_bÙh
);

253 
	`´št_ho¡
(
hbuf
, 
abuf
, 
show_bÙh
);

256 ià(
»‰v
) {

257 
diff
 = (
tv
.
tv_£c
-
»‰v
->tv_£c)*1000000+Ñv.
tv_u£c
-rettv->tv_usec);

258 
	`´štf
("%3d.%03dm ", 
diff
/1000, diff%1000);

259 ià(
brok’_rou‹r
)

260 
	`´štf
("(This broken„outer„eturned corrupted…ayload) ");

263 
e
->
“_”ºo
) {

264 
ETIMEDOUT
:

265 
	`´štf
("\n");

267 
EMSGSIZE
:

268 
	`´štf
("pmtu %d\n", 
e
->
“_šfo
);

269 
mtu
 = 
e
->
“_šfo
;

270 
´og»ss
 = 
mtu
;

272 
ECONNREFUSED
:

273 
	`´štf
("reached\n");

274 
hİs_to
 = 
¢dhİs
<0 ? 
‰l
 : sndhops;

275 
hİs_äom
 = 
»thİs
;

277 
EPROTO
:

278 
	`´štf
("!P\n");

280 
EHOSTUNREACH
:

281 ià((
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_ICMP
 &&

282 
e
->
“_ty³
 == 11 &&

283 
e
->
“_code
 == 0) ||

284 (
e
->
“_Üigš
 =ğ
SO_EE_ORIGIN_ICMP6
 &&

285 
e
->
“_ty³
 == 3 &&

286 
e
->
“_code
 == 0)) {

287 ià(
»thİs
>=0) {

288 ià(
»thİs
<=64)

289 
»thİs
 = 65-rethops;

290 ià(
»thİs
<=128)

291 
»thİs
 = 129-rethops;

293 
»thİs
 = 256-rethops;

294 ià(
¢dhİs
>=0 && 
»thİs
 != sndhops)

295 
	`´štf
("asymm %2d ", 
»thİs
);

296 ià(
¢dhİs
<0 && 
»thİs
 !ğ
‰l
)

297 
	`´štf
("asymm %2d ", 
»thİs
);

299 
	`´štf
("\n");

302 
	`´štf
("!H\n");

304 
ENETUNREACH
:

305 
	`´štf
("!N\n");

307 
EACCES
:

308 
	`´štf
("!A\n");

311 
	`´štf
("\n");

312 
”ºo
 = 
e
->
“_”ºo
;

313 
	`³¼Ü
("NET ERROR");

316 
»¡¬t
;

317 
	}
}

319 
	$´obe_‰l
(
fd
, 
‰l
)

321 
i
;

322 
´obehdr
 *
hdr
 = 
pktbuf
;

324 
	`mem£t
(
pktbuf
, 0, 
mtu
);

325 
»¡¬t
:

327 
i
=0; i<10; i++) {

328 
»s
;

330 
hdr
->
‰l
 =tl;

331 
çmy
) {

332 
AF_INET6
:

333 ((
sockaddr_š6
 *)&
rg‘
)->
sš6_pÜt
 = 
	`htÚs
(
ba£_pÜt
 + 
hi¥Œ
);

335 
AF_INET
:

336 ((
sockaddr_š
 *)&
rg‘
)->
sš_pÜt
 = 
	`htÚs
(
ba£_pÜt
 + 
hi¥Œ
);

339 
	`g‘timeofday
(&
hdr
->
tv
, 
NULL
);

340 
his
[
hi¥Œ
].
hİs
 = 
‰l
;

341 
his
[
hi¥Œ
].
£ndtime
 = 
hdr
->
tv
;

342 ià(
	`£ndto
(
fd
, 
pktbuf
, 
mtu
-
ov”h—d
, 0, (
sockaddr
 *)&
rg‘
, 
rg‘Ën
) > 0)

344 
»s
 = 
	`»cv”r
(
fd
, 
‰l
);

345 
his
[
hi¥Œ
].
hİs
 = 0;

346 ià(
»s
==0)

348 ià(
»s
 > 0)

349 
»¡¬t
;

351 
hi¥Œ
 = (hisptr + 1) & 63;

353 ià(
i
<10) {

354 
	`d©a_wa™
(
fd
);

355 ià(
	`»cv
(
fd
, 
pktbuf
, 
mtu
, 
MSG_DONTWAIT
) > 0) {

356 
	`´štf
("%2d?:„•ly„eûived 8)\n", 
‰l
);

359  
	`»cv”r
(
fd
, 
‰l
);

362 
	`´štf
("%2d: s’d faed\n", 
‰l
);

364 
	}
}

366 
	$u§ge
(è
	`__©Œibu‹
((
nÜ‘uº
));

368 
	$u§ge
()

370 
	`årštf
(
¡d”r
, "Usage:racepath6 [-n] [-b] [-l <len>] [-p…ort] <destination>\n");

371 
	`ex™
(-1);

372 
	}
}

375 
	$maš
(
¬gc
, **
¬gv
)

377 
fd
;

378 
Ú
;

379 
‰l
;

380 *
p
;

381 
addršfo
 
hšts
, *
ai
, *
ai0
;

382 
ch
;

383 
gai
;

384 
pbuf
[
NI_MAXSERV
];

386 #ifdeà
USE_IDN


387 
	`£oÿË
(
LC_ALL
, "");

390 (
ch
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "nbh?l:p:")è!ğ
EOF
) {

391 
ch
) {

393 
no_»sŞve
 = 1;

396 
show_bÙh
 = 1;

399 
mtu
 = 
	`©oi
(
İrg
);

402 
ba£_pÜt
 = 
	`©oi
(
İrg
);

405 
	`u§ge
();

409 
¬gc
 -ğ
İtšd
;

410 
¬gv
 +ğ
İtšd
;

412 ià(
¬gc
 != 1)

413 
	`u§ge
();

416 ià(!
ba£_pÜt
) {

417 
p
 = 
	`¡rchr
(
¬gv
[0], '/');

418 ià(
p
) {

419 *
p
 = 0;

420 
ba£_pÜt
 = ()
	`©oi
(
p
+1);

422 
ba£_pÜt
 = 44444;

425 
	`¥rštf
(
pbuf
, "%u", 
ba£_pÜt
);

427 
	`mem£t
(&
hšts
, 0, (hints));

428 
hšts
.
ai_çmy
 = 
çmy
;

429 
hšts
.
ai_sockty³
 = 
SOCK_DGRAM
;

430 
hšts
.
ai_´ÙocŞ
 = 
IPPROTO_UDP
;

431 #ifdeà
USE_IDN


432 
hšts
.
ai_æags
 = 
AI_IDN
;

434 
gai
 = 
	`g‘addršfo
(
¬gv
[0], 
pbuf
, &
hšts
, &
ai0
);

435 ià(
gai
) {

436 
	`årštf
(
¡d”r
, "g‘addršfo: %s\n", 
	`gai_¡»¼Ü
(
gai
));

437 
	`ex™
(1);

440 
fd
 = -1;

441 
ai
 = 
ai0
;‡i;‡˜ğai->
ai_Ãxt
) {

443 ià(
çmy
 && 
ai
->
ai_çmy
 != family)

445 ià(
ai
->
ai_çmy
 !ğ
AF_INET6
 &&

446 
ai
->
ai_çmy
 !ğ
AF_INET
)

448 
çmy
 = 
ai
->
ai_çmy
;

449 
fd
 = 
	`sock‘
(
ai
->
ai_çmy
,‡i->
ai_sockty³
,‡i->
ai_´ÙocŞ
);

450 ià(
fd
 < 0)

452 
	`memıy
(&
rg‘
, 
ai
->
ai_addr
, (target));

453 
rg‘Ën
 = 
ai
->
ai_add¾’
;

456 ià(
fd
 < 0) {

457 
	`³¼Ü
("socket/connect");

458 
	`ex™
(1);

460 
	`ä“addršfo
(
ai0
);

462 
çmy
) {

463 
AF_INET6
:

464 
ov”h—d
 = 48;

465 ià(!
mtu
)

466 
mtu
 = 128000;

467 ià(
mtu
 <ğ
ov”h—d
)

468 
pk’_”rÜ
;

470 
Ú
 = 
IPV6_PMTUDISC_DO
;

471 ià(
	`£tsockİt
(
fd
, 
SOL_IPV6
, 
IPV6_MTU_DISCOVER
, &
Ú
, (on)) &&

472 (
Ú
 = 
IPV6_PMTUDISC_DO
,

473 
	`£tsockİt
(
fd
, 
SOL_IPV6
, 
IPV6_MTU_DISCOVER
, &
Ú
, (on)))) {

474 
	`³¼Ü
("IPV6_MTU_DISCOVER");

475 
	`ex™
(1);

477 
Ú
 = 1;

478 ià(
	`£tsockİt
(
fd
, 
SOL_IPV6
, 
IPV6_RECVERR
, &
Ú
, (on))) {

479 
	`³¼Ü
("IPV6_RECVERR");

480 
	`ex™
(1);

483 #ifdeà
IPV6_RECVHOPLIMIT


484 
	`£tsockİt
(
fd
, 
SOL_IPV6
, 
IPV6_HOPLIMIT
, &
Ú
, (on)) &&

485 
	`£tsockİt
(
fd
, 
SOL_IPV6
, 
IPV6_2292HOPLIMIT
, &
Ú
, (on))

487 
	`£tsockİt
(
fd
, 
SOL_IPV6
, 
IPV6_HOPLIMIT
, &
Ú
, (on))

490 
	`³¼Ü
("IPV6_HOPLIMIT");

491 
	`ex™
(1);

493 ià(!
	`IN6_IS_ADDR_V4MAPPED
(&(((
sockaddr_š6
 *)&
rg‘
)->
sš6_addr
)))

495 
m­³d
 = 1;

497 
AF_INET
:

498 
ov”h—d
 = 28;

499 ià(!
mtu
)

500 
mtu
 = 65535;

501 ià(
mtu
 <ğ
ov”h—d
)

502 
pk’_”rÜ
;

504 
Ú
 = 
IP_PMTUDISC_DO
;

505 ià(
	`£tsockİt
(
fd
, 
SOL_IP
, 
IP_MTU_DISCOVER
, &
Ú
, (on))) {

506 
	`³¼Ü
("IP_MTU_DISCOVER");

507 
	`ex™
(1);

509 
Ú
 = 1;

510 ià(
	`£tsockİt
(
fd
, 
SOL_IP
, 
IP_RECVERR
, &
Ú
, (on))) {

511 
	`³¼Ü
("IP_RECVERR");

512 
	`ex™
(1);

514 ià(
	`£tsockİt
(
fd
, 
SOL_IP
, 
IP_RECVTTL
, &
Ú
, (on))) {

515 
	`³¼Ü
("IP_RECVTTL");

516 
	`ex™
(1);

520 
pktbuf
 = 
	`m®loc
(
mtu
);

521 ià(!
pktbuf
) {

522 
	`³¼Ü
("malloc");

523 
	`ex™
(1);

526 
‰l
=1;tl<32;tl++) {

527 
»s
;

528 
i
;

530 
Ú
 = 
‰l
;

531 
çmy
) {

532 
AF_INET6
:

533 ià(
	`£tsockİt
(
fd
, 
SOL_IPV6
, 
IPV6_UNICAST_HOPS
, &
Ú
, (on))) {

534 
	`³¼Ü
("IPV6_UNICAST_HOPS");

535 
	`ex™
(1);

537 ià(!
m­³d
)

540 
AF_INET
:

541 ià(
	`£tsockİt
(
fd
, 
SOL_IP
, 
IP_TTL
, &
Ú
, (on))) {

542 
	`³¼Ü
("IP_TTL");

543 
	`ex™
(1);

547 
»¡¬t
:

548 
i
=0; i<3; i++) {

549 
Şd_mtu
;

551 
Şd_mtu
 = 
mtu
;

552 
»s
 = 
	`´obe_‰l
(
fd
, 
‰l
);

553 ià(
mtu
 !ğ
Şd_mtu
)

554 
»¡¬t
;

555 ià(
»s
 == 0)

556 
dÚe
;

557 ià(
»s
 > 0)

561 ià(
»s
 < 0)

562 
	`´štf
("%2d:‚Ø»¶y\n", 
‰l
);

564 
	`´štf
(" ToØmªy hİs:…mtu %d\n", 
mtu
);

566 
dÚe
:

567 
	`´štf
(" Resume:…mtu %d ", 
mtu
);

568 ià(
hİs_to
>=0)

569 
	`´štf
("hİ %d ", 
hİs_to
);

570 ià(
hİs_äom
>=0)

571 
	`´štf
("back %d ", 
hİs_äom
);

572 
	`´štf
("\n");

573 
	`ex™
(0);

575 
pk’_”rÜ
:

576 
	`årštf
(
¡d”r
, "Error:…ktlen must be > %d‡nd <= %d\n",

577 
ov”h—d
, 
INT_MAX
);

578 
	`ex™
(1);

579 
	}
}

	@traceroute6.c

56 #iâdeà
lšt


57 
	gcİyright
[] =

233 
	~<sys/·¿m.h
>

234 
	~<sys/time.h
>

235 
	~<sys/sock‘.h
>

236 
	~<sys/fe.h
>

237 
	~<sys/ioùl.h
>

238 
	~<Ãt/if.h
>

240 #ià
__lšux__


241 
	~<’dŸn.h
>

243 
	~<Ãtš‘/š_sy¡m.h
>

244 
	~<Ãtš‘/š.h
>

245 
	~<Ãtš‘/.h
>

246 
	~<Ãtš‘/_icmp.h
>

247 
	~<Ãtš‘/udp.h
>

249 
	~<Ãtš‘/6.h
>

250 
	~<Ãtš‘/icmp6.h
>

251 
	~<lšux/ty³s.h
>

252 #ifdeà
CAPABILITIES


253 
	~<sys/ÿ·b™y.h
>

256 #ifdeà
USE_IDN


257 
	~<idÇ.h
>

258 
	~<loÿË.h
>

261 
	~<¬·/š‘.h
>

263 
	~<Ãtdb.h
>

264 
	~<¡dio.h
>

265 
	~<”ºo.h
>

266 
	~<¡dlib.h
>

267 
	~<¡ršg.h
>

268 
	~<uni¡d.h
>

270 
	~"SNAPSHOT.h
"

272 #iâdeà
SOL_IPV6


273 
	#SOL_IPV6
 
IPPROTO_IPV6


	)

276 
	#MAXPACKET
 65535

	)

277 
	#MAX_HOSTNAMELEN
 
NI_MAXHOST


	)

279 #iâdeà
FD_SET


280 
	#NFDBITS
 (8*(
fd_£t
))

	)

281 
	#FD_SETSIZE
 
NFDBITS


	)

282 
	#FD_SET
(
n
, 
p
è(Õ)->
fds_b™s
[Ò)/
NFDBITS
] |ğ(1 << (Òè% NFDBITS)))

	)

283 
	#FD_CLR
(
n
, 
p
è(Õ)->
fds_b™s
[Ò)/
NFDBITS
] &ğ~(1 << (Òè% NFDBITS)))

	)

284 
	#FD_ISSET
(
n
, 
p
è(Õ)->
fds_b™s
[Ò)/
NFDBITS
] & (1 << (Òè% NFDBITS)))

	)

285 
	#FD_ZERO
(
p
è
	`mem£t
((*)Õ), 0, (*Õ)))

	)

288 
	#F´štf
 ()
årštf


	)

289 
	#Prštf
 ()
´štf


	)

291 
u_ch¬
 
	g·ck‘
[512];

293 
wa™_fÜ_»¶y
(, 
sockaddr_š6
 *, 
š6_addr
 *, );

294 
·ck‘_ok
(
u_ch¬
 *
buf
, 
cc
, 
sockaddr_š6
 *
äom
,

295 
š6_addr
 *
to
, 
£q
, 
timev®
 *);

296 
£nd_´obe
(
£q
, 
‰l
);

297 
d–T
 (
timev®
 *, timeval *);

298 
´št
(*
buf
, 
cc
, 
sockaddr_š6
 *
äom
);

299 
tvsub
 (
timev®
 *, timeval *);

300 
u§ge
();

302 
	gicmp_sock
;

303 
	g¢dsock
;

304 
timezÚe
 
	gtz
;

306 
sockaddr_š6
 
	gwh”‘o
;

308 
sockaddr_š6
 
	g§ddr
;

309 
sockaddr_š6
 
	gfœ¡hİ
;

310 *
	gsourû
 = 
NULL
;

311 *
	gdeviû
 = 
NULL
;

312 *
	gho¡Çme
;

314 
	gÅrobes
 = 3;

315 
	gmax_‰l
 = 30;

316 
pid_t
 
	gid’t
;

317 
u_shÜt
 
	gpÜt
 = 32768+666;

318 
	gİtiÚs
;

319 
	gv”bo£
;

320 
	gwa™time
 = 5;

321 
	gnæag
;

324 
	spkt_fÜm©


326 
__u32
 
	mid’t
;

327 
__u32
 
	m£q
;

328 
timev®
 
	mtv
;

331 *
	g£ndbuff
;

332 
	gd©®’
 = (
pkt_fÜm©
);

336 
	$maš
(
¬gc
, *
¬gv
[])

338 
·
[
MAX_HOSTNAMELEN
];

339 *
İrg
;

340 
İtšd
;

341 
ho¡’t
 *
hp
;

342 
sockaddr_š6
 
äom
, *
to
;

343 
ch
, 
i
, 
Ú
, 
´obe
, 
£q
, 
tos
, 
‰l
;

344 
sock‘_”ºo
;

346 
icmp_sock
 = 
	`sock‘
(
AF_INET6
, 
SOCK_RAW
, 
IPPROTO_ICMPV6
);

347 
sock‘_”ºo
 = 
”ºo
;

349 ià(
	`£tuid
(
	`g‘uid
())) {

350 
	`³¼Ü
("traceroute6: setuid");

351 
	`ex™
(-1);

353 #ifdeà
CAPABILITIES


355 
ÿp_t
 
ÿps
 = 
	`ÿp_š™
();

356 ià(
	`ÿp_£t_´oc
(
ÿps
)) {

357 
	`³¼Ü
("traceroute6: cap_set_proc");

358 
	`ex™
(-1);

360 
	`ÿp_ä“
(
ÿps
);

364 #ifdeà
USE_IDN


365 
	`£oÿË
(
LC_ALL
, "");

368 
Ú
 = 1;

369 
£q
 = 
tos
 = 0;

370 
to
 = (
sockaddr_š6
 *)&
wh”‘o
;

371 (
ch
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "dm:Å:q:rs:t:w:vi:g:V")è!ğ
EOF
) {

372 
ch
) {

374 
İtiÚs
 |ğ
SO_DEBUG
;

377 
max_‰l
 = 
	`©oi
(
İrg
);

378 ià(
max_‰l
 <= 1) {

379 
	`F´štf
(
¡d”r
,

381 
	`ex™
(1);

385 
næag
++;

388 
pÜt
 = 
	`©oi
(
İrg
);

389 ià(
pÜt
 < 1) {

390 
	`F´štf
(
¡d”r
,

392 
	`ex™
(1);

396 
Årobes
 = 
	`©oi
(
İrg
);

397 ià(
Årobes
 < 1) {

398 
	`F´štf
(
¡d”r
,

400 
	`ex™
(1);

404 
İtiÚs
 |ğ
SO_DONTROUTE
;

411 
sourû
 = 
İrg
;

414 
deviû
 = 
İrg
;

417 
	`F´štf
(
¡d”r
, "Sorry,„thdr is‚ot yet supported\n");

420 
v”bo£
++;

423 
wa™time
 = 
	`©oi
(
İrg
);

424 ià(
wa™time
 <= 1) {

425 
	`F´štf
(
¡d”r
,

427 
	`ex™
(1);

431 
	`´štf
("Œaûrou‹6 ut™y, iputs-%s\n", 
SNAPSHOT
);

432 
	`ex™
(0);

434 
	`u§ge
();

437 
¬gc
 -ğ
İtšd
;

438 
¬gv
 +ğ
İtšd
;

440 ià(
¬gc
 < 1)

441 
	`u§ge
();

443 
	`£šebuf
 (
¡dout
);

445 (è
	`mem£t
((*)&
wh”‘o
, 0, (whereto));

447 
to
->
sš6_çmy
 = 
AF_INET6
;

448 
to
->
sš6_pÜt
 = 
	`htÚs
(
pÜt
);

450 ià(
	`š‘_±Ú
(
AF_INET6
, *
¬gv
, &
to
->
sš6_addr
) > 0) {

451 
ho¡Çme
 = *
¬gv
;

453 *
idn
 = 
NULL
;

454 #ifdeà
USE_IDN


455 ià(
	`idÇ_to_ascii_lz
(*
¬gv
, &
idn
, 0è!ğ
IDNA_SUCCESS
)

456 
idn
 = 
NULL
;

458 
hp
 = 
	`g‘ho¡byÇme2
(
idn
 ? idÀ: *
¬gv
, 
AF_INET6
);

459 ià(
hp
) {

460 
	`memmove
((
ÿddr_t
)&
to
->
sš6_addr
, 
hp
->
h_addr
, (to->sin6_addr));

461 
ho¡Çme
 = (*)
hp
->
h_Çme
;

463 ()
	`årštf
(
¡d”r
,

464 "Œaûrou‹: unknowÀho¡ %s\n", *
¬gv
);

465 
	`ex™
(1);

468 
fœ¡hİ
 = *
to
;

469 ià(*++
¬gv
) {

470 
d©®’
 = 
	`©oi
(*
¬gv
);

474 ià(
d©®’
 == 0)

475 
d©®’
 = (
pkt_fÜm©
);

476 ià(
d©®’
 < ()(
pkt_fÜm©
) ||

477 
d©®’
 >ğ
MAXPACKET
) {

478 
	`F´štf
(
¡d”r
,

480 ()(
pkt_fÜm©
), 
MAXPACKET
);

481 
	`ex™
(1);

485 
id’t
 = 
	`g‘pid
();

487 
£ndbuff
 = 
	`m®loc
(
d©®’
);

488 ià(
£ndbuff
 =ğ
NULL
) {

489 
	`årštf
(
¡d”r
, "malloc failed\n");

490 
	`ex™
(1);

493 ià(
icmp_sock
 < 0) {

494 
”ºo
 = 
sock‘_”ºo
;

495 
	`³¼Ü
("traceroute6: icmp socket");

496 
	`ex™
(1);

499 #ifdeà
IPV6_RECVPKTINFO


500 
	`£tsockİt
(
icmp_sock
, 
SOL_IPV6
, 
IPV6_RECVPKTINFO
, &
Ú
, (on));

501 
	`£tsockİt
(
icmp_sock
, 
SOL_IPV6
, 
IPV6_2292PKTINFO
, &
Ú
, (on));

503 
	`£tsockİt
(
icmp_sock
, 
SOL_IPV6
, 
IPV6_PKTINFO
, &
Ú
, (on));

506 ià(
İtiÚs
 & 
SO_DEBUG
)

507 
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_DEBUG
,

508 (*)&
Ú
, (on));

509 ià(
İtiÚs
 & 
SO_DONTROUTE
)

510 
	`£tsockİt
(
icmp_sock
, 
SOL_SOCKET
, 
SO_DONTROUTE
,

511 (*)&
Ú
, (on));

513 #ifdeà
__lšux__


514 
Ú
 = 2;

515 ià(
	`£tsockİt
(
icmp_sock
, 
SOL_RAW
, 
IPV6_CHECKSUM
, &
Ú
, (on)) < 0) {

519 
	`årštf
(
¡d”r
, "setsockopt(RAW_CHECKSUM) failed -ryo continue.");

523 ià((
¢dsock
 = 
	`sock‘
(
AF_INET6
, 
SOCK_DGRAM
, 0)) < 0) {

524 
	`³¼Ü
("traceroute: UDP socket");

525 
	`ex™
(5);

527 #ifdeà
SO_SNDBUF


528 ià(
	`£tsockİt
(
¢dsock
, 
SOL_SOCKET
, 
SO_SNDBUF
, (*)&
d©®’
,

529 (
d©®’
)) < 0) {

530 
	`³¼Ü
("traceroute: SO_SNDBUF");

531 
	`ex™
(6);

535 ià(
İtiÚs
 & 
SO_DEBUG
)

536 (è
	`£tsockİt
(
¢dsock
, 
SOL_SOCKET
, 
SO_DEBUG
,

537 (*)&
Ú
, (on));

538 ià(
İtiÚs
 & 
SO_DONTROUTE
)

539 (è
	`£tsockİt
(
¢dsock
, 
SOL_SOCKET
, 
SO_DONTROUTE
,

540 (*)&
Ú
, (on));

542 ià(
sourû
 =ğ
NULL
) {

543 
sockËn_t
 
®’
;

544 
´obe_fd
 = 
	`sock‘
(
AF_INET6
, 
SOCK_DGRAM
, 0);

546 ià(
´obe_fd
 < 0) {

547 
	`³¼Ü
("socket");

548 
	`ex™
(1);

550 ià(
deviû
) {

551 ià(
	`£tsockİt
(
´obe_fd
, 
SOL_SOCKET
, 
SO_BINDTODEVICE
, 
deviû
, 
	`¡¾’
(device)+1) == -1)

552 
	`³¼Ü
("WARNING: interface is ignored");

554 
fœ¡hİ
.
sš6_pÜt
 = 
	`htÚs
(1025);

555 ià(
	`cÚÃù
(
´obe_fd
, (
sockaddr
*)&
fœ¡hİ
, (firsthop)) == -1) {

556 
	`³¼Ü
("connect");

557 
	`ex™
(1);

559 
®’
 = (
§ddr
);

560 ià(
	`g‘sockÇme
(
´obe_fd
, (
sockaddr
*)&
§ddr
, &
®’
) == -1) {

561 
	`³¼Ü
("getsockname");

562 
	`ex™
(1);

564 
§ddr
.
sš6_pÜt
 = 0;

565 
	`şo£
(
´obe_fd
);

567 (è
	`mem£t
((*)&
§ddr
, 0, (saddr));

568 
§ddr
.
sš6_çmy
 = 
AF_INET6
;

569 ià(
	`š‘_±Ú
(
AF_INET6
, 
sourû
, &
§ddr
.
sš6_addr
) <= 0)

571 
	`Prštf
("Œaûrou‹: unknowÀadd¸%s\n", 
sourû
);

572 
	`ex™
(1);

576 ià(
	`bšd
(
¢dsock
, (
sockaddr
 *)&
§ddr
, (saddr)) < 0) {

577 
	`³¼Ü
 ("traceroute: bind sending socket");

578 
	`ex™
 (1);

580 ià(
	`bšd
(
icmp_sock
, (
sockaddr
 *)&
§ddr
, (saddr)) < 0) {

581 
	`³¼Ü
 ("traceroute: bind icmp6 socket");

582 
	`ex™
 (1);

585 
	`F´štf
(
¡d”r
, "Œaûrou‹Ø% (%s)", 
ho¡Çme
,

586 
	`š‘_Áİ
(
AF_INET6
, &
to
->
sš6_addr
, 
·
, (pa)));

588 
	`F´štf
(
¡d”r
, " from %s",

589 
	`š‘_Áİ
(
AF_INET6
, &
§ddr
.
sš6_addr
, 
·
, (pa)));

590 
	`F´štf
(
¡d”r
, ", %d hİ max, %d by‹…ack‘s\n", 
max_‰l
, 
d©®’
);

591 (è
	`fæush
(
¡d”r
);

593 
‰l
 = 1; <ğ
max_‰l
; ++ttl) {

594 
š6_addr
 
Ï¡addr
 = {{{0,}}};

595 
gÙ_th”e
 = 0;

596 
uÄ—chabË
 = 0;

598 
	`Prštf
("%2d ", 
‰l
);

599 
´obe
 = 0;…rob< 
Årobes
; ++probe) {

600 
cc
, 
»£t_tim”
;

601 
timev®
 
t1
, 
t2
;

602 
timezÚe
 
tz
;

603 
š6_addr
 
to
;

605 
	`g‘timeofday
(&
t1
, &
tz
);

606 
	`£nd_´obe
(++
£q
, 
‰l
);

607 
»£t_tim”
 = 1;

609 (
cc
 = 
	`wa™_fÜ_»¶y
(
icmp_sock
, &
äom
, &
to
, 
»£t_tim”
)) != 0) {

610 
	`g‘timeofday
(&
t2
, &
tz
);

611 ià((
i
 = 
	`·ck‘_ok
(
·ck‘
, 
cc
, &
äom
, &
to
, 
£q
, &
t1
))) {

612 
»£t_tim”
 = 1;

613 ià(
	`memcmp
(&
äom
.
sš6_addr
, &
Ï¡addr
, (from.sin6_addr))) {

614 
	`´št
(
·ck‘
, 
cc
, &
äom
);

615 
	`memıy
(&
Ï¡addr
,

616 &
äom
.
sš6_addr
,

617 (
Ï¡addr
));

619 
	`Prštf
(" %g ms", 
	`d–T
(&
t1
, &
t2
));

620 
i
 - 1) {

621 
ICMP6_DST_UNREACH_NOPORT
:

622 ++
gÙ_th”e
;

625 
ICMP6_DST_UNREACH_NOROUTE
:

626 ++
uÄ—chabË
;

627 
	`Prštf
(" !N");

629 
ICMP6_DST_UNREACH_ADDR
:

630 ++
uÄ—chabË
;

631 
	`Prštf
(" !H");

634 
ICMP6_DST_UNREACH_ADMIN
:

635 ++
uÄ—chabË
;

636 
	`Prštf
(" !S");

641 
»£t_tim”
 = 0;

643 ià(
cc
 <= 0)

644 
	`Prštf
(" *");

645 (è
	`fæush
(
¡dout
);

647 
	`putch¬
('\n');

648 ià(
gÙ_th”e
 ||

649 (
uÄ—chabË
 > 0 && uÄ—chabË >ğ
Årobes
-1))

650 
	`ex™
(0);

654 
	}
}

657 
	$wa™_fÜ_»¶y
(
sock
, 
äom
, 
to
, 
»£t_tim”
)

658 
sock
;

659 
sockaddr_š6
 *
äom
;

660 
š6_addr
 *
to
;

661 
»£t_tim”
;

663 
fd_£t
 
fds
;

664 
timev®
 
wa™
;

665 
cc
 = 0;

666 
cbuf
[512];

668 
	`FD_ZERO
(&
fds
);

669 
	`FD_SET
(
sock
, &
fds
);

670 ià(
»£t_tim”
) {

683 
wa™
.
tv_£c
 = 
wa™time
;

684 
wa™
.
tv_u£c
 = 0;

687 ià(
	`£Ëù
(
sock
+1, &
fds
, (
fd_£t
 *)0, (fd_£ˆ*)0, &
wa™
) > 0) {

688 
iovec
 
iov
;

689 
msghdr
 
msg
;

690 
iov
.
iov_ba£
 = 
·ck‘
;

691 
iov
.
iov_Ën
 = (
·ck‘
);

692 
msg
.
msg_Çme
 = (*)
äom
;

693 
msg
.
msg_Çm–’
 = (*
äom
);

694 
msg
.
msg_iov
 = &
iov
;

695 
msg
.
msg_iovËn
 = 1;

696 
msg
.
msg_æags
 = 0;

697 
msg
.
msg_cÚŒŞ
 = 
cbuf
;

698 
msg
.
msg_cÚŒŞËn
 = (
cbuf
);

700 
cc
 = 
	`»cvmsg
(
icmp_sock
, &
msg
, 0);

701 ià(
cc
 >= 0) {

702 
cmsghdr
 *
cmsg
;

703 
š6_pktšfo
 *
i
;

705 
cmsg
 = 
	`CMSG_FIRSTHDR
(&
msg
);

706 
cmsg
;

707 
cmsg
 = 
	`CMSG_NXTHDR
(&
msg
, cmsg)) {

708 ià(
cmsg
->
cmsg_Ëv–
 !ğ
SOL_IPV6
)

710 
cmsg
->
cmsg_ty³
) {

711 
IPV6_PKTINFO
:

712 #ifdeà
IPV6_2292PKTINFO


713 
IPV6_2292PKTINFO
:

715 
i
 = (
š6_pktšfo
 *)
	`CMSG_DATA
(
cmsg
);

716 
	`memıy
(
to
, 
i
, (*to));

722 (
cc
);

723 
	}
}

726 
	$£nd_´obe
(
£q
, 
‰l
)

728 
pkt_fÜm©
 *
pkt
 = (pkt_fÜm© *è
£ndbuff
;

729 
i
;

731 
pkt
->
id’t
 = 
	`htÚl
(ident);

732 
pkt
->
£q
 = 
	`htÚl
(seq);

733 
	`g‘timeofday
(&
pkt
->
tv
, &
tz
);

735 
i
 = 
	`£tsockİt
(
¢dsock
, 
SOL_IPV6
, 
IPV6_UNICAST_HOPS
, &
‰l
, (ttl));

736 ià(
i
 < 0)

738 
	`³¼Ü
("setsockopt");

739 
	`ex™
(1);

743 
i
 = 
	`£ndto
(
¢dsock
, 
£ndbuff
, 
d©®’
, 0,

744 (
sockaddr
 *)&
wh”‘o
, (whereto));

745 } 
i
<0 && 
”ºo
 =ğ
ECONNREFUSED
);

747 ià(
i
 < 0 || i !ğ
d©®’
) {

748 ià(
i
<0)

749 
	`³¼Ü
("sendto");

750 
	`Prštf
("Œaûrou‹: wrÙ% %d ch¬s,„‘=%d\n", 
ho¡Çme
,

751 
d©®’
, 
i
);

752 (è
	`fæush
(
¡dout
);

754 
	}
}

757 
	$d–T
(
timev®
 *
t1p
, timev® *
t2p
)

759 
dt
;

761 
dt
 = ()(
t2p
->
tv_£c
 - 
t1p
->tv_sec) * 1000.0 +

762 ()(
t2p
->
tv_u£c
 - 
t1p
->tv_usec) / 1000.0;

763  (
dt
);

764 
	}
}

770 * 
	$´_ty³
(
t
)

772 
t
) {

821 
	}
}

824 
	$·ck‘_ok
(
u_ch¬
 *
buf
, 
cc
, 
sockaddr_š6
 *
äom
,

825 
š6_addr
 *
to
, 
£q
,

826 
timev®
 *
tv
)

828 
icmp6_hdr
 *
iı
;

829 
u_ch¬
 
ty³
, 
code
;

831 
iı
 = (
icmp6_hdr
 *è
buf
;

833 
ty³
 = 
iı
->
icmp6_ty³
;

834 
code
 = 
iı
->
icmp6_code
;

836 ià((
ty³
 =ğ
ICMP6_TIME_EXCEEDED
 && 
code
 =ğ
ICMP6_TIME_EXCEED_TRANSIT
) ||

837 
ty³
 =ğ
ICMP6_DST_UNREACH
)

839 
6_hdr
 *
h
;

840 
udphdr
 *
up
;

841 
Ãxthdr
;

843 
h
 = (
6_hdr
 *è(
iı
 + 1);

844 
up
 = (
udphdr
 *)(
h
+1);

845 
Ãxthdr
 = 
h
->
6_nxt
;

847 ià(
Ãxthdr
 == 44) {

848 
Ãxthdr
 = *(*)
up
;

849 
up
++;

851 ià(
Ãxthdr
 =ğ
IPPROTO_UDP
)

853 
pkt_fÜm©
 *
pkt
;

855 
pkt
 = (
pkt_fÜm©
 *è(
up
 + 1);

857 ià(
	`Áohl
(
pkt
->
id’t
) == ident &&

858 
	`Áohl
(
pkt
->
£q
) == seq)

860 *
tv
 = 
pkt
->tv;

861  (
ty³
 =ğ
ICMP6_TIME_EXCEEDED
 ? -1 : 
code
+1);

867 ià(
v”bo£
) {

868 *
p
;

869 
·1
[
MAX_HOSTNAMELEN
];

870 
·2
[
MAX_HOSTNAMELEN
];

871 
i
;

873 
p
 = (*è(
iı
 + 1);

875 
	`Prštf
("\n%d by‹ äom % tØ%s", 
cc
,

876 
	`š‘_Áİ
(
AF_INET6
, &
äom
->
sš6_addr
, 
·1
, (pa1)),

877 
	`š‘_Áİ
(
AF_INET6
, 
to
, 
·2
, (pa2)));

879 
	`Prštf
(": icm°ty³ %d (%sècod%d\n", 
ty³
, 
	`´_ty³
(type),

880 
iı
->
icmp6_code
);

882 
cc
 -ğ(
icmp6_hdr
);

883 
i
 = 0; i < 
cc
 ; i++) {

884 ià(
i
 % 16 == 0)

885 
	`Prštf
("%04x:", 
i
);

886 ià(
i
 % 4 == 0)

887 
	`Prštf
(" ");

888 
	`Prštf
("%02x", 0xfà& ()
p
[
i
]);

889 ià(
i
 % 16 =ğ15 && i + 1 < 
cc
)

890 
	`Prštf
("\n");

892 
	`Prštf
("\n");

896 
	}
}

899 
	$´št
(*
buf
, 
cc
, 
sockaddr_š6
 *
äom
)

901 
·
[
MAX_HOSTNAMELEN
];

903 ià(
næag
)

904 
	`Prštf
(" %s", 
	`š‘_Áİ
(
AF_INET6
, &
äom
->
sš6_addr
,

905 
·
, (pa)));

908 cÚ¡ *
ho¡Çme
;

909 
ho¡’t
 *
hp
;

910 *
s
 = 
NULL
;

912 
ho¡Çme
 = 
	`š‘_Áİ
(
AF_INET6
, &
äom
->
sš6_addr
, 
·
, (pa));

914 ià((
hp
 = 
	`g‘ho¡byaddr
((*)&
äom
->
sš6_addr
,

915 (
äom
->
sš6_addr
), 
AF_INET6
))) {

916 #ifdeà
USE_IDN


917 ià(
	`idÇ_to_unicode_lzlz
(
hp
->
h_Çme
, &
s
, 0è!ğ
IDNA_SUCCESS
)

918 
s
 = 
NULL
;

922 
	`Prštf
(" % (%s)", 
hp
 ? (
s
 ? s : hp->
h_Çme
è: 
ho¡Çme
, 
·
);

924 
	`ä“
(
s
);

926 
	}
}

934 
	$tvsub
(
out
, 
š
)

935 
timev®
 *
out
, *
š
;

937 ià((
out
->
tv_u£c
 -ğ
š
->tv_usec) < 0) {

938 
out
->
tv_£c
--;

939 
out
->
tv_u£c
 += 1000000;

941 
out
->
tv_£c
 -ğ
š
->tv_sec;

942 
	}
}

944 
	$u§ge
()

946 
	`årštf
(
¡d”r
,

949 
	`ex™
(1);

950 
	}
}

	@/usr/include/arpa/inet.h

18 #iâdeà
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<Ãtš‘/š.h
>

25 #iâdeà
__sockËn_t_defšed


26 
__sockËn_t
 
	tsockËn_t
;

27 
	#__sockËn_t_defšed


	)

30 
__BEGIN_DECLS


34 
š_addr_t
 
	$š‘_addr
 (cÚ¡ *
__ı
è
__THROW
;

37 
š_addr_t
 
	$š‘_Êaof
 (
š_addr
 
__š
è
__THROW
;

41 
š_addr
 
	$š‘_mak—ddr
 (
š_addr_t
 
__Ãt
, in_addr_ˆ
__ho¡
)

42 
__THROW
;

45 
š_addr_t
 
	$š‘_Ãtof
 (
š_addr
 
__š
è
__THROW
;

49 
š_addr_t
 
	$š‘_ÃtwÜk
 (cÚ¡ *
__ı
è
__THROW
;

53 *
	$š‘_Áß
 (
š_addr
 
__š
è
__THROW
;

58 
	$š‘_±Ú
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

59 *
__»¡riù
 
__buf
è
__THROW
;

64 cÚ¡ *
	$š‘_Áİ
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

65 *
__»¡riù
 
__buf
, 
sockËn_t
 
__Ën
)

66 
__THROW
;

70 #ifdeà
__USE_MISC


73 
	$š‘_©Ú
 (cÚ¡ *
__ı
, 
š_addr
 *
__šp
è
__THROW
;

77 *
	$š‘_Ã
 (
š_addr_t
 
__Ãt
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

82 *
	$š‘_Ãt_Áİ
 (
__af
, cÚ¡ *
__ı
, 
__b™s
,

83 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

88 
	$š‘_Ãt_±Ú
 (
__af
, cÚ¡ *
__ı
,

89 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

94 
	$š‘_n§p_addr
 (cÚ¡ *
__ı
,

95 *
__buf
, 
__Ën
è
__THROW
;

99 *
	$š‘_n§p_Áß
 (
__Ën
, cÚ¡ *
__ı
,

100 *
__buf
è
__THROW
;

103 
__END_DECLS


	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__exùy³
 (
i§Êum
);

111 
__exùy³
 (
i§Íha
);

112 
__exùy³
 (
isúŒl
);

113 
__exùy³
 (
isdig™
);

114 
__exùy³
 (
i¦ow”
);

115 
__exùy³
 (
isg¿ph
);

116 
__exùy³
 (
i¥ršt
);

117 
__exùy³
 (
i¥unù
);

118 
__exùy³
 (
is¥aû
);

119 
__exùy³
 (
isuµ”
);

120 
__exùy³
 (
isxdig™
);

124 
	$tŞow”
 (
__c
è
__THROW
;

127 
	$touµ”
 (
__c
è
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__exùy³
 (
isbÏnk
);

138 
__END_NAMESPACE_C99


141 #ifdeà
__USE_GNU


143 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

146 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


150 
	$i§scii
 (
__c
è
__THROW
;

154 
	$tßscii
 (
__c
è
__THROW
;

158 
	`__exùy³
 (
_touµ”
);

159 
	`__exùy³
 (
_tŞow”
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

164 (
__ex‹nsiÚ__
 \

165 ({ 
__»s
; \

166 ià( (
c
) > 1) \

168 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

174 
__»s
 = 
f
 
¬gs
; \

177 
__»s
 = (
a
)[(è(
c
)]; \

178 
__»s
; 
	}
}))

	)

180 #ià!
defšed
 
__NO_CTYPE


181 #ifdeà
__isùy³_f


182 
	$__isùy³_f
 (
®num
)

183 
	$__isùy³_f
 (
®pha
)

184 
	$__isùy³_f
 (
úŒl
)

185 
	$__isùy³_f
 (
dig™
)

186 
	$__isùy³_f
 (
low”
)

187 
	$__isùy³_f
 (
g¿ph
)

188 
	$__isùy³_f
 (
´št
)

189 
	$__isùy³_f
 (
punù
)

190 
	$__isùy³_f
 (
¥aû
)

191 
	$__isùy³_f
 (
uµ”
)

192 
	$__isùy³_f
 (
xdig™
)

193 #ifdeà
__USE_ISOC99


194 
	$__isùy³_f
 (
bÏnk
)

196 #–ià
defšed
 
__isùy³


197 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

198 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

199 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

200 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

201 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

202 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

203 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

204 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

205 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

206 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

207 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

208 #ifdeà
__USE_ISOC99


209 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

213 #ifdeà
__USE_EXTERN_INLINES


214 
__ex‹º_šlše
 

215 
	`__NTH
 (
	$tŞow”
 (
__c
))

217  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

218 
	}
}

220 
__ex‹º_šlše
 

221 
__NTH
 (
	$touµ”
 (
__c
))

223  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

224 
	}
}

227 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


228 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

229 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

232 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


233 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

234 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

236 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

237 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

243 #ifdeà
__USE_XOPEN2K8


257 
	~<xloÿË.h
>

261 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

262 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

264 
	#__exùy³_l
(
Çme
) \

265 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

271 
__exùy³_l
 (
i§Êum_l
);

272 
__exùy³_l
 (
i§Íha_l
);

273 
__exùy³_l
 (
isúŒl_l
);

274 
__exùy³_l
 (
isdig™_l
);

275 
__exùy³_l
 (
i¦ow”_l
);

276 
__exùy³_l
 (
isg¿ph_l
);

277 
__exùy³_l
 (
i¥ršt_l
);

278 
__exùy³_l
 (
i¥unù_l
);

279 
__exùy³_l
 (
is¥aû_l
);

280 
__exùy³_l
 (
isuµ”_l
);

281 
__exùy³_l
 (
isxdig™_l
);

283 
__exùy³_l
 (
isbÏnk_l
);

287 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

288 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

291 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

292 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

294 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


295 
	#__tŞow”_l
(
c
, 
loÿË
) \

296 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

297 
	#__touµ”_l
(
c
, 
loÿË
) \

298 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

299 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

300 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

304 #iâdeà
__NO_CTYPE


305 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

306 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

307 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

308 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

309 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

310 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

311 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

312 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

313 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

314 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

315 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

317 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

319 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


320 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

321 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

324 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

325 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

326 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

327 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

328 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

329 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

330 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

331 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

332 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

333 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

334 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

336 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

338 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


339 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

340 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/dirent.h

22 #iâdef 
_DIRENT_H


23 
	#_DIRENT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdeà
__USE_XOPEN


32 #iâdeà
__šo_t_defšed


33 #iâdeà
__USE_FILE_OFFSET64


34 
__šo_t
 
	tšo_t
;

36 
__šo64_t
 
	tšo_t
;

38 
	#__šo_t_defšed


	)

40 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


41 
__šo64_t
 
	tšo64_t
;

42 
	#__šo64_t_defšed


	)

61 
	~<b™s/dœ’t.h
>

63 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
è&& !defšed 
d_f’o


64 
	#d_šo
 
d_f’o


	)

81 #ifdeà
_DIRENT_HAVE_D_NAMLEN


82 
	#_D_EXACT_NAMLEN
(
d
è((d)->
d_ÇmËn
)

	)

83 
	#_D_ALLOC_NAMLEN
(
d
è(
	`_D_EXACT_NAMLEN
 (dè+ 1)

	)

85 
	#_D_EXACT_NAMLEN
(
d
è(
	`¡¾’
 ((d)->
d_Çme
))

	)

86 #ifdeà
_DIRENT_HAVE_D_RECLEN


87 
	#_D_ALLOC_NAMLEN
(
d
è(((*è(dè+ (d)->
d_»ş’
è- &(d)->
d_Çme
[0])

	)

89 
	#_D_ALLOC_NAMLEN
(
d
è( (d)->
d_Çme
 > 1 ?  (d)->d_name : \

90 
	`_D_EXACT_NAMLEN
 (
d
è+ 1)

	)

95 #ifdeà
__USE_BSD


99 
	mDT_UNKNOWN
 = 0,

100 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

101 
	mDT_FIFO
 = 1,

102 
	#DT_FIFO
 
DT_FIFO


	)

103 
	mDT_CHR
 = 2,

104 
	#DT_CHR
 
DT_CHR


	)

105 
	mDT_DIR
 = 4,

106 
	#DT_DIR
 
DT_DIR


	)

107 
	mDT_BLK
 = 6,

108 
	#DT_BLK
 
DT_BLK


	)

109 
	mDT_REG
 = 8,

110 
	#DT_REG
 
DT_REG


	)

111 
	mDT_LNK
 = 10,

112 
	#DT_LNK
 
DT_LNK


	)

113 
	mDT_SOCK
 = 12,

114 
	#DT_SOCK
 
DT_SOCK


	)

115 
	mDT_WHT
 = 14

116 
	#DT_WHT
 
DT_WHT


	)

120 
	#IFTODT
(
mode
è(((modeè& 0170000è>> 12)

	)

121 
	#DTTOIF
(
dœty³
è((dœty³è<< 12)

	)

127 
__dœ¡»am
 
	tDIR
;

134 
DIR
 *
	$İ’dœ
 (cÚ¡ *
__Çme
è
	`__nÚnuÎ
 ((1));

136 #ifdeà
__USE_XOPEN2K8


141 
DIR
 *
	`fdİ’dœ
 (
__fd
);

149 
	$şo£dœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

161 #iâdeà
__USE_FILE_OFFSET64


162 
dœ’t
 *
	$»addœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

164 #ifdeà
__REDIRECT


165 
dœ’t
 *
	`__REDIRECT
 (
»addœ
, (
DIR
 *
__dœp
), 
»addœ64
)

166 
	`__nÚnuÎ
 ((1));

168 
	#»addœ
 
»addœ64


	)

172 #ifdeà
__USE_LARGEFILE64


173 
dœ’t64
 *
	$»addœ64
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

176 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


182 #iâdeà
__USE_FILE_OFFSET64


183 
	$»addœ_r
 (
DIR
 *
__»¡riù
 
__dœp
,

184 
dœ’t
 *
__»¡riù
 
__’Œy
,

185 
dœ’t
 **
__»¡riù
 
__»suÉ
)

186 
	`__nÚnuÎ
 ((1, 2, 3));

188 #ifdeà
__REDIRECT


189 
	`__REDIRECT
 (
»addœ_r
,

190 (
DIR
 *
__»¡riù
 
__dœp
,

191 
dœ’t
 *
__»¡riù
 
__’Œy
,

192 
dœ’t
 **
__»¡riù
 
__»suÉ
),

193 
»addœ64_r
è
	`__nÚnuÎ
 ((1, 2, 3));

195 
	#»addœ_r
 
»addœ64_r


	)

199 #ifdeà
__USE_LARGEFILE64


200 
	$»addœ64_r
 (
DIR
 *
__»¡riù
 
__dœp
,

201 
dœ’t64
 *
__»¡riù
 
__’Œy
,

202 
dœ’t64
 **
__»¡riù
 
__»suÉ
)

203 
	`__nÚnuÎ
 ((1, 2, 3));

208 
	$»wšddœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

210 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


211 
	~<b™s/ty³s.h
>

214 
	$£ekdœ
 (
DIR
 *
__dœp
, 
__pos
è
__THROW
 
	`__nÚnuÎ
 ((1));

217 
	$‹Îdœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

220 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN2K8


223 
	$dœfd
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 #ià
defšed
 
__OPTIMIZE__
 && defšed 
_DIR_dœfd


226 
	#dœfd
(
dœp
è
	`_DIR_dœfd
 (dœp)

	)

229 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC


230 #iâdeà
MAXNAMLEN


232 
	~<b™s/posix1_lim.h
>

235 #ifdeà
NAME_MAX


236 
	#MAXNAMLEN
 
NAME_MAX


	)

238 
	#MAXNAMLEN
 255

	)

243 
	#__Ãed_size_t


	)

244 
	~<¡ddef.h
>

253 #iâdeà
__USE_FILE_OFFSET64


254 
	`sÿndœ
 (cÚ¡ *
__»¡riù
 
__dœ
,

255 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

256 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

257 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

258 cÚ¡ 
dœ’t
 **))

259 
	`__nÚnuÎ
 ((1, 2));

261 #ifdeà
__REDIRECT


262 
	`__REDIRECT
 (
sÿndœ
,

263 (cÚ¡ *
__»¡riù
 
__dœ
,

264 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

265 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

266 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

267 cÚ¡ 
dœ’t
 **)),

268 
sÿndœ64
è
	`__nÚnuÎ
 ((1, 2));

270 
	#sÿndœ
 
sÿndœ64


	)

274 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


277 
	`sÿndœ64
 (cÚ¡ *
__»¡riù
 
__dœ
,

278 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

279 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

280 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

281 cÚ¡ 
dœ’t64
 **))

282 
	`__nÚnuÎ
 ((1, 2));

285 #ifdeà
__USE_GNU


291 #iâdeà
__USE_FILE_OFFSET64


292 
	`sÿndœ©
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

293 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

294 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

295 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

296 cÚ¡ 
dœ’t
 **))

297 
	`__nÚnuÎ
 ((2, 3));

299 #ifdeà
__REDIRECT


300 
	`__REDIRECT
 (
sÿndœ©
,

301 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

302 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

303 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

304 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

305 cÚ¡ 
dœ’t
 **)),

306 
sÿndœ©64
è
	`__nÚnuÎ
 ((2, 3));

308 
	#sÿndœ©
 
sÿndœ©64


	)

314 
	`sÿndœ©64
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

315 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

316 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

317 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

318 cÚ¡ 
dœ’t64
 **))

319 
	`__nÚnuÎ
 ((2, 3));

323 #iâdeà
__USE_FILE_OFFSET64


324 
	$®phasÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

325 cÚ¡ 
dœ’t
 **
__e2
)

326 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

328 #ifdeà
__REDIRECT


329 
	`__REDIRECT_NTH
 (
®phasÜt
,

330 (cÚ¡ 
dœ’t
 **
__e1
,

331 cÚ¡ 
dœ’t
 **
__e2
),

332 
®phasÜt64
è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

334 
	#®phasÜt
 
®phasÜt64


	)

338 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


339 
	$®phasÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

340 cÚ¡ 
dœ’t64
 **
__e2
)

341 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

346 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC


351 #iâdeà
__USE_FILE_OFFSET64


352 
__ssize_t
 
	$g‘dœ’Œ›s
 (
__fd
, *
__»¡riù
 
__buf
,

353 
size_t
 
__nby‹s
,

354 
__off_t
 *
__»¡riù
 
__ba£p
)

355 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

357 #ifdeà
__REDIRECT


358 
__ssize_t
 
	`__REDIRECT_NTH
 (
g‘dœ’Œ›s
,

359 (
__fd
, *
__»¡riù
 
__buf
,

360 
size_t
 
__nby‹s
,

361 
__off64_t
 *
__»¡riù
 
__ba£p
),

362 
g‘dœ’Œ›s64
è
	`__nÚnuÎ
 ((2, 4));

364 
	#g‘dœ’Œ›s
 
g‘dœ’Œ›s64


	)

368 #ifdeà
__USE_LARGEFILE64


369 
__ssize_t
 
	$g‘dœ’Œ›s64
 (
__fd
, *
__»¡riù
 
__buf
,

370 
size_t
 
__nby‹s
,

371 
__off64_t
 *
__»¡riù
 
__ba£p
)

372 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

376 #ifdeà
__USE_GNU


378 #iâdeà
__USE_FILE_OFFSET64


379 
	$v”siÚsÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

380 cÚ¡ 
dœ’t
 **
__e2
)

381 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

383 #ifdeà
__REDIRECT


384 
	`__REDIRECT_NTH
 (
v”siÚsÜt
,

385 (cÚ¡ 
dœ’t
 **
__e1
,

386 cÚ¡ 
dœ’t
 **
__e2
),

387 
v”siÚsÜt64
)

388 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

390 
	#v”siÚsÜt
 
v”siÚsÜt64


	)

394 #ifdeà
__USE_LARGEFILE64


395 
	$v”siÚsÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

396 cÚ¡ 
dœ’t64
 **
__e2
)

397 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

401 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_BSD
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

62 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


63 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

64 
	#htŞe16
(
x
è(x)

	)

65 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

66 
	#Ë16toh
(
x
è(x)

	)

68 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

69 
	#htŞe32
(
x
è(x)

	)

70 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

71 
	#Ë32toh
(
x
è(x)

	)

73 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

74 
	#htŞe64
(
x
è(x)

	)

75 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

76 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


26 #iâdef 
__Ãed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


35 
	~<b™s/”ºo.h
>

36 #undeà
__Ãed_Em©h


38 #ifdef 
_ERRNO_H


45 #iâdef 
”ºo


46 
”ºo
;

49 #ifdeà
__USE_GNU


54 *
´og¿m_švoÿtiÚ_Çme
, *
´og¿m_švoÿtiÚ_shÜt_Çme
;

58 
	g__END_DECLS


66 #ià
defšed
 
__USE_GNU
 || defšed 
__Ãed_”rÜ_t


67 #iâdeà
__”rÜ_t_defšed


68 
	t”rÜ_t
;

69 
	#__”rÜ_t_defšed
 1

	)

71 #undeà
__Ãed_”rÜ_t


	@/usr/include/fcntl.h

22 #iâdef 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

35 
	~<b™s/fú.h
>

40 #iâdeà
__mode_t_defšed


41 
__mode_t
 
	tmode_t
;

42 
	#__mode_t_defšed


	)

45 #iâdeà
__off_t_defšed


46 #iâdeà
__USE_FILE_OFFSET64


47 
__off_t
 
	toff_t
;

49 
__off64_t
 
	toff_t
;

51 
	#__off_t_defšed


	)

54 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


55 
__off64_t
 
	toff64_t
;

56 
	#__off64_t_defšed


	)

59 #iâdeà
__pid_t_defšed


60 
__pid_t
 
	tpid_t
;

61 
	#__pid_t_defšed


	)

65 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


66 
	#__Ãed_time¥ec


	)

67 
	~<time.h
>

68 
	~<b™s/¡©.h
>

70 
	#S_IFMT
 
__S_IFMT


	)

71 
	#S_IFDIR
 
__S_IFDIR


	)

72 
	#S_IFCHR
 
__S_IFCHR


	)

73 
	#S_IFBLK
 
__S_IFBLK


	)

74 
	#S_IFREG
 
__S_IFREG


	)

75 #ifdeà
__S_IFIFO


76 
	#S_IFIFO
 
__S_IFIFO


	)

78 #ifdeà
__S_IFLNK


79 
	#S_IFLNK
 
__S_IFLNK


	)

81 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
è&& defšed 
__S_IFSOCK


82 
	#S_IFSOCK
 
__S_IFSOCK


	)

87 
	#S_ISUID
 
__S_ISUID


	)

88 
	#S_ISGID
 
__S_ISGID


	)

90 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


92 
	#S_ISVTX
 
__S_ISVTX


	)

95 
	#S_IRUSR
 
__S_IREAD


	)

96 
	#S_IWUSR
 
__S_IWRITE


	)

97 
	#S_IXUSR
 
__S_IEXEC


	)

99 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

101 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

102 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

103 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

105 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

107 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

108 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

109 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

111 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

114 #ifdef 
__USE_MISC


115 #iâdeà
R_OK


118 
	#R_OK
 4

	)

119 
	#W_OK
 2

	)

120 
	#X_OK
 1

	)

121 
	#F_OK
 0

	)

126 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


127 
	#SEEK_SET
 0

	)

128 
	#SEEK_CUR
 1

	)

129 
	#SEEK_END
 2

	)

137 
fú
 (
__fd
, 
__cmd
, ...);

145 #iâdeà
__USE_FILE_OFFSET64


146 
	$İ’
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

148 #ifdeà
__REDIRECT


149 
	`__REDIRECT
 (
İ’
, (cÚ¡ *
__fe
, 
__oæag
, ...), 
İ’64
)

150 
	`__nÚnuÎ
 ((1));

152 
	#İ’
 
İ’64


	)

155 #ifdeà
__USE_LARGEFILE64


156 
	$İ’64
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

159 #ifdeà
__USE_ATFILE


169 #iâdeà
__USE_FILE_OFFSET64


170 
	$İ’©
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

171 
	`__nÚnuÎ
 ((2));

173 #ifdeà
__REDIRECT


174 
	`__REDIRECT
 (
İ’©
, (
__fd
, cÚ¡ *
__fe
, 
__oæag
,

175 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

177 
	#İ’©
 
İ’©64


	)

180 #ifdeà
__USE_LARGEFILE64


181 
	$İ’©64
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

182 
	`__nÚnuÎ
 ((2));

191 #iâdeà
__USE_FILE_OFFSET64


192 
	$ü—t
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

194 #ifdeà
__REDIRECT


195 
	`__REDIRECT
 (
ü—t
, (cÚ¡ *
__fe
, 
mode_t
 
__mode
),

196 
ü—t64
è
	`__nÚnuÎ
 ((1));

198 
	#ü—t
 
ü—t64


	)

201 #ifdeà
__USE_LARGEFILE64


202 
	$ü—t64
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

205 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

206 && !
defšed
 
__USE_POSIX
))

215 
	#F_ULOCK
 0

	)

216 
	#F_LOCK
 1

	)

217 
	#F_TLOCK
 2

	)

218 
	#F_TEST
 3

	)

220 #iâdeà
__USE_FILE_OFFSET64


221 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Ën
);

223 #ifdeà
__REDIRECT


224 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

226 
	#lockf
 
lockf64


	)

229 #ifdeà
__USE_LARGEFILE64


230 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Ën
);

234 #ifdeà
__USE_XOPEN2K


237 #iâdeà
__USE_FILE_OFFSET64


238 
	$posix_çdvi£
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
,

239 
__advi£
è
__THROW
;

241 #ifdeà
__REDIRECT_NTH


242 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

243 
__off64_t
 
__Ën
, 
__advi£
),

244 
posix_çdvi£64
);

246 
	#posix_çdvi£
 
posix_çdvi£64


	)

249 #ifdeà
__USE_LARGEFILE64


250 
	$posix_çdvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
,

251 
__advi£
è
__THROW
;

259 #iâdeà
__USE_FILE_OFFSET64


260 
	`posix_çÎoÿ‹
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
);

262 #ifdeà
__REDIRECT


263 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

264 
__off64_t
 
__Ën
),

265 
posix_çÎoÿ‹64
);

267 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

270 #ifdeà
__USE_LARGEFILE64


271 
	`posix_çÎoÿ‹64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
);

277 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
 \

278 && 
defšed
 
__va_¬g_·ck_Ën


279 
	~<b™s/fú2.h
>

282 
__END_DECLS


	@/usr/include/ifaddrs.h

19 #iâdeà
_IFADDRS_H


20 
	#_IFADDRS_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<sys/sock‘.h
>

25 
__BEGIN_DECLS


29 
	siçddrs


31 
içddrs
 *
	miç_Ãxt
;

33 *
	miç_Çme
;

34 
	miç_æags
;

36 
sockaddr
 *
	miç_addr
;

37 
sockaddr
 *
	miç_Ãtmask
;

44 
sockaddr
 *
	mifu_brßdaddr
;

45 
sockaddr
 *
	mifu_d¡addr
;

46 } 
	miç_ifu
;

49 #iâdeà
iç_brßdaddr


50 
	#iç_brßdaddr
 
iç_ifu
.
ifu_brßdaddr


	)

52 #iâdeà
iç_d¡addr


53 
	#iç_d¡addr
 
iç_ifu
.
ifu_d¡addr


	)

56 *
	miç_d©a
;

66 
	$g‘içddrs
 (
içddrs
 **
__içp
è
__THROW
;

69 
	$ä“içddrs
 (
içddrs
 *
__iç
è
__THROW
;

71 
__END_DECLS


	@/usr/include/linux/errqueue.h

1 #iâdeà
_LINUX_ERRQUEUE_H


2 
	#_LINUX_ERRQUEUE_H


	)

4 
	~<lšux/ty³s.h
>

6 
	ssock_ex‹nded_”r
 {

7 
__u32
 
	m“_”ºo
;

8 
__u8
 
	m“_Üigš
;

9 
__u8
 
	m“_ty³
;

10 
__u8
 
	m“_code
;

11 
__u8
 
	m“_·d
;

12 
__u32
 
	m“_šfo
;

13 
__u32
 
	m“_d©a
;

16 
	#SO_EE_ORIGIN_NONE
 0

	)

17 
	#SO_EE_ORIGIN_LOCAL
 1

	)

18 
	#SO_EE_ORIGIN_ICMP
 2

	)

19 
	#SO_EE_ORIGIN_ICMP6
 3

	)

20 
	#SO_EE_ORIGIN_TXSTATUS
 4

	)

21 
	#SO_EE_ORIGIN_TIMESTAMPING
 
SO_EE_ORIGIN_TXSTATUS


	)

23 
	#SO_EE_OFFENDER
(
“
è((
sockaddr
*)(Óe)+1))

	)

	@/usr/include/linux/filter.h

5 #iâdeà
__LINUX_FILTER_H__


6 
	#__LINUX_FILTER_H__


	)

9 
	~<lšux/ty³s.h
>

15 
	#BPF_MAJOR_VERSION
 1

	)

16 
	#BPF_MINOR_VERSION
 1

	)

23 
	ssock_f‹r
 {

24 
__u16
 
	mcode
;

25 
__u8
 
	mjt
;

26 
__u8
 
	mjf
;

27 
__u32
 
	mk
;

30 
	ssock_årog
 {

31 
	mËn
;

32 
sock_f‹r
 *
	mf‹r
;

39 
	#BPF_CLASS
(
code
è((codeè& 0x07)

	)

40 
	#BPF_LD
 0x00

	)

41 
	#BPF_LDX
 0x01

	)

42 
	#BPF_ST
 0x02

	)

43 
	#BPF_STX
 0x03

	)

44 
	#BPF_ALU
 0x04

	)

45 
	#BPF_JMP
 0x05

	)

46 
	#BPF_RET
 0x06

	)

47 
	#BPF_MISC
 0x07

	)

50 
	#BPF_SIZE
(
code
è((codeè& 0x18)

	)

51 
	#BPF_W
 0x00

	)

52 
	#BPF_H
 0x08

	)

53 
	#BPF_B
 0x10

	)

54 
	#BPF_MODE
(
code
è((codeè& 0xe0)

	)

55 
	#BPF_IMM
 0x00

	)

56 
	#BPF_ABS
 0x20

	)

57 
	#BPF_IND
 0x40

	)

58 
	#BPF_MEM
 0x60

	)

59 
	#BPF_LEN
 0x80

	)

60 
	#BPF_MSH
 0xa0

	)

63 
	#BPF_OP
(
code
è((codeè& 0xf0)

	)

64 
	#BPF_ADD
 0x00

	)

65 
	#BPF_SUB
 0x10

	)

66 
	#BPF_MUL
 0x20

	)

67 
	#BPF_DIV
 0x30

	)

68 
	#BPF_OR
 0x40

	)

69 
	#BPF_AND
 0x50

	)

70 
	#BPF_LSH
 0x60

	)

71 
	#BPF_RSH
 0x70

	)

72 
	#BPF_NEG
 0x80

	)

73 
	#BPF_MOD
 0x90

	)

74 
	#BPF_XOR
 0xa0

	)

76 
	#BPF_JA
 0x00

	)

77 
	#BPF_JEQ
 0x10

	)

78 
	#BPF_JGT
 0x20

	)

79 
	#BPF_JGE
 0x30

	)

80 
	#BPF_JSET
 0x40

	)

81 
	#BPF_SRC
(
code
è((codeè& 0x08)

	)

82 
	#BPF_K
 0x00

	)

83 
	#BPF_X
 0x08

	)

86 
	#BPF_RVAL
(
code
è((codeè& 0x18)

	)

87 
	#BPF_A
 0x10

	)

90 
	#BPF_MISCOP
(
code
è((codeè& 0xf8)

	)

91 
	#BPF_TAX
 0x00

	)

92 
	#BPF_TXA
 0x80

	)

94 #iâdeà
BPF_MAXINSNS


95 
	#BPF_MAXINSNS
 4096

	)

101 #iâdeà
BPF_STMT


102 
	#BPF_STMT
(
code
, 
k
è{ ()(code), 0, 0, k }

	)

104 #iâdeà
BPF_JUMP


105 
	#BPF_JUMP
(
code
, 
k
, 
jt
, 
jf
è{ ()(code), jt, jf, k }

	)

111 
	#BPF_MEMWORDS
 16

	)

118 
	#SKF_AD_OFF
 (-0x1000)

	)

119 
	#SKF_AD_PROTOCOL
 0

	)

120 
	#SKF_AD_PKTTYPE
 4

	)

121 
	#SKF_AD_IFINDEX
 8

	)

122 
	#SKF_AD_NLATTR
 12

	)

123 
	#SKF_AD_NLATTR_NEST
 16

	)

124 
	#SKF_AD_MARK
 20

	)

125 
	#SKF_AD_QUEUE
 24

	)

126 
	#SKF_AD_HATYPE
 28

	)

127 
	#SKF_AD_RXHASH
 32

	)

128 
	#SKF_AD_CPU
 36

	)

129 
	#SKF_AD_ALU_XOR_X
 40

	)

130 
	#SKF_AD_VLAN_TAG
 44

	)

131 
	#SKF_AD_VLAN_TAG_PRESENT
 48

	)

132 
	#SKF_AD_PAY_OFFSET
 52

	)

133 
	#SKF_AD_MAX
 56

	)

134 
	#SKF_NET_OFF
 (-0x100000)

	)

135 
	#SKF_LL_OFF
 (-0x200000)

	)

	@/usr/include/linux/if.h

19 #iâdeà
_LINUX_IF_H


20 
	#_LINUX_IF_H


	)

22 
	~<lšux/ty³s.h
>

23 
	~<lšux/sock‘.h
>

26 
	#IFNAMSIZ
 16

	)

27 
	#IFALIASZ
 256

	)

28 
	~<lšux/hdlc/ioùl.h
>

31 
	#IFF_UP
 0x1

	)

32 
	#IFF_BROADCAST
 0x2

	)

33 
	#IFF_DEBUG
 0x4

	)

34 
	#IFF_LOOPBACK
 0x8

	)

35 
	#IFF_POINTOPOINT
 0x10

	)

36 
	#IFF_NOTRAILERS
 0x20

	)

37 
	#IFF_RUNNING
 0x40

	)

38 
	#IFF_NOARP
 0x80

	)

39 
	#IFF_PROMISC
 0x100

	)

40 
	#IFF_ALLMULTI
 0x200

	)

42 
	#IFF_MASTER
 0x400

	)

43 
	#IFF_SLAVE
 0x800

	)

45 
	#IFF_MULTICAST
 0x1000

	)

47 
	#IFF_PORTSEL
 0x2000

	)

48 
	#IFF_AUTOMEDIA
 0x4000

	)

49 
	#IFF_DYNAMIC
 0x8000

	)

51 
	#IFF_LOWER_UP
 0x10000

	)

52 
	#IFF_DORMANT
 0x20000

	)

54 
	#IFF_ECHO
 0x40000

	)

56 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

57 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

60 
	#IFF_802_1Q_VLAN
 0x1

	)

61 
	#IFF_EBRIDGE
 0x2

	)

62 
	#IFF_SLAVE_INACTIVE
 0x4

	)

63 
	#IFF_MASTER_8023AD
 0x8

	)

64 
	#IFF_MASTER_ALB
 0x10

	)

65 
	#IFF_BONDING
 0x20

	)

66 
	#IFF_SLAVE_NEEDARP
 0x40

	)

67 
	#IFF_ISATAP
 0x80

	)

68 
	#IFF_MASTER_ARPMON
 0x100

	)

69 
	#IFF_WAN_HDLC
 0x200

	)

70 
	#IFF_XMIT_DST_RELEASE
 0x400

	)

73 
	#IFF_DONT_BRIDGE
 0x800

	)

74 
	#IFF_DISABLE_NETPOLL
 0x1000

	)

75 
	#IFF_MACVLAN_PORT
 0x2000

	)

76 
	#IFF_BRIDGE_PORT
 0x4000

	)

77 
	#IFF_OVS_DATAPATH
 0x8000

	)

79 
	#IFF_TX_SKB_SHARING
 0x10000

	)

81 
	#IFF_UNICAST_FLT
 0x20000

	)

82 
	#IFF_TEAM_PORT
 0x40000

	)

83 
	#IFF_SUPP_NOFCS
 0x80000

	)

84 
	#IFF_LIVE_ADDR_CHANGE
 0x100000

	)

86 
	#IFF_MACVLAN
 0x200000

	)

89 
	#IF_GET_IFACE
 0x0001

	)

90 
	#IF_GET_PROTO
 0x0002

	)

93 
	#IF_IFACE_V35
 0x1000

	)

94 
	#IF_IFACE_V24
 0x1001

	)

95 
	#IF_IFACE_X21
 0x1002

	)

96 
	#IF_IFACE_T1
 0x1003

	)

97 
	#IF_IFACE_E1
 0x1004

	)

98 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

99 
	#IF_IFACE_X21D
 0x1006

	)

102 
	#IF_PROTO_HDLC
 0x2000

	)

103 
	#IF_PROTO_PPP
 0x2001

	)

104 
	#IF_PROTO_CISCO
 0x2002

	)

105 
	#IF_PROTO_FR
 0x2003

	)

106 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

107 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

108 
	#IF_PROTO_X25
 0x2006

	)

109 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

110 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

111 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

112 
	#IF_PROTO_FR_PVC
 0x200A

	)

113 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

114 
	#IF_PROTO_RAW
 0x200C

	)

118 
	mIF_OPER_UNKNOWN
,

119 
	mIF_OPER_NOTPRESENT
,

120 
	mIF_OPER_DOWN
,

121 
	mIF_OPER_LOWERLAYERDOWN
,

122 
	mIF_OPER_TESTING
,

123 
	mIF_OPER_DORMANT
,

124 
	mIF_OPER_UP
,

129 
	mIF_LINK_MODE_DEFAULT
,

130 
	mIF_LINK_MODE_DORMANT
,

143 
	sifm­
 {

144 
	mmem_¡¬t
;

145 
	mmem_’d
;

146 
	mba£_addr
;

147 
	mœq
;

148 
	mdma
;

149 
	mpÜt
;

153 
	sif_£‰šgs
 {

154 
	mty³
;

155 
	msize
;

158 
¿w_hdlc_´Ùo
 *
	m¿w_hdlc
;

159 
cisco_´Ùo
 *
	mcisco
;

160 
ä_´Ùo
 *
	mä
;

161 
ä_´Ùo_pvc
 *
	mä_pvc
;

162 
ä_´Ùo_pvc_šfo
 *
	mä_pvc_šfo
;

165 
sync_£rŸl_£‰šgs
 *
	msync
;

166 
‹1_£‰šgs
 *
	m‹1
;

167 } 
	mifs_ifsu
;

177 
	siäeq
 {

178 
	#IFHWADDRLEN
 6

	)

181 
	miän_Çme
[
IFNAMSIZ
];

182 } 
	miä_iän
;

185 
sockaddr
 
	miäu_addr
;

186 
sockaddr
 
	miäu_d¡addr
;

187 
sockaddr
 
	miäu_brßdaddr
;

188 
sockaddr
 
	miäu_Ãtmask
;

189 
sockaddr
 
	miäu_hwaddr
;

190 
	miäu_æags
;

191 
	miäu_iv®ue
;

192 
	miäu_mtu
;

193 
ifm­
 
	miäu_m­
;

194 
	miäu_¦ave
[
IFNAMSIZ
];

195 
	miäu_ÃwÇme
[
IFNAMSIZ
];

196 * 
	miäu_d©a
;

197 
if_£‰šgs
 
	miäu_£‰šgs
;

198 } 
	miä_iäu
;

201 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

202 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

203 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

204 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

205 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

206 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

207 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

208 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

209 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

210 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

211 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

212 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

213 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

214 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

215 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

216 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

217 
	#iä_£‰šgs
 
iä_iäu
.
iäu_£‰šgs


	)

226 
	sifcÚf
 {

227 
	mifc_Ën
;

229 *
	mifcu_buf
;

230 
iäeq
 *
	mifcu_»q
;

231 } 
	mifc_ifcu
;

233 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

234 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

	@/usr/include/linux/if_arp.h

23 #iâdeà
_LINUX_IF_ARP_H


24 
	#_LINUX_IF_ARP_H


	)

26 
	~<lšux/Ãtdeviû.h
>

29 
	#ARPHRD_NETROM
 0

	)

30 
	#ARPHRD_ETHER
 1

	)

31 
	#ARPHRD_EETHER
 2

	)

32 
	#ARPHRD_AX25
 3

	)

33 
	#ARPHRD_PRONET
 4

	)

34 
	#ARPHRD_CHAOS
 5

	)

35 
	#ARPHRD_IEEE802
 6

	)

36 
	#ARPHRD_ARCNET
 7

	)

37 
	#ARPHRD_APPLETLK
 8

	)

38 
	#ARPHRD_DLCI
 15

	)

39 
	#ARPHRD_ATM
 19

	)

40 
	#ARPHRD_METRICOM
 23

	)

41 
	#ARPHRD_IEEE1394
 24

	)

42 
	#ARPHRD_EUI64
 27

	)

43 
	#ARPHRD_INFINIBAND
 32

	)

46 
	#ARPHRD_SLIP
 256

	)

47 
	#ARPHRD_CSLIP
 257

	)

48 
	#ARPHRD_SLIP6
 258

	)

49 
	#ARPHRD_CSLIP6
 259

	)

50 
	#ARPHRD_RSRVD
 260

	)

51 
	#ARPHRD_ADAPT
 264

	)

52 
	#ARPHRD_ROSE
 270

	)

53 
	#ARPHRD_X25
 271

	)

54 
	#ARPHRD_HWX25
 272

	)

55 
	#ARPHRD_CAN
 280

	)

56 
	#ARPHRD_PPP
 512

	)

57 
	#ARPHRD_CISCO
 513

	)

58 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

59 
	#ARPHRD_LAPB
 516

	)

60 
	#ARPHRD_DDCMP
 517

	)

61 
	#ARPHRD_RAWHDLC
 518

	)

63 
	#ARPHRD_TUNNEL
 768

	)

64 
	#ARPHRD_TUNNEL6
 769

	)

65 
	#ARPHRD_FRAD
 770

	)

66 
	#ARPHRD_SKIP
 771

	)

67 
	#ARPHRD_LOOPBACK
 772

	)

68 
	#ARPHRD_LOCALTLK
 773

	)

69 
	#ARPHRD_FDDI
 774

	)

70 
	#ARPHRD_BIF
 775

	)

71 
	#ARPHRD_SIT
 776

	)

72 
	#ARPHRD_IPDDP
 777

	)

73 
	#ARPHRD_IPGRE
 778

	)

74 
	#ARPHRD_PIMREG
 779

	)

75 
	#ARPHRD_HIPPI
 780

	)

76 
	#ARPHRD_ASH
 781

	)

77 
	#ARPHRD_ECONET
 782

	)

78 
	#ARPHRD_IRDA
 783

	)

80 
	#ARPHRD_FCPP
 784

	)

81 
	#ARPHRD_FCAL
 785

	)

82 
	#ARPHRD_FCPL
 786

	)

83 
	#ARPHRD_FCFABRIC
 787

	)

85 
	#ARPHRD_IEEE802_TR
 800

	)

86 
	#ARPHRD_IEEE80211
 801

	)

87 
	#ARPHRD_IEEE80211_PRISM
 802

	)

88 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

89 
	#ARPHRD_IEEE802154
 804

	)

90 
	#ARPHRD_IEEE802154_MONITOR
 805

	)

92 
	#ARPHRD_PHONET
 820

	)

93 
	#ARPHRD_PHONET_PIPE
 821

	)

94 
	#ARPHRD_CAIF
 822

	)

95 
	#ARPHRD_IP6GRE
 823

	)

96 
	#ARPHRD_NETLINK
 824

	)

98 
	#ARPHRD_VOID
 0xFFFF

	)

99 
	#ARPHRD_NONE
 0xFFFE

	)

102 
	#ARPOP_REQUEST
 1

	)

103 
	#ARPOP_REPLY
 2

	)

104 
	#ARPOP_RREQUEST
 3

	)

105 
	#ARPOP_RREPLY
 4

	)

106 
	#ARPOP_InREQUEST
 8

	)

107 
	#ARPOP_InREPLY
 9

	)

108 
	#ARPOP_NAK
 10

	)

112 
	s¬´eq
 {

113 
sockaddr
 
	m¬p_·
;

114 
sockaddr
 
	m¬p_ha
;

115 
	m¬p_æags
;

116 
sockaddr
 
	m¬p_Ãtmask
;

117 
	m¬p_dev
[16];

120 
	s¬´eq_Şd
 {

121 
sockaddr
 
	m¬p_·
;

122 
sockaddr
 
	m¬p_ha
;

123 
	m¬p_æags
;

124 
sockaddr
 
	m¬p_Ãtmask
;

128 
	#ATF_COM
 0x02

	)

129 
	#ATF_PERM
 0x04

	)

130 
	#ATF_PUBL
 0x08

	)

131 
	#ATF_USETRAILERS
 0x10

	)

132 
	#ATF_NETMASK
 0x20

	)

134 
	#ATF_DONTPUB
 0x40

	)

140 
	s¬phdr
 {

141 
__be16
 
	m¬_hrd
;

142 
__be16
 
	m¬_´o
;

143 
	m¬_hÊ
;

144 
	m¬_¶n
;

145 
__be16
 
	m¬_İ
;

151 
	m¬_sha
[
ETH_ALEN
];

152 
	m¬_s
[4];

153 
	m¬_tha
[
ETH_ALEN
];

154 
	m¬_t
[4];

	@/usr/include/linux/if_ether.h

21 #iâdeà
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<lšux/ty³s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

42 
	#ETH_P_LOOP
 0x0060

	)

43 
	#ETH_P_PUP
 0x0200

	)

44 
	#ETH_P_PUPAT
 0x0201

	)

45 
	#ETH_P_IP
 0x0800

	)

46 
	#ETH_P_X25
 0x0805

	)

47 
	#ETH_P_ARP
 0x0806

	)

48 
	#ETH_P_BPQ
 0x08FF

	)

49 
	#ETH_P_IEEEPUP
 0x0a00

	)

50 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

51 
	#ETH_P_BATMAN
 0x4305

	)

52 
	#ETH_P_DEC
 0x6000

	)

53 
	#ETH_P_DNA_DL
 0x6001

	)

54 
	#ETH_P_DNA_RC
 0x6002

	)

55 
	#ETH_P_DNA_RT
 0x6003

	)

56 
	#ETH_P_LAT
 0x6004

	)

57 
	#ETH_P_DIAG
 0x6005

	)

58 
	#ETH_P_CUST
 0x6006

	)

59 
	#ETH_P_SCA
 0x6007

	)

60 
	#ETH_P_TEB
 0x6558

	)

61 
	#ETH_P_RARP
 0x8035

	)

62 
	#ETH_P_ATALK
 0x809B

	)

63 
	#ETH_P_AARP
 0x80F3

	)

64 
	#ETH_P_8021Q
 0x8100

	)

65 
	#ETH_P_IPX
 0x8137

	)

66 
	#ETH_P_IPV6
 0x86DD

	)

67 
	#ETH_P_PAUSE
 0x8808

	)

68 
	#ETH_P_SLOW
 0x8809

	)

69 
	#ETH_P_WCCP
 0x883E

	)

71 
	#ETH_P_PPP_DISC
 0x8863

	)

72 
	#ETH_P_PPP_SES
 0x8864

	)

73 
	#ETH_P_MPLS_UC
 0x8847

	)

74 
	#ETH_P_MPLS_MC
 0x8848

	)

75 
	#ETH_P_ATMMPOA
 0x884ø

	)

76 
	#ETH_P_LINK_CTL
 0x886ø

	)

77 
	#ETH_P_ATMFATE
 0x8884

	)

80 
	#ETH_P_PAE
 0x888E

	)

81 
	#ETH_P_AOE
 0x88A2

	)

82 
	#ETH_P_8021AD
 0x88A8

	)

83 
	#ETH_P_802_EX1
 0x88B5

	)

84 
	#ETH_P_TIPC
 0x88CA

	)

85 
	#ETH_P_8021AH
 0x88E7

	)

86 
	#ETH_P_MVRP
 0x88F5

	)

87 
	#ETH_P_1588
 0x88F7

	)

88 
	#ETH_P_PRP
 0x88FB

	)

89 
	#ETH_P_FCOE
 0x8906

	)

90 
	#ETH_P_TDLS
 0x890D

	)

91 
	#ETH_P_FIP
 0x8914

	)

92 
	#ETH_P_QINQ1
 0x9100

	)

93 
	#ETH_P_QINQ2
 0x9200

	)

94 
	#ETH_P_QINQ3
 0x9300

	)

95 
	#ETH_P_EDSA
 0xDADA

	)

96 
	#ETH_P_AF_IUCV
 0xFBFB

	)

98 
	#ETH_P_802_3_MIN
 0x0600

	)

105 
	#ETH_P_802_3
 0x0001

	)

106 
	#ETH_P_AX25
 0x0002

	)

107 
	#ETH_P_ALL
 0x0003

	)

108 
	#ETH_P_802_2
 0x0004

	)

109 
	#ETH_P_SNAP
 0x0005

	)

110 
	#ETH_P_DDCMP
 0x0006

	)

111 
	#ETH_P_WAN_PPP
 0x0007

	)

112 
	#ETH_P_PPP_MP
 0x0008

	)

113 
	#ETH_P_LOCALTALK
 0x0009

	)

114 
	#ETH_P_CAN
 0x000C

	)

115 
	#ETH_P_CANFD
 0x000D

	)

116 
	#ETH_P_PPPTALK
 0x0010

	)

117 
	#ETH_P_TR_802_2
 0x0011

	)

118 
	#ETH_P_MOBITEX
 0x0015

	)

119 
	#ETH_P_CONTROL
 0x0016

	)

120 
	#ETH_P_IRDA
 0x0017

	)

121 
	#ETH_P_ECONET
 0x0018

	)

122 
	#ETH_P_HDLC
 0x0019

	)

123 
	#ETH_P_ARCNET
 0x001A

	)

124 
	#ETH_P_DSA
 0x001B

	)

125 
	#ETH_P_TRAILER
 0x001C

	)

126 
	#ETH_P_PHONET
 0x00F5

	)

127 
	#ETH_P_IEEE802154
 0x00F6

	)

128 
	#ETH_P_CAIF
 0x00F7

	)

134 
	s‘hhdr
 {

135 
	mh_de¡
[
ETH_ALEN
];

136 
	mh_sourû
[
ETH_ALEN
];

137 
__be16
 
	mh_´Ùo
;

138 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/if_packet.h

1 #iâdeà
__LINUX_IF_PACKET_H


2 
	#__LINUX_IF_PACKET_H


	)

4 
	~<lšux/ty³s.h
>

6 
	ssockaddr_pkt
 {

7 
	m¥kt_çmy
;

8 
	m¥kt_deviû
[14];

9 
__be16
 
	m¥kt_´ÙocŞ
;

12 
	ssockaddr_Î
 {

13 
	m¦l_çmy
;

14 
__be16
 
	m¦l_´ÙocŞ
;

15 
	m¦l_ifšdex
;

16 
	m¦l_h©y³
;

17 
	m¦l_pk‰y³
;

18 
	m¦l_h®’
;

19 
	m¦l_addr
[8];

24 
	#PACKET_HOST
 0

	)

25 
	#PACKET_BROADCAST
 1

	)

26 
	#PACKET_MULTICAST
 2

	)

27 
	#PACKET_OTHERHOST
 3

	)

28 
	#PACKET_OUTGOING
 4

	)

30 
	#PACKET_LOOPBACK
 5

	)

31 
	#PACKET_FASTROUTE
 6

	)

35 
	#PACKET_ADD_MEMBERSHIP
 1

	)

36 
	#PACKET_DROP_MEMBERSHIP
 2

	)

37 
	#PACKET_RECV_OUTPUT
 3

	)

39 
	#PACKET_RX_RING
 5

	)

40 
	#PACKET_STATISTICS
 6

	)

41 
	#PACKET_COPY_THRESH
 7

	)

42 
	#PACKET_AUXDATA
 8

	)

43 
	#PACKET_ORIGDEV
 9

	)

44 
	#PACKET_VERSION
 10

	)

45 
	#PACKET_HDRLEN
 11

	)

46 
	#PACKET_RESERVE
 12

	)

47 
	#PACKET_TX_RING
 13

	)

48 
	#PACKET_LOSS
 14

	)

49 
	#PACKET_VNET_HDR
 15

	)

50 
	#PACKET_TX_TIMESTAMP
 16

	)

51 
	#PACKET_TIMESTAMP
 17

	)

52 
	#PACKET_FANOUT
 18

	)

53 
	#PACKET_TX_HAS_OFF
 19

	)

55 
	#PACKET_FANOUT_HASH
 0

	)

56 
	#PACKET_FANOUT_LB
 1

	)

57 
	#PACKET_FANOUT_CPU
 2

	)

58 
	#PACKET_FANOUT_ROLLOVER
 3

	)

59 
	#PACKET_FANOUT_RND
 4

	)

60 
	#PACKET_FANOUT_FLAG_ROLLOVER
 0x1000

	)

61 
	#PACKET_FANOUT_FLAG_DEFRAG
 0x8000

	)

63 
	sack‘_¡©s
 {

64 
	m_·ck‘s
;

65 
	m_drİs
;

68 
	sack‘_¡©s_v3
 {

69 
	m_·ck‘s
;

70 
	m_drİs
;

71 
	m_ä“ze_q_út
;

74 
	uack‘_¡©s_u
 {

75 
ack‘_¡©s
 
	m¡©s1
;

76 
ack‘_¡©s_v3
 
	m¡©s3
;

79 
	sack‘_auxd©a
 {

80 
__u32
 
	m_¡©us
;

81 
__u32
 
	m_Ën
;

82 
__u32
 
	m_¢­Ën
;

83 
__u16
 
	m_mac
;

84 
__u16
 
	m_Ãt
;

85 
__u16
 
	m_vÏn_tci
;

86 
__u16
 
	m_·ddšg
;

90 
	#TP_STATUS_KERNEL
 0

	)

91 
	#TP_STATUS_USER
 (1 << 0)

	)

92 
	#TP_STATUS_COPY
 (1 << 1)

	)

93 
	#TP_STATUS_LOSING
 (1 << 2)

	)

94 
	#TP_STATUS_CSUMNOTREADY
 (1 << 3)

	)

95 
	#TP_STATUS_VLAN_VALID
 (1 << 4è

	)

96 
	#TP_STATUS_BLK_TMO
 (1 << 5)

	)

99 
	#TP_STATUS_AVAILABLE
 0

	)

100 
	#TP_STATUS_SEND_REQUEST
 (1 << 0)

	)

101 
	#TP_STATUS_SENDING
 (1 << 1)

	)

102 
	#TP_STATUS_WRONG_FORMAT
 (1 << 2)

	)

105 
	#TP_STATUS_TS_SOFTWARE
 (1 << 29)

	)

106 
	#TP_STATUS_TS_SYS_HARDWARE
 (1 << 30)

	)

107 
	#TP_STATUS_TS_RAW_HARDWARE
 (1 << 31)

	)

110 
	#TP_FT_REQ_FILL_RXHASH
 0x1

	)

112 
	sack‘_hdr
 {

113 
	m_¡©us
;

114 
	m_Ën
;

115 
	m_¢­Ën
;

116 
	m_mac
;

117 
	m_Ãt
;

118 
	m_£c
;

119 
	m_u£c
;

122 
	#TPACKET_ALIGNMENT
 16

	)

123 
	#TPACKET_ALIGN
(
x
è(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

124 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘_hdr
)è+ (
sockaddr_Î
))

	)

126 
	sack‘2_hdr
 {

127 
__u32
 
	m_¡©us
;

128 
__u32
 
	m_Ën
;

129 
__u32
 
	m_¢­Ën
;

130 
__u16
 
	m_mac
;

131 
__u16
 
	m_Ãt
;

132 
__u32
 
	m_£c
;

133 
__u32
 
	m_n£c
;

134 
__u16
 
	m_vÏn_tci
;

135 
__u16
 
	m_·ddšg
;

138 
	sack‘_hdr_v¬ŸÁ1
 {

139 
__u32
 
	m_rxhash
;

140 
__u32
 
	m_vÏn_tci
;

143 
	sack‘3_hdr
 {

144 
__u32
 
	m_Ãxt_off£t
;

145 
__u32
 
	m_£c
;

146 
__u32
 
	m_n£c
;

147 
__u32
 
	m_¢­Ën
;

148 
__u32
 
	m_Ën
;

149 
__u32
 
	m_¡©us
;

150 
__u16
 
	m_mac
;

151 
__u16
 
	m_Ãt
;

154 
ack‘_hdr_v¬ŸÁ1
 
	mhv1
;

158 
	sack‘_bd_ts
 {

159 
	mts_£c
;

161 
	mts_u£c
;

162 
	mts_n£c
;

166 
	sack‘_hdr_v1
 {

167 
__u32
 
	mblock_¡©us
;

168 
__u32
 
	mnum_pkts
;

169 
__u32
 
	moff£t_to_fœ¡_pkt
;

174 
__u32
 
	mblk_Ën
;

185 
__®igÃd_u64
 
	m£q_num
;

212 
ack‘_bd_ts
 
	mts_fœ¡_pkt
, 
	mts_Ï¡_pkt
;

215 
	uack‘_bd_h—d”_u
 {

216 
ack‘_hdr_v1
 
	mbh1
;

219 
	sack‘_block_desc
 {

220 
__u32
 
	mv”siÚ
;

221 
__u32
 
	moff£t_to_´iv
;

222 
ack‘_bd_h—d”_u
 
	mhdr
;

225 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘2_hdr
)è+ (
sockaddr_Î
))

	)

226 
	#TPACKET3_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘3_hdr
)è+ (
sockaddr_Î
))

	)

228 
	eack‘_v”siÚs
 {

229 
	mTPACKET_V1
,

230 
	mTPACKET_V2
,

231 
	mTPACKET_V3


247 
	sack‘_»q
 {

248 
	m_block_size
;

249 
	m_block_Ä
;

250 
	m_äame_size
;

251 
	m_äame_Ä
;

254 
	sack‘_»q3
 {

255 
	m_block_size
;

256 
	m_block_Ä
;

257 
	m_äame_size
;

258 
	m_äame_Ä
;

259 
	m_»tœe_blk_tov
;

260 
	m_sizeof_´iv
;

261 
	m_ã©u»_»q_wÜd
;

264 
	uack‘_»q_u
 {

265 
ack‘_»q
 
	m»q
;

266 
ack‘_»q3
 
	m»q3
;

269 
	s·ck‘_m»q
 {

270 
	mmr_ifšdex
;

271 
	mmr_ty³
;

272 
	mmr_®’
;

273 
	mmr_add»ss
[8];

276 
	#PACKET_MR_MULTICAST
 0

	)

277 
	#PACKET_MR_PROMISC
 1

	)

278 
	#PACKET_MR_ALLMULTI
 2

	)

279 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/limits.h

1 #iâdeà
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 65536

	)

7 
	#ARG_MAX
 131072

	)

8 
	#LINK_MAX
 127

	)

9 
	#MAX_CANON
 255

	)

10 
	#MAX_INPUT
 255

	)

11 
	#NAME_MAX
 255

	)

12 
	#PATH_MAX
 4096

	)

13 
	#PIPE_BUF
 4096

	)

14 
	#XATTR_NAME_MAX
 255

	)

15 
	#XATTR_SIZE_MAX
 65536

	)

16 
	#XATTR_LIST_MAX
 65536

	)

18 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/route.h

23 #iâdeà
_LINUX_ROUTE_H


24 
	#_LINUX_ROUTE_H


	)

26 
	~<lšux/if.h
>

30 
	s¹’Œy
 {

31 
	m¹_·d1
;

32 
sockaddr
 
	m¹_d¡
;

33 
sockaddr
 
	m¹_g©eway
;

34 
sockaddr
 
	m¹_g’mask
;

35 
	m¹_æags
;

36 
	m¹_·d2
;

37 
	m¹_·d3
;

38 *
	m¹_·d4
;

39 
	m¹_m‘ric
;

40 *
	m¹_dev
;

41 
	m¹_mtu
;

42 
	#¹_mss
 
¹_mtu


	)

43 
	m¹_wšdow
;

44 
	m¹_œ‰
;

48 
	#RTF_UP
 0x0001

	)

49 
	#RTF_GATEWAY
 0x0002

	)

50 
	#RTF_HOST
 0x0004

	)

51 
	#RTF_REINSTATE
 0x0008

	)

52 
	#RTF_DYNAMIC
 0x0010

	)

53 
	#RTF_MODIFIED
 0x0020

	)

54 
	#RTF_MTU
 0x0040

	)

55 
	#RTF_MSS
 
RTF_MTU


	)

56 
	#RTF_WINDOW
 0x0080

	)

57 
	#RTF_IRTT
 0x0100

	)

58 
	#RTF_REJECT
 0x0200

	)

	@/usr/include/linux/sockios.h

18 #iâdeà
_LINUX_SOCKIOS_H


19 
	#_LINUX_SOCKIOS_H


	)

21 
	~<asm/sockios.h
>

24 
	#SIOCINQ
 
FIONREAD


	)

25 
	#SIOCOUTQ
 
TIOCOUTQ


	)

28 
	#SIOCADDRT
 0x890B

	)

29 
	#SIOCDELRT
 0x890C

	)

30 
	#SIOCRTMSG
 0x890D

	)

33 
	#SIOCGIFNAME
 0x8910

	)

34 
	#SIOCSIFLINK
 0x8911

	)

35 
	#SIOCGIFCONF
 0x8912

	)

36 
	#SIOCGIFFLAGS
 0x8913

	)

37 
	#SIOCSIFFLAGS
 0x8914

	)

38 
	#SIOCGIFADDR
 0x8915

	)

39 
	#SIOCSIFADDR
 0x8916

	)

40 
	#SIOCGIFDSTADDR
 0x8917

	)

41 
	#SIOCSIFDSTADDR
 0x8918

	)

42 
	#SIOCGIFBRDADDR
 0x8919

	)

43 
	#SIOCSIFBRDADDR
 0x891¨

	)

44 
	#SIOCGIFNETMASK
 0x891b

	)

45 
	#SIOCSIFNETMASK
 0x891ø

	)

46 
	#SIOCGIFMETRIC
 0x891d

	)

47 
	#SIOCSIFMETRIC
 0x891

	)

48 
	#SIOCGIFMEM
 0x891à

	)

49 
	#SIOCSIFMEM
 0x8920

	)

50 
	#SIOCGIFMTU
 0x8921

	)

51 
	#SIOCSIFMTU
 0x8922

	)

52 
	#SIOCSIFNAME
 0x8923

	)

53 
	#SIOCSIFHWADDR
 0x8924

	)

54 
	#SIOCGIFENCAP
 0x8925

	)

55 
	#SIOCSIFENCAP
 0x8926

	)

56 
	#SIOCGIFHWADDR
 0x8927

	)

57 
	#SIOCGIFSLAVE
 0x8929

	)

58 
	#SIOCSIFSLAVE
 0x8930

	)

59 
	#SIOCADDMULTI
 0x8931

	)

60 
	#SIOCDELMULTI
 0x8932

	)

61 
	#SIOCGIFINDEX
 0x8933

	)

62 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

63 
	#SIOCSIFPFLAGS
 0x8934

	)

64 
	#SIOCGIFPFLAGS
 0x8935

	)

65 
	#SIOCDIFADDR
 0x8936

	)

66 
	#SIOCSIFHWBROADCAST
 0x8937

	)

67 
	#SIOCGIFCOUNT
 0x8938

	)

69 
	#SIOCGIFBR
 0x8940

	)

70 
	#SIOCSIFBR
 0x8941

	)

72 
	#SIOCGIFTXQLEN
 0x8942

	)

73 
	#SIOCSIFTXQLEN
 0x8943

	)

78 
	#SIOCETHTOOL
 0x8946

	)

80 
	#SIOCGMIIPHY
 0x8947

	)

81 
	#SIOCGMIIREG
 0x8948

	)

82 
	#SIOCSMIIREG
 0x8949

	)

84 
	#SIOCWANDEV
 0x894A

	)

86 
	#SIOCOUTQNSD
 0x894B

	)

90 
	#SIOCDARP
 0x8953

	)

91 
	#SIOCGARP
 0x8954

	)

92 
	#SIOCSARP
 0x8955

	)

95 
	#SIOCDRARP
 0x8960

	)

96 
	#SIOCGRARP
 0x8961

	)

97 
	#SIOCSRARP
 0x8962

	)

101 
	#SIOCGIFMAP
 0x8970

	)

102 
	#SIOCSIFMAP
 0x8971

	)

106 
	#SIOCADDDLCI
 0x8980

	)

107 
	#SIOCDELDLCI
 0x8981

	)

109 
	#SIOCGIFVLAN
 0x8982

	)

110 
	#SIOCSIFVLAN
 0x8983

	)

114 
	#SIOCBONDENSLAVE
 0x8990

	)

115 
	#SIOCBONDRELEASE
 0x8991

	)

116 
	#SIOCBONDSETHWADDR
 0x8992

	)

117 
	#SIOCBONDSLAVEINFOQUERY
 0x8993

	)

118 
	#SIOCBONDINFOQUERY
 0x8994

	)

119 
	#SIOCBONDCHANGEACTIVE
 0x8995

	)

122 
	#SIOCBRADDBR
 0x89a0

	)

123 
	#SIOCBRDELBR
 0x89a1

	)

124 
	#SIOCBRADDIF
 0x89a2

	)

125 
	#SIOCBRDELIF
 0x89a3

	)

128 
	#SIOCSHWTSTAMP
 0x89b0

	)

129 
	#SIOCGHWTSTAMP
 0x89b1

	)

142 
	#SIOCDEVPRIVATE
 0x89F0

	)

148 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty³s.h
>

6 #iâdeà
__ASSEMBLY__


8 
	~<lšux/posix_ty³s.h
>

16 #ifdeà
__CHECKER__


17 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

19 
	#__b™wi£__


	)

21 #ifdeà
__CHECK_ENDIAN__


22 
	#__b™wi£
 
__b™wi£__


	)

24 
	#__b™wi£


	)

27 
__u16
 
	t__b™wi£
 
	t__Ë16
;

28 
__u16
 
	t__b™wi£
 
	t__be16
;

29 
__u32
 
	t__b™wi£
 
	t__Ë32
;

30 
__u32
 
	t__b™wi£
 
	t__be32
;

31 
__u64
 
	t__b™wi£
 
	t__Ë64
;

32 
__u64
 
	t__b™wi£
 
	t__be64
;

34 
__u16
 
	t__b™wi£
 
	t__sum16
;

35 
__u32
 
	t__b™wi£
 
	t__wsum
;

46 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

47 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

48 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/locale.h

22 #iâdef 
_LOCALE_H


23 
	#_LOCALE_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	#__Ãed_NULL


	)

28 
	~<¡ddef.h
>

29 
	~<b™s/loÿË.h
>

31 
	g__BEGIN_DECLS


35 
	#LC_CTYPE
 
__LC_CTYPE


	)

36 
	#LC_NUMERIC
 
__LC_NUMERIC


	)

37 
	#LC_TIME
 
__LC_TIME


	)

38 
	#LC_COLLATE
 
__LC_COLLATE


	)

39 
	#LC_MONETARY
 
__LC_MONETARY


	)

40 
	#LC_MESSAGES
 
__LC_MESSAGES


	)

41 
	#LC_ALL
 
__LC_ALL


	)

42 
	#LC_PAPER
 
__LC_PAPER


	)

43 
	#LC_NAME
 
__LC_NAME


	)

44 
	#LC_ADDRESS
 
__LC_ADDRESS


	)

45 
	#LC_TELEPHONE
 
__LC_TELEPHONE


	)

46 
	#LC_MEASUREMENT
 
__LC_MEASUREMENT


	)

47 
	#LC_IDENTIFICATION
 
__LC_IDENTIFICATION


	)

50 
__BEGIN_NAMESPACE_STD


53 
	slcÚv


57 *
	mdecim®_pošt
;

58 *
	mthou§nds_£p
;

64 *
	mgroupšg
;

70 *
	mšt_cu¼_symbŞ
;

71 *
	mcu¼’cy_symbŞ
;

72 *
	mmÚ_decim®_pošt
;

73 *
	mmÚ_thou§nds_£p
;

74 *
	mmÚ_groupšg
;

75 *
	mpos™ive_sign
;

76 *
	mÃg©ive_sign
;

77 
	mšt_äac_dig™s
;

78 
	mäac_dig™s
;

80 
	mp_cs_´eûdes
;

82 
	mp_£p_by_¥aû
;

84 
	mn_cs_´eûdes
;

86 
	mn_£p_by_¥aû
;

93 
	mp_sign_po¢
;

94 
	mn_sign_po¢
;

95 #ifdeà
__USE_ISOC99


97 
	mšt_p_cs_´eûdes
;

99 
	mšt_p_£p_by_¥aû
;

101 
	mšt_n_cs_´eûdes
;

103 
	mšt_n_£p_by_¥aû
;

110 
	mšt_p_sign_po¢
;

111 
	mšt_n_sign_po¢
;

113 
	m__št_p_cs_´eûdes
;

114 
	m__št_p_£p_by_¥aû
;

115 
	m__št_n_cs_´eûdes
;

116 
	m__št_n_£p_by_¥aû
;

117 
	m__št_p_sign_po¢
;

118 
	m__št_n_sign_po¢
;

124 *
	$£oÿË
 (
__ÿ‹gÜy
, cÚ¡ *
__loÿË
è
__THROW
;

127 
lcÚv
 *
	$loÿËcÚv
 (è
__THROW
;

129 
__END_NAMESPACE_STD


132 #ifdef 
__USE_XOPEN2K8


145 
	~<xloÿË.h
>

151 
__loÿË_t
 
	$ÃwloÿË
 (
__ÿ‹gÜy_mask
, cÚ¡ *
__loÿË
,

152 
__loÿË_t
 
__ba£
è
__THROW
;

158 
	#LC_CTYPE_MASK
 (1 << 
__LC_CTYPE
)

	)

159 
	#LC_NUMERIC_MASK
 (1 << 
__LC_NUMERIC
)

	)

160 
	#LC_TIME_MASK
 (1 << 
__LC_TIME
)

	)

161 
	#LC_COLLATE_MASK
 (1 << 
__LC_COLLATE
)

	)

162 
	#LC_MONETARY_MASK
 (1 << 
__LC_MONETARY
)

	)

163 
	#LC_MESSAGES_MASK
 (1 << 
__LC_MESSAGES
)

	)

164 
	#LC_PAPER_MASK
 (1 << 
__LC_PAPER
)

	)

165 
	#LC_NAME_MASK
 (1 << 
__LC_NAME
)

	)

166 
	#LC_ADDRESS_MASK
 (1 << 
__LC_ADDRESS
)

	)

167 
	#LC_TELEPHONE_MASK
 (1 << 
__LC_TELEPHONE
)

	)

168 
	#LC_MEASUREMENT_MASK
 (1 << 
__LC_MEASUREMENT
)

	)

169 
	#LC_IDENTIFICATION_MASK
 (1 << 
__LC_IDENTIFICATION
)

	)

170 
	#LC_ALL_MASK
 (
LC_CTYPE_MASK
 \

171 | 
LC_NUMERIC_MASK
 \

172 | 
LC_TIME_MASK
 \

173 | 
LC_COLLATE_MASK
 \

174 | 
LC_MONETARY_MASK
 \

175 | 
LC_MESSAGES_MASK
 \

176 | 
LC_PAPER_MASK
 \

177 | 
LC_NAME_MASK
 \

178 | 
LC_ADDRESS_MASK
 \

179 | 
LC_TELEPHONE_MASK
 \

180 | 
LC_MEASUREMENT_MASK
 \

181 | 
LC_IDENTIFICATION_MASK
 \

182 )

	)

186 
__loÿË_t
 
	$du¶oÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

190 
	$ä“loÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

197 
__loÿË_t
 
	$u£loÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

201 
	#LC_GLOBAL_LOCALE
 ((
__loÿË_t
è-1L)

	)

205 
__END_DECLS


	@/usr/include/malloc.h

19 #iâdeà
_MALLOC_H


20 
	#_MALLOC_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<¡ddef.h
>

24 
	~<¡dio.h
>

26 #ifdeà
_LIBC


27 
	#__MALLOC_HOOK_VOLATILE


	)

28 
	#__MALLOC_DEPRECATED


	)

30 
	#__MALLOC_HOOK_VOLATILE
 vŞ©e

	)

31 
	#__MALLOC_DEPRECATED
 
__©Œibu‹_d•»ÿ‹d__


	)

35 
__BEGIN_DECLS


38 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

41 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

42 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

49 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

50 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

53 
	$ä“
 (*
__±r
è
__THROW
;

56 
	$cä“
 (*
__±r
è
__THROW
;

59 *
	$mem®ign
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

60 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

63 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

67 *
	$pv®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

71 *(*
__mÜecÜe
è(
±rdiff_t
 
__size
);

74 *
	$__deçuÉ_mÜecÜe
 (
±rdiff_t
 
__size
)

75 
__THROW
 
__©Œibu‹_m®loc__
;

79 
	sm®lšfo


81 
¬’a
;

82 
Üdblks
;

83 
smblks
;

84 
hblks
;

85 
hblkhd
;

86 
usmblks
;

87 
fsmblks
;

88 
uÜdblks
;

89 
fÜdblks
;

90 
k“pco¡
;

94 
m®lšfo
 
	$m®lšfo
 (è
__THROW
;

97 #iâdeà
M_MXFAST


98 
	#M_MXFAST
 1

	)

100 #iâdeà
M_NLBLKS


101 
	#M_NLBLKS
 2

	)

103 #iâdeà
M_GRAIN


104 
	#M_GRAIN
 3

	)

106 #iâdeà
M_KEEP


107 
	#M_KEEP
 4

	)

111 
	#M_TRIM_THRESHOLD
 -1

	)

112 
	#M_TOP_PAD
 -2

	)

113 
	#M_MMAP_THRESHOLD
 -3

	)

114 
	#M_MMAP_MAX
 -4

	)

115 
	#M_CHECK_ACTION
 -5

	)

116 
	#M_PERTURB
 -6

	)

117 
	#M_ARENA_TEST
 -7

	)

118 
	#M_ARENA_MAX
 -8

	)

121 
	$m®lİt
 (
__·¿m
, 
__v®
è
__THROW
;

125 
	$m®loc_Œim
 (
size_t
 
__·d
è
__THROW
;

129 
size_t
 
	$m®loc_u§bË_size
 (*
__±r
è
__THROW
;

132 
	$m®loc_¡©s
 (è
__THROW
;

135 
	$m®loc_šfo
 (
__İtiÚs
, 
FILE
 *
__å
è
__THROW
;

138 *
	$m®loc_g‘_¡©e
 (è
__THROW
;

142 
	$m®loc_£t_¡©e
 (*
__±r
è
__THROW
;

147 (*
__MALLOC_HOOK_VOLATILE
 
__m®loc_š™Ÿlize_hook
) ()

148 
__MALLOC_DEPRECATED
;

150 (*
__MALLOC_HOOK_VOLATILE
 
__ä“_hook
è(*
__±r
,

152 
__MALLOC_DEPRECATED
;

153 *(*
__MALLOC_HOOK_VOLATILE
 
__m®loc_hook
)(
size_t
 
__size
,

155 
__MALLOC_DEPRECATED
;

156 *(*
__MALLOC_HOOK_VOLATILE
 
__»®loc_hook
)(*
__±r
,

157 
size_t
 
__size
,

159 
__MALLOC_DEPRECATED
;

160 *(*
__MALLOC_HOOK_VOLATILE
 
__mem®ign_hook
)(
size_t
 
__®ignm’t
,

161 
size_t
 
__size
,

163 
__MALLOC_DEPRECATED
;

164 (*
__MALLOC_HOOK_VOLATILE
 
__aá”_mÜecÜe_hook
) ();

167 
	$__m®loc_check_š™
 (è
__THROW
 
__MALLOC_DEPRECATED
;

170 
__END_DECLS


	@/usr/include/math.h

23 #iâdef 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


32 
	~<b™s/huge_v®.h
>

33 #ifdeà
__USE_ISOC99


34 
	~<b™s/huge_v®f.h
>

35 
	~<b™s/huge_v®l.h
>

38 
	~<b™s/šf.h
>

41 
	~<b™s/Çn.h
>

45 
	~<b™s/m©hdef.h
>

52 
	#__MATHCALL
(
funùiÚ
,
suffix
, 
¬gs
) \

53 
	`__MATHDECL
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
)

	)

54 
	#__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

55 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
); \

56 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
)

	)

57 
	#__MATHCALLX
(
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

58 
	`__MATHDECLX
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
)

	)

59 
	#__MATHDECLX
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

60 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
); \

61 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
)

	)

62 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

63 
ty³
 
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
è
¬gs
 
__THROW


	)

65 
	#_MdoubË_
 

	)

66 
	#__MATH_PRECNAME
(
Çme
,
r
è
	`__CONCAT
Òame,r)

	)

67 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

68 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

69 
	~<b™s/m©hÿÎs.h
>

70 #undeà
_MdoubË_


71 #undeà
_MdoubË_BEGIN_NAMESPACE


72 #undeà
_MdoubË_END_NAMESPACE


73 #undeà
__MATH_PRECNAME


75 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


81 #iâdeà
_Mæßt_


82 
	#_Mæßt_
 

	)

84 
	#_MdoubË_
 
_Mæßt_


	)

85 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f
##
	)
r

86 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

87 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

88 
	~<b™s/m©hÿÎs.h
>

89 #undeà
_MdoubË_


90 #undeà
_MdoubË_BEGIN_NAMESPACE


91 #undeà
_MdoubË_END_NAMESPACE


92 #undeà
__MATH_PRECNAME


94 #ià!(
defšed
 
__NO_LONG_DOUBLE_MATH
 && defšed 
_LIBC
) \

95 || 
defšed
 
__LDBL_COMPAT


96 #ifdeà
__LDBL_COMPAT


98 #ifdeà
__USE_ISOC99


99 
	$__Ædbl_Ãx‰ow¬df
 (
__x
, 
__y
)

100 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

101 #ifdeà
__REDIRECT_NTH


102 
	`__REDIRECT_NTH
 (
Ãx‰ow¬df
, (
__x
, 
__y
),

103 
__Ædbl_Ãx‰ow¬df
)

104 
	`__©Œibu‹__
 ((
__cÚ¡__
));

105 
	`__REDIRECT_NTH
 (
Ãx‰ow¬d
, (
__x
, 
__y
),

106 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

107 
	`__REDIRECT_NTH
 (
Ãx‰ow¬dl
,

108 (
__x
, 
__y
),

109 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

113 #undeà
__MATHDECL_1


114 
	#__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
®Ÿs
) \

115 
ty³
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
), \

116 
¬gs
, 
®Ÿs
)

	)

117 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

118 
	`__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
	`__CONCAT
(funùiÚ,suffix))

	)

124 #iâdeà
_MlÚg_doubË_


125 
	#_MlÚg_doubË_
 

	)

127 
	#_MdoubË_
 
_MlÚg_doubË_


	)

128 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
l
##
	)
r

129 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

130 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

131 
	#__MATH_DECLARE_LDOUBLE
 1

	)

132 
	~<b™s/m©hÿÎs.h
>

133 #undeà
_MdoubË_


134 #undeà
_MdoubË_BEGIN_NAMESPACE


135 #undeà
_MdoubË_END_NAMESPACE


136 #undeà
__MATH_PRECNAME


141 #undeà
__MATHDECL_1


142 #undeà
__MATHDECL


143 #undeà
__MATHCALL


146 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


148 
signgam
;

153 #ifdeà
__USE_ISOC99


191 
FP_NAN
 =

192 
	#FP_NAN
 0

	)

193 
FP_NAN
,

194 
FP_INFINITE
 =

195 
	#FP_INFINITE
 1

	)

196 
FP_INFINITE
,

197 
FP_ZERO
 =

198 
	#FP_ZERO
 2

	)

199 
FP_ZERO
,

200 
FP_SUBNORMAL
 =

201 
	#FP_SUBNORMAL
 3

	)

202 
FP_SUBNORMAL
,

203 
FP_NORMAL
 =

204 
	#FP_NORMAL
 4

	)

205 
FP_NORMAL


209 #ifdeà
__NO_LONG_DOUBLE_MATH


210 
	#åşassify
(
x
) \

211 ( (
x
è=ğ (è? 
	`__åşassifyf
 (xè: 
	`__åşassify
 (x))

	)

213 
	#åşassify
(
x
) \

214 ( (
x
) ==  () \

215 ? 
	`__åşassifyf
 (
x
) \

216 :  (
x
) ==  () \

217 ? 
	`__åşassify
 (
x
è: 
	`__åşassifyl
 (x))

	)

221 #ifdeà
__NO_LONG_DOUBLE_MATH


222 
	#signb™
(
x
) \

223 ( (
x
è=ğ (è? 
	`__signb™f
 (xè: 
	`__signb™
 (x))

	)

225 
	#signb™
(
x
) \

226 ( (
x
) ==  () \

227 ? 
	`__signb™f
 (
x
) \

228 :  (
x
) ==  () \

229 ? 
	`__signb™
 (
x
è: 
	`__signb™l
 (x))

	)

233 #ifdeà
__NO_LONG_DOUBLE_MATH


234 
	#isfš™e
(
x
) \

235 ( (
x
è=ğ (è? 
	`__fš™ef
 (xè: 
	`__fš™e
 (x))

	)

237 
	#isfš™e
(
x
) \

238 ( (
x
) ==  () \

239 ? 
	`__fš™ef
 (
x
) \

240 :  (
x
) ==  () \

241 ? 
	`__fš™e
 (
x
è: 
	`__fš™–
 (x))

	)

245 
	#i¢Üm®
(
x
è(
	`åşassify
 (xè=ğ
FP_NORMAL
)

	)

249 #ifdeà
__NO_LONG_DOUBLE_MATH


250 
	#i¢ª
(
x
) \

251 ( (
x
è=ğ (è? 
	`__i¢ªf
 (xè: 
	`__i¢ª
 (x))

	)

253 
	#i¢ª
(
x
) \

254 ( (
x
) ==  () \

255 ? 
	`__i¢ªf
 (
x
) \

256 :  (
x
) ==  () \

257 ? 
	`__i¢ª
 (
x
è: 
	`__i¢ªl
 (x))

	)

261 #ifdeà
__NO_LONG_DOUBLE_MATH


262 
	#isšf
(
x
) \

263 ( (
x
è=ğ (è? 
	`__isšff
 (xè: 
	`__isšf
 (x))

	)

265 
	#isšf
(
x
) \

266 ( (
x
) ==  () \

267 ? 
	`__isšff
 (
x
) \

268 :  (
x
) ==  () \

269 ? 
	`__isšf
 (
x
è: 
	`__isšæ
 (x))

	)

273 
	#MATH_ERRNO
 1

	)

274 
	#MATH_ERREXCEPT
 2

	)

279 #iâdeà
__FAST_MATH__


280 
	#m©h_”rhªdlšg
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

285 #ifdeà
__USE_GNU


287 #ifdeà
__NO_LONG_DOUBLE_MATH


288 
	#issigÇlšg
(
x
) \

289 ( (
x
è=ğ (è? 
	`__issigÇlšgf
 (xè: 
	`__issigÇlšg
 (x))

	)

291 
	#issigÇlšg
(
x
) \

292 ( (
x
) ==  () \

293 ? 
	`__issigÇlšgf
 (
x
) \

294 :  (
x
) ==  () \

295 ? 
	`__issigÇlšg
 (
x
è: 
	`__issigÇlšgl
 (x))

	)

299 #ifdef 
__USE_MISC


303 
_IEEE_
 = -1,

304 
_SVID_
,

305 
_XOPEN_
,

306 
_POSIX_
,

307 
_ISOC_


308 } 
	t_LIB_VERSION_TYPE
;

313 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

317 #ifdeà
__USE_SVID


323 #ifdeà
__ılu¥lus


324 
__exû±iÚ


326 
exû±iÚ


329 
ty³
;

330 *
Çme
;

331 
¬g1
;

332 
¬g2
;

333 
»tv®
;

334 
	}
};

336 #ifdeà
__ılu¥lus


337 
	$m©h”r
 (
__exû±iÚ
 *
__exc
è
	`throw
 ();

339 
	`m©h”r
 (
exû±iÚ
 *
__exc
);

342 
	#X_TLOSS
 1.41484755040568800000e+16

	)

345 
	#DOMAIN
 1

	)

346 
	#SING
 2

	)

347 
	#OVERFLOW
 3

	)

348 
	#UNDERFLOW
 4

	)

349 
	#TLOSS
 5

	)

350 
	#PLOSS
 6

	)

353 
	#HUGE
 3.40282347e+38F

	)

357 #ifdeà
__USE_XOPEN


359 
	#MAXFLOAT
 3.40282347e+38F

	)

366 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


367 
	#M_E
 2.7182818284590452354

	)

368 
	#M_LOG2E
 1.4426950408889634074

	)

369 
	#M_LOG10E
 0.43429448190325182765

	)

370 
	#M_LN2
 0.69314718055994530942

	)

371 
	#M_LN10
 2.30258509299404568402

	)

372 
	#M_PI
 3.14159265358979323846

	)

373 
	#M_PI_2
 1.57079632679489661923

	)

374 
	#M_PI_4
 0.78539816339744830962

	)

375 
	#M_1_PI
 0.31830988618379067154

	)

376 
	#M_2_PI
 0.63661977236758134308

	)

377 
	#M_2_SQRTPI
 1.12837916709551257390

	)

378 
	#M_SQRT2
 1.41421356237309504880

	)

379 
	#M_SQRT1_2
 0.70710678118654752440

	)

385 #ifdeà
__USE_GNU


386 
	#M_El
 2.718281828459045235360287471352662498L

	)

387 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

388 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

389 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

390 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

391 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

392 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

393 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

394 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

395 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

396 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

397 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

398 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

405 #ià
defšed
 
__STRICT_ANSI__
 && !defšed 
__NO_MATH_INLINES


406 
	#__NO_MATH_INLINES
 1

	)

409 #ià
defšed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

416 
	#isg»©”
(
x
, 
y
è
	`__butš_isg»©”
(x, y)

	)

417 
	#isg»©”equ®
(
x
, 
y
è
	`__butš_isg»©”equ®
(x, y)

	)

418 
	#i¦ess
(
x
, 
y
è
	`__butš_i¦ess
(x, y)

	)

419 
	#i¦es£qu®
(
x
, 
y
è
	`__butš_i¦es£qu®
(x, y)

	)

420 
	#i¦essg»©”
(
x
, 
y
è
	`__butš_i¦essg»©”
(x, y)

	)

421 
	#isunÜd”ed
(
u
, 
v
è
	`__butš_isunÜd”ed
(u, v)

	)

425 #ifdeà
__USE_EXTERN_INLINES


426 
	~<b™s/m©hšlše.h
>

431 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

432 
	~<b™s/m©h-fš™e.h
>

435 #ifdeà
__USE_ISOC99


439 #iâdeà
isg»©”


440 
	#isg»©”
(
x
, 
y
) \

441 (
__ex‹nsiÚ__
 \

442 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

443 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x > __y; 
	}
}))

	)

447 #iâdeà
isg»©”equ®


448 
	#isg»©”equ®
(
x
, 
y
) \

449 (
__ex‹nsiÚ__
 \

450 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

451 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x >ğ__y; }))

	)

455 #iâdeà
i¦ess


456 
	#i¦ess
(
x
, 
y
) \

457 (
__ex‹nsiÚ__
 \

458 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

459 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x < __y; }))

	)

463 #iâdeà
i¦es£qu®


464 
	#i¦es£qu®
(
x
, 
y
) \

465 (
__ex‹nsiÚ__
 \

466 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

467 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x <ğ__y; }))

	)

471 #iâdeà
i¦essg»©”


472 
	#i¦essg»©”
(
x
, 
y
) \

473 (
__ex‹nsiÚ__
 \

474 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

475 !
	`isunÜd”ed
 (
__x
, 
__y
è&& (__x < __y || __y < __x); }))

	)

479 #iâdeà
isunÜd”ed


480 
	#isunÜd”ed
(
u
, 
v
) \

481 (
__ex‹nsiÚ__
 \

482 ({ 
	`__ty³of__
(
u
è
__u
 = (u); __ty³of__(
v
è
__v
 = (v); \

483 
	`åşassify
 (
__u
è=ğ
FP_NAN
 || fpşassify (
__v
è=ğFP_NAN; }))

	)

488 
	g__END_DECLS


	@/usr/include/net/if.h

19 #iâdeà
_NET_IF_H


20 
	#_NET_IF_H
 1

	)

22 
	~<ã©u»s.h
>

24 #ifdeà
__USE_MISC


25 
	~<sys/ty³s.h
>

26 
	~<sys/sock‘.h
>

31 
	#IF_NAMESIZE
 16

	)

33 
	sif_Çmešdex


35 
	mif_šdex
;

36 *
	mif_Çme
;

40 #ifdeà
__USE_MISC


44 
	mIFF_UP
 = 0x1,

45 
	#IFF_UP
 
IFF_UP


	)

46 
	mIFF_BROADCAST
 = 0x2,

47 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

48 
	mIFF_DEBUG
 = 0x4,

49 
	#IFF_DEBUG
 
IFF_DEBUG


	)

50 
	mIFF_LOOPBACK
 = 0x8,

51 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

52 
	mIFF_POINTOPOINT
 = 0x10,

53 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

54 
	mIFF_NOTRAILERS
 = 0x20,

55 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

56 
	mIFF_RUNNING
 = 0x40,

57 
	#IFF_RUNNING
 
IFF_RUNNING


	)

58 
	mIFF_NOARP
 = 0x80,

59 
	#IFF_NOARP
 
IFF_NOARP


	)

60 
	mIFF_PROMISC
 = 0x100,

61 
	#IFF_PROMISC
 
IFF_PROMISC


	)

64 
	mIFF_ALLMULTI
 = 0x200,

65 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

67 
	mIFF_MASTER
 = 0x400,

68 
	#IFF_MASTER
 
IFF_MASTER


	)

69 
	mIFF_SLAVE
 = 0x800,

70 
	#IFF_SLAVE
 
IFF_SLAVE


	)

72 
	mIFF_MULTICAST
 = 0x1000,

73 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

75 
	mIFF_PORTSEL
 = 0x2000,

76 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

77 
	mIFF_AUTOMEDIA
 = 0x4000,

78 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

79 
	mIFF_DYNAMIC
 = 0x8000

80 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

88 
	siçddr


90 
sockaddr
 
	miç_addr
;

93 
sockaddr
 
	mifu_brßdaddr
;

94 
sockaddr
 
	mifu_d¡addr
;

95 } 
	miç_ifu
;

96 
içû
 *
	miç_iå
;

97 
içddr
 *
	miç_Ãxt
;

100 
	#iç_brßdaddr
 
iç_ifu
.
ifu_brßdaddr


	)

101 
	#iç_d¡addr
 
iç_ifu
.
ifu_d¡addr


	)

111 
	sifm­


113 
	mmem_¡¬t
;

114 
	mmem_’d
;

115 
	mba£_addr
;

116 
	mœq
;

117 
	mdma
;

118 
	mpÜt
;

126 
	siäeq


128 
	#IFHWADDRLEN
 6

	)

129 
	#IFNAMSIZ
 
IF_NAMESIZE


	)

132 
	miän_Çme
[
IFNAMSIZ
];

133 } 
	miä_iän
;

137 
sockaddr
 
	miäu_addr
;

138 
sockaddr
 
	miäu_d¡addr
;

139 
sockaddr
 
	miäu_brßdaddr
;

140 
sockaddr
 
	miäu_Ãtmask
;

141 
sockaddr
 
	miäu_hwaddr
;

142 
	miäu_æags
;

143 
	miäu_iv®ue
;

144 
	miäu_mtu
;

145 
ifm­
 
	miäu_m­
;

146 
	miäu_¦ave
[
IFNAMSIZ
];

147 
	miäu_ÃwÇme
[
IFNAMSIZ
];

148 
__ÿddr_t
 
	miäu_d©a
;

149 } 
	miä_iäu
;

151 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

152 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

153 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

154 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

155 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

156 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

157 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

158 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

159 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

160 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

161 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

162 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

163 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

164 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

165 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

166 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

167 
	#_IOT_iäeq
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),16,0,0)

	)

168 
	#_IOT_iäeq_shÜt
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

169 
	#_IOT_iäeq_št
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

176 
	sifcÚf


178 
	mifc_Ën
;

181 
__ÿddr_t
 
	mifcu_buf
;

182 
iäeq
 *
	mifcu_»q
;

183 } 
	mifc_ifcu
;

185 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

186 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

187 
	#_IOT_ifcÚf
 
	`_IOT
(
	`_IOTS
(
ifcÚf
),1,0,0,0,0è

	)

190 
__BEGIN_DECLS


193 
	$if_Çm‘ošdex
 (cÚ¡ *
__iâame
è
__THROW
;

194 *
	$if_šdextÚame
 (
__ifšdex
, *
__iâame
è
__THROW
;

197 
if_Çmešdex
 *
	$if_Çmešdex
 (è
__THROW
;

200 
	$if_ä“Çmešdex
 (
if_Çmešdex
 *
__±r
è
__THROW
;

202 
__END_DECLS


	@/usr/include/net/if_arp.h

22 #iâdeà
_NET_IF_ARP_H


24 
	#_NET_IF_ARP_H
 1

	)

25 
	~<sys/cdefs.h
>

27 
	~<sys/ty³s.h
>

28 
	~<sys/sock‘.h
>

30 
	g__BEGIN_DECLS


33 
	#MAX_ADDR_LEN
 7

	)

39 
	#ARPOP_REQUEST
 1

	)

40 
	#ARPOP_REPLY
 2

	)

41 
	#ARPOP_RREQUEST
 3

	)

42 
	#ARPOP_RREPLY
 4

	)

43 
	#ARPOP_InREQUEST
 8

	)

44 
	#ARPOP_InREPLY
 9

	)

45 
	#ARPOP_NAK
 10

	)

54 
	s¬phdr


56 
	m¬_hrd
;

57 
	m¬_´o
;

58 
	m¬_hÊ
;

59 
	m¬_¶n
;

60 
	m¬_İ
;

64 
	m__¬_sha
[
ETH_ALEN
];

65 
	m__¬_s
[4];

66 
	m__¬_tha
[
ETH_ALEN
];

67 
	m__¬_t
[4];

73 
	#ARPHRD_NETROM
 0

	)

74 
	#ARPHRD_ETHER
 1

	)

75 
	#ARPHRD_EETHER
 2

	)

76 
	#ARPHRD_AX25
 3

	)

77 
	#ARPHRD_PRONET
 4

	)

78 
	#ARPHRD_CHAOS
 5

	)

79 
	#ARPHRD_IEEE802
 6

	)

80 
	#ARPHRD_ARCNET
 7

	)

81 
	#ARPHRD_APPLETLK
 8

	)

82 
	#ARPHRD_DLCI
 15

	)

83 
	#ARPHRD_ATM
 19

	)

84 
	#ARPHRD_METRICOM
 23

	)

85 
	#ARPHRD_IEEE1394
 24

	)

86 
	#ARPHRD_EUI64
 27

	)

87 
	#ARPHRD_INFINIBAND
 32

	)

90 
	#ARPHRD_SLIP
 256

	)

91 
	#ARPHRD_CSLIP
 257

	)

92 
	#ARPHRD_SLIP6
 258

	)

93 
	#ARPHRD_CSLIP6
 259

	)

94 
	#ARPHRD_RSRVD
 260

	)

95 
	#ARPHRD_ADAPT
 264

	)

96 
	#ARPHRD_ROSE
 270

	)

97 
	#ARPHRD_X25
 271

	)

98 
	#ARPHRD_HWX25
 272

	)

99 
	#ARPHRD_PPP
 512

	)

100 
	#ARPHRD_CISCO
 513

	)

101 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

102 
	#ARPHRD_LAPB
 516

	)

103 
	#ARPHRD_DDCMP
 517

	)

104 
	#ARPHRD_RAWHDLC
 518

	)

106 
	#ARPHRD_TUNNEL
 768

	)

107 
	#ARPHRD_TUNNEL6
 769

	)

108 
	#ARPHRD_FRAD
 770

	)

109 
	#ARPHRD_SKIP
 771

	)

110 
	#ARPHRD_LOOPBACK
 772

	)

111 
	#ARPHRD_LOCALTLK
 773

	)

112 
	#ARPHRD_FDDI
 774

	)

113 
	#ARPHRD_BIF
 775

	)

114 
	#ARPHRD_SIT
 776

	)

115 
	#ARPHRD_IPDDP
 777

	)

116 
	#ARPHRD_IPGRE
 778

	)

117 
	#ARPHRD_PIMREG
 779

	)

118 
	#ARPHRD_HIPPI
 780

	)

119 
	#ARPHRD_ASH
 781

	)

120 
	#ARPHRD_ECONET
 782

	)

121 
	#ARPHRD_IRDA
 783

	)

122 
	#ARPHRD_FCPP
 784

	)

123 
	#ARPHRD_FCAL
 785

	)

124 
	#ARPHRD_FCPL
 786

	)

125 
	#ARPHRD_FCFABRIC
 787

	)

126 
	#ARPHRD_IEEE802_TR
 800

	)

127 
	#ARPHRD_IEEE80211
 801

	)

128 
	#ARPHRD_IEEE80211_PRISM
 802

	)

129 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

130 
	#ARPHRD_IEEE802154
 804

	)

131 
	#ARPHRD_IEEE802154_PHY
 805

	)

133 
	#ARPHRD_VOID
 0xFFFF

	)

134 
	#ARPHRD_NONE
 0xFFFE

	)

138 
	s¬´eq


140 
sockaddr
 
	m¬p_·
;

141 
sockaddr
 
	m¬p_ha
;

142 
	m¬p_æags
;

143 
sockaddr
 
	m¬p_Ãtmask
;

144 
	m¬p_dev
[16];

147 
	s¬´eq_Şd


149 
sockaddr
 
	m¬p_·
;

150 
sockaddr
 
	m¬p_ha
;

151 
	m¬p_æags
;

152 
sockaddr
 
	m¬p_Ãtmask
;

156 
	#ATF_COM
 0x02

	)

157 
	#ATF_PERM
 0x04

	)

158 
	#ATF_PUBL
 0x08

	)

159 
	#ATF_USETRAILERS
 0x10

	)

160 
	#ATF_NETMASK
 0x20

	)

162 
	#ATF_DONTPUB
 0x40

	)

163 
	#ATF_MAGIC
 0x80

	)

167 
	#ARPD_UPDATE
 0x01

	)

168 
	#ARPD_LOOKUP
 0x02

	)

169 
	#ARPD_FLUSH
 0x03

	)

171 
	s¬pd_»que¡


173 
	m»q
;

174 
u_št32_t
 
	m
;

175 
	mdev
;

176 
	m¡amp
;

177 
	mupd©ed
;

178 
	mha
[
MAX_ADDR_LEN
];

181 
	g__END_DECLS


	@/usr/include/netdb.h

22 #iâdef 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<Ãtš‘/š.h
>

28 
	~<¡dšt.h
>

29 #ifdeà
__USE_MISC


32 
	~<½c/Ãtdb.h
>

35 #ifdeà
__USE_GNU


36 
	#__Ãed_sigev’t_t


	)

37 
	~<b™s/sigšfo.h
>

38 
	#__Ãed_time¥ec


	)

39 
	~<time.h
>

42 
	~<b™s/Ãtdb.h
>

45 
	#_PATH_HEQUIV
 "/‘c/ho¡s.equiv"

	)

46 
	#_PATH_HOSTS
 "/‘c/ho¡s"

	)

47 
	#_PATH_NETWORKS
 "/‘c/ÃtwÜks"

	)

48 
	#_PATH_NSSWITCH_CONF
 "/‘c/nssw™ch.cÚf"

	)

49 
	#_PATH_PROTOCOLS
 "/‘c/´ÙocŞs"

	)

50 
	#_PATH_SERVICES
 "/‘c/£rviûs"

	)

53 
	g__BEGIN_DECLS


55 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


58 
	#h_”ºo
 (*
	`__h_”ºo_loÿtiÚ
 ())

	)

61 *
	$__h_”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

65 
	#HOST_NOT_FOUND
 1

	)

66 
	#TRY_AGAIN
 2

	)

68 
	#NO_RECOVERY
 3

	)

70 
	#NO_DATA
 4

	)

73 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


74 
	#NETDB_INTERNAL
 -1

	)

75 
	#NETDB_SUCCESS
 0

	)

76 
	#NO_ADDRESS
 
NO_DATA


	)

79 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_XOPEN_EXTENDED


81 
	#IPPORT_RESERVED
 1024

	)

84 #ifdeà
__USE_GNU


86 
	#SCOPE_DELIMITER
 '%'

	)

89 #ifdeà
__USE_MISC


92 
	$h”rÜ
 (cÚ¡ *
__¡r
è
__THROW
;

95 cÚ¡ *
	$h¡»¼Ü
 (
__”r_num
è
__THROW
;

100 
	sho¡’t


102 *
h_Çme
;

103 **
h_®Ÿ£s
;

104 
h_add¹y³
;

105 
h_Ëngth
;

106 **
h_addr_li¡
;

107 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


108 
	#h_addr
 
h_addr_li¡
[0]

	)

117 
	`£tho¡’t
 (
__¡ay_İ’
);

123 
	`’dho¡’t
 ();

130 
ho¡’t
 *
	`g‘ho¡’t
 ();

137 
ho¡’t
 *
	`g‘ho¡byaddr
 (cÚ¡ *
__addr
, 
__sockËn_t
 
__Ën
,

138 
__ty³
);

144 
ho¡’t
 *
	`g‘ho¡byÇme
 (cÚ¡ *
__Çme
);

146 #ifdeà
__USE_MISC


155 
ho¡’t
 *
	`g‘ho¡byÇme2
 (cÚ¡ *
__Çme
, 
__af
);

167 
	`g‘ho¡’t_r
 (
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

168 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

169 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

170 *
__»¡riù
 
__h_”ºİ
);

172 
	`g‘ho¡byaddr_r
 (cÚ¡ *
__»¡riù
 
__addr
, 
__sockËn_t
 
__Ën
,

173 
__ty³
,

174 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

175 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

176 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

177 *
__»¡riù
 
__h_”ºİ
);

179 
	`g‘ho¡byÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

180 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

181 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

182 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

183 *
__»¡riù
 
__h_”ºİ
);

185 
	`g‘ho¡byÇme2_r
 (cÚ¡ *
__»¡riù
 
__Çme
, 
__af
,

186 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

187 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

188 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

189 *
__»¡riù
 
__h_”ºİ
);

198 
	`£Š‘’t
 (
__¡ay_İ’
);

204 
	`’dÃ‹Á
 ();

211 
Ã‹Á
 *
	`g‘Ã‹Á
 ();

218 
Ã‹Á
 *
	`g‘Ãtbyaddr
 (
ušt32_t
 
__Ãt
, 
__ty³
);

224 
Ã‹Á
 *
	`g‘ÃtbyÇme
 (cÚ¡ *
__Çme
);

226 #ifdef 
__USE_MISC


237 
	`g‘Ã‹Á_r
 (
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

238 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

239 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

240 *
__»¡riù
 
__h_”ºİ
);

242 
	`g‘Ãtbyaddr_r
 (
ušt32_t
 
__Ãt
, 
__ty³
,

243 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

244 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

245 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

246 *
__»¡riù
 
__h_”ºİ
);

248 
	`g‘ÃtbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

249 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

250 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

251 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

252 *
__»¡riù
 
__h_”ºİ
);

257 
	s£rv’t


259 *
s_Çme
;

260 **
s_®Ÿ£s
;

261 
s_pÜt
;

262 *
s_´Ùo
;

270 
	`£t£rv’t
 (
__¡ay_İ’
);

276 
	`’d£rv’t
 ();

283 
£rv’t
 *
	`g‘£rv’t
 ();

290 
£rv’t
 *
	`g‘£rvbyÇme
 (cÚ¡ *
__Çme
, cÚ¡ *
__´Ùo
);

297 
£rv’t
 *
	`g‘£rvbypÜt
 (
__pÜt
, cÚ¡ *
__´Ùo
);

300 #ifdef 
__USE_MISC


308 
	`g‘£rv’t_r
 (
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

309 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

310 
£rv’t
 **
__»¡riù
 
__»suÉ
);

312 
	`g‘£rvbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

313 cÚ¡ *
__»¡riù
 
__´Ùo
,

314 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

315 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

316 
£rv’t
 **
__»¡riù
 
__»suÉ
);

318 
	`g‘£rvbypÜt_r
 (
__pÜt
, cÚ¡ *
__»¡riù
 
__´Ùo
,

319 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

320 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

321 
£rv’t
 **
__»¡riù
 
__»suÉ
);

326 
	s´ÙÛÁ


328 *
p_Çme
;

329 **
p_®Ÿ£s
;

330 
p_´Ùo
;

338 
	`£rÙÛÁ
 (
__¡ay_İ’
);

344 
	`’d´ÙÛÁ
 ();

351 
´ÙÛÁ
 *
	`g‘´ÙÛÁ
 ();

357 
´ÙÛÁ
 *
	`g‘´ÙobyÇme
 (cÚ¡ *
__Çme
);

363 
´ÙÛÁ
 *
	`g‘´Ùobynumb”
 (
__´Ùo
);

366 #ifdef 
__USE_MISC


374 
	`g‘´ÙÛÁ_r
 (
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

375 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

376 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

378 
	`g‘´ÙobyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

379 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

380 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

381 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

383 
	`g‘´Ùobynumb”_r
 (
__´Ùo
,

384 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

385 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

386 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

395 
	`£Š‘g»Á
 (cÚ¡ *
__Ãtgroup
);

403 
	`’dÃtg»Á
 ();

412 
	`g‘Ãtg»Á
 (**
__»¡riù
 
__ho¡p
,

413 **
__»¡riù
 
__u£½
,

414 **
__»¡riù
 
__domašp
);

423 
	`šÃtgr
 (cÚ¡ *
__Ãtgroup
, cÚ¡ *
__ho¡
,

424 cÚ¡ *
__u£r
, cÚ¡ *
__domaš
);

432 
	`g‘Ãtg»Á_r
 (**
__»¡riù
 
__ho¡p
,

433 **
__»¡riù
 
__u£½
,

434 **
__»¡riù
 
__domašp
,

435 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
);

439 #ifdeà
__USE_BSD


451 
	`rcmd
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

452 cÚ¡ *
__»¡riù
 
__locu£r
,

453 cÚ¡ *
__»¡riù
 
__»mu£r
,

454 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

463 
	`rcmd_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

464 cÚ¡ *
__»¡riù
 
__locu£r
,

465 cÚ¡ *
__»¡riù
 
__»mu£r
,

466 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

467 
§_çmy_t
 
__af
);

479 
	`»xec
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

480 cÚ¡ *
__»¡riù
 
__Çme
,

481 cÚ¡ *
__»¡riù
 
__·ss
,

482 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

491 
	`»xec_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

492 cÚ¡ *
__»¡riù
 
__Çme
,

493 cÚ¡ *
__»¡riù
 
__·ss
,

494 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

495 
§_çmy_t
 
__af
);

505 
	`ru£rok
 (cÚ¡ *
__rho¡
, 
__su£r
,

506 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

515 
	`ru£rok_af
 (cÚ¡ *
__rho¡
, 
__su£r
,

516 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

517 
§_çmy_t
 
__af
);

528 
	`œu£rok
 (
ušt32_t
 
__¿ddr
, 
__su£r
,

529 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

539 
	`œu£rok_af
 (cÚ¡ *
__¿ddr
, 
__su£r
,

540 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

541 
§_çmy_t
 
__af
);

551 
	`¼esvpÜt
 (*
__®pÜt
);

560 
	`¼esvpÜt_af
 (*
__®pÜt
, 
§_çmy_t
 
__af
);

565 #ifdef 
__USE_POSIX


567 
	saddršfo


569 
ai_æags
;

570 
ai_çmy
;

571 
ai_sockty³
;

572 
ai_´ÙocŞ
;

573 
sockËn_t
 
ai_add¾’
;

574 
sockaddr
 *
ai_addr
;

575 *
ai_ÿnÚÇme
;

576 
addršfo
 *
ai_Ãxt
;

579 #ifdeà
__USE_GNU


581 
	sgaicb


583 cÚ¡ *
¬_Çme
;

584 cÚ¡ *
¬_£rviû
;

585 cÚ¡ 
addršfo
 *
¬_»que¡
;

586 
addršfo
 *
¬_»suÉ
;

588 
__»tuº
;

589 
__glibc_»£rved
[5];

593 
	#GAI_WAIT
 0

	)

594 
	#GAI_NOWAIT
 1

	)

598 
	#AI_PASSIVE
 0x0001

	)

599 
	#AI_CANONNAME
 0x0002

	)

600 
	#AI_NUMERICHOST
 0x0004

	)

601 
	#AI_V4MAPPED
 0x0008

	)

602 
	#AI_ALL
 0x0010

	)

603 
	#AI_ADDRCONFIG
 0x0020

	)

605 #ifdeà
__USE_GNU


606 
	#AI_IDN
 0x0040

	)

609 
	#AI_CANONIDN
 0x0080

	)

610 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

612 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

615 
	#AI_NUMERICSERV
 0x0400

	)

618 
	#EAI_BADFLAGS
 -1

	)

619 
	#EAI_NONAME
 -2

	)

620 
	#EAI_AGAIN
 -3

	)

621 
	#EAI_FAIL
 -4

	)

622 
	#EAI_FAMILY
 -6

	)

623 
	#EAI_SOCKTYPE
 -7

	)

624 
	#EAI_SERVICE
 -8

	)

625 
	#EAI_MEMORY
 -10

	)

626 
	#EAI_SYSTEM
 -11

	)

627 
	#EAI_OVERFLOW
 -12

	)

628 #ifdeà
__USE_GNU


629 
	#EAI_NODATA
 -5

	)

630 
	#EAI_ADDRFAMILY
 -9

	)

631 
	#EAI_INPROGRESS
 -100

	)

632 
	#EAI_CANCELED
 -101

	)

633 
	#EAI_NOTCANCELED
 -102

	)

634 
	#EAI_ALLDONE
 -103

	)

635 
	#EAI_INTR
 -104

	)

636 
	#EAI_IDN_ENCODE
 -105

	)

639 #ifdeà
__USE_MISC


640 
	#NI_MAXHOST
 1025

	)

641 
	#NI_MAXSERV
 32

	)

644 
	#NI_NUMERICHOST
 1

	)

645 
	#NI_NUMERICSERV
 2

	)

646 
	#NI_NOFQDN
 4

	)

647 
	#NI_NAMEREQD
 8

	)

648 
	#NI_DGRAM
 16

	)

649 #ifdeà
__USE_GNU


650 
	#NI_IDN
 32

	)

651 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

653 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

662 
	`g‘addršfo
 (cÚ¡ *
__»¡riù
 
__Çme
,

663 cÚ¡ *
__»¡riù
 
__£rviû
,

664 cÚ¡ 
addršfo
 *
__»¡riù
 
__»q
,

665 
addršfo
 **
__»¡riù
 
__·i
);

668 
	$ä“addršfo
 (
addršfo
 *
__ai
è
__THROW
;

671 cÚ¡ *
	$gai_¡»¼Ü
 (
__ecode
è
__THROW
;

677 
	`g‘Çmešfo
 (cÚ¡ 
sockaddr
 *
__»¡riù
 
__§
,

678 
sockËn_t
 
__§Ën
, *
__»¡riù
 
__ho¡
,

679 
sockËn_t
 
__ho¡Ën
, *
__»¡riù
 
__£rv
,

680 
sockËn_t
 
__£rvËn
, 
__æags
);

683 #ifdeà
__USE_GNU


692 
	`g‘addršfo_a
 (
__mode
, 
gaicb
 *
__li¡
[
__»¡riù_¬r
],

693 
__’t
, 
sigev’t
 *
__»¡riù
 
__sig
);

703 
	`gai_su¥’d
 (cÚ¡ 
gaicb
 *cÚ¡ 
__li¡
[], 
__’t
,

704 cÚ¡ 
time¥ec
 *
__timeout
);

707 
	$gai_”rÜ
 (
gaicb
 *
__»q
è
__THROW
;

710 
	$gai_ÿnûl
 (
gaicb
 *
__gaicbp
è
__THROW
;

713 
__END_DECLS


	@/usr/include/netinet/icmp6.h

18 #iâdeà
_NETINET_ICMP6_H


19 
	#_NETINET_ICMP6_H
 1

	)

21 
	~<š‰y³s.h
>

22 
	~<¡ršg.h
>

23 
	~<sys/ty³s.h
>

24 
	~<Ãtš‘/š.h
>

26 
	#ICMP6_FILTER
 1

	)

28 
	#ICMP6_FILTER_BLOCK
 1

	)

29 
	#ICMP6_FILTER_PASS
 2

	)

30 
	#ICMP6_FILTER_BLOCKOTHERS
 3

	)

31 
	#ICMP6_FILTER_PASSONLY
 4

	)

33 
	sicmp6_f‹r


35 
ušt32_t
 
	micmp6_ft
[8];

38 
	sicmp6_hdr


40 
ušt8_t
 
	micmp6_ty³
;

41 
ušt8_t
 
	micmp6_code
;

42 
ušt16_t
 
	micmp6_cksum
;

45 
ušt32_t
 
	micmp6_un_d©a32
[1];

46 
ušt16_t
 
	micmp6_un_d©a16
[2];

47 
ušt8_t
 
	micmp6_un_d©a8
[4];

48 } 
	micmp6_d©aun
;

51 
	#icmp6_d©a32
 
icmp6_d©aun
.
icmp6_un_d©a32


	)

52 
	#icmp6_d©a16
 
icmp6_d©aun
.
icmp6_un_d©a16


	)

53 
	#icmp6_d©a8
 
icmp6_d©aun
.
icmp6_un_d©a8


	)

54 
	#icmp6_µŒ
 
icmp6_d©a32
[0]

	)

55 
	#icmp6_mtu
 
icmp6_d©a32
[0]

	)

56 
	#icmp6_id
 
icmp6_d©a16
[0]

	)

57 
	#icmp6_£q
 
icmp6_d©a16
[1]

	)

58 
	#icmp6_maxd–ay
 
icmp6_d©a16
[0]

	)

60 
	#ICMP6_DST_UNREACH
 1

	)

61 
	#ICMP6_PACKET_TOO_BIG
 2

	)

62 
	#ICMP6_TIME_EXCEEDED
 3

	)

63 
	#ICMP6_PARAM_PROB
 4

	)

65 
	#ICMP6_INFOMSG_MASK
 0x80

	)

67 
	#ICMP6_ECHO_REQUEST
 128

	)

68 
	#ICMP6_ECHO_REPLY
 129

	)

69 
	#MLD_LISTENER_QUERY
 130

	)

70 
	#MLD_LISTENER_REPORT
 131

	)

71 
	#MLD_LISTENER_REDUCTION
 132

	)

73 
	#ICMP6_DST_UNREACH_NOROUTE
 0

	)

74 
	#ICMP6_DST_UNREACH_ADMIN
 1

	)

76 
	#ICMP6_DST_UNREACH_BEYONDSCOPE
 2

	)

77 
	#ICMP6_DST_UNREACH_ADDR
 3

	)

78 
	#ICMP6_DST_UNREACH_NOPORT
 4

	)

80 
	#ICMP6_TIME_EXCEED_TRANSIT
 0

	)

81 
	#ICMP6_TIME_EXCEED_REASSEMBLY
 1

	)

83 
	#ICMP6_PARAMPROB_HEADER
 0

	)

84 
	#ICMP6_PARAMPROB_NEXTHEADER
 1

	)

85 
	#ICMP6_PARAMPROB_OPTION
 2

	)

87 
	#ICMP6_FILTER_WILLPASS
(
ty³
, 
f‹½
) \

88 ((((
f‹½
)->
icmp6_ft
[(
ty³
è>> 5]è& (1 << (Ñy³è& 31))è=ğ0)

	)

90 
	#ICMP6_FILTER_WILLBLOCK
(
ty³
, 
f‹½
) \

91 ((((
f‹½
)->
icmp6_ft
[(
ty³
è>> 5]è& (1 << (Ñy³è& 31))è!ğ0)

	)

93 
	#ICMP6_FILTER_SETPASS
(
ty³
, 
f‹½
) \

94 ((((
f‹½
)->
icmp6_ft
[(
ty³
è>> 5]è&ğ~(1 << (Ñy³è& 31))))

	)

96 
	#ICMP6_FILTER_SETBLOCK
(
ty³
, 
f‹½
) \

97 ((((
f‹½
)->
icmp6_ft
[(
ty³
è>> 5]è|ğ(1 << (Ñy³è& 31))))

	)

99 
	#ICMP6_FILTER_SETPASSALL
(
f‹½
) \

100 
	`mem£t
 (
f‹½
, 0,  (
icmp6_f‹r
));

	)

102 
	#ICMP6_FILTER_SETBLOCKALL
(
f‹½
) \

103 
	`mem£t
 (
f‹½
, 0xFF,  (
icmp6_f‹r
));

	)

105 
	#ND_ROUTER_SOLICIT
 133

	)

106 
	#ND_ROUTER_ADVERT
 134

	)

107 
	#ND_NEIGHBOR_SOLICIT
 135

	)

108 
	#ND_NEIGHBOR_ADVERT
 136

	)

109 
	#ND_REDIRECT
 137

	)

111 
	snd_rou‹r_sŞic™


113 
icmp6_hdr
 
	mnd_rs_hdr
;

117 
	#nd_rs_ty³
 
nd_rs_hdr
.
icmp6_ty³


	)

118 
	#nd_rs_code
 
nd_rs_hdr
.
icmp6_code


	)

119 
	#nd_rs_cksum
 
nd_rs_hdr
.
icmp6_cksum


	)

120 
	#nd_rs_»£rved
 
nd_rs_hdr
.
icmp6_d©a32
[0]

	)

122 
	snd_rou‹r_adv”t


124 
icmp6_hdr
 
	mnd_¿_hdr
;

125 
ušt32_t
 
	mnd_¿_»achabË
;

126 
ušt32_t
 
	mnd_¿_»Œªsm™
;

130 
	#nd_¿_ty³
 
nd_¿_hdr
.
icmp6_ty³


	)

131 
	#nd_¿_code
 
nd_¿_hdr
.
icmp6_code


	)

132 
	#nd_¿_cksum
 
nd_¿_hdr
.
icmp6_cksum


	)

133 
	#nd_¿_curhİlim™
 
nd_¿_hdr
.
icmp6_d©a8
[0]

	)

134 
	#nd_¿_æags_»£rved
 
nd_¿_hdr
.
icmp6_d©a8
[1]

	)

135 
	#ND_RA_FLAG_MANAGED
 0x80

	)

136 
	#ND_RA_FLAG_OTHER
 0x40

	)

137 
	#ND_RA_FLAG_HOME_AGENT
 0x20

	)

138 
	#nd_¿_rou‹r_liãtime
 
nd_¿_hdr
.
icmp6_d©a16
[1]

	)

140 
	snd_ÃighbÜ_sŞic™


142 
icmp6_hdr
 
	mnd_ns_hdr
;

143 
š6_addr
 
	mnd_ns_rg‘
;

147 
	#nd_ns_ty³
 
nd_ns_hdr
.
icmp6_ty³


	)

148 
	#nd_ns_code
 
nd_ns_hdr
.
icmp6_code


	)

149 
	#nd_ns_cksum
 
nd_ns_hdr
.
icmp6_cksum


	)

150 
	#nd_ns_»£rved
 
nd_ns_hdr
.
icmp6_d©a32
[0]

	)

152 
	snd_ÃighbÜ_adv”t


154 
icmp6_hdr
 
	mnd_Ç_hdr
;

155 
š6_addr
 
	mnd_Ç_rg‘
;

159 
	#nd_Ç_ty³
 
nd_Ç_hdr
.
icmp6_ty³


	)

160 
	#nd_Ç_code
 
nd_Ç_hdr
.
icmp6_code


	)

161 
	#nd_Ç_cksum
 
nd_Ç_hdr
.
icmp6_cksum


	)

162 
	#nd_Ç_æags_»£rved
 
nd_Ç_hdr
.
icmp6_d©a32
[0]

	)

163 #ià 
BYTE_ORDER
 =ğ
BIG_ENDIAN


164 
	#ND_NA_FLAG_ROUTER
 0x80000000

	)

165 
	#ND_NA_FLAG_SOLICITED
 0x40000000

	)

166 
	#ND_NA_FLAG_OVERRIDE
 0x20000000

	)

168 
	#ND_NA_FLAG_ROUTER
 0x00000080

	)

169 
	#ND_NA_FLAG_SOLICITED
 0x00000040

	)

170 
	#ND_NA_FLAG_OVERRIDE
 0x00000020

	)

173 
	snd_»dœeù


175 
icmp6_hdr
 
	mnd_rd_hdr
;

176 
š6_addr
 
	mnd_rd_rg‘
;

177 
š6_addr
 
	mnd_rd_d¡
;

181 
	#nd_rd_ty³
 
nd_rd_hdr
.
icmp6_ty³


	)

182 
	#nd_rd_code
 
nd_rd_hdr
.
icmp6_code


	)

183 
	#nd_rd_cksum
 
nd_rd_hdr
.
icmp6_cksum


	)

184 
	#nd_rd_»£rved
 
nd_rd_hdr
.
icmp6_d©a32
[0]

	)

186 
	snd_İt_hdr


188 
ušt8_t
 
	mnd_İt_ty³
;

189 
ušt8_t
 
	mnd_İt_Ën
;

193 
	#ND_OPT_SOURCE_LINKADDR
 1

	)

194 
	#ND_OPT_TARGET_LINKADDR
 2

	)

195 
	#ND_OPT_PREFIX_INFORMATION
 3

	)

196 
	#ND_OPT_REDIRECTED_HEADER
 4

	)

197 
	#ND_OPT_MTU
 5

	)

198 
	#ND_OPT_RTR_ADV_INTERVAL
 7

	)

199 
	#ND_OPT_HOME_AGENT_INFO
 8

	)

201 
	snd_İt_´efix_šfo


203 
ušt8_t
 
	mnd_İt_pi_ty³
;

204 
ušt8_t
 
	mnd_İt_pi_Ën
;

205 
ušt8_t
 
	mnd_İt_pi_´efix_Ën
;

206 
ušt8_t
 
	mnd_İt_pi_æags_»£rved
;

207 
ušt32_t
 
	mnd_İt_pi_v®id_time
;

208 
ušt32_t
 
	mnd_İt_pi_´eã¼ed_time
;

209 
ušt32_t
 
	mnd_İt_pi_»£rved2
;

210 
š6_addr
 
	mnd_İt_pi_´efix
;

213 
	#ND_OPT_PI_FLAG_ONLINK
 0x80

	)

214 
	#ND_OPT_PI_FLAG_AUTO
 0x40

	)

215 
	#ND_OPT_PI_FLAG_RADDR
 0x20

	)

217 
	snd_İt_rd_hdr


219 
ušt8_t
 
	mnd_İt_rh_ty³
;

220 
ušt8_t
 
	mnd_İt_rh_Ën
;

221 
ušt16_t
 
	mnd_İt_rh_»£rved1
;

222 
ušt32_t
 
	mnd_İt_rh_»£rved2
;

226 
	snd_İt_mtu


228 
ušt8_t
 
	mnd_İt_mtu_ty³
;

229 
ušt8_t
 
	mnd_İt_mtu_Ën
;

230 
ušt16_t
 
	mnd_İt_mtu_»£rved
;

231 
ušt32_t
 
	mnd_İt_mtu_mtu
;

234 
	smld_hdr


236 
icmp6_hdr
 
	mmld_icmp6_hdr
;

237 
š6_addr
 
	mmld_addr
;

240 
	#mld_ty³
 
mld_icmp6_hdr
.
icmp6_ty³


	)

241 
	#mld_code
 
mld_icmp6_hdr
.
icmp6_code


	)

242 
	#mld_cksum
 
mld_icmp6_hdr
.
icmp6_cksum


	)

243 
	#mld_maxd–ay
 
mld_icmp6_hdr
.
icmp6_d©a16
[0]

	)

244 
	#mld_»£rved
 
mld_icmp6_hdr
.
icmp6_d©a16
[1]

	)

246 
	#ICMP6_ROUTER_RENUMBERING
 138

	)

248 
	sicmp6_rou‹r_»num


250 
icmp6_hdr
 
	m¼_hdr
;

251 
ušt8_t
 
	m¼_£gnum
;

252 
ušt8_t
 
	m¼_æags
;

253 
ušt16_t
 
	m¼_maxd–ay
;

254 
ušt32_t
 
	m¼_»£rved
;

257 
	#¼_ty³
 
¼_hdr
.
icmp6_ty³


	)

258 
	#¼_code
 
¼_hdr
.
icmp6_code


	)

259 
	#¼_cksum
 
¼_hdr
.
icmp6_cksum


	)

260 
	#¼_£qnum
 
¼_hdr
.
icmp6_d©a32
[0]

	)

263 
	#ICMP6_RR_FLAGS_TEST
 0x80

	)

264 
	#ICMP6_RR_FLAGS_REQRESULT
 0x40

	)

265 
	#ICMP6_RR_FLAGS_FORCEAPPLY
 0x20

	)

266 
	#ICMP6_RR_FLAGS_SPECSITE
 0x10

	)

267 
	#ICMP6_RR_FLAGS_PREVDONE
 0x08

	)

269 
	s¼_pco_m©ch


271 
ušt8_t
 
	m½m_code
;

272 
ušt8_t
 
	m½m_Ën
;

273 
ušt8_t
 
	m½m_Üdš®
;

274 
ušt8_t
 
	m½m_m©chËn
;

275 
ušt8_t
 
	m½m_mšËn
;

276 
ušt8_t
 
	m½m_maxËn
;

277 
ušt16_t
 
	m½m_»£rved
;

278 
š6_addr
 
	m½m_´efix
;

282 
	#RPM_PCO_ADD
 1

	)

283 
	#RPM_PCO_CHANGE
 2

	)

284 
	#RPM_PCO_SETGLOBAL
 3

	)

286 
	s¼_pco_u£


288 
ušt8_t
 
	m½u_u£Ën
;

289 
ušt8_t
 
	m½u_k“¶’
;

290 
ušt8_t
 
	m½u_¿mask
;

291 
ušt8_t
 
	m½u_¿æags
;

292 
ušt32_t
 
	m½u_vÉime
;

293 
ušt32_t
 
	m½u_¶time
;

294 
ušt32_t
 
	m½u_æags
;

295 
š6_addr
 
	m½u_´efix
;

298 
	#ICMP6_RR_PCOUSE_RAFLAGS_ONLINK
 0x20

	)

299 
	#ICMP6_RR_PCOUSE_RAFLAGS_AUTO
 0x10

	)

301 #ià
BYTE_ORDER
 =ğ
BIG_ENDIAN


302 
	#ICMP6_RR_PCOUSE_FLAGS_DECRVLTIME
 0x80000000

	)

303 
	#ICMP6_RR_PCOUSE_FLAGS_DECRPLTIME
 0x40000000

	)

304 #–ià
BYTE_ORDER
 =ğ
LITTLE_ENDIAN


305 
	#ICMP6_RR_PCOUSE_FLAGS_DECRVLTIME
 0x80

	)

306 
	#ICMP6_RR_PCOUSE_FLAGS_DECRPLTIME
 0x40

	)

309 
	s¼_»suÉ


311 
ušt16_t
 
	m¼r_æags
;

312 
ušt8_t
 
	m¼r_Üdš®
;

313 
ušt8_t
 
	m¼r_m©chedËn
;

314 
ušt32_t
 
	m¼r_ifid
;

315 
š6_addr
 
	m¼r_´efix
;

318 #ià
BYTE_ORDER
 =ğ
BIG_ENDIAN


319 
	#ICMP6_RR_RESULT_FLAGS_OOB
 0x0002

	)

320 
	#ICMP6_RR_RESULT_FLAGS_FORBIDDEN
 0x0001

	)

321 #–ià
BYTE_ORDER
 =ğ
LITTLE_ENDIAN


322 
	#ICMP6_RR_RESULT_FLAGS_OOB
 0x0200

	)

323 
	#ICMP6_RR_RESULT_FLAGS_FORBIDDEN
 0x0100

	)

327 
	snd_İt_adv_š‹rv®


329 
ušt8_t
 
	mnd_İt_adv_š‹rv®_ty³
;

330 
ušt8_t
 
	mnd_İt_adv_š‹rv®_Ën
;

331 
ušt16_t
 
	mnd_İt_adv_š‹rv®_»£rved
;

332 
ušt32_t
 
	mnd_İt_adv_š‹rv®_iv®
;

336 
	snd_İt_home_ag’t_šfo


338 
ušt8_t
 
	mnd_İt_home_ag’t_šfo_ty³
;

339 
ušt8_t
 
	mnd_İt_home_ag’t_šfo_Ën
;

340 
ušt16_t
 
	mnd_İt_home_ag’t_šfo_»£rved
;

341 
ušt16_t
 
	mnd_İt_home_ag’t_šfo_´eã»nû
;

342 
ušt16_t
 
	mnd_İt_home_ag’t_šfo_liãtime
;

	@/usr/include/netinet/in.h

18 #iâdef 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<¡dšt.h
>

23 
	~<sys/sock‘.h
>

24 
	~<b™s/ty³s.h
>

27 
__BEGIN_DECLS


30 
ušt32_t
 
	tš_addr_t
;

31 
	sš_addr


33 
š_addr_t
 
	ms_addr
;

37 
	~<b™s/š.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_RAW
 = 255,

89 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

90 
	mIPPROTO_MAX


96 #iâdeà
__USE_KERNEL_IPV6_DEFS


99 
	mIPPROTO_HOPOPTS
 = 0,

100 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

101 
	mIPPROTO_ROUTING
 = 43,

102 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

103 
	mIPPROTO_FRAGMENT
 = 44,

104 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

105 
	mIPPROTO_ICMPV6
 = 58,

106 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

107 
	mIPPROTO_NONE
 = 59,

108 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

109 
	mIPPROTO_DSTOPTS
 = 60,

110 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

111 
	mIPPROTO_MH
 = 135

112 
	#IPPROTO_MH
 
IPPROTO_MH


	)

117 
ušt16_t
 
	tš_pÜt_t
;

122 
	mIPPORT_ECHO
 = 7,

123 
	mIPPORT_DISCARD
 = 9,

124 
	mIPPORT_SYSTAT
 = 11,

125 
	mIPPORT_DAYTIME
 = 13,

126 
	mIPPORT_NETSTAT
 = 15,

127 
	mIPPORT_FTP
 = 21,

128 
	mIPPORT_TELNET
 = 23,

129 
	mIPPORT_SMTP
 = 25,

130 
	mIPPORT_TIMESERVER
 = 37,

131 
	mIPPORT_NAMESERVER
 = 42,

132 
	mIPPORT_WHOIS
 = 43,

133 
	mIPPORT_MTP
 = 57,

135 
	mIPPORT_TFTP
 = 69,

136 
	mIPPORT_RJE
 = 77,

137 
	mIPPORT_FINGER
 = 79,

138 
	mIPPORT_TTYLINK
 = 87,

139 
	mIPPORT_SUPDUP
 = 95,

142 
	mIPPORT_EXECSERVER
 = 512,

143 
	mIPPORT_LOGINSERVER
 = 513,

144 
	mIPPORT_CMDSERVER
 = 514,

145 
	mIPPORT_EFSSERVER
 = 520,

148 
	mIPPORT_BIFFUDP
 = 512,

149 
	mIPPORT_WHOSERVER
 = 513,

150 
	mIPPORT_ROUTESERVER
 = 520,

153 
	mIPPORT_RESERVED
 = 1024,

156 
	mIPPORT_USERRESERVED
 = 5000

164 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

165 
	#IN_CLASSA_NET
 0xff000000

	)

166 
	#IN_CLASSA_NSHIFT
 24

	)

167 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

168 
	#IN_CLASSA_MAX
 128

	)

170 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

171 
	#IN_CLASSB_NET
 0xffff0000

	)

172 
	#IN_CLASSB_NSHIFT
 16

	)

173 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

174 
	#IN_CLASSB_MAX
 65536

	)

176 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

177 
	#IN_CLASSC_NET
 0xffffff00

	)

178 
	#IN_CLASSC_NSHIFT
 8

	)

179 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

181 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

182 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

184 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

185 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

188 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

190 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

192 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

195 
	#IN_LOOPBACKNET
 127

	)

197 #iâdeà
INADDR_LOOPBACK


198 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

202 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

203 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

204 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

205 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

207 #iâdeà
__USE_KERNEL_IPV6_DEFS


209 
	sš6_addr


213 
ušt8_t
 
	m__u6_addr8
[16];

214 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


215 
ušt16_t
 
	m__u6_addr16
[8];

216 
ušt32_t
 
	m__u6_addr32
[4];

218 } 
	m__š6_u
;

219 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

220 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


221 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

222 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

227 cÚ¡ 
š6_addr
 
š6addr_ªy
;

228 cÚ¡ 
š6_addr
 
š6addr_loİback
;

229 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

230 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

232 
	#INET_ADDRSTRLEN
 16

	)

233 
	#INET6_ADDRSTRLEN
 46

	)

237 
	ssockaddr_š


239 
__SOCKADDR_COMMON
 (
sš_
);

240 
š_pÜt_t
 
	msš_pÜt
;

241 
š_addr
 
	msš_addr
;

244 
	msš_z”o
[ (
sockaddr
) -

245 
__SOCKADDR_COMMON_SIZE
 -

246  (
š_pÜt_t
) -

247  (
š_addr
)];

250 #iâdeà
__USE_KERNEL_IPV6_DEFS


252 
	ssockaddr_š6


254 
__SOCKADDR_COMMON
 (
sš6_
);

255 
š_pÜt_t
 
	msš6_pÜt
;

256 
ušt32_t
 
	msš6_æowšfo
;

257 
š6_addr
 
	msš6_addr
;

258 
ušt32_t
 
	msš6_scİe_id
;

262 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


264 
	s_m»q


267 
š_addr
 
	mimr_muÉŸddr
;

270 
š_addr
 
	mimr_š‹rçû
;

273 
	s_m»q_sourû


276 
š_addr
 
	mimr_muÉŸddr
;

279 
š_addr
 
	mimr_š‹rçû
;

282 
š_addr
 
	mimr_sourûaddr
;

286 #iâdeà
__USE_KERNEL_IPV6_DEFS


288 
	sv6_m»q


291 
š6_addr
 
	mv6mr_muÉŸddr
;

294 
	mv6mr_š‹rçû
;

298 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


300 
	sgroup_»q


303 
ušt32_t
 
	mgr_š‹rçû
;

306 
sockaddr_¡Üage
 
	mgr_group
;

309 
	sgroup_sourû_»q


312 
ušt32_t
 
	mg¤_š‹rçû
;

315 
sockaddr_¡Üage
 
	mg¤_group
;

318 
sockaddr_¡Üage
 
	mg¤_sourû
;

323 
	s_msf‹r


326 
š_addr
 
	mimsf_muÉŸddr
;

329 
š_addr
 
	mimsf_š‹rçû
;

332 
ušt32_t
 
	mimsf_fmode
;

335 
ušt32_t
 
	mimsf_num¤c
;

337 
š_addr
 
	mimsf_¦i¡
[1];

340 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

341 -  (
š_addr
) \

342 + (
num¤c
è*  (
š_addr
))

	)

344 
	sgroup_f‹r


347 
ušt32_t
 
	mgf_š‹rçû
;

350 
sockaddr_¡Üage
 
	mgf_group
;

353 
ušt32_t
 
	mgf_fmode
;

356 
ušt32_t
 
	mgf_num¤c
;

358 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

361 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

362 -  (
sockaddr_¡Üage
) \

363 + ((
num¤c
) \

364 *  (
sockaddr_¡Üage
)))

	)

374 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

375 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

376 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

377 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

378 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

379 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

380 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

382 
	~<’dŸn.h
>

385 
	~<b™s/by‹sw­.h
>

387 #ifdeà
__OPTIMIZE__


391 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


394 
	#Áohl
(
x
è(x)

	)

395 
	#Áohs
(
x
è(x)

	)

396 
	#htÚl
(
x
è(x)

	)

397 
	#htÚs
(
x
è(x)

	)

399 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


400 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

401 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

402 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

403 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

408 #ifdeà
__GNUC__


409 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

410 (
__ex‹nsiÚ__
 \

411 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

412 
__a
->
s6_addr32
[0] == 0 \

413 && 
__a
->
s6_addr32
[1] == 0 \

414 && 
__a
->
s6_addr32
[2] == 0 \

415 && 
__a
->
s6_addr32
[3] =ğ0; 
	}
}))

	)

417 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

418 (
__ex‹nsiÚ__
 \

419 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

420 
__a
->
s6_addr32
[0] == 0 \

421 && 
__a
->
s6_addr32
[1] == 0 \

422 && 
__a
->
s6_addr32
[2] == 0 \

423 && 
__a
->
s6_addr32
[3] =ğ
	`htÚl
 (1); }))

	)

425 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

426 (
__ex‹nsiÚ__
 \

427 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

428 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xã800000); }))

	)

430 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

431 (
__ex‹nsiÚ__
 \

432 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

433 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xãc00000); }))

	)

435 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

436 (
__ex‹nsiÚ__
 \

437 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

438 
__a
->
s6_addr32
[0] == 0 \

439 && 
__a
->
s6_addr32
[1] == 0 \

440 && 
__a
->
s6_addr32
[2] =ğ
	`htÚl
 (0xffff); }))

	)

442 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

443 (
__ex‹nsiÚ__
 \

444 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

445 
__a
->
s6_addr32
[0] == 0 \

446 && 
__a
->
s6_addr32
[1] == 0 \

447 && 
__a
->
s6_addr32
[2] == 0 \

448 && 
	`Áohl
 (
__a
->
s6_addr32
[3]è> 1; }))

	)

450 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

451 (
__ex‹nsiÚ__
 \

452 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

453 cÚ¡ 
š6_addr
 *
__b
 = (cÚ¡ š6_add¸*è(
b
); \

454 
__a
->
s6_addr32
[0] =ğ
__b
->s6_addr32[0] \

455 && 
__a
->
s6_addr32
[1] =ğ
__b
->s6_addr32[1] \

456 && 
__a
->
s6_addr32
[2] =ğ
__b
->s6_addr32[2] \

457 && 
__a
->
s6_addr32
[3] =ğ
__b
->s6_addr32[3]; }))

	)

459 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

460 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

461 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

462 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

463 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

465 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

466 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

467 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

468 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

469 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

471 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

472 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

473 =ğ
	`htÚl
 (0xã800000))

	)

475 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

476 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

477 =ğ
	`htÚl
 (0xãc00000))

	)

479 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

480 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

481 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

482 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

484 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

485 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

486 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

487 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0) \

488 && (
	`Áohl
 (((cÚ¡ 
ušt32_t
 *è(
a
))[3]è> 1))

	)

490 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

491 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[0]) \

492 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[1]) \

493 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[2]) \

494 && (((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

497 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((cÚ¡ 
ušt8_t
 *è×))[0] =ğ0xff)

	)

499 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


501 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

504 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

505 
__THROW
;

509 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

510 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

511 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

513 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

514 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

515 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

517 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

518 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

519 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

521 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

522 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

523 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

525 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

526 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

527 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

530 #ifdeà
__USE_GNU


531 
cmsghdr
;

534 
	sš6_pktšfo


536 
š6_addr
 
i6_addr
;

537 
i6_ifšdex
;

541 
	s6_mtušfo


543 
sockaddr_š6
 
6m_addr
;

544 
ušt32_t
 
6m_mtu
;

549 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

550 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

551 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

552 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

553 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

554 cÚ¡ 
ušt8_t
 *
__ty³p
, 
__muÉx
,

555 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

556 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

557 
__muÉx
, 
__¶usy
)

558 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

559 
	$š‘6_İtiÚ_Ãxt
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

560 
ušt8_t
 **
__Œp
)

561 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

562 
	$š‘6_İtiÚ_fšd
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

563 
ušt8_t
 **
__Œp
, 
__ty³
)

564 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

568 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

569 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

570 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

571 **
__d©abuå
è
__THROW
;

572 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

573 
__THROW
;

574 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

575 
sockËn_t
 
__v®Ën
è
__THROW
;

576 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

577 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

578 **
__d©abuå
è
__THROW
;

579 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

580 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

581 **
__d©abuå
è
__THROW
;

582 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

583 
sockËn_t
 
__v®Ën
è
__THROW
;

587 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

588 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

589 
__£gm’ts
è
__THROW
;

590 
	$š‘6_¹h_add
 (*
__bp
, cÚ¡ 
š6_addr
 *
__addr
è
__THROW
;

591 
	$š‘6_¹h_»v”£
 (cÚ¡ *
__š
, *
__out
è
__THROW
;

592 
	$š‘6_¹h_£gm’ts
 (cÚ¡ *
__bp
è
__THROW
;

593 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (cÚ¡ *
__bp
, 
__šdex
)

594 
__THROW
;

600 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

601 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

602 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

603 
__THROW
;

606 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

607 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

608 
ušt32_t
 
__num¤c
,

609 cÚ¡ 
š_addr
 *
__¦i¡
)

610 
__THROW
;

614 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

615 cÚ¡ 
sockaddr
 *
__group
,

616 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

617 
ušt32_t
 *
__num¤c
,

618 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

621 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

622 cÚ¡ 
sockaddr
 *
__group
,

623 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

624 
ušt32_t
 
__num¤c
,

625 cÚ¡ 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

628 
__END_DECLS


	@/usr/include/netinet/in_systm.h

19 #iâdeà
_NETINET_IN_SYSTM_H


20 
	#_NETINET_IN_SYSTM_H
 1

	)

22 
	~<sys/cdefs.h
>

23 
	~<sys/ty³s.h
>

25 
__BEGIN_DECLS


34 
u_št16_t
 
	tn_shÜt
;

35 
u_št32_t
 
	tn_lÚg
;

36 
u_št32_t
 
	tn_time
;

38 
	g__END_DECLS


	@/usr/include/netinet/ip.h

18 #iâdeà
__NETINET_IP_H


19 
	#__NETINET_IP_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<sys/ty³s.h
>

24 
	~<Ãtš‘/š.h
>

26 
__BEGIN_DECLS


28 
	stime¡amp


30 
u_št8_t
 
	mËn
;

31 
u_št8_t
 
	m±r
;

32 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


33 
	mæags
:4;

34 
	mov”æow
:4;

35 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


36 
	mov”æow
:4;

37 
	mæags
:4;

41 
u_št32_t
 
	md©a
[9];

44 
	shdr


46 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


47 
	mihl
:4;

48 
	mv”siÚ
:4;

49 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


50 
	mv”siÚ
:4;

51 
	mihl
:4;

55 
u_št8_t
 
	mtos
;

56 
u_št16_t
 
	mtÙ_Ën
;

57 
u_št16_t
 
	mid
;

58 
u_št16_t
 
	mäag_off
;

59 
u_št8_t
 
	m‰l
;

60 
u_št8_t
 
	m´ÙocŞ
;

61 
u_št16_t
 
	mcheck
;

62 
u_št32_t
 
	m§ddr
;

63 
u_št32_t
 
	mdaddr
;

67 #ifdeà
__USE_BSD


107 
	s


109 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


110 
	m_hl
:4;

111 
	m_v
:4;

113 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


114 
	m_v
:4;

115 
	m_hl
:4;

117 
u_št8_t
 
	m_tos
;

118 
u_shÜt
 
	m_Ën
;

119 
u_shÜt
 
	m_id
;

120 
u_shÜt
 
	m_off
;

121 
	#IP_RF
 0x8000

	)

122 
	#IP_DF
 0x4000

	)

123 
	#IP_MF
 0x2000

	)

124 
	#IP_OFFMASK
 0x1ffà

	)

125 
u_št8_t
 
	m_‰l
;

126 
u_št8_t
 
	m_p
;

127 
u_shÜt
 
	m_sum
;

128 
š_addr
 
	m_¤c
, 
	m_d¡
;

134 
	s_time¡amp


136 
u_št8_t
 
	mt_code
;

137 
u_št8_t
 
	mt_Ën
;

138 
u_št8_t
 
	mt_±r
;

139 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


140 
	mt_æg
:4;

141 
	mt_oæw
:4;

143 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


144 
	mt_oæw
:4;

145 
	mt_æg
:4;

147 
u_št32_t
 
	md©a
[9];

151 
	#IPVERSION
 4

	)

152 
	#IP_MAXPACKET
 65535

	)

160 
	#IPTOS_ECN_MASK
 0x03

	)

161 
	#IPTOS_ECN
(
x
è((xè& 
IPTOS_ECN_MASK
)

	)

162 
	#IPTOS_ECN_NOT_ECT
 0x00

	)

163 
	#IPTOS_ECN_ECT1
 0x01

	)

164 
	#IPTOS_ECN_ECT0
 0x02

	)

165 
	#IPTOS_ECN_CE
 0x03

	)

173 
	#IPTOS_DSCP_MASK
 0xfc

	)

174 
	#IPTOS_DSCP
(
x
è((xè& 
IPTOS_DSCP_MASK
)

	)

175 
	#IPTOS_DSCP_AF11
 0x28

	)

176 
	#IPTOS_DSCP_AF12
 0x30

	)

177 
	#IPTOS_DSCP_AF13
 0x38

	)

178 
	#IPTOS_DSCP_AF21
 0x48

	)

179 
	#IPTOS_DSCP_AF22
 0x50

	)

180 
	#IPTOS_DSCP_AF23
 0x58

	)

181 
	#IPTOS_DSCP_AF31
 0x68

	)

182 
	#IPTOS_DSCP_AF32
 0x70

	)

183 
	#IPTOS_DSCP_AF33
 0x78

	)

184 
	#IPTOS_DSCP_AF41
 0x88

	)

185 
	#IPTOS_DSCP_AF42
 0x90

	)

186 
	#IPTOS_DSCP_AF43
 0x98

	)

187 
	#IPTOS_DSCP_EF
 0xb8

	)

194 
	#IPTOS_CLASS_MASK
 0xe0

	)

195 
	#IPTOS_CLASS
(
şass
è((şassè& 
IPTOS_CLASS_MASK
)

	)

196 
	#IPTOS_CLASS_CS0
 0x00

	)

197 
	#IPTOS_CLASS_CS1
 0x20

	)

198 
	#IPTOS_CLASS_CS2
 0x40

	)

199 
	#IPTOS_CLASS_CS3
 0x60

	)

200 
	#IPTOS_CLASS_CS4
 0x80

	)

201 
	#IPTOS_CLASS_CS5
 0xa0

	)

202 
	#IPTOS_CLASS_CS6
 0xc0

	)

203 
	#IPTOS_CLASS_CS7
 0xe0

	)

205 
	#IPTOS_CLASS_DEFAULT
 
IPTOS_CLASS_CS0


	)

211 
	#IPTOS_TOS_MASK
 0x1E

	)

212 
	#IPTOS_TOS
(
tos
è(Ñosè& 
IPTOS_TOS_MASK
)

	)

213 
	#IPTOS_LOWDELAY
 0x10

	)

214 
	#IPTOS_THROUGHPUT
 0x08

	)

215 
	#IPTOS_RELIABILITY
 0x04

	)

216 
	#IPTOS_LOWCOST
 0x02

	)

217 
	#IPTOS_MINCOST
 
IPTOS_LOWCOST


	)

222 
	#IPTOS_PREC_MASK
 
IPTOS_CLASS_MASK


	)

223 
	#IPTOS_PREC
(
tos
è
	`IPTOS_CLASS
Ños)

	)

224 
	#IPTOS_PREC_NETCONTROL
 
IPTOS_CLASS_CS7


	)

225 
	#IPTOS_PREC_INTERNETCONTROL
 
IPTOS_CLASS_CS6


	)

226 
	#IPTOS_PREC_CRITIC_ECP
 
IPTOS_CLASS_CS5


	)

227 
	#IPTOS_PREC_FLASHOVERRIDE
 
IPTOS_CLASS_CS4


	)

228 
	#IPTOS_PREC_FLASH
 
IPTOS_CLASS_CS3


	)

229 
	#IPTOS_PREC_IMMEDIATE
 
IPTOS_CLASS_CS2


	)

230 
	#IPTOS_PREC_PRIORITY
 
IPTOS_CLASS_CS1


	)

231 
	#IPTOS_PREC_ROUTINE
 
IPTOS_CLASS_CS0


	)

236 
	#IPOPT_COPY
 0x80

	)

237 
	#IPOPT_CLASS_MASK
 0x60

	)

238 
	#IPOPT_NUMBER_MASK
 0x1f

	)

240 
	#IPOPT_COPIED
(
o
è((oè& 
IPOPT_COPY
)

	)

241 
	#IPOPT_CLASS
(
o
è((oè& 
IPOPT_CLASS_MASK
)

	)

242 
	#IPOPT_NUMBER
(
o
è((oè& 
IPOPT_NUMBER_MASK
)

	)

244 
	#IPOPT_CONTROL
 0x00

	)

245 
	#IPOPT_RESERVED1
 0x20

	)

246 
	#IPOPT_DEBMEAS
 0x40

	)

247 
	#IPOPT_MEASUREMENT
 
IPOPT_DEBMEAS


	)

248 
	#IPOPT_RESERVED2
 0x60

	)

250 
	#IPOPT_EOL
 0

	)

251 
	#IPOPT_END
 
IPOPT_EOL


	)

252 
	#IPOPT_NOP
 1

	)

253 
	#IPOPT_NOOP
 
IPOPT_NOP


	)

255 
	#IPOPT_RR
 7

	)

256 
	#IPOPT_TS
 68

	)

257 
	#IPOPT_TIMESTAMP
 
IPOPT_TS


	)

258 
	#IPOPT_SECURITY
 130

	)

259 
	#IPOPT_SEC
 
IPOPT_SECURITY


	)

260 
	#IPOPT_LSRR
 131

	)

261 
	#IPOPT_SATID
 136

	)

262 
	#IPOPT_SID
 
IPOPT_SATID


	)

263 
	#IPOPT_SSRR
 137

	)

264 
	#IPOPT_RA
 148

	)

269 
	#IPOPT_OPTVAL
 0

	)

270 
	#IPOPT_OLEN
 1

	)

271 
	#IPOPT_OFFSET
 2

	)

272 
	#IPOPT_MINOFF
 4

	)

274 
	#MAX_IPOPTLEN
 40

	)

277 
	#IPOPT_TS_TSONLY
 0

	)

278 
	#IPOPT_TS_TSANDADDR
 1

	)

279 
	#IPOPT_TS_PRESPEC
 3

	)

282 
	#IPOPT_SECUR_UNCLASS
 0x0000

	)

283 
	#IPOPT_SECUR_CONFID
 0xf135

	)

284 
	#IPOPT_SECUR_EFTO
 0x789a

	)

285 
	#IPOPT_SECUR_MMMM
 0xbc4d

	)

286 
	#IPOPT_SECUR_RESTR
 0xaf13

	)

287 
	#IPOPT_SECUR_SECRET
 0xd788

	)

288 
	#IPOPT_SECUR_TOPSECRET
 0x6bc5

	)

293 
	#MAXTTL
 255

	)

294 
	#IPDEFTTL
 64

	)

295 
	#IPFRAGTTL
 60

	)

296 
	#IPTTLDEC
 1

	)

298 
	#IP_MSS
 576

	)

300 
	g__END_DECLS


	@/usr/include/netinet/ip6.h

18 #iâdeà
_NETINET_IP6_H


19 
	#_NETINET_IP6_H
 1

	)

21 
	~<š‰y³s.h
>

22 
	~<Ãtš‘/š.h
>

24 
	s6_hdr


28 
	s6_hdrùl


30 
ušt32_t
 
	m6_un1_æow
;

32 
ušt16_t
 
	m6_un1_¶’
;

33 
ušt8_t
 
	m6_un1_nxt
;

34 
ušt8_t
 
	m6_un1_hlim
;

35 } 
	m6_un1
;

36 
ušt8_t
 
	m6_un2_vfc
;

37 } 
	m6_ùlun
;

38 
š6_addr
 
	m6_¤c
;

39 
š6_addr
 
	m6_d¡
;

42 
	#6_vfc
 
6_ùlun
.
6_un2_vfc


	)

43 
	#6_æow
 
6_ùlun
.
6_un1
.
6_un1_æow


	)

44 
	#6_¶’
 
6_ùlun
.
6_un1
.
6_un1_¶’


	)

45 
	#6_nxt
 
6_ùlun
.
6_un1
.
6_un1_nxt


	)

46 
	#6_hlim
 
6_ùlun
.
6_un1
.
6_un1_hlim


	)

47 
	#6_hİs
 
6_ùlun
.
6_un1
.
6_un1_hlim


	)

50 
	s6_ext


52 
ušt8_t
 
	m6e_nxt
;

53 
ušt8_t
 
	m6e_Ën
;

57 
	s6_hbh


59 
ušt8_t
 
	m6h_nxt
;

60 
ušt8_t
 
	m6h_Ën
;

65 
	s6_de¡


67 
ušt8_t
 
	m6d_nxt
;

68 
ušt8_t
 
	m6d_Ën
;

73 
	s6_¹hdr


75 
ušt8_t
 
	m6r_nxt
;

76 
ušt8_t
 
	m6r_Ën
;

77 
ušt8_t
 
	m6r_ty³
;

78 
ušt8_t
 
	m6r_£gËá
;

83 
	s6_¹hdr0


85 
ušt8_t
 
	m6r0_nxt
;

86 
ušt8_t
 
	m6r0_Ën
;

87 
ušt8_t
 
	m6r0_ty³
;

88 
ušt8_t
 
	m6r0_£gËá
;

89 
ušt8_t
 
	m6r0_»£rved
;

90 
ušt8_t
 
	m6r0_¦m­
[3];

92 
š6_addr
 
	m6r0_addr
[0];

96 
	s6_äag


98 
ušt8_t
 
	m6f_nxt
;

99 
ušt8_t
 
	m6f_»£rved
;

100 
ušt16_t
 
	m6f_ofæg
;

101 
ušt32_t
 
	m6f_id’t
;

104 #ià
BYTE_ORDER
 =ğ
BIG_ENDIAN


105 
	#IP6F_OFF_MASK
 0xfff8

	)

106 
	#IP6F_RESERVED_MASK
 0x0006

	)

107 
	#IP6F_MORE_FRAG
 0x0001

	)

109 
	#IP6F_OFF_MASK
 0xf8fà

	)

110 
	#IP6F_RESERVED_MASK
 0x0600

	)

111 
	#IP6F_MORE_FRAG
 0x0100

	)

115 
	s6_İt


117 
ušt8_t
 
	m6o_ty³
;

118 
ušt8_t
 
	m6o_Ën
;

125 
	#IP6OPT_TYPE
(
o
è((oè& 0xc0)

	)

126 
	#IP6OPT_TYPE_SKIP
 0x00

	)

127 
	#IP6OPT_TYPE_DISCARD
 0x40

	)

128 
	#IP6OPT_TYPE_FORCEICMP
 0x80

	)

129 
	#IP6OPT_TYPE_ICMP
 0xc0

	)

130 
	#IP6OPT_TYPE_MUTABLE
 0x20

	)

133 
	#IP6OPT_PAD1
 0

	)

134 
	#IP6OPT_PADN
 1

	)

136 
	#IP6OPT_JUMBO
 0xc2

	)

137 
	#IP6OPT_NSAP_ADDR
 0xc3

	)

138 
	#IP6OPT_TUNNEL_LIMIT
 0x04

	)

139 
	#IP6OPT_ROUTER_ALERT
 0x05

	)

142 
	s6_İt_jumbo


144 
ušt8_t
 
	m6oj_ty³
;

145 
ušt8_t
 
	m6oj_Ën
;

146 
ušt8_t
 
	m6oj_jumbo_Ën
[4];

148 
	#IP6OPT_JUMBO_LEN
 6

	)

151 
	s6_İt_n§p


153 
ušt8_t
 
	m6Ú_ty³
;

154 
ušt8_t
 
	m6Ú_Ën
;

155 
ušt8_t
 
	m6Ú_¤c_n§p_Ën
;

156 
ušt8_t
 
	m6Ú_d¡_n§p_Ën
;

162 
	s6_İt_tuÂ–


164 
ušt8_t
 
	m6Ù_ty³
;

165 
ušt8_t
 
	m6Ù_Ën
;

166 
ušt8_t
 
	m6Ù_’ÿp_lim™
;

170 
	s6_İt_rou‹r


172 
ušt8_t
 
	m6Ü_ty³
;

173 
ušt8_t
 
	m6Ü_Ën
;

174 
ušt8_t
 
	m6Ü_v®ue
[2];

178 #ià
BYTE_ORDER
 =ğ
BIG_ENDIAN


179 
	#IP6_ALERT_MLD
 0x0000

	)

180 
	#IP6_ALERT_RSVP
 0x0001

	)

181 
	#IP6_ALERT_AN
 0x0002

	)

183 
	#IP6_ALERT_MLD
 0x0000

	)

184 
	#IP6_ALERT_RSVP
 0x0100

	)

185 
	#IP6_ALERT_AN
 0x0200

	)

	@/usr/include/netinet/ip_icmp.h

18 #iâdeà
__NETINET_IP_ICMP_H


19 
	#__NETINET_IP_ICMP_H
 1

	)

21 
	~<sys/cdefs.h
>

22 
	~<sys/ty³s.h
>

24 
__BEGIN_DECLS


26 
	sicmphdr


28 
u_št8_t
 
	mty³
;

29 
u_št8_t
 
	mcode
;

30 
u_št16_t
 
	mchecksum
;

35 
u_št16_t
 
	mid
;

36 
u_št16_t
 
	m£qu’û
;

37 } 
	mecho
;

38 
u_št32_t
 
	mg©eway
;

41 
u_št16_t
 
	m__glibc_»£rved
;

42 
u_št16_t
 
	mmtu
;

43 } 
	mäag
;

44 } 
	mun
;

47 
	#ICMP_ECHOREPLY
 0

	)

48 
	#ICMP_DEST_UNREACH
 3

	)

49 
	#ICMP_SOURCE_QUENCH
 4

	)

50 
	#ICMP_REDIRECT
 5

	)

51 
	#ICMP_ECHO
 8

	)

52 
	#ICMP_TIME_EXCEEDED
 11

	)

53 
	#ICMP_PARAMETERPROB
 12

	)

54 
	#ICMP_TIMESTAMP
 13

	)

55 
	#ICMP_TIMESTAMPREPLY
 14

	)

56 
	#ICMP_INFO_REQUEST
 15

	)

57 
	#ICMP_INFO_REPLY
 16

	)

58 
	#ICMP_ADDRESS
 17

	)

59 
	#ICMP_ADDRESSREPLY
 18

	)

60 
	#NR_ICMP_TYPES
 18

	)

64 
	#ICMP_NET_UNREACH
 0

	)

65 
	#ICMP_HOST_UNREACH
 1

	)

66 
	#ICMP_PROT_UNREACH
 2

	)

67 
	#ICMP_PORT_UNREACH
 3

	)

68 
	#ICMP_FRAG_NEEDED
 4

	)

69 
	#ICMP_SR_FAILED
 5

	)

70 
	#ICMP_NET_UNKNOWN
 6

	)

71 
	#ICMP_HOST_UNKNOWN
 7

	)

72 
	#ICMP_HOST_ISOLATED
 8

	)

73 
	#ICMP_NET_ANO
 9

	)

74 
	#ICMP_HOST_ANO
 10

	)

75 
	#ICMP_NET_UNR_TOS
 11

	)

76 
	#ICMP_HOST_UNR_TOS
 12

	)

77 
	#ICMP_PKT_FILTERED
 13

	)

78 
	#ICMP_PREC_VIOLATION
 14

	)

79 
	#ICMP_PREC_CUTOFF
 15

	)

80 
	#NR_ICMP_UNREACH
 15

	)

83 
	#ICMP_REDIR_NET
 0

	)

84 
	#ICMP_REDIR_HOST
 1

	)

85 
	#ICMP_REDIR_NETTOS
 2

	)

86 
	#ICMP_REDIR_HOSTTOS
 3

	)

89 
	#ICMP_EXC_TTL
 0

	)

90 
	#ICMP_EXC_FRAGTIME
 1

	)

93 #ifdeà
__USE_BSD


125 
	~<Ãtš‘/š.h
>

126 
	~<Ãtš‘/.h
>

131 
	sicmp_¿_addr


133 
u_št32_t
 
	mœa_addr
;

134 
u_št32_t
 
	mœa_´eã»nû
;

137 
	sicmp


139 
u_št8_t
 
	micmp_ty³
;

140 
u_št8_t
 
	micmp_code
;

141 
u_št16_t
 
	micmp_cksum
;

144 
u_ch¬
 
	mih_µŒ
;

145 
š_addr
 
	mih_gwaddr
;

146 
	sih_id£q


148 
u_št16_t
 
	micd_id
;

149 
u_št16_t
 
	micd_£q
;

150 } 
	mih_id£q
;

151 
u_št32_t
 
	mih_void
;

154 
	sih_pmtu


156 
u_št16_t
 
	mm_void
;

157 
u_št16_t
 
	mm_Ãxtmtu
;

158 } 
	mih_pmtu
;

160 
	sih_¹¿dv


162 
u_št8_t
 
	mœt_num_addrs
;

163 
u_št8_t
 
	mœt_w·
;

164 
u_št16_t
 
	mœt_liãtime
;

165 } 
	mih_¹¿dv
;

166 } 
	micmp_hun
;

167 
	#icmp_µŒ
 
icmp_hun
.
ih_µŒ


	)

168 
	#icmp_gwaddr
 
icmp_hun
.
ih_gwaddr


	)

169 
	#icmp_id
 
icmp_hun
.
ih_id£q
.
icd_id


	)

170 
	#icmp_£q
 
icmp_hun
.
ih_id£q
.
icd_£q


	)

171 
	#icmp_void
 
icmp_hun
.
ih_void


	)

172 
	#icmp_pmvoid
 
icmp_hun
.
ih_pmtu
.
m_void


	)

173 
	#icmp_Ãxtmtu
 
icmp_hun
.
ih_pmtu
.
m_Ãxtmtu


	)

174 
	#icmp_num_addrs
 
icmp_hun
.
ih_¹¿dv
.
œt_num_addrs


	)

175 
	#icmp_w·
 
icmp_hun
.
ih_¹¿dv
.
œt_w·


	)

176 
	#icmp_liãtime
 
icmp_hun
.
ih_¹¿dv
.
œt_liãtime


	)

181 
u_št32_t
 
	m™s_Ùime
;

182 
u_št32_t
 
	m™s_¹ime
;

183 
u_št32_t
 
	m™s_‰ime
;

184 } 
	mid_ts
;

187 

 
	midi_
;

189 } 
	mid_
;

190 
icmp_¿_addr
 
	mid_¿dv
;

191 
u_št32_t
 
	mid_mask
;

192 
u_št8_t
 
	mid_d©a
[1];

193 } 
	micmp_dun
;

194 
	#icmp_Ùime
 
icmp_dun
.
id_ts
.
™s_Ùime


	)

195 
	#icmp_¹ime
 
icmp_dun
.
id_ts
.
™s_¹ime


	)

196 
	#icmp_‰ime
 
icmp_dun
.
id_ts
.
™s_‰ime


	)

197 
	#icmp_
 
icmp_dun
.
id_
.
idi_


	)

198 
	#icmp_¿dv
 
icmp_dun
.
id_¿dv


	)

199 
	#icmp_mask
 
icmp_dun
.
id_mask


	)

200 
	#icmp_d©a
 
icmp_dun
.
id_d©a


	)

211 
	#ICMP_MINLEN
 8

	)

212 
	#ICMP_TSLEN
 (8 + 3 *  (
n_time
)è

	)

213 
	#ICMP_MASKLEN
 12

	)

214 
	#ICMP_ADVLENMIN
 (8 +  (

è+ 8è

	)

215 #iâdeà
_IP_VHL


216 
	#ICMP_ADVLEN
(
p
è(8 + (Õ)->
icmp_
.
_hl
 << 2è+ 8)

	)

219 
	#ICMP_ADVLEN
(
p
è(8 + (
	`IP_VHL_HL
(Õ)->
icmp_
.
_vhl
è<< 2è+ 8)

	)

225 
	#ICMP_UNREACH
 3

	)

226 
	#ICMP_SOURCEQUENCH
 4

	)

227 
	#ICMP_ROUTERADVERT
 9

	)

228 
	#ICMP_ROUTERSOLICIT
 10

	)

229 
	#ICMP_TIMXCEED
 11

	)

230 
	#ICMP_PARAMPROB
 12

	)

231 
	#ICMP_TSTAMP
 13

	)

232 
	#ICMP_TSTAMPREPLY
 14

	)

233 
	#ICMP_IREQ
 15

	)

234 
	#ICMP_IREQREPLY
 16

	)

235 
	#ICMP_MASKREQ
 17

	)

236 
	#ICMP_MASKREPLY
 18

	)

238 
	#ICMP_MAXTYPE
 18

	)

241 
	#ICMP_UNREACH_NET
 0

	)

242 
	#ICMP_UNREACH_HOST
 1

	)

243 
	#ICMP_UNREACH_PROTOCOL
 2

	)

244 
	#ICMP_UNREACH_PORT
 3

	)

245 
	#ICMP_UNREACH_NEEDFRAG
 4

	)

246 
	#ICMP_UNREACH_SRCFAIL
 5

	)

247 
	#ICMP_UNREACH_NET_UNKNOWN
 6

	)

248 
	#ICMP_UNREACH_HOST_UNKNOWN
 7

	)

249 
	#ICMP_UNREACH_ISOLATED
 8

	)

250 
	#ICMP_UNREACH_NET_PROHIB
 9

	)

251 
	#ICMP_UNREACH_HOST_PROHIB
 10

	)

252 
	#ICMP_UNREACH_TOSNET
 11

	)

253 
	#ICMP_UNREACH_TOSHOST
 12

	)

254 
	#ICMP_UNREACH_FILTER_PROHIB
 13

	)

255 
	#ICMP_UNREACH_HOST_PRECEDENCE
 14

	)

256 
	#ICMP_UNREACH_PRECEDENCE_CUTOFF
 15

	)

259 
	#ICMP_REDIRECT_NET
 0

	)

260 
	#ICMP_REDIRECT_HOST
 1

	)

261 
	#ICMP_REDIRECT_TOSNET
 2

	)

262 
	#ICMP_REDIRECT_TOSHOST
 3

	)

265 
	#ICMP_TIMXCEED_INTRANS
 0

	)

266 
	#ICMP_TIMXCEED_REASS
 1

	)

269 
	#ICMP_PARAMPROB_OPTABSENT
 1

	)

271 
	#ICMP_INFOTYPE
(
ty³
) \

272 ((
ty³
è=ğ
ICMP_ECHOREPLY
 || (ty³è=ğ
ICMP_ECHO
 || \

273 (
ty³
è=ğ
ICMP_ROUTERADVERT
 || (ty³è=ğ
ICMP_ROUTERSOLICIT
 || \

274 (
ty³
è=ğ
ICMP_TSTAMP
 || (ty³è=ğ
ICMP_TSTAMPREPLY
 || \

275 (
ty³
è=ğ
ICMP_IREQ
 || (ty³è=ğ
ICMP_IREQREPLY
 || \

276 (
ty³
è=ğ
ICMP_MASKREQ
 || (ty³è=ğ
ICMP_MASKREPLY
)

	)

280 
	g__END_DECLS


	@/usr/include/netinet/udp.h

47 #iâdeà
__NETINET_UDP_H


48 
	#__NETINET_UDP_H
 1

	)

50 
	~<ã©u»s.h
>

51 
	~<sys/ty³s.h
>

56 
	sudphdr


58 
__ex‹nsiÚ__
 union

62 
u_št16_t
 
	muh_¥Üt
;

63 
u_št16_t
 
	muh_dpÜt
;

64 
u_št16_t
 
	muh_uËn
;

65 
u_št16_t
 
	muh_sum
;

69 
u_št16_t
 
	msourû
;

70 
u_št16_t
 
	mde¡
;

71 
u_št16_t
 
	mËn
;

72 
u_št16_t
 
	mcheck
;

78 
	#UDP_CORK
 1

	)

79 
	#UDP_ENCAP
 100

	)

83 
	#UDP_ENCAP_ESPINUDP_NON_IKE
 1

	)

84 
	#UDP_ENCAP_ESPINUDP
 2

	)

85 
	#UDP_ENCAP_L2TPINUDP
 3

	)

87 
	#SOL_UDP
 17

	)

	@/usr/include/protocols/timed.h

32 #iâdef 
_PROTOCOLS_TIMED_H


33 
	#_PROTOCOLS_TIMED_H
 1

	)

35 
	~<sys/ty³s.h
>

36 
	~<sys/time.h
>

42 
	#TSPVERSION
 1

	)

43 
	#ANYADDR
 
NULL


	)

44 
	#MAXHOSTNAMELEN
 64

	)

46 
	st¥
 {

47 
u_ch¬
 
	mt¥_ty³
;

48 
u_ch¬
 
	mt¥_v”s
;

49 
u_shÜt
 
	mt¥_£q
;

51 
timev®
 
	mt¥u_time
;

52 
	mt¥u_hİút
;

53 } 
	mt¥_u
;

54 
	mt¥_Çme
[
MAXHOSTNAMELEN
];

57 
	#t¥_time
 
t¥_u
.
t¥u_time


	)

58 
	#t¥_hİút
 
t¥_u
.
t¥u_hİút


	)

63 
	#TSP_ANY
 0

	)

64 
	#TSP_ADJTIME
 1

	)

65 
	#TSP_ACK
 2

	)

66 
	#TSP_MASTERREQ
 3

	)

67 
	#TSP_MASTERACK
 4

	)

68 
	#TSP_SETTIME
 5

	)

69 
	#TSP_MASTERUP
 6

	)

70 
	#TSP_SLAVEUP
 7

	)

71 
	#TSP_ELECTION
 8

	)

72 
	#TSP_ACCEPT
 9

	)

73 
	#TSP_REFUSE
 10

	)

74 
	#TSP_CONFLICT
 11

	)

75 
	#TSP_RESOLVE
 12

	)

76 
	#TSP_QUIT
 13

	)

77 
	#TSP_DATE
 14

	)

78 
	#TSP_DATEREQ
 15

	)

79 
	#TSP_DATEACK
 16

	)

80 
	#TSP_TRACEON
 17

	)

81 
	#TSP_TRACEOFF
 18

	)

82 
	#TSP_MSITE
 19

	)

83 
	#TSP_MSITEREQ
 20

	)

84 
	#TSP_TEST
 21

	)

85 
	#TSP_SETDATE
 22

	)

86 
	#TSP_SETDATEREQ
 23

	)

87 
	#TSP_LOOP
 24

	)

89 
	#TSPTYPENUMBER
 25

	)

91 #ifdeà
TSPTYPES


92 *
	gt¥ty³
[
TSPTYPENUMBER
] =

	@/usr/include/resolv.h

52 #iâdeà
_RESOLV_H_


56 
	~<sys/ty³s.h
>

57 
	~<Ãtš‘/š.h
>

59 #iâdeà
__Ãed_»s_¡©e


60 
	#_RESOLV_H_


	)

62 
	~<sys/·¿m.h
>

63 
	~<sys/cdefs.h
>

64 
	~<¡dio.h
>

65 
	~<¬·/Çme£r.h
>

68 #iâdeà
__»s_¡©e_defšed


69 
	#__»s_¡©e_defšed


	)

71 ’um { 
	m»s_gßh—d
, 
	m»s_ÃxŠs
, 
	m»s_modif›d
, 
	m»s_dÚe
, 
	m»s_”rÜ
 }

72 
	t»s_£ndhookaù
;

74 
	$»s_£ndhookaù
 (*
	t»s_£nd_qhook
è(
	tsockaddr_š
 * cÚ¡ *
	t__ns
,

75 cÚ¡ 
	tu_ch¬
 **
	t__qu”y
,

76 *
	t__qu”yËn
,

77 
	tu_ch¬
 *
	t__ªs
,

78 
	t__ªssiz
,

79 *
	t__»¥Ën
);

81 
	$»s_£ndhookaù
 (*
	t»s_£nd_rhook
è(cÚ¡ 
	tsockaddr_š
 *
	t__ns
,

82 cÚ¡ 
	tu_ch¬
 *
	t__qu”y
,

83 
	t__qu”yËn
,

84 
	tu_ch¬
 *
	t__ªs
,

85 
	t__ªssiz
,

86 *
	t__»¥Ën
);

91 
	#MAXNS
 3

	)

92 
	#MAXDFLSRCH
 3

	)

93 
	#MAXDNSRCH
 6

	)

94 
	#LOCALDOMAINPARTS
 2

	)

96 
	#RES_TIMEOUT
 5

	)

97 
	#MAXRESOLVSORT
 10

	)

98 
	#RES_MAXNDOTS
 15

	)

99 
	#RES_MAXRETRANS
 30

	)

100 
	#RES_MAXRETRY
 5

	)

101 
	#RES_DFLRETRY
 2

	)

102 
	#RES_MAXTIME
 65535

	)

104 
	s__»s_¡©e
 {

105 
»Œªs
;

106 
»Œy
;

107 
u_lÚg
 
İtiÚs
;

108 
nscouÁ
;

109 
sockaddr_š


110 
n§ddr_li¡
[
MAXNS
];

111 
	#n§ddr
 
n§ddr_li¡
[0]

	)

112 
u_shÜt
 
id
;

114 *
dn¤ch
[
MAXDNSRCH
+1];

115 
defdÇme
[256];

116 
u_lÚg
 
pfcode
;

117 
ndÙs
:4;

118 
nsÜt
:4;

119 
v6_uÇva
:1;

120 
unu£d
:23;

122 
š_addr
 
addr
;

123 
u_št32_t
 
mask
;

124 } 
sÜt_li¡
[
MAXRESOLVSORT
];

126 
»s_£nd_qhook
 
qhook
;

127 
»s_£nd_rhook
 
rhook
;

128 
»s_h_”ºo
;

129 
_vcsock
;

130 
u_št
 
_æags
;

133 
·d
[52];

135 
u_št16_t
 
nscouÁ
;

136 
u_št16_t
 
nsm­
[
MAXNS
];

137 
nssocks
[
MAXNS
];

138 
u_št16_t
 
nscouÁ6
;

139 
u_št16_t
 
nsš™
;

140 
sockaddr_š6
 *
n§ddrs
[
MAXNS
];

141 #ifdeà
_LIBC


142 
š™¡amp


143 
	`__©Œibu‹__
((
·cked
));

145 
_š™¡amp
[2];

147 } 
_ext
;

148 } 
_u
;

151 
__»s_¡©e
 *
	t»s_¡©e
;

152 #undeà
__Ãed_»s_¡©e


155 #ifdeà
_RESOLV_H_


164 
	#__RES
 19991006

	)

172 #iâdeà
_PATH_RESCONF


173 
	#_PATH_RESCONF
 "/‘c/»sŞv.cÚf"

	)

176 
	s»s_sym
 {

177 
numb”
;

178 * 
Çme
;

179 * 
humªÇme
;

185 
	#RES_F_VC
 0x00000001

	)

186 
	#RES_F_CONN
 0x00000002

	)

187 
	#RES_F_EDNS0ERR
 0x00000004

	)

190 
	#RES_EXHAUSTIVE
 0x00000001

	)

195 
	#RES_INIT
 0x00000001

	)

196 
	#RES_DEBUG
 0x00000002

	)

197 
	#RES_AAONLY
 0x00000004

	)

198 
	#RES_USEVC
 0x00000008

	)

199 
	#RES_PRIMARY
 0x00000010

	)

200 
	#RES_IGNTC
 0x00000020

	)

201 
	#RES_RECURSE
 0x00000040

	)

202 
	#RES_DEFNAMES
 0x00000080

	)

203 
	#RES_STAYOPEN
 0x00000100

	)

204 
	#RES_DNSRCH
 0x00000200

	)

205 
	#RES_INSECURE1
 0x00000400

	)

206 
	#RES_INSECURE2
 0x00000800

	)

207 
	#RES_NOALIASES
 0x00001000

	)

208 
	#RES_USE_INET6
 0x00002000

	)

209 
	#RES_ROTATE
 0x00004000

	)

210 
	#RES_NOCHECKNAME
 0x00008000

	)

211 
	#RES_KEEPTSIG
 0x00010000

	)

212 
	#RES_BLAST
 0x00020000

	)

213 
	#RES_USEBSTRING
 0x00040000

	)

215 
	#RES_NOIP6DOTINT
 0x00080000

	)

217 
	#RES_USE_EDNS0
 0x00100000

	)

218 
	#RES_SNGLKUP
 0x00200000

	)

219 
	#RES_SNGLKUPREOP
 0x00400000

	)

221 
	#RES_USE_DNSSEC
 0x00800000

	)

222 
	#RES_NOTLDQUERY
 0x01000000

	)

225 
	#RES_DEFAULT
 (
RES_RECURSE
|
RES_DEFNAMES
|
RES_DNSRCH
|
RES_NOIP6DOTINT
)

	)

230 
	#RES_PRF_STATS
 0x00000001

	)

231 
	#RES_PRF_UPDATE
 0x00000002

	)

232 
	#RES_PRF_CLASS
 0x00000004

	)

233 
	#RES_PRF_CMD
 0x00000008

	)

234 
	#RES_PRF_QUES
 0x00000010

	)

235 
	#RES_PRF_ANS
 0x00000020

	)

236 
	#RES_PRF_AUTH
 0x00000040

	)

237 
	#RES_PRF_ADD
 0x00000080

	)

238 
	#RES_PRF_HEAD1
 0x00000100

	)

239 
	#RES_PRF_HEAD2
 0x00000200

	)

240 
	#RES_PRF_TTLID
 0x00000400

	)

241 
	#RES_PRF_HEADX
 0x00000800

	)

242 
	#RES_PRF_QUERY
 0x00001000

	)

243 
	#RES_PRF_REPLY
 0x00002000

	)

244 
	#RES_PRF_INIT
 0x00004000

	)

248 
__BEGIN_DECLS


249 
__»s_¡©e
 *
	$__»s_¡©e
(è
	`__©Œibu‹__
 ((
__cÚ¡__
));

250 
__END_DECLS


251 
	#_»s
 (*
	`__»s_¡©e
())

	)

253 #iâdeà
__BIND_NOSTATIC


254 
	#å_nqu”y
 
__å_nqu”y


	)

255 
	#å_qu”y
 
__å_qu”y


	)

256 
	#ho¡®Ÿs
 
__ho¡®Ÿs


	)

257 
	#p_qu”y
 
__p_qu”y


	)

258 
	#»s_şo£
 
__»s_şo£


	)

259 
	#»s_š™
 
__»s_š™


	)

260 
	#»s_isour£rv”
 
__»s_isour£rv”


	)

261 
	#»s_mkqu”y
 
__»s_mkqu”y


	)

262 
	#»s_qu”y
 
__»s_qu”y


	)

263 
	#»s_qu”ydomaš
 
__»s_qu”ydomaš


	)

264 
	#»s_£¬ch
 
__»s_£¬ch


	)

265 
	#»s_£nd
 
__»s_£nd


	)

267 
__BEGIN_DECLS


268 
	$å_nqu”y
 (cÚ¡ 
u_ch¬
 *, , 
FILE
 *è
__THROW
;

269 
	$å_qu”y
 (cÚ¡ 
u_ch¬
 *, 
FILE
 *è
__THROW
;

270 cÚ¡ * 
	$ho¡®Ÿs
 (cÚ¡ *è
__THROW
;

271 
	$p_qu”y
 (cÚ¡ 
u_ch¬
 *è
__THROW
;

272 
	$»s_şo£
 (è
__THROW
;

273 
	$»s_š™
 (è
__THROW
;

274 
	$»s_isour£rv”
 (cÚ¡ 
sockaddr_š
 *è
__THROW
;

275 
	$»s_mkqu”y
 (, cÚ¡ *, , , cÚ¡ 
u_ch¬
 *,

276 , cÚ¡ 
u_ch¬
 *, u_ch¬ *, è
__THROW
;

277 
	$»s_qu”y
 (cÚ¡ *, , , 
u_ch¬
 *, è
__THROW
;

278 
	$»s_qu”ydomaš
 (const *, const *, , ,

279 
u_ch¬
 *, è
__THROW
;

280 
	$»s_£¬ch
 (cÚ¡ *, , , 
u_ch¬
 *, è
__THROW
;

281 
	$»s_£nd
 (cÚ¡ 
u_ch¬
 *, , u_ch¬ *, è
__THROW
;

282 
__END_DECLS


285 
	#b64_Áİ
 
__b64_Áİ


	)

286 
	#b64_±Ú
 
__b64_±Ú


	)

287 
	#dn_comp
 
__dn_comp


	)

288 
	#dn_couÁ_Ïb–s
 
__dn_couÁ_Ïb–s


	)

289 
	#dn_ex·nd
 
__dn_ex·nd


	)

290 
	#dn_skÇme
 
__dn_skÇme


	)

291 
	#å_»s¡©
 
__å_»s¡©


	)

292 
	#loc_©Ú
 
__loc_©Ú


	)

293 
	#loc_Áß
 
__loc_Áß


	)

294 
	#p_cdÇme
 
__p_cdÇme


	)

295 
	#p_cdÂame
 
__p_cdÂame


	)

296 
	#p_şass
 
__p_şass


	)

297 
	#p_fqÇme
 
__p_fqÇme


	)

298 
	#p_fqÂame
 
__p_fqÂame


	)

299 
	#p_İtiÚ
 
__p_İtiÚ


	)

300 
	#p_£c¡od©e
 
__p_£c¡od©e


	)

301 
	#p_£ùiÚ
 
__p_£ùiÚ


	)

302 
	#p_time
 
__p_time


	)

303 
	#p_ty³
 
__p_ty³


	)

304 
	#p_rcode
 
__p_rcode


	)

305 
	#puÚg
 
__puÚg


	)

306 
	#putshÜt
 
__putshÜt


	)

307 
	#»s_dnok
 
__»s_dnok


	)

308 
	#»s_hnok
 
__»s_hnok


	)

309 
	#»s_ho¡®Ÿs
 
__»s_ho¡®Ÿs


	)

310 
	#»s_maok
 
__»s_maok


	)

311 
	#»s_Çmešqu”y
 
__»s_Çmešqu”y


	)

312 
	#»s_nşo£
 
__»s_nşo£


	)

313 
	#»s_nš™
 
__»s_nš™


	)

314 
	#»s_nmkqu”y
 
__»s_nmkqu”y


	)

315 
	#»s_Åqu”y
 
__»s_Åqu”y


	)

316 
	#»s_nqu”y
 
__»s_nqu”y


	)

317 
	#»s_nqu”ydomaš
 
__»s_nqu”ydomaš


	)

318 
	#»s_n£¬ch
 
__»s_n£¬ch


	)

319 
	#»s_n£nd
 
__»s_n£nd


	)

320 
	#»s_nisour£rv”
 
__»s_nisour£rv”


	)

321 
	#»s_ownok
 
__»s_ownok


	)

322 
	#»s_qu”›sm©ch
 
__»s_qu”›sm©ch


	)

323 
	#»s_¿ndomid
 
__»s_¿ndomid


	)

324 
	#sym_Áİ
 
__sym_Áİ


	)

325 
	#sym_Áos
 
__sym_Áos


	)

326 
	#sym_¡Ú
 
__sym_¡Ú


	)

327 
__BEGIN_DECLS


328 
	$»s_hnok
 (cÚ¡ *è
__THROW
;

329 
	$»s_ownok
 (cÚ¡ *è
__THROW
;

330 
	$»s_maok
 (cÚ¡ *è
__THROW
;

331 
	$»s_dnok
 (cÚ¡ *è
__THROW
;

332 
	$sym_¡Ú
 (cÚ¡ 
»s_sym
 *, cÚ¡ *, *è
__THROW
;

333 cÚ¡ * 
	$sym_Áos
 (cÚ¡ 
»s_sym
 *, , *è
__THROW
;

334 cÚ¡ * 
	$sym_Áİ
 (cÚ¡ 
»s_sym
 *, , *è
__THROW
;

335 
	$b64_Áİ
 (
u_ch¬
 cÚ¡ *, 
size_t
, *, size_tè
__THROW
;

336 
	$b64_±Ú
 (cÚ¡ *, 
u_ch¬
 *, 
size_t
è
__THROW
;

337 
	$loc_©Ú
 (cÚ¡ *
__ascii
, 
u_ch¬
 *
__bš¬y
è
__THROW
;

338 cÚ¡ * 
	$loc_Áß
 (cÚ¡ 
u_ch¬
 *
__bš¬y
, *
__ascii
è
__THROW
;

339 
	$dn_skÇme
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *è
__THROW
;

340 
	$puÚg
 (
u_št32_t
, 
u_ch¬
 *è
__THROW
;

341 
	$putshÜt
 (
u_št16_t
, 
u_ch¬
 *è
__THROW
;

342 cÚ¡ * 
	$p_şass
 (è
__THROW
;

343 cÚ¡ * 
	$p_time
 (
u_št32_t
è
__THROW
;

344 cÚ¡ * 
	$p_ty³
 (è
__THROW
;

345 cÚ¡ * 
	$p_rcode
 (è
__THROW
;

346 cÚ¡ 
u_ch¬
 * 
	$p_cdÂame
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, , 
FILE
 *)

347 
__THROW
;

348 cÚ¡ 
u_ch¬
 * 
	$p_cdÇme
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, 
FILE
 *è
__THROW
;

349 cÚ¡ 
u_ch¬
 * 
	$p_fqÂame
 (cÚ¡ 
u_ch¬
 *
__ı
, cÚ¡ u_ch¬ *
__msg
,

350 , *, è
__THROW
;

351 cÚ¡ 
u_ch¬
 * 
	$p_fqÇme
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, 
FILE
 *è
__THROW
;

352 cÚ¡ * 
	$p_İtiÚ
 (
u_lÚg
 
__İtiÚ
è
__THROW
;

353 * 
	$p_£c¡od©e
 (
u_lÚg
è
__THROW
;

354 
	$dn_couÁ_Ïb–s
 (cÚ¡ *è
__THROW
;

355 
	$dn_comp
 (cÚ¡ *, 
u_ch¬
 *, , u_char **, u_char **)

356 
__THROW
;

357 
	$dn_ex·nd
 (cÚ¡ 
u_ch¬
 *, const u_char *, const u_char *,

358 *, è
__THROW
;

359 
u_št
 
	$»s_¿ndomid
 (è
__THROW
;

360 
	$»s_Çmešqu”y
 (const *, , ,

361 cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *è
__THROW
;

362 
	$»s_qu”›sm©ch
 (cÚ¡ 
u_ch¬
 *, const u_char *,

363 cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *è
__THROW
;

364 cÚ¡ * 
	$p_£ùiÚ
 (
__£ùiÚ
, 
__İcode
è
__THROW
;

366 
	$»s_nš™
 (
»s_¡©e
è
__THROW
;

367 
	$»s_nisour£rv”
 (cÚ¡ 
»s_¡©e
,

368 cÚ¡ 
sockaddr_š
 *è
__THROW
;

369 
	$å_»s¡©
 (cÚ¡ 
»s_¡©e
, 
FILE
 *è
__THROW
;

370 
	$»s_Åqu”y
 (cÚ¡ 
»s_¡©e
, cÚ¡ 
u_ch¬
 *, , 
FILE
 *)

371 
__THROW
;

372 cÚ¡ * 
	$»s_ho¡®Ÿs
 (cÚ¡ 
»s_¡©e
, cÚ¡ *, *, 
size_t
)

373 
__THROW
;

374 
	$»s_nqu”y
 (
»s_¡©e
, cÚ¡ *, , , 
u_ch¬
 *, )

375 
__THROW
;

376 
	$»s_n£¬ch
 (
»s_¡©e
, cÚ¡ *, , , 
u_ch¬
 *, )

377 
__THROW
;

378 
	$»s_nqu”ydomaš
 (
»s_¡©e
, const *, const *, ,

379 , 
u_ch¬
 *, è
__THROW
;

380 
	$»s_nmkqu”y
 (
»s_¡©e
, , const *, , ,

381 cÚ¡ 
u_ch¬
 *, , const u_char *, u_char *,

382 è
__THROW
;

383 
	$»s_n£nd
 (
»s_¡©e
, cÚ¡ 
u_ch¬
 *, , u_char *, )

384 
__THROW
;

385 
	$»s_nşo£
 (
»s_¡©e
è
__THROW
;

386 
__END_DECLS


	@/usr/include/sched.h

19 #iâdef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

30 
	#__Ãed_time_t


	)

31 
	#__Ãed_time¥ec


	)

32 
	~<time.h
>

34 #iâdeà
__pid_t_defšed


35 
__pid_t
 
	tpid_t
;

36 
	#__pid_t_defšed


	)

41 
	~<b™s/sched.h
>

43 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

46 
__BEGIN_DECLS


49 
	$sched_£¬am
 (
__pid_t
 
__pid
, cÚ¡ 
sched_·¿m
 *
__·¿m
)

50 
__THROW
;

53 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

56 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

57 cÚ¡ 
sched_·¿m
 *
__·¿m
è
__THROW
;

60 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

63 
	$sched_y›ld
 (è
__THROW
;

66 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

69 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

72 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

75 #ifdeà
__USE_GNU


77 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

78 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

79 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

80 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

81 
ıu£
)

	)

82 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

83 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

85 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

86 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

87 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

88 
ıu£
)

	)

89 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

90 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

92 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

93 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

94 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

95 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

97 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

98 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

99 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

101 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

103 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

104 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

105 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

106 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

107 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

108 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

110 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

111 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

112 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

116 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

117 cÚ¡ 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

120 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

121 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

124 
__END_DECLS


	@/usr/include/setjmp.h

22 #iâdef 
_SETJMP_H


23 
	#_SETJMP_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/£tjmp.h
>

30 
	~<b™s/sig£t.h
>

34 
	s__jmp_buf_g


40 
__jmp_buf
 
	m__jmpbuf
;

41 
	m__mask_was_§ved
;

42 
__sig£t_t
 
	m__§ved_mask
;

46 
__BEGIN_NAMESPACE_STD


48 
__jmp_buf_g
 
	tjmp_buf
[1];

52 
	$£tjmp
 (
jmp_buf
 
__’v
è
__THROWNL
;

54 
__END_NAMESPACE_STD


59 
	$__sig£tjmp
 (
__jmp_buf_g
 
__’v
[1], 
__§vemask
è
__THROWNL
;

63 
	$_£tjmp
 (
__jmp_buf_g
 
__’v
[1]è
__THROWNL
;

67 
	#£tjmp
(
’v
è
	`_£tjmp
 (’v)

	)

70 
__BEGIN_NAMESPACE_STD


74 
	$lÚgjmp
 (
__jmp_buf_g
 
__’v
[1], 
__v®
)

75 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

77 
__END_NAMESPACE_STD


79 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


83 
	$_lÚgjmp
 (
__jmp_buf_g
 
__’v
[1], 
__v®
)

84 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

88 #ifdef 
__USE_POSIX


92 
__jmp_buf_g
 
	tsigjmp_buf
[1];

96 
	#sig£tjmp
(
’v
, 
§vemask
è
	`__sig£tjmp
 (’v, savemask)

	)

102 
	$siglÚgjmp
 (
sigjmp_buf
 
__’v
, 
__v®
)

103 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

108 #ià
__USE_FORTIFY_LEVEL
 > 0

109 
	~<b™s/£tjmp2.h
>

112 
__END_DECLS


	@/usr/include/signal.h

22 #iâdef 
_SIGNAL_H


24 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	~<b™s/sig£t.h
>

36 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


37 #iâdeà
__sig_©omic_t_defšed


38 
	#__sig_©omic_t_defšed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #undeà
__Ãed_sig_©omic_t


46 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

47 #iâdeà
__sig£t_t_defšed


48 
	#__sig£t_t_defšed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #undeà
__Ãed_sig£t_t


54 #ifdeà
_SIGNAL_H


56 
	~<b™s/ty³s.h
>

57 
	~<b™s/signum.h
>

59 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


60 #iâdeà
__pid_t_defšed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_defšed


	)

64 #ifdeà
__USE_XOPEN


66 #iâdeà
__uid_t_defšed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_defšed


	)

72 #ifdeà
__USE_POSIX199309


74 
	#__Ãed_time¥ec


	)

75 
	~<time.h
>

78 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


80 
	~<b™s/sigšfo.h
>

85 (*
	t__sighªdËr_t
) ();

90 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

91 
__THROW
;

92 #ifdeà
__USE_GNU


93 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifdeà
__USE_BSD


102 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

103 
__THROW
;

106 #ifdeà
__REDIRECT_NTH


107 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

108 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

109 
__sysv_sigÇl
);

111 
	#sigÇl
 
__sysv_sigÇl


	)

114 
__END_NAMESPACE_STD


116 #ifdeà
__USE_XOPEN


119 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

120 
__THROW
;

126 #ifdeà
__USE_POSIX


127 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

130 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


134 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$¿i£
 (
__sig
è
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifdeà
__USE_SVID


144 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

145 
__THROW
;

146 
	$gsigÇl
 (
__sig
è
__THROW
;

149 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN2K


151 
	`psigÇl
 (
__sig
, cÚ¡ *
__s
);

154 #ifdeà
__USE_XOPEN2K


156 
	`psigšfo
 (cÚ¡ 
sigšfo_t
 *
__pšfo
, cÚ¡ *
__s
);

167 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

169 #ifdeà
__USE_XOPEN


170 #ifdeà
__GNUC__


171 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

174 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

179 #ifdeà
__USE_BSD


186 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

189 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

192 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

195 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

199 #ifdeà
__USE_MISC


200 
	#NSIG
 
_NSIG


	)

203 #ifdeà
__USE_GNU


204 
__sighªdËr_t
 
	tsighªdËr_t
;

208 #ifdeà
__USE_BSD


209 
__sighªdËr_t
 
	tsig_t
;

212 #ifdeà
__USE_POSIX


215 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

218 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

221 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

224 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

227 
	$sigismemb”
 (cÚ¡ 
sig£t_t
 *
__£t
, 
__signo
)

228 
__THROW
 
	`__nÚnuÎ
 ((1));

230 #ifdeà
__USE_GNU


232 
	$sigi£m±y£t
 (cÚ¡ 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

235 
	$sigªd£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

236 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

239 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

240 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

245 
	~<b™s/sigaùiÚ.h
>

248 
	$sig´ocmask
 (
__how
, cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

249 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

256 
	$sigsu¥’d
 (cÚ¡ 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

259 
	$sigaùiÚ
 (
__sig
, cÚ¡ 
sigaùiÚ
 *
__»¡riù
 
__aù
,

260 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

263 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

270 
	$sigwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

271 
	`__nÚnuÎ
 ((1, 2));

273 #ifdeà
__USE_POSIX199309


278 
	$sigwa™šfo
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

279 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

286 
	$sigtimedwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

287 
sigšfo_t
 *
__»¡riù
 
__šfo
,

288 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
)

289 
	`__nÚnuÎ
 ((1));

293 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, cÚ¡ 
sigv®
 
__v®
)

294 
__THROW
;

299 #ifdeà
__USE_BSD


303 cÚ¡ *cÚ¡ 
_sys_sigli¡
[
_NSIG
];

304 cÚ¡ *cÚ¡ 
sys_sigli¡
[
_NSIG
];

307 
	ssigvec


309 
__sighªdËr_t
 
sv_hªdËr
;

310 
sv_mask
;

312 
sv_æags
;

313 
	#sv_Ú¡ack
 
sv_æags


	)

317 
	#SV_ONSTACK
 (1 << 0)

	)

318 
	#SV_INTERRUPT
 (1 << 1)

	)

319 
	#SV_RESETHAND
 (1 << 2)

	)

327 
	$sigvec
 (
__sig
, cÚ¡ 
sigvec
 *
__vec
,

328 
sigvec
 *
__ovec
è
__THROW
;

332 
	~<b™s/sigcÚ‹xt.h
>

335 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

340 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


341 
	#__Ãed_size_t


	)

342 
	~<¡ddef.h
>

347 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

349 
	~<b™s/sig¡ack.h
>

350 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


352 
	~<sys/ucÚ‹xt.h
>

358 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

359 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

363 
	$sig®t¡ack
 (cÚ¡ 
sig®t¡ack
 *
__»¡riù
 
__ss
,

364 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

368 #ifdeà
__USE_XOPEN_EXTENDED


372 
	$sighŞd
 (
__sig
è
__THROW
;

375 
	$sig»l£
 (
__sig
è
__THROW
;

378 
	$sigignÜe
 (
__sig
è
__THROW
;

381 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

384 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


387 
	~<b™s/±h»adty³s.h
>

388 
	~<b™s/sigth»ad.h
>

395 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

397 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

401 
__END_DECLS


	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


25 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	#__Ãed_FILE


	)

37 
	#__Ãed___FILE


	)

41 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_SVID
 || defšed 
__USE_POSIX
 \

51 || 
defšed
 
	g__USE_BSD
 || defšed 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

52 || 
defšed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_defšed
 1

	)

58 #undeà
__Ãed_FILE


61 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_defšed
 1

	)

68 #undeà
__Ãed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


77 #ifdeà
__GNUC__


78 #iâdeà
_VA_LIST_DEFINED


79 
_G_va_li¡
 
	tva_li¡
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<¡d¬g.h
>

87 #ifdeà
__USE_XOPEN2K8


88 #iâdeà
__off_t_defšed


89 #iâdeà
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_defšed


	)

96 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_defšed


	)

101 #iâdeà
__ssize_t_defšed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_defšed


	)

108 
__BEGIN_NAMESPACE_STD


109 #iâdeà
__USE_FILE_OFFSET64


110 
_G_åos_t
 
	tåos_t
;

112 
_G_åos64_t
 
	tåos_t
;

114 
__END_NAMESPACE_STD


115 #ifdeà
__USE_LARGEFILE64


116 
_G_åos64_t
 
	tåos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #iâdeà
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #iâdeà
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifdeà
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


151 
	#P_tmpdœ
 "/tmp"

	)

164 
	~<b™s/¡dio_lim.h
>

168 
_IO_FILE
 *
¡dš
;

169 
_IO_FILE
 *
¡dout
;

170 
_IO_FILE
 *
¡d”r
;

172 
	#¡dš
 
¡dš


	)

173 
	#¡dout
 
¡dout


	)

174 
	#¡d”r
 
¡d”r


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

180 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifdeà
__USE_ATFILE


185 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

186 cÚ¡ *
__Ãw
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #iâdeà
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfe
 (è
__wur
;

197 #ifdeà
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

200 
	#tmpfe
 
tmpfe64


	)

204 #ifdeà
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfe64
 (è
__wur
;

209 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifdeà
__USE_MISC


215 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

219 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


227 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

228 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`fşo£
 (
FILE
 *
__¡»am
);

242 
	`fæush
 (
FILE
 *
__¡»am
);

243 
__END_NAMESPACE_STD


245 #ifdeà
__USE_MISC


252 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

255 #ifdeà
__USE_GNU


262 
	`fşo£®l
 ();

266 
__BEGIN_NAMESPACE_STD


267 #iâdeà
__USE_FILE_OFFSET64


272 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

273 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

278 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

279 cÚ¡ *
__»¡riù
 
__modes
,

280 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

282 #ifdeà
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

284 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

287 cÚ¡ *
__»¡riù
 
__modes
,

288 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

289 
__wur
;

291 
	#fİ’
 
fİ’64


	)

292 
	#äeİ’
 
äeİ’64


	)

295 
__END_NAMESPACE_STD


296 #ifdeà
__USE_LARGEFILE64


297 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

298 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

299 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

300 cÚ¡ *
__»¡riù
 
__modes
,

301 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

313 cÚ¡ *
__»¡riù
 
__modes
,

314 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

317 #ifdeà
__USE_XOPEN2K8


319 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

337 
__modes
, 
size_t
 
__n
è
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

344 
size_t
 
__size
è
__THROW
;

347 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

357 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

362 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

364 
	$¥rštf
 (*
__»¡riù
 
__s
,

365 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

371 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

372 
_G_va_li¡
 
__¬g
);

377 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

379 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

380 
_G_va_li¡
 
__¬g
è
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

387 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

388 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

390 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

391 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

392 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifdeà
__USE_GNU


399 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

400 
_G_va_li¡
 
__¬g
)

401 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

402 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

403 cÚ¡ *
__»¡riù
 
__fmt
, ...)

404 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

405 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

406 cÚ¡ *
__»¡riù
 
__fmt
, ...)

407 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

410 #ifdeà
__USE_XOPEN2K8


412 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

413 
_G_va_li¡
 
__¬g
)

414 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

415 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

416 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

426 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

431 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

433 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

434 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

436 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

444 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

445 
__isoc99_fsÿnf
è
__wur
;

446 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

447 
__isoc99_sÿnf
è
__wur
;

448 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

449 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

450 
__isoc99_ssÿnf
);

452 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

454 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

455 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

456 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

457 
	#fsÿnf
 
__isoc99_fsÿnf


	)

458 
	#sÿnf
 
__isoc99_sÿnf


	)

459 
	#ssÿnf
 
__isoc99_ssÿnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

472 
_G_va_li¡
 
__¬g
)

473 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

479 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

480 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

483 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

484 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

485 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

487 #ià!
defšed
 
__USE_GNU
 \

488 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

489 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

490 #ifdeà
__REDIRECT


494 
	`__REDIRECT
 (
vfsÿnf
,

495 (
FILE
 *
__»¡riù
 
__s
,

496 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

497 
__isoc99_vfsÿnf
)

498 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

499 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

500 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

501 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

502 
	`__REDIRECT_NTH
 (
vssÿnf
,

503 (cÚ¡ *
__»¡riù
 
__s
,

504 cÚ¡ *
__»¡riù
 
__fÜm©
,

505 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

506 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

508 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

509 cÚ¡ *
__»¡riù
 
__fÜm©
,

510 
_G_va_li¡
 
__¬g
è
__wur
;

511 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

512 
_G_va_li¡
 
__¬g
è
__wur
;

513 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

514 cÚ¡ *
__»¡riù
 
__fÜm©
,

515 
_G_va_li¡
 
__¬g
è
__THROW
;

516 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

517 
	#vsÿnf
 
__isoc99_vsÿnf


	)

518 
	#vssÿnf
 
__isoc99_vssÿnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fg‘c
 (
FILE
 *
__¡»am
);

532 
	`g‘c
 (
FILE
 *
__¡»am
);

538 
	`g‘ch¬
 ();

539 
__END_NAMESPACE_STD


543 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

545 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


550 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

551 
	`g‘ch¬_uÆocked
 ();

554 #ifdeà
__USE_MISC


561 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

565 
__BEGIN_NAMESPACE_STD


573 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

574 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

580 
	`putch¬
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

587 #ifdeà
__USE_MISC


594 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

597 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


602 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

603 
	`putch¬_uÆocked
 (
__c
);

607 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 \

608 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

610 
	`g‘w
 (
FILE
 *
__¡»am
);

613 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

623 
__wur
;

625 #ià!
defšed
 
__USE_ISOC11
 \

626 || (
defšed
 
__ılu¥lus
 && __cplusplus <= 201103L)

638 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

640 
__END_NAMESPACE_STD


642 #ifdeà
__USE_GNU


649 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

650 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

666 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

667 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

668 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

669 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

670 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

678 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

679 
size_t
 *
__»¡riù
 
__n
,

680 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

695 
	`puts
 (cÚ¡ *
__s
);

702 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

709 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

715 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

716 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifdeà
__USE_GNU


726 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

727 
FILE
 *
__»¡riù
 
__¡»am
);

730 #ifdeà
__USE_MISC


737 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

739 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

740 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

754 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

759 
	`»wšd
 (
FILE
 *
__¡»am
);

760 
__END_NAMESPACE_STD


767 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


768 #iâdeà
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

778 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

780 #ifdeà
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#á–lo
 
á–lo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #iâdeà
__USE_FILE_OFFSET64


798 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

803 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

805 #ifdeà
__REDIRECT


806 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

807 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

808 
	`__REDIRECT
 (
f£os
,

809 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

811 
	#fg‘pos
 
fg‘pos64


	)

812 
	#f£os
 
f£os64


	)

815 
__END_NAMESPACE_STD


817 #ifdeà
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

819 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

820 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

821 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

828 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

830 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifdeà
__USE_MISC


835 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

836 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

837 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`³¼Ü
 (cÚ¡ *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<b™s/sys_”¾i¡.h
>

856 #ifdef 
__USE_POSIX


858 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

861 #ifdeà
__USE_MISC


863 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

867 #ià(
defšed
 
__USE_POSIX2
 || defšed 
__USE_SVID
 || defšed 
__USE_BSD
 || \

868 
defšed
 
__USE_MISC
)

873 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

879 
	`pşo£
 (
FILE
 *
__¡»am
);

883 #ifdef 
__USE_POSIX


885 *
	$ù”mid
 (*
__s
è
__THROW
;

889 #ifdeà
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob¡ack
;

899 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

900 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

901 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

902 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

903 cÚ¡ *
__»¡riù
 
__fÜm©
,

904 
_G_va_li¡
 
__¬gs
)

905 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

909 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


913 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

917 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

920 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

923 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


927 
	#__Ãed_g‘İt


	)

928 
	~<g‘İt.h
>

933 #ifdeà
__USE_EXTERN_INLINES


934 
	~<b™s/¡dio.h
>

936 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


937 
	~<b™s/¡dio2.h
>

939 #ifdeà
__LDBL_COMPAT


940 
	~<b™s/¡dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

34 
	g__BEGIN_DECLS


36 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


37 
	#_STDLIB_H
 1

	)

39 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


41 
	~<b™s/wa™æags.h
>

42 
	~<b™s/wa™¡©us.h
>

44 #ifdeà
__USE_BSD


49 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


50 
	#__WAIT_INT
(
¡©us
) \

51 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

52 { .
__š
 = (
¡©us
è}).
__i
))

	)

54 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

62 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
wa™
 *
	m__u±r
;

70 *
	m__Œ
;

71 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (¡©us))

	)

85 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (
	`__WAIT_INT
 (¡©us))

	)

86 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (
	`__WAIT_INT
 (¡©us))

	)

87 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (
	`__WAIT_INT
 (¡©us))

	)

88 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (¡©us))

	)

89 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (¡©us))

	)

90 #ifdeà
__WIFCONTINUED


91 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (¡©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquÙ
;

100 
	m»m
;

101 } 
	tdiv_t
;

104 #iâdeà
__ldiv_t_defšed


107 
	mquÙ
;

108 
	m»m
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_defšed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


115 
__BEGIN_NAMESPACE_C99


117 
__ex‹nsiÚ__
 struct

119 
	mquÙ
;

120 
	m»m
;

121 } 
	tÎdiv_t
;

122 
	#__Îdiv_t_defšed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

139 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (cÚ¡ *
__ÅŒ
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

147 
	$©oi
 (cÚ¡ *
__ÅŒ
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

150 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

151 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

152 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


155 
__BEGIN_NAMESPACE_C99


157 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

158 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

173 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

175 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

176 **
__»¡riù
 
__’d±r
)

177 
__THROW
 
	`__nÚnuÎ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

184 **
__»¡riù
 
__’d±r
, 
__ba£
)

185 
__THROW
 
	`__nÚnuÎ
 ((1));

187 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifdeà
__USE_BSD


194 
__ex‹nsiÚ__


195 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

196 **
__»¡riù
 
__’d±r
, 
__ba£
)

197 
__THROW
 
	`__nÚnuÎ
 ((1));

199 
__ex‹nsiÚ__


200 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

205 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


206 
__BEGIN_NAMESPACE_C99


208 
__ex‹nsiÚ__


209 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

210 **
__»¡riù
 
__’d±r
, 
__ba£
)

211 
__THROW
 
	`__nÚnuÎ
 ((1));

213 
__ex‹nsiÚ__


214 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

215 **
__»¡riù
 
__’d±r
, 
__ba£
)

216 
__THROW
 
	`__nÚnuÎ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifdeà
__USE_GNU


235 
	~<xloÿË.h
>

239 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

240 **
__»¡riù
 
__’d±r
, 
__ba£
,

241 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

243 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

244 **
__»¡riù
 
__’d±r
,

245 
__ba£
, 
__loÿË_t
 
__loc
)

246 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

248 
__ex‹nsiÚ__


249 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

250 **
__»¡riù
 
__’d±r
, 
__ba£
,

251 
__loÿË_t
 
__loc
)

252 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

254 
__ex‹nsiÚ__


255 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

256 **
__»¡riù
 
__’d±r
,

257 
__ba£
, 
__loÿË_t
 
__loc
)

258 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

260 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

261 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

262 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

264 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

265 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

266 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

268 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

269 **
__»¡riù
 
__’d±r
,

270 
__loÿË_t
 
__loc
)

271 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

275 #ifdeà
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__ex‹º_šlše
 

278 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

280  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

281 
	}
}

282 
__ex‹º_šlše
 

283 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

285  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

292 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

294  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

308 
	$a64l
 (cÚ¡ *
__s
)

309 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

313 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_BSD


314 
	~<sys/ty³s.h
>

321 
	$¿ndom
 (è
__THROW
;

324 
	$¤ªdom
 (
__£ed
è
__THROW
;

330 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

331 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

335 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

338 #ifdeà
__USE_MISC


343 
	s¿ndom_d©a


345 
št32_t
 *
åŒ
;

346 
št32_t
 *
½Œ
;

347 
št32_t
 *
¡©e
;

348 
¿nd_ty³
;

349 
¿nd_deg
;

350 
¿nd_£p
;

351 
št32_t
 *
’d_±r
;

354 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

355 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

357 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

358 
__THROW
 
	`__nÚnuÎ
 ((2));

360 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

361 
size_t
 
__¡©–’
,

362 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

363 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

365 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

366 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

367 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$¿nd
 (è
__THROW
;

376 
	$¤ªd
 (
__£ed
è
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifdeà
__USE_POSIX


381 
	$¿nd_r
 (*
__£ed
è
__THROW
;

385 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


389 
	$d¿nd48
 (è
__THROW
;

390 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

393 
	$Ìªd48
 (è
__THROW
;

394 
	$Äªd48
 (
__xsubi
[3])

395 
__THROW
 
	`__nÚnuÎ
 ((1));

398 
	$m¿nd48
 (è
__THROW
;

399 
	$j¿nd48
 (
__xsubi
[3])

400 
__THROW
 
	`__nÚnuÎ
 ((1));

403 
	$¤ªd48
 (
__£edv®
è
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__nÚnuÎ
 ((1));

406 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

408 #ifdeà
__USE_MISC


412 
	sd¿nd48_d©a


414 
__x
[3];

415 
__Şd_x
[3];

416 
__c
;

417 
__š™
;

418 
__ex‹nsiÚ__
 
__a
;

423 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

424 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

425 
	$”ªd48_r
 (
__xsubi
[3],

426 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

427 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

431 *
__»¡riù
 
__»suÉ
)

432 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

433 
	$Äªd48_r
 (
__xsubi
[3],

434 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

435 *
__»¡riù
 
__»suÉ
)

436 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

439 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

442 
	$j¿nd48_r
 (
__xsubi
[3],

443 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

444 *
__»¡riù
 
__»suÉ
)

445 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

448 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$lcÚg48_r
 (
__·¿m
[7],

455 
d¿nd48_d©a
 *
__bufãr
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

462 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


463 
	#__m®loc_ªd_ÿÎoc_defšed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

468 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

469 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

483 
	$ä“
 (*
__±r
è
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$cä“
 (*
__±r
è
__THROW
;

491 #ià
defšed
 
__USE_GNU
 || defšed 
__USE_BSD
 || defšed 
__USE_MISC


492 
	~<®loÿ.h
>

495 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

496 || 
defšed
 
__USE_BSD


498 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

501 #ifdeà
__USE_XOPEN2K


503 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

504 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

507 #ifdeà
__USE_ISOC11


509 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

510 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

519 
	`©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

521 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


523 #ifdeà
__ılu¥lus


524 "C++" 
	`©_quick_ex™
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

527 
	`©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

536 
__THROW
 
	`__nÚnuÎ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

545 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


549 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

551 
__END_NAMESPACE_STD


553 #ifdeà
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

565 
__END_NAMESPACE_STD


567 #ifdeà
__USE_GNU


570 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

571 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

574 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


578 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

581 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


584 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

585 
__THROW
 
	`__nÚnuÎ
 ((2));

588 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$ş—»nv
 (è
__THROW
;

599 #ià
defšed
 
__USE_MISC
 \

600 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

606 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

609 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 \

610 || 
defšed
 
__USE_XOPEN2K8


619 #iâdeà
__USE_FILE_OFFSET64


620 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

622 #ifdeà
__REDIRECT


623 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

624 
	`__nÚnuÎ
 ((1)è
__wur
;

626 
	#mk¡emp
 
mk¡emp64


	)

629 #ifdeà
__USE_LARGEFILE64


630 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

634 #ifdeà
__USE_MISC


641 #iâdeà
__USE_FILE_OFFSET64


642 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

644 #ifdeà
__REDIRECT


645 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

646 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

648 
	#mk¡emps
 
mk¡emps64


	)

651 #ifdeà
__USE_LARGEFILE64


652 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

653 
	`__nÚnuÎ
 ((1)è
__wur
;

657 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K8


663 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

666 #ifdeà
__USE_GNU


673 #iâdeà
__USE_FILE_OFFSET64


674 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

676 #ifdeà
__REDIRECT


677 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

678 
	`__nÚnuÎ
 ((1)è
__wur
;

680 
	#mko¡emp
 
mko¡emp64


	)

683 #ifdeà
__USE_LARGEFILE64


684 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

693 #iâdeà
__USE_FILE_OFFSET64


694 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

695 
	`__nÚnuÎ
 ((1)è
__wur
;

697 #ifdeà
__REDIRECT


698 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

699 
__æags
), 
mko¡emps64
)

700 
	`__nÚnuÎ
 ((1)è
__wur
;

702 
	#mko¡emps
 
mko¡emps64


	)

705 #ifdeà
__USE_LARGEFILE64


706 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

707 
	`__nÚnuÎ
 ((1)è
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

725 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

728 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


734 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

735 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

740 #iâdeà
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com·r_â_t
) (const *, const *);

744 #ifdef 
__USE_GNU


745 
__com·r_â_t
 
	tcom·risÚ_â_t
;

748 #ifdeà
__USE_GNU


749 (*
	t__com·r_d_â_t
) (const *, const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

756 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

757 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

759 #ifdeà
__USE_EXTERN_INLINES


760 
	~<b™s/¡dlib-b£¬ch.h
>

765 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

766 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

767 #ifdeà
__USE_GNU


768 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

769 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

770 
	`__nÚnuÎ
 ((1, 4));

775 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

776 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

777 
__END_NAMESPACE_STD


779 #ifdeà
__USE_ISOC99


780 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

781 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

785 
__BEGIN_NAMESPACE_STD


789 
div_t
 
	$div
 (
__num”
, 
__d’om
)

790 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

791 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

792 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

793 
__END_NAMESPACE_STD


795 #ifdeà
__USE_ISOC99


796 
__BEGIN_NAMESPACE_C99


797 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

798 
__d’om
)

799 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

800 
__END_NAMESPACE_C99


804 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

805 || 
defšed
 
__USE_SVID


812 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

813 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

818 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

819 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

824 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

825 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

828 #ifdeà
__USE_MISC


830 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

831 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

832 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

833 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

834 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

835 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

836 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

837 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

842 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

843 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

844 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

845 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

846 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

847 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

849 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

850 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

851 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

852 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

853 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

854 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

855 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

856 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

860 
__BEGIN_NAMESPACE_STD


863 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

866 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

867 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

870 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

874 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

875 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

877 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

878 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

879 
__THROW
;

880 
__END_NAMESPACE_STD


883 #ifdeà
__USE_SVID


888 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

892 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


899 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

900 *cÚ¡ *
__»¡riù
 
__tok’s
,

901 **
__»¡riù
 
__v®u•
)

902 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

906 #ifdeà
__USE_XOPEN


908 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

914 #ifdeà
__USE_XOPEN2KXSI


916 
	$posix_İ’±
 (
__oæag
è
__wur
;

919 #ifdeà
__USE_XOPEN


924 
	$g¿Á±
 (
__fd
è
__THROW
;

928 
	$uÆock±
 (
__fd
è
__THROW
;

933 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

936 #ifdeà
__USE_GNU


940 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

941 
__THROW
 
	`__nÚnuÎ
 ((2));

944 
	`g‘±
 ();

947 #ifdeà
__USE_BSD


951 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

952 
__THROW
 
	`__nÚnuÎ
 ((1));

955 
	~<b™s/¡dlib-æßt.h
>

958 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


959 
	~<b™s/¡dlib.h
>

961 #ifdeà
__LDBL_COMPAT


962 
	~<b™s/¡dlib-ldbl.h
>

966 #undeà
__Ãed_m®loc_ªd_ÿÎoc


968 
__END_DECLS


	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


30 
	#__Ãed_size_t


	)

31 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

39 #ià
defšed
 
__ılu¥lus
 && (__ılu¥lu >ğ199711L || 
__GNUC_PREREQ
 (4, 4))

40 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

44 
__BEGIN_NAMESPACE_STD


46 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

47 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

50 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

51 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

52 
__END_NAMESPACE_STD


57 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN


58 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

59 
__c
, 
size_t
 
__n
)

60 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

64 
__BEGIN_NAMESPACE_STD


66 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

69 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

70 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

73 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


76 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

78 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

79 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ifdeà
__OPTIMIZE__


82 
__ex‹º_®ways_šlše
 *

83 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


85  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

88 
__ex‹º_®ways_šlše
 const *

89 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


91  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

94 
	}
}

96 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

97 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

99 
__END_NAMESPACE_STD


101 #ifdeà
__USE_GNU


104 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


105 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

107 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

108 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

110 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

111 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

115 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


116 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

118 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

119 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

121 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

122 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

127 
__BEGIN_NAMESPACE_STD


129 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

132 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

133 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

134 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

137 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

138 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

140 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

141 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

144 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

147 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

151 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

152 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

154 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

155 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

156 
__THROW
 
	`__nÚnuÎ
 ((2));

157 
__END_NAMESPACE_STD


159 #ifdeà
__USE_XOPEN2K8


163 
	~<xloÿË.h
>

166 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

167 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

169 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

170 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

173 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 \

174 || 
defšed
 
__USE_XOPEN2K8


176 *
	$¡rdup
 (cÚ¡ *
__s
)

177 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

183 #ià
defšed
 
__USE_XOPEN2K8


184 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

185 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

188 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


190 
	#¡rdu·
(
s
) \

191 (
__ex‹nsiÚ__
 \

193 cÚ¡ *
__Şd
 = (
s
); \

194 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

195 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

196 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

197 
	}
}))

	)

200 
	#¡ºdu·
(
s
, 
n
) \

201 (
__ex‹nsiÚ__
 \

203 cÚ¡ *
__Şd
 = (
s
); \

204 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

205 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

206 
__Ãw
[
__Ën
] = '\0'; \

207 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

208 }))

	)

211 
	g__BEGIN_NAMESPACE_STD


213 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


216 *
¡rchr
 (*
__s
, 
__c
)

217 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

218 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

219 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

221 #ifdeà
__OPTIMIZE__


222 
__ex‹º_®ways_šlše
 *

223 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


225  
__butš_¡rchr
 (
__s
, 
__c
);

228 
__ex‹º_®ways_šlše
 const *

229 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


231  
__butš_¡rchr
 (
__s
, 
__c
);

236 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

237 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

240 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


243 *
	`¡¼chr
 (*
__s
, 
__c
)

244 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

245 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

246 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

248 #ifdeà
__OPTIMIZE__


249 
__ex‹º_®ways_šlše
 *

250 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


252  
	`__butš_¡¼chr
 (
__s
, 
__c
);

255 
__ex‹º_®ways_šlše
 const *

256 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


258  
	`__butš_¡¼chr
 (
__s
, 
__c
);

261 
	}
}

263 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

264 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

266 
__END_NAMESPACE_STD


268 #ifdeà
__USE_GNU


271 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


272 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

273 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

274 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

275 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

277 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

278 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

282 
__BEGIN_NAMESPACE_STD


285 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

286 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

289 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

290 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

292 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


295 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

296 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

297 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

298 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

300 #ifdeà
__OPTIMIZE__


301 
__ex‹º_®ways_šlše
 *

302 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


304  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

307 
__ex‹º_®ways_šlše
 const *

308 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


310  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

313 
	}
}

315 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

316 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

319 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


322 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

323 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

324 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

325 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

327 #ifdeà
__OPTIMIZE__


328 
__ex‹º_®ways_šlše
 *

329 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


331  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

334 
__ex‹º_®ways_šlše
 const *

335 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


337  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

340 
	}
}

342 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

343 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

348 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

349 
__THROW
 
	`__nÚnuÎ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

355 cÚ¡ *
__»¡riù
 
__d–im
,

356 **
__»¡riù
 
__§ve_±r
)

357 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

358 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


359 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

360 **
__»¡riù
 
__§ve_±r
)

361 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

364 #ifdeà
__USE_GNU


366 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

368 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

369 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

370 cÚ¡ *
__ÃedË
)

371 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

373 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

374 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

378 #ifdeà
__USE_GNU


382 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

383 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

384 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

388 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

389 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

390 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

391 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

392 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

393 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

400 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

407 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

414 
__END_NAMESPACE_STD


415 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_MISC


423 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


426 #ifdeà
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

428 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

429 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

431 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

433 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

438 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

439 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

443 #ifdeà
__USE_XOPEN2K8


445 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

451 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

453 #ifdeà
__USE_BSD


455 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

462 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

466 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`šdex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

471 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

474 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__ex‹º_®ways_šlše
 *

476 
	`šdex
 (*
__s
, 
__c
è
__THROW


478  
	`__butš_šdex
 (
__s
, 
__c
);

481 
__ex‹º_®ways_šlše
 const *

482 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


484  
	`__butš_šdex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

490 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

494 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`ršdex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

499 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

502 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__ex‹º_®ways_šlše
 *

504 
	`ršdex
 (*
__s
, 
__c
è
__THROW


506  
	`__butš_ršdex
 (
__s
, 
__c
);

509 
__ex‹º_®ways_šlše
 const *

510 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


512  
	`__butš_ršdex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

518 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

523 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

527 #ifdef 
__USE_GNU


528 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

529 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

530 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

534 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

535 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

538 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

546 
__loÿË_t
 
__loc
)

547 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

549 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

550 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

551 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

558 cÚ¡ *
__»¡riù
 
__d–im
)

559 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

567 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

568 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

569 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

570 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

574 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

575 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

576 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

577 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

578 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

585 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

588 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

593 #iâdeà
ba£Çme


598 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£Çme
 (*
__f’ame
)

600 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

601 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

602 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

604 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

610 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

611 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

612 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


632 
	~<b™s/¡ršg.h
>

635 
	~<b™s/¡ršg2.h
>

638 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


640 
	~<b™s/¡ršg3.h
>

644 
__END_DECLS


	@/usr/include/syslog.h

1 
	~<sys/sy¦og.h
>

	@/usr/include/time.h

22 #iâdef 
_TIME_H


24 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

25 ! 
defšed
 
	g__Ãed_time¥ec
)

26 
	#_TIME_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__Ãed_size_t


	)

36 
	#__Ãed_NULL


	)

37 
	~<¡ddef.h
>

41 
	~<b™s/time.h
>

44 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


45 #iâdeà
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

53 
	#__şock_t_defšed
 1

	)

55 
	~<b™s/ty³s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__şock_t
 
	tşock_t
;

60 
	g__END_NAMESPACE_STD


61 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
şock_t
)

66 #undeà
__Ãed_şock_t


68 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

69 
	#__time_t_defšed
 1

	)

71 
	~<b™s/ty³s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #undeà
__Ãed_time_t


84 #ià!
defšed
 
__şockid_t_defšed
 && \

85 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

86 
	#__şockid_t_defšed
 1

	)

88 
	~<b™s/ty³s.h
>

91 
__şockid_t
 
	tşockid_t
;

94 #undeà
__şockid_time_t


96 #ià!
defšed
 
__tim”_t_defšed
 && \

97 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

98 
	#__tim”_t_defšed
 1

	)

100 
	~<b™s/ty³s.h
>

103 
__tim”_t
 
	ttim”_t
;

106 #undeà
__Ãed_tim”_t


109 #ià(!
defšed
 
__time¥ec_defšed
 \

110 && ((
defšed
 
_TIME_H
 \

111 && (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
 \

112 || 
defšed
 
__USE_ISOC11
)) \

113 || 
defšed
 
__Ãed_time¥ec
))

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
__sysÿÎ_¦Úg_t
 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 cÚ¡ *
tm_zÚe
;

149 
__tm_gmtoff
;

150 cÚ¡ *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 #ifdeà
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
şock_t
 
	$şock
 (è
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

195 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

196 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

199 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

205 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

206 cÚ¡ *
__»¡riù
 
__fÜm©
,

207 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifdeà
__USE_XOPEN


213 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

214 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

215 
__THROW
;

218 #ifdeà
__USE_XOPEN2K8


221 
	~<xloÿË.h
>

223 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

224 cÚ¡ *
__»¡riù
 
__fÜm©
,

225 cÚ¡ 
tm
 *
__»¡riù
 
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

229 #ifdeà
__USE_GNU


230 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

231 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

232 
__loÿË_t
 
__loc
è
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

243 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

244 
__END_NAMESPACE_STD


246 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

250 
tm
 *
__»¡riù
 
__
è
__THROW
;

254 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

255 
tm
 *
__»¡riù
 
__
è
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

264 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

265 
__END_NAMESPACE_STD


267 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


272 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

273 *
__»¡riù
 
__buf
è
__THROW
;

276 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

277 *
__»¡riù
 
__buf
è
__THROW
;

282 *
__tzÇme
[2];

283 
__daylight
;

284 
__timezÚe
;

287 #ifdef 
__USE_POSIX


289 *
tzÇme
[2];

293 
	$tz£t
 (è
__THROW
;

296 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


297 
daylight
;

298 
timezÚe
;

301 #ifdeà
__USE_SVID


304 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

310 
	#__i¦—p
(
y—r
) \

311 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

314 #ifdeà
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

322 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

325 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

329 #ifdeà
__USE_POSIX199309


334 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

335 
time¥ec
 *
__»maššg
);

339 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

342 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

345 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

346 
__THROW
;

348 #ifdeà
__USE_XOPEN2K


353 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

354 cÚ¡ 
time¥ec
 *
__»q
,

355 
time¥ec
 *
__»m
);

358 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

363 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

364 
sigev’t
 *
__»¡riù
 
__evp
,

365 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

368 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

371 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

372 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

373 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

376 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

377 
__THROW
;

380 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

384 #ifdeà
__USE_ISOC11


386 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__nÚnuÎ
 ((1));

391 #ifdeà
__USE_XOPEN_EXTENDED


403 
g‘d©e_”r
;

412 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

415 #ifdeà
__USE_GNU


426 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

427 
tm
 *
__»¡riù
 
__»sbuå
);

430 
__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

71 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

75 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

79 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

83 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

86 #ifdeà
__USE_XOPEN2K8


87 
	#_XOPEN_VERSION
 700

	)

88 #–ià
defšed
 
__USE_XOPEN2K


89 
	#_XOPEN_VERSION
 600

	)

90 #–ià
defšed
 
__USE_UNIX98


91 
	#_XOPEN_VERSION
 500

	)

93 
	#_XOPEN_VERSION
 4

	)

97 
	#_XOPEN_XCU_VERSION
 4

	)

100 
	#_XOPEN_XPG2
 1

	)

101 
	#_XOPEN_XPG3
 1

	)

102 
	#_XOPEN_XPG4
 1

	)

105 
	#_XOPEN_UNIX
 1

	)

108 
	#_XOPEN_CRYPT
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<b™s/posix_İt.h
>

205 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


206 
	~<b™s/’vœÚm’ts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<b™s/ty³s.h
>

219 #iâdef 
__ssize_t_defšed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_defšed


	)

224 
	#__Ãed_size_t


	)

225 
	#__Ãed_NULL


	)

226 
	~<¡ddef.h
>

228 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


231 #iâdeà
__gid_t_defšed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_defšed


	)

236 #iâdeà
__uid_t_defšed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_defšed


	)

241 #iâdeà
__off_t_defšed


242 #iâdeà
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_defšed


	)

249 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_defšed


	)

254 #iâdeà
__u£cÚds_t_defšed


255 
__u£cÚds_t
 
	tu£cÚds_t
;

256 
	#__u£cÚds_t_defšed


	)

259 #iâdeà
__pid_t_defšed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_defšed


	)

265 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


266 #iâdeà
__šŒ_t_defšed


267 
__šŒ_t
 
	tšŒ_t
;

268 
	#__šŒ_t_defšed


	)

272 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


273 #iâdeà
__sockËn_t_defšed


274 
__sockËn_t
 
	tsockËn_t
;

275 
	#__sockËn_t_defšed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

289 #ifdeà
__USE_GNU


292 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

293 
__THROW
 
	`__nÚnuÎ
 ((1));

296 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

297 
__THROW
 
	`__nÚnuÎ
 ((1));

300 #ifdeà
__USE_ATFILE


304 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

305 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

310 #iâdef 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifdeà
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #ià
defšed
 
__USE_BSD
 && !defšed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #iâdeà
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

336 #ifdeà
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifdeà
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

346 
__THROW
;

353 
	`şo£
 (
__fd
);

360 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

366 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

368 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


369 #iâdeà
__USE_FILE_OFFSET64


376 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

377 
__off_t
 
__off£t
è
__wur
;

384 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
è
__wur
;

387 #ifdeà
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

389 
__off64_t
 
__off£t
),

390 
´—d64
è
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

392 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

393 
pwr™e64
è
__wur
;

395 
	#´—d
 
´—d64


	)

396 
	#pwr™e
 
pwr™e64


	)

400 #ifdeà
__USE_LARGEFILE64


404 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

405 
__off64_t
 
__off£t
è
__wur
;

408 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
è
__wur
;

417 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

419 #ifdeà
__USE_GNU


422 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

432 
	$®¬m
 (
__£cÚds
è
__THROW
;

444 
	`¦“p
 (
__£cÚds
);

446 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

447 || 
defšed
 
__USE_BSD


452 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

453 
__THROW
;

460 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

469 
	`·u£
 ();

473 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

476 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

483 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

488 #ifdeà
__USE_ATFILE


491 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

492 
__gid_t
 
__group
, 
__æag
)

493 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

497 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

499 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


501 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

511 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

520 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

521 || 
defšed
 
__USE_BSD


525 *
	$g‘wd
 (*
__buf
)

526 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

531 
	$dup
 (
__fd
è
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

536 #ifdeà
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

543 **
__’vœÚ
;

544 #ifdeà
__USE_GNU


545 **
’vœÚ
;

551 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

552 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

554 #ifdeà
__USE_XOPEN2K8


557 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

558 
__THROW
 
	`__nÚnuÎ
 ((2));

563 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

564 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

568 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

569 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

573 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

574 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

578 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

584 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

585 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 #ifdeà
__USE_GNU


590 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

591 *cÚ¡ 
__’vp
[])

592 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

596 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


598 
	$niû
 (
__šc
è
__THROW
 
__wur
;

603 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

609 
	~<b™s/cÚâame.h
>

612 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

613 
__THROW
 
	`__nÚnuÎ
 ((1));

616 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

619 
	$syscÚf
 (
__Çme
è
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

628 
__pid_t
 
	$g‘pid
 (è
__THROW
;

631 
__pid_t
 
	$g‘µid
 (è
__THROW
;

634 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

637 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

638 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


639 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

646 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

648 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


660 
	$£g½
 (è
__THROW
;

667 
__pid_t
 
	$£tsid
 (è
__THROW
;

669 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


671 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

675 
__uid_t
 
	$g‘uid
 (è
__THROW
;

678 
__uid_t
 
	$g‘euid
 (è
__THROW
;

681 
__gid_t
 
	$g‘gid
 (è
__THROW
;

684 
__gid_t
 
	$g‘egid
 (è
__THROW
;

689 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

691 #ifdef 
__USE_GNU


693 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

700 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

702 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


705 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

708 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


710 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

717 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

719 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


722 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

725 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


727 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

730 #ifdeà
__USE_GNU


733 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

734 
__THROW
;

738 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

739 
__THROW
;

743 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

744 
__THROW
 
__wur
;

748 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

749 
__THROW
 
__wur
;

756 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

758 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

759 || 
defšed
 
__USE_BSD


764 
__pid_t
 
	$vfÜk
 (è
__THROW
;

770 *
	$‰yÇme
 (
__fd
è
__THROW
;

774 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

775 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

779 
	$i§‰y
 (
__fd
è
__THROW
;

781 #ià
defšed
 
__USE_BSD
 \

782 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

785 
	$‰y¦Ù
 (è
__THROW
;

790 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

791 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

793 #ifdeà
__USE_ATFILE


796 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

797 cÚ¡ *
__to
, 
__æags
)

798 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

801 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


803 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

804 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

809 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

810 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

811 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

814 #ifdeà
__USE_ATFILE


816 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

817 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

820 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

821 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

822 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

826 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

828 #ifdeà
__USE_ATFILE


830 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

831 
__THROW
 
	`__nÚnuÎ
 ((2));

835 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

839 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

842 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

849 *
	`g‘logš
 ();

850 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


857 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

860 #ifdef 
__USE_BSD


862 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

866 #ifdef 
__USE_POSIX2


870 
	#__Ãed_g‘İt


	)

871 
	~<g‘İt.h
>

875 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


879 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

883 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

886 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

887 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

891 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

897 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

898 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

899 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

900 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

906 
	$vhªgup
 (è
__THROW
;

909 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

917 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

918 
size_t
 
__off£t
, 
__sÿË
)

919 
__THROW
 
	`__nÚnuÎ
 ((1));

925 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

929 *
	$g‘u£rsh–l
 (è
__THROW
;

930 
	$’du£rsh–l
 (è
__THROW
;

931 
	$£tu£rsh–l
 (è
__THROW
;

937 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

941 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

944 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

948 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

956 
	`fsync
 (
__fd
);

959 #ifdeà
__USE_GNU


962 
	$syncfs
 (
__fd
è
__THROW
;

966 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


969 
	`g‘ho¡id
 ();

972 
	$sync
 (è
__THROW
;

975 #ià
defšed
 
__USE_BSD
 || !defšed 
__USE_XOPEN2K


978 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

983 
	$g‘dbËsize
 (è
__THROW
;

989 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


992 #iâdeà
__USE_FILE_OFFSET64


993 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

994 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

996 #ifdeà
__REDIRECT_NTH


997 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

998 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

999 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1001 
	#Œunÿ‹
 
Œunÿ‹64


	)

1004 #ifdeà
__USE_LARGEFILE64


1005 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1006 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1011 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_POSIX199309
 \

1012 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1015 #iâdeà
__USE_FILE_OFFSET64


1016 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1018 #ifdeà
__REDIRECT_NTH


1019 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1020 
árunÿ‹64
è
__wur
;

1022 
	#árunÿ‹
 
árunÿ‹64


	)

1025 #ifdeà
__USE_LARGEFILE64


1026 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1032 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1033 || 
defšed
 
__USE_MISC


1037 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1043 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1047 #ifdeà
__USE_MISC


1058 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1063 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1075 
	#F_ULOCK
 0

	)

1076 
	#F_LOCK
 1

	)

1077 
	#F_TLOCK
 2

	)

1078 
	#F_TEST
 3

	)

1080 #iâdeà
__USE_FILE_OFFSET64


1081 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1083 #ifdeà
__REDIRECT


1084 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1085 
lockf64
è
__wur
;

1087 
	#lockf
 
lockf64


	)

1090 #ifdeà
__USE_LARGEFILE64


1091 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1096 #ifdeà
__USE_GNU


1101 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1102 (
__ex‹nsiÚ__
 \

1103 ({ 
__»suÉ
; \

1104 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1105 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1106 
__»suÉ
; 
	}
}))

	)

1109 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1112 
fd©async
 (
__fdes
);

1118 #ifdef 
__USE_XOPEN


1120 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1121 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1125 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1126 
__THROW
 
	`__nÚnuÎ
 ((1));

1133 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1134 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1140 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1142 *
	$ù”mid
 (*
__s
è
__THROW
;

1147 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1148 
	~<b™s/uni¡d.h
>

1151 
__END_DECLS


	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/arpa/nameser.h

52 #iâdeà
_ARPA_NAMESER_H_


53 
	#_ARPA_NAMESER_H_


	)

57 
	#BIND_4_COMPAT


	)

59 
	~<sys/·¿m.h
>

60 #ià(!
defšed
(
BSD
)) || (BSD < 199306)

61 
	~<sys/b™y³s.h
>

63 
	~<sys/ty³s.h
>

65 
	~<sys/cdefs.h
>

75 
	#__NAMESER
 19991006

	)

79 
	#NS_PACKETSZ
 512

	)

80 
	#NS_MAXDNAME
 1025

	)

81 
	#NS_MAXMSG
 65535

	)

82 
	#NS_MAXCDNAME
 255

	)

83 
	#NS_MAXLABEL
 63

	)

84 
	#NS_HFIXEDSZ
 12

	)

85 
	#NS_QFIXEDSZ
 4

	)

86 
	#NS_RRFIXEDSZ
 10

	)

87 
	#NS_INT32SZ
 4

	)

88 
	#NS_INT16SZ
 2

	)

89 
	#NS_INT8SZ
 1

	)

90 
	#NS_INADDRSZ
 4

	)

91 
	#NS_IN6ADDRSZ
 16

	)

92 
	#NS_CMPRSFLGS
 0xc0

	)

93 
	#NS_DEFAULTPORT
 53

	)

98 
	e__ns_£ù
 {

99 
	mns_s_qd
 = 0,

100 
	mns_s_zn
 = 0,

101 
	mns_s_ª
 = 1,

102 
	mns_s_´
 = 1,

103 
	mns_s_ns
 = 2,

104 
	mns_s_ud
 = 2,

105 
	mns_s_¬
 = 3,

106 
	mns_s_max
 = 4

107 } 
	tns_£ù
;

114 
	s__ns_msg
 {

115 cÚ¡ 
u_ch¬
 *
	m_msg
, *
	m_eom
;

116 
u_št16_t
 
	m_id
, 
	m_æags
, 
	m_couÁs
[
ns_s_max
];

117 cÚ¡ 
u_ch¬
 *
	m_£ùiÚs
[
ns_s_max
];

118 
ns_£ù
 
	m_£ù
;

119 
	m_¼num
;

120 cÚ¡ 
u_ch¬
 *
	m_msg_±r
;

121 } 
	tns_msg
;

124 
	s_ns_æagd©a
 { 
	mmask
, 
	mshiá
; };

125 cÚ¡ 
_ns_æagd©a
 _ns_flagdata[];

129 
	#ns_msg_id
(
hªdË
è((hªdË).
_id
 + 0)

	)

130 
	#ns_msg_ba£
(
hªdË
è((hªdË).
_msg
 + 0)

	)

131 
	#ns_msg_’d
(
hªdË
è((hªdË).
_eom
 + 0)

	)

132 
	#ns_msg_size
(
hªdË
è((hªdË).
_eom
 - (hªdË).
_msg
)

	)

133 
	#ns_msg_couÁ
(
hªdË
, 
£ùiÚ
è((hªdË).
_couÁs
[£ùiÚ] + 0)

	)

138 
	s__ns_¼
 {

139 
	mÇme
[
NS_MAXDNAME
];

140 
u_št16_t
 
	mty³
;

141 
u_št16_t
 
	m¼_şass
;

142 
u_št32_t
 
	m‰l
;

143 
u_št16_t
 
	mrdËngth
;

144 cÚ¡ 
u_ch¬
 * 
	mrd©a
;

145 } 
	tns_¼
;

148 
	#ns_¼_Çme
(
¼
è((Ôr).
Çme
[0] !ğ'\0'è? (¼).Çm: ".")

	)

149 
	#ns_¼_ty³
(
¼
è((
ns_ty³
)(Ôr).
ty³
 + 0))

	)

150 
	#ns_¼_şass
(
¼
è((
ns_şass
)(Ôr).
¼_şass
 + 0))

	)

151 
	#ns_¼_‰l
(
¼
è(Ôr).
‰l
 + 0)

	)

152 
	#ns_¼_rdËn
(
¼
è(Ôr).
rdËngth
 + 0)

	)

153 
	#ns_¼_rd©a
(
¼
è(Ôr).
rd©a
 + 0)

	)

160 
	e__ns_æag
 {

161 
	mns_f_qr
,

162 
	mns_f_İcode
,

163 
	mns_f_¯
,

164 
	mns_f_tc
,

165 
	mns_f_rd
,

166 
	mns_f_¿
,

167 
	mns_f_z
,

168 
	mns_f_ad
,

169 
	mns_f_cd
,

170 
	mns_f_rcode
,

171 
	mns_f_max


172 } 
	tns_æag
;

177 
	e__ns_İcode
 {

178 
	mns_o_qu”y
 = 0,

179 
	mns_o_iqu”y
 = 1,

180 
	mns_o_¡©us
 = 2,

182 
	mns_o_nÙify
 = 4,

183 
	mns_o_upd©e
 = 5,

184 
	mns_o_max
 = 6

185 } 
	tns_İcode
;

190 
	e__ns_rcode
 {

191 
	mns_r_nÛ¼Ü
 = 0,

192 
	mns_r_fÜm”r
 = 1,

193 
	mns_r_£rvç
 = 2,

194 
	mns_r_nxdomaš
 = 3,

195 
	mns_r_nÙim¶
 = 4,

196 
	mns_r_»fu£d
 = 5,

198 
	mns_r_yxdomaš
 = 6,

199 
	mns_r_yx¼£t
 = 7,

200 
	mns_r_nx¼£t
 = 8,

201 
	mns_r_nÙauth
 = 9,

202 
	mns_r_nÙzÚe
 = 10,

203 
	mns_r_max
 = 11,

205 
	mns_r_badv”s
 = 16,

207 
	mns_r_badsig
 = 16,

208 
	mns_r_badkey
 = 17,

209 
	mns_r_badtime
 = 18

210 } 
	tns_rcode
;

213 
	e__ns_upd©e_İ”©iÚ
 {

214 
	mns_uİ_d–‘e
 = 0,

215 
	mns_uİ_add
 = 1,

216 
	mns_uİ_max
 = 2

217 } 
	tns_upd©e_İ”©iÚ
;

222 
	sns_tsig_key
 {

223 
	mÇme
[
NS_MAXDNAME
], 
	m®g
[NS_MAXDNAME];

224 *
	md©a
;

225 
	mËn
;

227 
ns_tsig_key
 
	tns_tsig_key
;

232 
	sns_tı_tsig_¡©e
 {

233 
	mcouÁ”
;

234 
d¡_key
 *
	mkey
;

235 *
	mùx
;

236 
	msig
[
NS_PACKETSZ
];

237 
	msigËn
;

239 
ns_tı_tsig_¡©e
 
	tns_tı_tsig_¡©e
;

241 
	#NS_TSIG_FUDGE
 300

	)

242 
	#NS_TSIG_TCP_COUNT
 100

	)

243 
	#NS_TSIG_ALG_HMAC_MD5
 "HMAC-MD5.SIG-ALG.REG.INT"

	)

245 
	#NS_TSIG_ERROR_NO_TSIG
 -10

	)

246 
	#NS_TSIG_ERROR_NO_SPACE
 -11

	)

247 
	#NS_TSIG_ERROR_FORMERR
 -12

	)

252 
	e__ns_ty³
 {

253 
	mns_t_šv®id
 = 0,

254 
	mns_t_a
 = 1,

255 
	mns_t_ns
 = 2,

256 
	mns_t_md
 = 3,

257 
	mns_t_mf
 = 4,

258 
	mns_t_úame
 = 5,

259 
	mns_t_sß
 = 6,

260 
	mns_t_mb
 = 7,

261 
	mns_t_mg
 = 8,

262 
	mns_t_mr
 = 9,

263 
	mns_t_nuÎ
 = 10,

264 
	mns_t_wks
 = 11,

265 
	mns_t_±r
 = 12,

266 
	mns_t_hšfo
 = 13,

267 
	mns_t_mšfo
 = 14,

268 
	mns_t_mx
 = 15,

269 
	mns_t_txt
 = 16,

270 
	mns_t_½
 = 17,

271 
	mns_t_afsdb
 = 18,

272 
	mns_t_x25
 = 19,

273 
	mns_t_isdn
 = 20,

274 
	mns_t_¹
 = 21,

275 
	mns_t_n§p
 = 22,

276 
	mns_t_n§p_±r
 = 23,

277 
	mns_t_sig
 = 24,

278 
	mns_t_key
 = 25,

279 
	mns_t_px
 = 26,

280 
	mns_t_gpos
 = 27,

281 
	mns_t_¯¯
 = 28,

282 
	mns_t_loc
 = 29,

283 
	mns_t_nxt
 = 30,

284 
	mns_t_eid
 = 31,

285 
	mns_t_nimloc
 = 32,

286 
	mns_t_¤v
 = 33,

287 
	mns_t_©ma
 = 34,

288 
	mns_t_Ç±r
 = 35,

289 
	mns_t_kx
 = 36,

290 
	mns_t_û¹
 = 37,

291 
	mns_t_a6
 = 38,

292 
	mns_t_dÇme
 = 39,

293 
	mns_t_sšk
 = 40,

294 
	mns_t_İt
 = 41,

295 
	mns_t_­l
 = 42,

296 
	mns_t_tkey
 = 249,

297 
	mns_t_tsig
 = 250,

298 
	mns_t_ixä
 = 251,

299 
	mns_t_axä
 = 252,

300 
	mns_t_mab
 = 253,

301 
	mns_t_maa
 = 254,

302 
	mns_t_ªy
 = 255,

303 
	mns_t_zxä
 = 256,

304 
	mns_t_max
 = 65536

305 } 
	tns_ty³
;

308 
	#ns_t_qt_p
(
t
è(
	`ns_t_xä_p
Ñè|| (tè=ğ
ns_t_ªy
 || \

309 (
t
è=ğ
ns_t_mab
 || (tè=ğ
ns_t_maa
)

	)

311 
	#ns_t_m¼_p
(
t
è(Ñè=ğ
ns_t_tsig
 || (tè=ğ
ns_t_İt
)

	)

313 
	#ns_t_¼_p
(
t
è(!
	`ns_t_qt_p
Ñè&& !
	`ns_t_m¼_p
Ñ))

	)

314 
	#ns_t_udp_p
(
t
è(Ñè!ğ
ns_t_axä
 && (tè!ğ
ns_t_zxä
)

	)

315 
	#ns_t_xä_p
(
t
è(Ñè=ğ
ns_t_axä
 || (tè=ğ
ns_t_ixä
 || \

316 (
t
è=ğ
ns_t_zxä
)

	)

321 
	e__ns_şass
 {

322 
	mns_c_šv®id
 = 0,

323 
	mns_c_š
 = 1,

324 
	mns_c_2
 = 2,

325 
	mns_c_chaos
 = 3,

326 
	mns_c_hs
 = 4,

328 
	mns_c_nÚe
 = 254,

329 
	mns_c_ªy
 = 255,

330 
	mns_c_max
 = 65536

331 } 
	tns_şass
;

335 
	e__ns_key_ty³s
 {

336 
	mns_kt_r§
 = 1,

337 
	mns_kt_dh
 = 2,

338 
	mns_kt_d§
 = 3,

339 
	mns_kt_´iv©e
 = 254

340 } 
	tns_key_ty³s
;

342 
	e__ns_û¹_ty³s
 {

343 
	mû¹_t_pkix
 = 1,

344 
	mû¹_t_¥ki
 = 2,

345 
	mû¹_t_pgp
 = 3,

346 
	mû¹_t_u¾
 = 253,

347 
	mû¹_t_oid
 = 254

348 } 
	tns_û¹_ty³s
;

351 
	#NS_KEY_TYPEMASK
 0xC000

	)

352 
	#NS_KEY_TYPE_AUTH_CONF
 0x0000

	)

353 
	#NS_KEY_TYPE_CONF_ONLY
 0x8000

	)

354 
	#NS_KEY_TYPE_AUTH_ONLY
 0x4000

	)

355 
	#NS_KEY_TYPE_NO_KEY
 0xC000

	)

357 
	#NS_KEY_NO_AUTH
 0x8000

	)

358 
	#NS_KEY_NO_CONF
 0x4000

	)

359 
	#NS_KEY_RESERVED2
 0x2000

	)

360 
	#NS_KEY_EXTENDED_FLAGS
 0x1000

	)

361 
	#NS_KEY_RESERVED4
 0x0800

	)

362 
	#NS_KEY_RESERVED5
 0x0400

	)

363 
	#NS_KEY_NAME_TYPE
 0x0300

	)

364 
	#NS_KEY_NAME_USER
 0x0000

	)

365 
	#NS_KEY_NAME_ENTITY
 0x0200

	)

366 
	#NS_KEY_NAME_ZONE
 0x0100

	)

367 
	#NS_KEY_NAME_RESERVED
 0x0300

	)

368 
	#NS_KEY_RESERVED8
 0x0080

	)

369 
	#NS_KEY_RESERVED9
 0x0040

	)

370 
	#NS_KEY_RESERVED10
 0x0020

	)

371 
	#NS_KEY_RESERVED11
 0x0010

	)

372 
	#NS_KEY_SIGNATORYMASK
 0x000F

	)

373 
	#NS_KEY_RESERVED_BITMASK
 ( 
NS_KEY_RESERVED2
 | \

374 
NS_KEY_RESERVED4
 | \

375 
NS_KEY_RESERVED5
 | \

376 
NS_KEY_RESERVED8
 | \

377 
NS_KEY_RESERVED9
 | \

378 
NS_KEY_RESERVED10
 | \

379 
NS_KEY_RESERVED11
 )

	)

380 
	#NS_KEY_RESERVED_BITMASK2
 0xFFFF

	)

382 
	#NS_ALG_MD5RSA
 1

	)

383 
	#NS_ALG_DH
 2

	)

384 
	#NS_ALG_DSA
 3

	)

385 
	#NS_ALG_DSS
 
NS_ALG_DSA


	)

386 
	#NS_ALG_EXPIRE_ONLY
 253

	)

387 
	#NS_ALG_PRIVATE_OID
 254

	)

390 
	#NS_KEY_PROT_TLS
 1

	)

391 
	#NS_KEY_PROT_EMAIL
 2

	)

392 
	#NS_KEY_PROT_DNSSEC
 3

	)

393 
	#NS_KEY_PROT_IPSEC
 4

	)

394 
	#NS_KEY_PROT_ANY
 255

	)

397 
	#NS_MD5RSA_MIN_BITS
 512

	)

398 
	#NS_MD5RSA_MAX_BITS
 4096

	)

400 
	#NS_MD5RSA_MAX_BYTES
 ((
NS_MD5RSA_MAX_BITS
+7/8)*2+3)

	)

402 
	#NS_MD5RSA_MAX_BASE64
 (((
NS_MD5RSA_MAX_BYTES
+2)/3)*4)

	)

403 
	#NS_MD5RSA_MIN_SIZE
 ((
NS_MD5RSA_MIN_BITS
+7)/8)

	)

404 
	#NS_MD5RSA_MAX_SIZE
 ((
NS_MD5RSA_MAX_BITS
+7)/8)

	)

406 
	#NS_DSA_SIG_SIZE
 41

	)

407 
	#NS_DSA_MIN_SIZE
 213

	)

408 
	#NS_DSA_MAX_BYTES
 405

	)

411 
	#NS_SIG_TYPE
 0

	)

412 
	#NS_SIG_ALG
 2

	)

413 
	#NS_SIG_LABELS
 3

	)

414 
	#NS_SIG_OTTL
 4

	)

415 
	#NS_SIG_EXPIR
 8

	)

416 
	#NS_SIG_SIGNED
 12

	)

417 
	#NS_SIG_FOOT
 16

	)

418 
	#NS_SIG_SIGNER
 18

	)

420 
	#NS_NXT_BITS
 8

	)

421 
	#NS_NXT_BIT_SET
Ğ
n
,
p
èÕ[Ò)/
NS_NXT_BITS
] |ğ(0x80>>(Ò)%NS_NXT_BITS)))

	)

422 
	#NS_NXT_BIT_CLEAR
(
n
,
p
èÕ[Ò)/
NS_NXT_BITS
] &ğ~(0x80>>(Ò)%NS_NXT_BITS)))

	)

423 
	#NS_NXT_BIT_ISSET
(
n
,
p
èÕ[Ò)/
NS_NXT_BITS
] & (0x80>>(Ò)%NS_NXT_BITS)))

	)

424 
	#NS_NXT_MAX
 127

	)

429 
	#NS_OPT_DNSSEC_OK
 0x8000U

	)

430 
	#NS_OPT_NSID
 3

	)

435 
	#NS_GET16
(
s
, 
ı
) do { \

436 cÚ¡ 
u_ch¬
 *
t_ı
 = (cÚ¡ u_ch¬ *)(
ı
); \

437 (
s
èğ((
u_št16_t
)
t_ı
[0] << 8) \

438 | ((
u_št16_t
)
t_ı
[1]) \

440 (
ı
è+ğ
NS_INT16SZ
; \

441 } 0)

	)

443 
	#NS_GET32
(
l
, 
ı
) do { \

444 cÚ¡ 
u_ch¬
 *
t_ı
 = (cÚ¡ u_ch¬ *)(
ı
); \

445 (
l
èğ((
u_št32_t
)
t_ı
[0] << 24) \

446 | ((
u_št32_t
)
t_ı
[1] << 16) \

447 | ((
u_št32_t
)
t_ı
[2] << 8) \

448 | ((
u_št32_t
)
t_ı
[3]) \

450 (
ı
è+ğ
NS_INT32SZ
; \

451 } 0)

	)

453 
	#NS_PUT16
(
s
, 
ı
) do { \

454 
u_št16_t
 
t_s
 = (u_št16_t)(
s
); \

455 
u_ch¬
 *
t_ı
 = (u_ch¬ *)(
ı
); \

456 *
t_ı
++ = 
t_s
 >> 8; \

457 *
t_ı
 = 
t_s
; \

458 (
ı
è+ğ
NS_INT16SZ
; \

459 } 0)

	)

461 
	#NS_PUT32
(
l
, 
ı
) do { \

462 
u_št32_t
 
t_l
 = (u_št32_t)(
l
); \

463 
u_ch¬
 *
t_ı
 = (u_ch¬ *)(
ı
); \

464 *
t_ı
++ = 
t_l
 >> 24; \

465 *
t_ı
++ = 
t_l
 >> 16; \

466 *
t_ı
++ = 
t_l
 >> 8; \

467 *
t_ı
 = 
t_l
; \

468 (
ı
è+ğ
NS_INT32SZ
; \

469 } 0)

	)

471 
__BEGIN_DECLS


472 
	$ns_msg_g‘æag
 (
ns_msg
, è
__THROW
;

473 
u_št
 
	$ns_g‘16
 (cÚ¡ 
u_ch¬
 *è
__THROW
;

474 
u_lÚg
 
	$ns_g‘32
 (cÚ¡ 
u_ch¬
 *è
__THROW
;

475 
	$ns_put16
 (
u_št
, 
u_ch¬
 *è
__THROW
;

476 
	$ns_put32
 (
u_lÚg
, 
u_ch¬
 *è
__THROW
;

477 
	$ns_š™·r£
 (cÚ¡ 
u_ch¬
 *, , 
ns_msg
 *è
__THROW
;

478 
	$ns_sk¼
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, 
ns_£ù
, )

479 
__THROW
;

480 
	$ns_·r£¼
 (
ns_msg
 *, 
ns_£ù
, , 
ns_¼
 *è
__THROW
;

481 
	$ns_¥ršŒr
 (cÚ¡ 
ns_msg
 *, cÚ¡ 
ns_¼
 *,

482 cÚ¡ *, cÚ¡ *, *, 
size_t
)

483 
__THROW
;

484 
	$ns_¥ršŒrf
 (cÚ¡ 
u_ch¬
 *, 
size_t
, const *,

485 
ns_şass
, 
ns_ty³
, 
u_lÚg
, cÚ¡ 
u_ch¬
 *,

486 
size_t
, const *, const *,

487 *, 
size_t
è
__THROW
;

488 
	$ns_fÜm©_‰l
 (
u_lÚg
, *, 
size_t
è
__THROW
;

489 
	$ns_·r£_‰l
 (cÚ¡ *, 
u_lÚg
 *è
__THROW
;

490 
u_št32_t
 
	$ns_d©‘o£cs
 (cÚ¡ *, *è
__THROW
;

491 
	$ns_Çme_ÁŞ
 (cÚ¡ 
u_ch¬
 *, u_ch¬ *, 
size_t
è
__THROW
;

492 
	$ns_Çme_Áİ
 (cÚ¡ 
u_ch¬
 *, *, 
size_t
è
__THROW
;

493 
	$ns_Çme_±Ú
 (cÚ¡ *, 
u_ch¬
 *, 
size_t
è
__THROW
;

494 
	$ns_Çme_uÅack
 (cÚ¡ 
u_ch¬
 *, const u_char *,

495 cÚ¡ 
u_ch¬
 *, u_ch¬ *, 
size_t
è
__THROW
;

496 
	$ns_Çme_·ck
 (cÚ¡ 
u_ch¬
 *, u_char *, ,

497 cÚ¡ 
u_ch¬
 **, cÚ¡ u_ch¬ **è
__THROW
;

498 
	$ns_Çme_uncom´ess
 (cÚ¡ 
u_ch¬
 *, const u_char *,

499 cÚ¡ 
u_ch¬
 *, *, 
size_t
è
__THROW
;

500 
	$ns_Çme_com´ess
 (cÚ¡ *, 
u_ch¬
 *, 
size_t
,

501 cÚ¡ 
u_ch¬
 **, cÚ¡ u_ch¬ **è
__THROW
;

502 
	$ns_Çme_sk
 (cÚ¡ 
u_ch¬
 **, cÚ¡ u_ch¬ *è
__THROW
;

503 
	$ns_Çme_rŞlback
 (cÚ¡ 
u_ch¬
 *, const u_char **,

504 cÚ¡ 
u_ch¬
 **è
__THROW
;

505 
	$ns_sign
 (
u_ch¬
 *, *, , , *,

506 cÚ¡ 
u_ch¬
 *, , u_ch¬ *, *, 
time_t
è
__THROW
;

507 
	$ns_sign2
 (
u_ch¬
 *, *, , , *,

508 cÚ¡ 
u_ch¬
 *, , u_ch¬ *, *, 
time_t
,

509 
u_ch¬
 **, u_ch¬ **è
__THROW
;

510 
	$ns_sign_tı
 (
u_ch¬
 *, *, , ,

511 
ns_tı_tsig_¡©e
 *, è
__THROW
;

512 
	$ns_sign_tı2
 (
u_ch¬
 *, *, , ,

513 
ns_tı_tsig_¡©e
 *, ,

514 
u_ch¬
 **, u_ch¬ **è
__THROW
;

515 
	$ns_sign_tı_š™
 (*, cÚ¡ 
u_ch¬
 *, ,

516 
ns_tı_tsig_¡©e
 *è
__THROW
;

517 
u_ch¬
 *
	$ns_fšd_tsig
 (
u_ch¬
 *, u_ch¬ *è
__THROW
;

518 
	$ns_v”ify
 (
u_ch¬
 *, *, *, const u_char *, ,

519 
u_ch¬
 *, *, 
time_t
 *, è
__THROW
;

520 
	$ns_v”ify_tı
 (
u_ch¬
 *, *, 
ns_tı_tsig_¡©e
 *, )

521 
__THROW
;

522 
	$ns_v”ify_tı_š™
 (*, cÚ¡ 
u_ch¬
 *, ,

523 
ns_tı_tsig_¡©e
 *è
__THROW
;

524 
	$ns_§medomaš
 (cÚ¡ *, cÚ¡ *è
__THROW
;

525 
	$ns_subdomaš
 (cÚ¡ *, cÚ¡ *è
__THROW
;

526 
	$ns_makeÿnÚ
 (cÚ¡ *, *, 
size_t
è
__THROW
;

527 
	$ns_§m’ame
 (cÚ¡ *, cÚ¡ *è
__THROW
;

528 
__END_DECLS


530 #ifdeà
BIND_4_COMPAT


531 
	~<¬·/Çme£r_com·t.h
>

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

101 #undeà
__USE_ISOC11


102 #undeà
__USE_ISOC99


103 #undeà
__USE_ISOC95


104 #undeà
__USE_ISOCXX11


105 #undeà
__USE_POSIX


106 #undeà
__USE_POSIX2


107 #undeà
__USE_POSIX199309


108 #undeà
__USE_POSIX199506


109 #undeà
__USE_XOPEN


110 #undeà
__USE_XOPEN_EXTENDED


111 #undeà
__USE_UNIX98


112 #undeà
__USE_XOPEN2K


113 #undeà
__USE_XOPEN2KXSI


114 #undeà
__USE_XOPEN2K8


115 #undeà
__USE_XOPEN2K8XSI


116 #undeà
__USE_LARGEFILE


117 #undeà
__USE_LARGEFILE64


118 #undeà
__USE_FILE_OFFSET64


119 #undeà
__USE_BSD


120 #undeà
__USE_SVID


121 #undeà
__USE_MISC


122 #undeà
__USE_ATFILE


123 #undeà
__USE_GNU


124 #undeà
__USE_REENTRANT


125 #undeà
__USE_FORTIFY_LEVEL


126 #undeà
__KERNEL_STRICT_NAMES


130 #iâdeà
_LOOSE_KERNEL_NAMES


131 
	#__KERNEL_STRICT_NAMES


	)

141 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


142 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

143 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

145 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

150 #ifdeà
_GNU_SOURCE


151 #undeà
_ISOC95_SOURCE


152 
	#_ISOC95_SOURCE
 1

	)

153 #undeà
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #undeà
_ISOC11_SOURCE


156 
	#_ISOC11_SOURCE
 1

	)

157 #undeà
_POSIX_SOURCE


158 
	#_POSIX_SOURCE
 1

	)

159 #undeà
_POSIX_C_SOURCE


160 
	#_POSIX_C_SOURCE
 200809L

	)

161 #undeà
_XOPEN_SOURCE


162 
	#_XOPEN_SOURCE
 700

	)

163 #undeà
_XOPEN_SOURCE_EXTENDED


164 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

165 #undeà
_LARGEFILE64_SOURCE


166 
	#_LARGEFILE64_SOURCE
 1

	)

167 #undeà
_DEFAULT_SOURCE


168 
	#_DEFAULT_SOURCE
 1

	)

169 #undeà
_BSD_SOURCE


170 
	#_BSD_SOURCE
 1

	)

171 #undeà
_SVID_SOURCE


172 
	#_SVID_SOURCE
 1

	)

173 #undeà
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #ià(
defšed
 
_DEFAULT_SOURCE
 \

180 || (!
defšed
 
	g__STRICT_ANSI__
 \

181 && !
defšed
 
	g_ISOC99_SOURCE
 \

182 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

183 && !
defšed
 
	g_XOPEN_SOURCE
 \

184 && !
defšed
 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
))

185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

187 #undeà
_BSD_SOURCE


188 
	#_BSD_SOURCE
 1

	)

189 #undeà
_SVID_SOURCE


190 
	#_SVID_SOURCE
 1

	)

194 #ià(
defšed
 
_ISOC11_SOURCE
 \

195 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

196 
	#__USE_ISOC11
 1

	)

200 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

201 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

202 
	#__USE_ISOC99
 1

	)

206 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

207 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

208 
	#__USE_ISOC95
 1

	)

215 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

216 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

217 
	#__USE_ISOCXX11
 1

	)

223 #ifdeà
_DEFAULT_SOURCE


224 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


225 
	#__USE_POSIX_IMPLICITLY
 1

	)

227 #undeà
_POSIX_SOURCE


228 
	#_POSIX_SOURCE
 1

	)

229 #undeà
_POSIX_C_SOURCE


230 
	#_POSIX_C_SOURCE
 200809L

	)

232 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

233 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

234 
	#_POSIX_SOURCE
 1

	)

235 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

236 
	#_POSIX_C_SOURCE
 2

	)

237 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

238 
	#_POSIX_C_SOURCE
 199506L

	)

239 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

240 
	#_POSIX_C_SOURCE
 200112L

	)

242 
	#_POSIX_C_SOURCE
 200809L

	)

244 
	#__USE_POSIX_IMPLICITLY
 1

	)

247 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


248 
	#__USE_POSIX
 1

	)

251 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


252 
	#__USE_POSIX2
 1

	)

255 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

256 
	#__USE_POSIX199309
 1

	)

259 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

260 
	#__USE_POSIX199506
 1

	)

263 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

264 
	#__USE_XOPEN2K
 1

	)

265 #undeà
__USE_ISOC95


266 
	#__USE_ISOC95
 1

	)

267 #undeà
__USE_ISOC99


268 
	#__USE_ISOC99
 1

	)

271 #ià(
_POSIX_C_SOURCE
 - 0) >= 200809L

272 
	#__USE_XOPEN2K8
 1

	)

273 #undeà
_ATFILE_SOURCE


274 
	#_ATFILE_SOURCE
 1

	)

277 #ifdef 
_XOPEN_SOURCE


278 
	#__USE_XOPEN
 1

	)

279 #ià(
_XOPEN_SOURCE
 - 0) >= 500

280 
	#__USE_XOPEN_EXTENDED
 1

	)

281 
	#__USE_UNIX98
 1

	)

282 #undeà
_LARGEFILE_SOURCE


283 
	#_LARGEFILE_SOURCE
 1

	)

284 #ià(
_XOPEN_SOURCE
 - 0) >= 600

285 #ià(
_XOPEN_SOURCE
 - 0) >= 700

286 
	#__USE_XOPEN2K8
 1

	)

287 
	#__USE_XOPEN2K8XSI
 1

	)

289 
	#__USE_XOPEN2K
 1

	)

290 
	#__USE_XOPEN2KXSI
 1

	)

291 #undeà
__USE_ISOC95


292 
	#__USE_ISOC95
 1

	)

293 #undeà
__USE_ISOC99


294 
	#__USE_ISOC99
 1

	)

297 #ifdeà
_XOPEN_SOURCE_EXTENDED


298 
	#__USE_XOPEN_EXTENDED
 1

	)

303 #ifdeà
_LARGEFILE_SOURCE


304 
	#__USE_LARGEFILE
 1

	)

307 #ifdeà
_LARGEFILE64_SOURCE


308 
	#__USE_LARGEFILE64
 1

	)

311 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

312 
	#__USE_FILE_OFFSET64
 1

	)

315 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


316 
	#__USE_MISC
 1

	)

319 #ifdef 
_BSD_SOURCE


320 
	#__USE_BSD
 1

	)

323 #ifdef 
_SVID_SOURCE


324 
	#__USE_SVID
 1

	)

327 #ifdef 
_ATFILE_SOURCE


328 
	#__USE_ATFILE
 1

	)

331 #ifdef 
_GNU_SOURCE


332 
	#__USE_GNU
 1

	)

335 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


336 
	#__USE_REENTRANT
 1

	)

339 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

340 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

341 #ià
_FORTIFY_SOURCE
 > 1

342 
	#__USE_FORTIFY_LEVEL
 2

	)

344 
	#__USE_FORTIFY_LEVEL
 1

	)

347 
	#__USE_FORTIFY_LEVEL
 0

	)

352 
	~<¡dc-´edef.h
>

360 #undeà
__GNU_LIBRARY__


361 
	#__GNU_LIBRARY__
 6

	)

365 
	#__GLIBC__
 2

	)

366 
	#__GLIBC_MINOR__
 19

	)

368 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

369 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

372 #iâdeà
__ASSEMBLER__


373 #iâdeà
_SYS_CDEFS_H


374 
	~<sys/cdefs.h
>

379 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


380 
	#__USE_LARGEFILE
 1

	)

381 
	#__USE_LARGEFILE64
 1

	)

387 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

388 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

389 && 
defšed
 
	g__ex‹º_šlše


390 
	#__USE_EXTERN_INLINES
 1

	)

398 
	~<gnu/¡ubs.h
>

	@/usr/include/getopt.h

19 #iâdeà
_GETOPT_H


21 #iâdeà
__Ãed_g‘İt


22 
	#_GETOPT_H
 1

	)

32 #ià!
defšed
 
__GNU_LIBRARY__


33 
	~<ùy³.h
>

36 #iâdeà
__THROW


37 #iâdeà
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

40 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__ılu¥lus


57 *
İrg
;

71 
İtšd
;

76 
İ‹¼
;

80 
İtİt
;

82 #iâdeà
__Ãed_g‘İt


104 
	sİtiÚ


106 cÚ¡ *
	gÇme
;

109 
	ghas_¬g
;

110 *
	gæag
;

111 
	gv®
;

116 
	#no_¬gum’t
 0

	)

117 
	#»quœed_¬gum’t
 1

	)

118 
	#İtiÚ®_¬gum’t
 2

	)

146 #ifdeà
__GNU_LIBRARY__


150 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

151 
__THROW
;

153 #ià
defšed
 
__Ãed_g‘İt
 && defšed 
__USE_POSIX2
 \

154 && !
defšed
 
	g__USE_POSIX_IMPLICITLY
 && !defšed 
	g__USE_GNU


158 #ifdeà
__REDIRECT


159 
__REDIRECT_NTH
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

160 cÚ¡ *
__shÜtİts
),

161 
__posix_g‘İt
);

163 
__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

164 cÚ¡ *
__shÜtİts
è
__THROW
;

165 
	#g‘İt
 
__posix_g‘İt


	)

169 
g‘İt
 ();

172 #iâdeà
__Ãed_g‘İt


173 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

174 cÚ¡ *
__shÜtİts
,

175 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

176 
__THROW
;

177 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

178 cÚ¡ *
__shÜtİts
,

179 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

180 
__THROW
;

184 #ifdef 
__ılu¥lus


189 #undeà
__Ãed_g‘İt


	@/usr/include/inttypes.h

22 #iâdeà
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<¡dšt.h
>

30 #iâdeà
____gwch¬_t_defšed


31 #ifdeà
__ılu¥lus


32 
	#__gwch¬_t
 
wch¬_t


	)

33 #–ià
defšed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¬_t
;

36 
	#__Ãed_wch¬_t


	)

37 
	~<¡ddef.h
>

38 
wch¬_t
 
	t__gwch¬_t
;

40 
	#____gwch¬_t_defšed
 1

	)

43 #ià
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Î"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #ià
__WORDSIZE
 == 64

273 
	mquÙ
;

274 
	m»m
;

275 } 
	timaxdiv_t
;

282 
__ex‹nsiÚ__
 
	mquÙ
;

283 
__ex‹nsiÚ__
 
	m»m
;

284 } 
	timaxdiv_t
;

290 
štmax_t
 
	$imaxabs
 (
štmax_t
 
__n
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
štmax_t
 
__num”
, iÁmax_ˆ
__d’om
)

294 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

297 
štmax_t
 
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

298 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

301 
uštmax_t
 
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

302 ** 
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

305 
štmax_t
 
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

306 
__gwch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

307 
__THROW
;

310 
uštmax_t
 
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

311 
__gwch¬_t
 ** 
__»¡riù
 
__’d±r
, 
__ba£
)

312 
__THROW
;

314 #ifdeà
__USE_EXTERN_INLINES


316 #ià
__WORDSIZE
 == 64

318 
	$__¡¹Ş_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

319 **
__»¡riù
 
__’d±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

323 
__ex‹º_šlše
 
štmax_t


324 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

325 
ba£
))

327  
	`__¡¹Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

328 
	}
}

330 
	$__¡¹oul_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 ** 
__»¡riù
 
__’d±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

335 
__ex‹º_šlše
 
uštmax_t


336 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

337 
ba£
))

339  
	`__¡¹oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc¡Ş_š‹º®
 (cÚ¡ 
__gwch¬_t
 * 
__»¡riù
 
__ÅŒ
,

343 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

347 
__ex‹º_šlše
 
štmax_t


348 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

349 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

351  
	`__wc¡Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc¡oul_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

355 
__»¡riù
 
__ÅŒ
,

356 
__gwch¬_t
 **

357 
__»¡riù
 
__’d±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

361 
__ex‹º_šlše
 
uštmax_t


362 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

363 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

365  
	`__wc¡oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

366 
	}
}

370 
__ex‹nsiÚ__


371 
	$__¡¹Şl_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

372 **
__»¡riù
 
__’d±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

376 
__ex‹º_šlše
 
štmax_t


377 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

378 
ba£
))

380  
	`__¡¹Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

381 
	}
}

383 
__ex‹nsiÚ__


384 
	$__¡¹ouÎ_š‹º®
 (const *

385 
__»¡riù
 
__ÅŒ
,

387 
__»¡riù
 
__’d±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

392 
__ex‹º_šlše
 
uštmax_t


393 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

394 
ba£
))

396  
	`__¡¹ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

397 
	}
}

399 
__ex‹nsiÚ__


400 
	$__wc¡Şl_š‹º®
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

401 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

405 
__ex‹º_šlše
 
štmax_t


406 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

407 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

409  
	`__wc¡Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

410 
	}
}

413 
__ex‹nsiÚ__


414 
	$__wc¡ouÎ_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

415 
__»¡riù
 
__ÅŒ
,

416 
__gwch¬_t
 **

417 
__»¡riù
 
__’d±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

422 
__ex‹º_šlše
 
uštmax_t


423 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

424 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

426  
	`__wc¡ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/libio.h

28 #iâdeà
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_cÚfig.h
>

33 
	#_IO_åos_t
 
_G_åos_t


	)

34 
	#_IO_åos64_t
 
_G_åos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li¡
 
_G_va_li¡


	)

45 
	#_IO_wšt_t
 
wšt_t


	)

48 
	#__Ãed___va_li¡


	)

49 
	~<¡d¬g.h
>

50 #ifdeà
__GNUC_VA_LIST


51 #undeà
_IO_va_li¡


52 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

55 #iâdeà
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #iâdeà
EOF


62 
	#EOF
 (-1)

	)

64 #iâdeà
NULL


65 #ià
defšed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuÎ
)

	)

69 #ià!
defšed
(
__ılu¥lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifdeà
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifdeà
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifdeà
_IO_MTSAFE_IO


148 #ià
defšed
 
__GLIBC__
 && __GLIBC__ >= 2

149 
	~<b™s/¡dio-lock.h
>

154 
	t_IO_lock_t
;

160 
	s_IO_m¬k”
 {

161 
_IO_m¬k”
 *
	m_Ãxt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

169 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

170 
	mpublic
:

171 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

172 ~
¡»amm¬k”
();

173 
§všg
(è{  
	m_¥os
 == -2; }

174 
d–
(
¡»amm¬k”
&);

175 
d–
();

180 
	e__codecvt_»suÉ


182 
	m__codecvt_ok
,

183 
	m__codecvt_·¹Ÿl
,

184 
	m__codecvt_”rÜ
,

185 
	m__codecvt_nocÚv


188 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

194 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

195 
	m__mb¡©e_t
 *,

196 cÚ¡ 
	mwch¬_t
 *,

197 cÚ¡ 
	mwch¬_t
 *,

198 cÚ¡ 
	mwch¬_t
 **, *,

200 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

201 
	m__mb¡©e_t
 *, *,

203 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

204 
	m__mb¡©e_t
 *,

206 cÚ¡ **, 
	mwch¬_t
 *,

207 
	mwch¬_t
 *, wchar_t **);

208 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

211 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

214 
_IO_icÚv_t
 
	m__cd_š
;

215 
_IO_icÚv_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¬_t
 *
	m_IO_»ad_±r
;

222 
wch¬_t
 *
	m_IO_»ad_’d
;

223 
wch¬_t
 *
	m_IO_»ad_ba£
;

224 
wch¬_t
 *
	m_IO_wr™e_ba£
;

225 
wch¬_t
 *
	m_IO_wr™e_±r
;

226 
wch¬_t
 *
	m_IO_wr™e_’d
;

227 
wch¬_t
 *
	m_IO_buf_ba£
;

228 
wch¬_t
 *
	m_IO_buf_’d
;

230 
wch¬_t
 *
	m_IO_§ve_ba£
;

231 
wch¬_t
 *
	m_IO_backup_ba£
;

233 
wch¬_t
 *
	m_IO_§ve_’d
;

235 
__mb¡©e_t
 
	m_IO_¡©e
;

236 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¬_t
 
	m_shÜtbuf
[1];

241 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

245 
	s_IO_FILE
 {

246 
	m_æags
;

247 
	#_IO_fe_æags
 
_æags


	)

251 * 
	m_IO_»ad_±r
;

252 * 
	m_IO_»ad_’d
;

253 * 
	m_IO_»ad_ba£
;

254 * 
	m_IO_wr™e_ba£
;

255 * 
	m_IO_wr™e_±r
;

256 * 
	m_IO_wr™e_’d
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_’d
;

260 *
	m_IO_§ve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_§ve_’d
;

264 
_IO_m¬k”
 *
	m_m¬k”s
;

266 
_IO_FILE
 *
	m_chaš
;

268 
	m_f’o
;

270 
	m_blksize
;

272 
	m_æags2
;

274 
_IO_off_t
 
	m_Şd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cŞumn
;

279 sigÃd 
	m_vbË_off£t
;

280 
	m_shÜtbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifdeà
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com¶‘e


290 
_IO_FILE
 
	m_fe
;

292 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_ä“»s_li¡
;

299 *
	m_ä“»s_buf
;

300 
size_t
 
	m_ä“»s_size
;

302 *
	m__·d1
;

303 *
	m__·d2
;

304 *
	m__·d3
;

305 *
	m__·d4
;

306 
size_t
 
	m__·d5
;

308 
	m_mode
;

310 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

314 #iâdeà
__ılu¥lus


315 
_IO_FILE
 
	t_IO_FILE
;

318 
	g_IO_FILE_¶us
;

320 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

321 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

322 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

323 #iâdeà
_LIBC


324 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

325 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

326 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

328 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

329 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

330 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

338 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

346 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, cÚ¡ *
	t__buf
,

347 
	tsize_t
 
	t__n
);

355 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

358 
	t__io_şo£_â
 (*
	t__cook›
);

361 #ifdeà
_GNU_SOURCE


363 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

364 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

365 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

366 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

371 
__io_»ad_â
 *
	m»ad
;

372 
__io_wr™e_â
 *
	mwr™e
;

373 
__io_£ek_â
 *
	m£ek
;

374 
__io_şo£_â
 *
	mşo£
;

375 } 
	t_IO_cook›_io_funùiÚs_t
;

376 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

378 
	g_IO_cook›_fe
;

381 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

382 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

386 #ifdeà
__ılu¥lus


390 
__und”æow
 (
_IO_FILE
 *);

391 
__uæow
 (
_IO_FILE
 *);

392 
__ov”æow
 (
_IO_FILE
 *, );

393 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


394 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

395 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

396 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

399 #ià 
__GNUC__
 >= 3

400 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

402 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

405 
	#_IO_g‘c_uÆocked
(
_å
) \

406 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

407 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

408 
	#_IO_³ekc_uÆocked
(
_å
) \

409 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

410 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

411 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

412 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

413 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

414 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

415 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

417 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


418 
	#_IO_g‘wc_uÆocked
(
_å
) \

419 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

420 || ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 \

421 >ğ(
_å
)->
_wide_d©a
->
_IO_»ad_’d
), 0) \

422 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

423 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

424 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

425 || ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

426 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
), 0) \

427 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

428 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

431 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

432 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

434 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

435 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

436 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

437 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

439 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

442 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

443 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

445 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

446 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

447 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

449 #ifdeà
_IO_MTSAFE_IO


450 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

451 
	#_IO_æockfe
(
_å
) \

452 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

453 
	#_IO_fuÆockfe
(
_å
) \

454 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

456 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

457 
	#_IO_æockfe
(
_å
è

	)

458 
	#_IO_fuÆockfe
(
_å
è

	)

459 
	#_IO_árylockfe
(
_å
è

	)

460 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

461 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

464 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

465 
_IO_va_li¡
, *
__»¡riù
);

466 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

467 
_IO_va_li¡
);

468 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

469 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

471 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

472 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

474 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

476 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


477 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

478 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

479 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

480 #ià
__GNUC__
 >= 2

483 #ià
defšed
 
_LIBC
 && defšed 
SHARED


484 
	~<shlib-com·t.h
>

485 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

486 
	#_IO_fwide_maybe_šcom·tibË
 \

487 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

488 cÚ¡ 
_IO_¡dš_u£d
;

489 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

492 #iâdeà
_IO_fwide_maybe_šcom·tibË


493 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

497 
	#_IO_fwide
(
__å
, 
__mode
) \

498 ({ 
__»suÉ
 = (
__mode
); \

499 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

501 ià((
__å
)->
_mode
 == 0) \

503 (
__å
)->
_mode
 = -1; \

504 
__»suÉ
 = (
__å
)->
_mode
; \

506 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

507 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

509 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

510 
__»suÉ
; })

	)

513 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

514 
_IO_va_li¡
, *
__»¡riù
);

515 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

516 
_IO_va_li¡
);

517 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

518 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

521 #ifdeà
__LDBL_COMPAT


522 
	~<b™s/libio-ldbl.h
>

525 #ifdeà
__ılu¥lus


	@/usr/include/linux/hdlc/ioctl.h

1 #iâdeà
__HDLC_IOCTL_H__


2 
	#__HDLC_IOCTL_H__


	)

5 
	#GENERIC_HDLC_VERSION
 4

	)

7 
	#CLOCK_DEFAULT
 0

	)

8 
	#CLOCK_EXT
 1

	)

9 
	#CLOCK_INT
 2

	)

10 
	#CLOCK_TXINT
 3

	)

11 
	#CLOCK_TXFROMRX
 4

	)

14 
	#ENCODING_DEFAULT
 0

	)

15 
	#ENCODING_NRZ
 1

	)

16 
	#ENCODING_NRZI
 2

	)

17 
	#ENCODING_FM_MARK
 3

	)

18 
	#ENCODING_FM_SPACE
 4

	)

19 
	#ENCODING_MANCHESTER
 5

	)

22 
	#PARITY_DEFAULT
 0

	)

23 
	#PARITY_NONE
 1

	)

24 
	#PARITY_CRC16_PR0
 2

	)

25 
	#PARITY_CRC16_PR1
 3

	)

26 
	#PARITY_CRC16_PR0_CCITT
 4

	)

27 
	#PARITY_CRC16_PR1_CCITT
 5

	)

28 
	#PARITY_CRC32_PR0_CCITT
 6

	)

29 
	#PARITY_CRC32_PR1_CCITT
 7

	)

31 
	#LMI_DEFAULT
 0

	)

32 
	#LMI_NONE
 1

	)

33 
	#LMI_ANSI
 2

	)

34 
	#LMI_CCITT
 3

	)

35 
	#LMI_CISCO
 4

	)

37 #iâdeà
__ASSEMBLY__


40 
	mşock_¿‹
;

41 
	mşock_ty³
;

42 
	mloİback
;

43 } 
	tsync_£rŸl_£‰šgs
;

46 
	mşock_¿‹
;

47 
	mşock_ty³
;

48 
	mloİback
;

49 
	m¦Ù_m­
;

50 } 
	t‹1_£‰šgs
;

53 
	m’codšg
;

54 
	m·r™y
;

55 } 
	t¿w_hdlc_´Ùo
;

58 
	mt391
;

59 
	mt392
;

60 
	mn391
;

61 
	mn392
;

62 
	mn393
;

63 
	mlmi
;

64 
	mdû
;

65 } 
	tä_´Ùo
;

68 
	mdlci
;

69 } 
	tä_´Ùo_pvc
;

72 
	mdlci
;

73 
	mma¡”
[
IFNAMSIZ
];

74 }
	tä_´Ùo_pvc_šfo
;

77 
	mš‹rv®
;

78 
	mtimeout
;

79 } 
	tcisco_´Ùo
;

	@/usr/include/linux/netdevice.h

25 #iâdeà
_LINUX_NETDEVICE_H


26 
	#_LINUX_NETDEVICE_H


	)

28 
	~<lšux/if.h
>

29 
	~<lšux/if_‘h”.h
>

30 
	~<lšux/if_·ck‘.h
>

31 
	~<lšux/if_lšk.h
>

34 
	#MAX_ADDR_LEN
 32

	)

37 
	#INIT_NETDEV_GROUP
 0

	)

43 
	mIF_PORT_UNKNOWN
 = 0,

44 
	mIF_PORT_10BASE2
,

45 
	mIF_PORT_10BASET
,

46 
	mIF_PORT_AUI
,

47 
	mIF_PORT_100BASET
,

48 
	mIF_PORT_100BASETX
,

49 
	mIF_PORT_100BASEFX


	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__FD_SETSIZE


22 
	#__FD_SETSIZE
 1024

	)

25 
	mfds_b™s
[
__FD_SETSIZE
 / (8 * ())];

26 } 
	t__k”Ãl_fd_£t
;

29 (*
	t__k”Ãl_sighªdËr_t
)();

32 
	t__k”Ãl_key_t
;

33 
	t__k”Ãl_mqd_t
;

35 
	~<asm/posix_ty³s.h
>

	@/usr/include/linux/socket.h

1 #iâdeà
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__®ignof__
 (
sockaddr
 *))

	)

11 
	t__k”Ãl_§_çmy_t
;

13 
	s__k”Ãl_sockaddr_¡Üage
 {

14 
__k”Ãl_§_çmy_t
 
	mss_çmy
;

16 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

19 } 
__©Œibu‹__
 ((
®igÃd
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/rpc/netdb.h

36 #iâdeà
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<ã©u»s.h
>

41 
	#__Ãed_size_t


	)

42 
	~<¡ddef.h
>

44 
__BEGIN_DECLS


46 
	s½ûÁ


48 *
	mr_Çme
;

49 **
	mr_®Ÿ£s
;

50 
	mr_numb”
;

53 
	$£ŒpûÁ
 (
__¡ayİ’
è
__THROW
;

54 
	$’d½ûÁ
 (è
__THROW
;

55 
½ûÁ
 *
	$g‘½cbyÇme
 (cÚ¡ *
__Çme
è
__THROW
;

56 
½ûÁ
 *
	$g‘½cbynumb”
 (
__numb”
è
__THROW
;

57 
½ûÁ
 *
	$g‘½ûÁ
 (è
__THROW
;

59 #ifdeà
__USE_MISC


60 
	$g‘½cbyÇme_r
 (cÚ¡ *
__Çme
, 
½ûÁ
 *
__»suÉ_buf
,

61 *
__bufãr
, 
size_t
 
__buæ’
,

62 
½ûÁ
 **
__»suÉ
è
__THROW
;

64 
	$g‘½cbynumb”_r
 (
__numb”
, 
½ûÁ
 *
__»suÉ_buf
,

65 *
__bufãr
, 
size_t
 
__buæ’
,

66 
½ûÁ
 **
__»suÉ
è
__THROW
;

68 
	$g‘½ûÁ_r
 (
½ûÁ
 *
__»suÉ_buf
, *
__bufãr
,

69 
size_t
 
__buæ’
, 
½ûÁ
 **
__»suÉ
è
__THROW
;

72 
__END_DECLS


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/wch¬.h
>

27 
	~<b™s/wÜdsize.h
>

34 #iâdeà
__št8_t_defšed


35 
	#__št8_t_defšed


	)

36 sigÃd 
	tšt8_t
;

37 
	tšt16_t
;

38 
	tšt32_t
;

39 #ià
__WORDSIZE
 == 64

40 
	tšt64_t
;

42 
__ex‹nsiÚ__


43 
	tšt64_t
;

48 
	tušt8_t
;

49 
	tušt16_t
;

50 #iâdeà
__ušt32_t_defšed


51 
	tušt32_t
;

52 
	#__ušt32_t_defšed


	)

54 #ià
__WORDSIZE
 == 64

55 
	tušt64_t
;

57 
__ex‹nsiÚ__


58 
	tušt64_t
;

65 sigÃd 
	tšt_Ëa¡8_t
;

66 
	tšt_Ëa¡16_t
;

67 
	tšt_Ëa¡32_t
;

68 #ià
__WORDSIZE
 == 64

69 
	tšt_Ëa¡64_t
;

71 
__ex‹nsiÚ__


72 
	tšt_Ëa¡64_t
;

76 
	tušt_Ëa¡8_t
;

77 
	tušt_Ëa¡16_t
;

78 
	tušt_Ëa¡32_t
;

79 #ià
__WORDSIZE
 == 64

80 
	tušt_Ëa¡64_t
;

82 
__ex‹nsiÚ__


83 
	tušt_Ëa¡64_t
;

90 sigÃd 
	tšt_ç¡8_t
;

91 #ià
__WORDSIZE
 == 64

92 
	tšt_ç¡16_t
;

93 
	tšt_ç¡32_t
;

94 
	tšt_ç¡64_t
;

96 
	tšt_ç¡16_t
;

97 
	tšt_ç¡32_t
;

98 
__ex‹nsiÚ__


99 
	tšt_ç¡64_t
;

103 
	tušt_ç¡8_t
;

104 #ià
__WORDSIZE
 == 64

105 
	tušt_ç¡16_t
;

106 
	tušt_ç¡32_t
;

107 
	tušt_ç¡64_t
;

109 
	tušt_ç¡16_t
;

110 
	tušt_ç¡32_t
;

111 
__ex‹nsiÚ__


112 
	tušt_ç¡64_t
;

117 #ià
__WORDSIZE
 == 64

118 #iâdeà
__šŒ_t_defšed


119 
	tšŒ_t
;

120 
	#__šŒ_t_defšed


	)

122 
	tušŒ_t
;

124 #iâdeà
__šŒ_t_defšed


125 
	tšŒ_t
;

126 
	#__šŒ_t_defšed


	)

128 
	tušŒ_t
;

133 #ià
__WORDSIZE
 == 64

134 
	tštmax_t
;

135 
	tuštmax_t
;

137 
__ex‹nsiÚ__


138 
	tštmax_t
;

139 
__ex‹nsiÚ__


140 
	tuštmax_t
;

144 #ià
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
èø## 
L


	)

146 
	#__UINT64_C
(
c
èø## 
UL


	)

148 
	#__INT64_C
(
c
èø## 
LL


	)

149 
	#__UINT64_C
(
c
èø## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #ià
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #ià
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #ià
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #ià
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #ià
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #ià
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 
	#SIZE_MAX
 (4294967295U)

	)

267 #iâdeà
WCHAR_MIN


269 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

270 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

274 
	#WINT_MIN
 (0u)

	)

275 
	#WINT_MAX
 (4294967295u)

	)

278 
	#INT8_C
(
c
è
	)
c

279 
	#INT16_C
(
c
è
	)
c

280 
	#INT32_C
(
c
è
	)
c

281 #ià
__WORDSIZE
 == 64

282 
	#INT64_C
(
c
èø## 
L


	)

284 
	#INT64_C
(
c
èø## 
LL


	)

288 
	#UINT8_C
(
c
è
	)
c

289 
	#UINT16_C
(
c
è
	)
c

290 
	#UINT32_C
(
c
èø## 
U


	)

291 #ià
__WORDSIZE
 == 64

292 
	#UINT64_C
(
c
èø## 
UL


	)

294 
	#UINT64_C
(
c
èø## 
ULL


	)

298 #ià
__WORDSIZE
 == 64

299 
	#INTMAX_C
(
c
èø## 
L


	)

300 
	#UINTMAX_C
(
c
èø## 
UL


	)

302 
	#INTMAX_C
(
c
èø## 
LL


	)

303 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/xlocale.h

20 #iâdeà
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loÿË_¡ruù


30 
__loÿË_d©a
 *
	m__loÿËs
[13];

33 cÚ¡ *
	m__ùy³_b
;

34 cÚ¡ *
	m__ùy³_tŞow”
;

35 cÚ¡ *
	m__ùy³_touµ”
;

38 cÚ¡ *
	m__Çmes
[13];

39 } *
	t__loÿË_t
;

42 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

23 
__off_t
 
	m__pos
;

24 
__mb¡©e_t
 
	m__¡©e
;

25 } 
	t_G_åos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb¡©e_t
 
	m__¡©e
;

30 } 
	t_G_åos64_t
;

31 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gcÚv.h
>

35 
__gcÚv_šfo
 
	m__cd
;

38 
__gcÚv_šfo
 
	m__cd
;

39 
__gcÚv_¡•_d©a
 
	m__d©a
;

40 } 
	m__combšed
;

41 } 
	t_G_icÚv_t
;

46 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/arpa/nameser_compat.h

34 #iâdeà
_ARPA_NAMESER_COMPAT_


35 
	#_ARPA_NAMESER_COMPAT_


	)

37 
	#__BIND
 19950621

	)

39 
	~<’dŸn.h
>

49 
	mid
 :16;

50 #ià
BYTE_ORDER
 =ğ
BIG_ENDIAN


52 
	mqr
: 1;

53 
	mİcode
: 4;

54 
	m¯
: 1;

55 
	mtc
: 1;

56 
	mrd
: 1;

58 
	m¿
: 1;

59 
	munu£d
 :1;

60 
	mad
: 1;

61 
	mcd
: 1;

62 
	mrcode
 :4;

64 #ià
BYTE_ORDER
 =ğ
LITTLE_ENDIAN
 || BYTE_ORDER =ğ
PDP_ENDIAN


66 
	mrd
 :1;

67 
	mtc
 :1;

68 
	m¯
 :1;

69 
	mİcode
 :4;

70 
	mqr
 :1;

72 
	mrcode
 :4;

73 
	mcd
: 1;

74 
	mad
: 1;

75 
	munu£d
 :1;

76 
	m¿
 :1;

79 
	mqdcouÁ
 :16;

80 
	mªcouÁ
 :16;

81 
	mnscouÁ
 :16;

82 
	m¬couÁ
 :16;

83 } 
	tHEADER
;

85 
	#PACKETSZ
 
NS_PACKETSZ


	)

86 
	#MAXDNAME
 
NS_MAXDNAME


	)

87 
	#MAXCDNAME
 
NS_MAXCDNAME


	)

88 
	#MAXLABEL
 
NS_MAXLABEL


	)

89 
	#HFIXEDSZ
 
NS_HFIXEDSZ


	)

90 
	#QFIXEDSZ
 
NS_QFIXEDSZ


	)

91 
	#RRFIXEDSZ
 
NS_RRFIXEDSZ


	)

92 
	#INT32SZ
 
NS_INT32SZ


	)

93 
	#INT16SZ
 
NS_INT16SZ


	)

94 
	#INT8SZ
 
NS_INT8SZ


	)

95 
	#INADDRSZ
 
NS_INADDRSZ


	)

96 
	#IN6ADDRSZ
 
NS_IN6ADDRSZ


	)

97 
	#INDIR_MASK
 
NS_CMPRSFLGS


	)

98 
	#NAMESERVER_PORT
 
NS_DEFAULTPORT


	)

100 
	#S_ZONE
 
ns_s_zn


	)

101 
	#S_PREREQ
 
ns_s_´


	)

102 
	#S_UPDATE
 
ns_s_ud


	)

103 
	#S_ADDT
 
ns_s_¬


	)

105 
	#QUERY
 
ns_o_qu”y


	)

106 
	#IQUERY
 
ns_o_iqu”y


	)

107 
	#STATUS
 
ns_o_¡©us


	)

108 
	#NS_NOTIFY_OP
 
ns_o_nÙify


	)

109 
	#NS_UPDATE_OP
 
ns_o_upd©e


	)

111 
	#NOERROR
 
ns_r_nÛ¼Ü


	)

112 
	#FORMERR
 
ns_r_fÜm”r


	)

113 
	#SERVFAIL
 
ns_r_£rvç


	)

114 
	#NXDOMAIN
 
ns_r_nxdomaš


	)

115 
	#NOTIMP
 
ns_r_nÙim¶


	)

116 
	#REFUSED
 
ns_r_»fu£d


	)

117 
	#YXDOMAIN
 
ns_r_yxdomaš


	)

118 
	#YXRRSET
 
ns_r_yx¼£t


	)

119 
	#NXRRSET
 
ns_r_nx¼£t


	)

120 
	#NOTAUTH
 
ns_r_nÙauth


	)

121 
	#NOTZONE
 
ns_r_nÙzÚe


	)

127 
	#DELETE
 
ns_uİ_d–‘e


	)

128 
	#ADD
 
ns_uİ_add


	)

130 
	#T_A
 
ns_t_a


	)

131 
	#T_NS
 
ns_t_ns


	)

132 
	#T_MD
 
ns_t_md


	)

133 
	#T_MF
 
ns_t_mf


	)

134 
	#T_CNAME
 
ns_t_úame


	)

135 
	#T_SOA
 
ns_t_sß


	)

136 
	#T_MB
 
ns_t_mb


	)

137 
	#T_MG
 
ns_t_mg


	)

138 
	#T_MR
 
ns_t_mr


	)

139 
	#T_NULL
 
ns_t_nuÎ


	)

140 
	#T_WKS
 
ns_t_wks


	)

141 
	#T_PTR
 
ns_t_±r


	)

142 
	#T_HINFO
 
ns_t_hšfo


	)

143 
	#T_MINFO
 
ns_t_mšfo


	)

144 
	#T_MX
 
ns_t_mx


	)

145 
	#T_TXT
 
ns_t_txt


	)

146 
	#T_RP
 
ns_t_½


	)

147 
	#T_AFSDB
 
ns_t_afsdb


	)

148 
	#T_X25
 
ns_t_x25


	)

149 
	#T_ISDN
 
ns_t_isdn


	)

150 
	#T_RT
 
ns_t_¹


	)

151 
	#T_NSAP
 
ns_t_n§p


	)

152 
	#T_NSAP_PTR
 
ns_t_n§p_±r


	)

153 
	#T_SIG
 
ns_t_sig


	)

154 
	#T_KEY
 
ns_t_key


	)

155 
	#T_PX
 
ns_t_px


	)

156 
	#T_GPOS
 
ns_t_gpos


	)

157 
	#T_AAAA
 
ns_t_¯¯


	)

158 
	#T_LOC
 
ns_t_loc


	)

159 
	#T_NXT
 
ns_t_nxt


	)

160 
	#T_EID
 
ns_t_eid


	)

161 
	#T_NIMLOC
 
ns_t_nimloc


	)

162 
	#T_SRV
 
ns_t_¤v


	)

163 
	#T_ATMA
 
ns_t_©ma


	)

164 
	#T_NAPTR
 
ns_t_Ç±r


	)

165 
	#T_A6
 
ns_t_a6


	)

166 
	#T_DNAME
 
ns_t_dÇme


	)

167 
	#T_TSIG
 
ns_t_tsig


	)

168 
	#T_IXFR
 
ns_t_ixä


	)

169 
	#T_AXFR
 
ns_t_axä


	)

170 
	#T_MAILB
 
ns_t_mab


	)

171 
	#T_MAILA
 
ns_t_maa


	)

172 
	#T_ANY
 
ns_t_ªy


	)

174 
	#C_IN
 
ns_c_š


	)

175 
	#C_CHAOS
 
ns_c_chaos


	)

176 
	#C_HS
 
ns_c_hs


	)

178 
	#C_NONE
 
ns_c_nÚe


	)

179 
	#C_ANY
 
ns_c_ªy


	)

181 
	#GETSHORT
 
NS_GET16


	)

182 
	#GETLONG
 
NS_GET32


	)

183 
	#PUTSHORT
 
NS_PUT16


	)

184 
	#PUTLONG
 
NS_PUT32


	)

	@/usr/include/linux/if_link.h

1 #iâdeà
_LINUX_IF_LINK_H


2 
	#_LINUX_IF_LINK_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

8 
	s¹Æ_lšk_¡©s
 {

9 
__u32
 
	mrx_·ck‘s
;

10 
__u32
 
	mtx_·ck‘s
;

11 
__u32
 
	mrx_by‹s
;

12 
__u32
 
	mtx_by‹s
;

13 
__u32
 
	mrx_”rÜs
;

14 
__u32
 
	mtx_”rÜs
;

15 
__u32
 
	mrx_drİ³d
;

16 
__u32
 
	mtx_drİ³d
;

17 
__u32
 
	mmuÉiÿ¡
;

18 
__u32
 
	mcŞlisiÚs
;

21 
__u32
 
	mrx_Ëngth_”rÜs
;

22 
__u32
 
	mrx_ov”_”rÜs
;

23 
__u32
 
	mrx_üc_”rÜs
;

24 
__u32
 
	mrx_äame_”rÜs
;

25 
__u32
 
	mrx_fifo_”rÜs
;

26 
__u32
 
	mrx_mis£d_”rÜs
;

29 
__u32
 
	mtx_abÜ‹d_”rÜs
;

30 
__u32
 
	mtx_ÿ¼›r_”rÜs
;

31 
__u32
 
	mtx_fifo_”rÜs
;

32 
__u32
 
	mtx_h—¹b—t_”rÜs
;

33 
__u32
 
	mtx_wšdow_”rÜs
;

36 
__u32
 
	mrx_com´es£d
;

37 
__u32
 
	mtx_com´es£d
;

41 
	s¹Æ_lšk_¡©s64
 {

42 
__u64
 
	mrx_·ck‘s
;

43 
__u64
 
	mtx_·ck‘s
;

44 
__u64
 
	mrx_by‹s
;

45 
__u64
 
	mtx_by‹s
;

46 
__u64
 
	mrx_”rÜs
;

47 
__u64
 
	mtx_”rÜs
;

48 
__u64
 
	mrx_drİ³d
;

49 
__u64
 
	mtx_drİ³d
;

50 
__u64
 
	mmuÉiÿ¡
;

51 
__u64
 
	mcŞlisiÚs
;

54 
__u64
 
	mrx_Ëngth_”rÜs
;

55 
__u64
 
	mrx_ov”_”rÜs
;

56 
__u64
 
	mrx_üc_”rÜs
;

57 
__u64
 
	mrx_äame_”rÜs
;

58 
__u64
 
	mrx_fifo_”rÜs
;

59 
__u64
 
	mrx_mis£d_”rÜs
;

62 
__u64
 
	mtx_abÜ‹d_”rÜs
;

63 
__u64
 
	mtx_ÿ¼›r_”rÜs
;

64 
__u64
 
	mtx_fifo_”rÜs
;

65 
__u64
 
	mtx_h—¹b—t_”rÜs
;

66 
__u64
 
	mtx_wšdow_”rÜs
;

69 
__u64
 
	mrx_com´es£d
;

70 
__u64
 
	mtx_com´es£d
;

74 
	s¹Æ_lšk_ifm­
 {

75 
__u64
 
	mmem_¡¬t
;

76 
__u64
 
	mmem_’d
;

77 
__u64
 
	mba£_addr
;

78 
__u16
 
	mœq
;

79 
__u8
 
	mdma
;

80 
__u8
 
	mpÜt
;

102 
	mIFLA_UNSPEC
,

103 
	mIFLA_ADDRESS
,

104 
	mIFLA_BROADCAST
,

105 
	mIFLA_IFNAME
,

106 
	mIFLA_MTU
,

107 
	mIFLA_LINK
,

108 
	mIFLA_QDISC
,

109 
	mIFLA_STATS
,

110 
	mIFLA_COST
,

111 
	#IFLA_COST
 
IFLA_COST


	)

112 
	mIFLA_PRIORITY
,

113 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

114 
	mIFLA_MASTER
,

115 
	#IFLA_MASTER
 
IFLA_MASTER


	)

116 
	mIFLA_WIRELESS
,

117 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

118 
	mIFLA_PROTINFO
,

119 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

120 
	mIFLA_TXQLEN
,

121 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

122 
	mIFLA_MAP
,

123 
	#IFLA_MAP
 
IFLA_MAP


	)

124 
	mIFLA_WEIGHT
,

125 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

126 
	mIFLA_OPERSTATE
,

127 
	mIFLA_LINKMODE
,

128 
	mIFLA_LINKINFO
,

129 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

130 
	mIFLA_NET_NS_PID
,

131 
	mIFLA_IFALIAS
,

132 
	mIFLA_NUM_VF
,

133 
	mIFLA_VFINFO_LIST
,

134 
	mIFLA_STATS64
,

135 
	mIFLA_VF_PORTS
,

136 
	mIFLA_PORT_SELF
,

137 
	mIFLA_AF_SPEC
,

138 
	mIFLA_GROUP
,

139 
	mIFLA_NET_NS_FD
,

140 
	mIFLA_EXT_MASK
,

141 
	mIFLA_PROMISCUITY
,

142 
	#IFLA_PROMISCUITY
 
IFLA_PROMISCUITY


	)

143 
	mIFLA_NUM_TX_QUEUES
,

144 
	mIFLA_NUM_RX_QUEUES
,

145 
	mIFLA_CARRIER
,

146 
	mIFLA_PHYS_PORT_ID
,

147 
	m__IFLA_MAX


151 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

154 
	#IFLA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
ifšfomsg
))))

	)

155 
	#IFLA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
ifšfomsg
))

	)

158 
	mIFLA_INET_UNSPEC
,

159 
	mIFLA_INET_CONF
,

160 
	m__IFLA_INET_MAX
,

163 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

196 
	mIFLA_INET6_UNSPEC
,

197 
	mIFLA_INET6_FLAGS
,

198 
	mIFLA_INET6_CONF
,

199 
	mIFLA_INET6_STATS
,

200 
	mIFLA_INET6_MCAST
,

201 
	mIFLA_INET6_CACHEINFO
,

202 
	mIFLA_INET6_ICMP6STATS
,

203 
	mIFLA_INET6_TOKEN
,

204 
	m__IFLA_INET6_MAX


207 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

210 
	mBRIDGE_MODE_UNSPEC
,

211 
	mBRIDGE_MODE_HAIRPIN
,

215 
	mIFLA_BRPORT_UNSPEC
,

216 
	mIFLA_BRPORT_STATE
,

217 
	mIFLA_BRPORT_PRIORITY
,

218 
	mIFLA_BRPORT_COST
,

219 
	mIFLA_BRPORT_MODE
,

220 
	mIFLA_BRPORT_GUARD
,

221 
	mIFLA_BRPORT_PROTECT
,

222 
	mIFLA_BRPORT_FAST_LEAVE
,

223 
	mIFLA_BRPORT_LEARNING
,

224 
	mIFLA_BRPORT_UNICAST_FLOOD
,

225 
	m__IFLA_BRPORT_MAX


227 
	#IFLA_BRPORT_MAX
 (
__IFLA_BRPORT_MAX
 - 1)

	)

229 
	siæa_ÿchešfo
 {

230 
__u32
 
	mmax_»asm_Ën
;

231 
__u32
 
	mt¡amp
;

232 
__u32
 
	m»achabË_time
;

233 
__u32
 
	m»Œªs_time
;

237 
	mIFLA_INFO_UNSPEC
,

238 
	mIFLA_INFO_KIND
,

239 
	mIFLA_INFO_DATA
,

240 
	mIFLA_INFO_XSTATS
,

241 
	m__IFLA_INFO_MAX
,

244 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

249 
	mIFLA_VLAN_UNSPEC
,

250 
	mIFLA_VLAN_ID
,

251 
	mIFLA_VLAN_FLAGS
,

252 
	mIFLA_VLAN_EGRESS_QOS
,

253 
	mIFLA_VLAN_INGRESS_QOS
,

254 
	mIFLA_VLAN_PROTOCOL
,

255 
	m__IFLA_VLAN_MAX
,

258 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

260 
	siæa_vÏn_æags
 {

261 
__u32
 
	mæags
;

262 
__u32
 
	mmask
;

266 
	mIFLA_VLAN_QOS_UNSPEC
,

267 
	mIFLA_VLAN_QOS_MAPPING
,

268 
	m__IFLA_VLAN_QOS_MAX


271 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

273 
	siæa_vÏn_qos_m­pšg
 {

274 
__u32
 
	mäom
;

275 
__u32
 
	mto
;

280 
	mIFLA_MACVLAN_UNSPEC
,

281 
	mIFLA_MACVLAN_MODE
,

282 
	mIFLA_MACVLAN_FLAGS
,

283 
	m__IFLA_MACVLAN_MAX
,

286 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

288 
	emacvÏn_mode
 {

289 
	mMACVLAN_MODE_PRIVATE
 = 1,

290 
	mMACVLAN_MODE_VEPA
 = 2,

291 
	mMACVLAN_MODE_BRIDGE
 = 4,

292 
	mMACVLAN_MODE_PASSTHRU
 = 8,

295 
	#MACVLAN_FLAG_NOPROMISC
 1

	)

299 
	mIFLA_VXLAN_UNSPEC
,

300 
	mIFLA_VXLAN_ID
,

301 
	mIFLA_VXLAN_GROUP
,

302 
	mIFLA_VXLAN_LINK
,

303 
	mIFLA_VXLAN_LOCAL
,

304 
	mIFLA_VXLAN_TTL
,

305 
	mIFLA_VXLAN_TOS
,

306 
	mIFLA_VXLAN_LEARNING
,

307 
	mIFLA_VXLAN_AGEING
,

308 
	mIFLA_VXLAN_LIMIT
,

309 
	mIFLA_VXLAN_PORT_RANGE
,

310 
	mIFLA_VXLAN_PROXY
,

311 
	mIFLA_VXLAN_RSC
,

312 
	mIFLA_VXLAN_L2MISS
,

313 
	mIFLA_VXLAN_L3MISS
,

314 
	mIFLA_VXLAN_PORT
,

315 
	mIFLA_VXLAN_GROUP6
,

316 
	mIFLA_VXLAN_LOCAL6
,

317 
	m__IFLA_VXLAN_MAX


319 
	#IFLA_VXLAN_MAX
 (
__IFLA_VXLAN_MAX
 - 1)

	)

321 
	siæa_vxÏn_pÜt_¿nge
 {

322 
__be16
 
	mlow
;

323 
__be16
 
	mhigh
;

329 
	mIFLA_BOND_UNSPEC
,

330 
	mIFLA_BOND_MODE
,

331 
	mIFLA_BOND_ACTIVE_SLAVE
,

332 
	m__IFLA_BOND_MAX
,

335 
	#IFLA_BOND_MAX
 (
__IFLA_BOND_MAX
 - 1)

	)

340 
	mIFLA_VF_INFO_UNSPEC
,

341 
	mIFLA_VF_INFO
,

342 
	m__IFLA_VF_INFO_MAX
,

345 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

348 
	mIFLA_VF_UNSPEC
,

349 
	mIFLA_VF_MAC
,

350 
	mIFLA_VF_VLAN
,

351 
	mIFLA_VF_TX_RATE
,

352 
	mIFLA_VF_SPOOFCHK
,

353 
	mIFLA_VF_LINK_STATE
,

354 
	m__IFLA_VF_MAX
,

357 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

359 
	siæa_vf_mac
 {

360 
__u32
 
	mvf
;

361 
__u8
 
	mmac
[32];

364 
	siæa_vf_vÏn
 {

365 
__u32
 
	mvf
;

366 
__u32
 
	mvÏn
;

367 
__u32
 
	mqos
;

370 
	siæa_vf_tx_¿‹
 {

371 
__u32
 
	mvf
;

372 
__u32
 
	m¿‹
;

375 
	siæa_vf_¥oofchk
 {

376 
__u32
 
	mvf
;

377 
__u32
 
	m£‰šg
;

381 
	mIFLA_VF_LINK_STATE_AUTO
,

382 
	mIFLA_VF_LINK_STATE_ENABLE
,

383 
	mIFLA_VF_LINK_STATE_DISABLE
,

384 
	m__IFLA_VF_LINK_STATE_MAX
,

387 
	siæa_vf_lšk_¡©e
 {

388 
__u32
 
	mvf
;

389 
__u32
 
	mlšk_¡©e
;

408 
	mIFLA_VF_PORT_UNSPEC
,

409 
	mIFLA_VF_PORT
,

410 
	m__IFLA_VF_PORT_MAX
,

413 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

416 
	mIFLA_PORT_UNSPEC
,

417 
	mIFLA_PORT_VF
,

418 
	mIFLA_PORT_PROFILE
,

419 
	mIFLA_PORT_VSI_TYPE
,

420 
	mIFLA_PORT_INSTANCE_UUID
,

421 
	mIFLA_PORT_HOST_UUID
,

422 
	mIFLA_PORT_REQUEST
,

423 
	mIFLA_PORT_RESPONSE
,

424 
	m__IFLA_PORT_MAX
,

427 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

429 
	#PORT_PROFILE_MAX
 40

	)

430 
	#PORT_UUID_MAX
 16

	)

431 
	#PORT_SELF_VF
 -1

	)

434 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

435 
	mPORT_REQUEST_PREASSOCIATE_RR
,

436 
	mPORT_REQUEST_ASSOCIATE
,

437 
	mPORT_REQUEST_DISASSOCIATE
,

441 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

442 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

443 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

444 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

445 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

446 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

447 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

449 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

450 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

451 
	mPORT_PROFILE_RESPONSE_INVALID
,

452 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

453 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

454 
	mPORT_PROFILE_RESPONSE_ERROR
,

457 
	siæa_pÜt_vsi
 {

458 
__u8
 
	mvsi_mgr_id
;

459 
__u8
 
	mvsi_ty³_id
[3];

460 
__u8
 
	mvsi_ty³_v”siÚ
;

461 
__u8
 
	m·d
[3];

468 
	mIFLA_IPOIB_UNSPEC
,

469 
	mIFLA_IPOIB_PKEY
,

470 
	mIFLA_IPOIB_MODE
,

471 
	mIFLA_IPOIB_UMCAST
,

472 
	m__IFLA_IPOIB_MAX


476 
	mIPOIB_MODE_DATAGRAM
 = 0,

477 
	mIPOIB_MODE_CONNECTED
 = 1,

480 
	#IFLA_IPOIB_MAX
 (
__IFLA_IPOIB_MAX
 - 1)

	)

486 
	mIFLA_HSR_UNSPEC
,

487 
	mIFLA_HSR_SLAVE1
,

488 
	mIFLA_HSR_SLAVE2
,

489 
	mIFLA_HSR_MULTICAST_SPEC
,

490 
	mIFLA_HSR_SUPERVISION_ADDR
,

491 
	mIFLA_HSR_SEQ_NR
,

492 
	m__IFLA_HSR_MAX
,

495 
	#IFLA_HSR_MAX
 (
__IFLA_HSR_MAX
 - 1)

	)

	@/usr/include/linux/stddef.h

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

54 
	#__STDC_ISO_10646__
 201103L

	)

57 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/gconv.h

22 #iâdeà
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	#__Ãed_mb¡©e_t


	)

27 
	#__Ãed_wšt_t


	)

28 
	~<wch¬.h
>

29 
	#__Ãed_size_t


	)

30 
	#__Ãed_wch¬_t


	)

31 
	~<¡ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gcÚv_¡•
;

65 
	g__gcÚv_¡•_d©a
;

66 
	g__gcÚv_lßded_objeù
;

67 
	g__gcÚv_Œªs_d©a
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 (*
	t__gcÚv_Œªs_fù
è(
	t__gcÚv_¡•
 *,

85 
	t__gcÚv_¡•_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gcÚv_Œªs_cÚ‹xt_fù
) (*, const *,

97 (*
	t__gcÚv_Œªs_qu”y_fù
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gcÚv_Œªs_š™_fù
) (**, const *);

102 (*
	t__gcÚv_Œªs_’d_fù
) (*);

104 
	s__gcÚv_Œªs_d©a


107 
__gcÚv_Œªs_fù
 
__Œªs_fù
;

108 
__gcÚv_Œªs_cÚ‹xt_fù
 
__Œªs_cÚ‹xt_fù
;

109 
__gcÚv_Œªs_’d_fù
 
__Œªs_’d_fù
;

110 *
__d©a
;

111 
__gcÚv_Œªs_d©a
 *
__Ãxt
;

116 
	s__gcÚv_¡•


118 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

119 cÚ¡ *
__modÇme
;

121 
__couÁ”
;

123 *
__äom_Çme
;

124 *
__to_Çme
;

126 
__gcÚv_fù
 
__fù
;

127 
__gcÚv_btowc_fù
 
__btowc_fù
;

128 
__gcÚv_š™_fù
 
__š™_fù
;

129 
__gcÚv_’d_fù
 
__’d_fù
;

133 
__mš_Ãeded_äom
;

134 
__max_Ãeded_äom
;

135 
__mš_Ãeded_to
;

136 
__max_Ãeded_to
;

139 
__¡©eful
;

141 *
__d©a
;

146 
	s__gcÚv_¡•_d©a


148 *
__outbuf
;

149 *
__outbuãnd
;

153 
__æags
;

157 
__švoÿtiÚ_couÁ”
;

161 
__š‹º®_u£
;

163 
__mb¡©e_t
 *
__¡©•
;

164 
__mb¡©e_t
 
__¡©e
;

168 
__gcÚv_Œªs_d©a
 *
__Œªs
;

173 
	s__gcÚv_šfo


175 
size_t
 
__n¡•s
;

176 
__gcÚv_¡•
 *
__¡•s
;

177 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

178 } *
	t__gcÚv_t
;

	@/usr/include/linux/netlink.h

1 #iâdeà
__LINUX_NETLINK_H


2 
	#__LINUX_NETLINK_H


	)

4 
	~<lšux/k”Ãl.h
>

5 
	~<lšux/sock‘.h
>

6 
	~<lšux/ty³s.h
>

8 
	#NETLINK_ROUTE
 0

	)

9 
	#NETLINK_UNUSED
 1

	)

10 
	#NETLINK_USERSOCK
 2

	)

11 
	#NETLINK_FIREWALL
 3

	)

12 
	#NETLINK_SOCK_DIAG
 4

	)

13 
	#NETLINK_NFLOG
 5

	)

14 
	#NETLINK_XFRM
 6

	)

15 
	#NETLINK_SELINUX
 7

	)

16 
	#NETLINK_ISCSI
 8

	)

17 
	#NETLINK_AUDIT
 9

	)

18 
	#NETLINK_FIB_LOOKUP
 10

	)

19 
	#NETLINK_CONNECTOR
 11

	)

20 
	#NETLINK_NETFILTER
 12

	)

21 
	#NETLINK_IP6_FW
 13

	)

22 
	#NETLINK_DNRTMSG
 14

	)

23 
	#NETLINK_KOBJECT_UEVENT
 15

	)

24 
	#NETLINK_GENERIC
 16

	)

26 
	#NETLINK_SCSITRANSPORT
 18

	)

27 
	#NETLINK_ECRYPTFS
 19

	)

28 
	#NETLINK_RDMA
 20

	)

29 
	#NETLINK_CRYPTO
 21

	)

31 
	#NETLINK_INET_DIAG
 
NETLINK_SOCK_DIAG


	)

33 
	#MAX_LINKS
 32

	)

35 
	ssockaddr_Æ
 {

36 
__k”Ãl_§_çmy_t
 
	mÆ_çmy
;

37 
	mÆ_·d
;

38 
__u32
 
	mÆ_pid
;

39 
__u32
 
	mÆ_groups
;

42 
	sÆmsghdr
 {

43 
__u32
 
	mÆmsg_Ën
;

44 
__u16
 
	mÆmsg_ty³
;

45 
__u16
 
	mÆmsg_æags
;

46 
__u32
 
	mÆmsg_£q
;

47 
__u32
 
	mÆmsg_pid
;

52 
	#NLM_F_REQUEST
 1

	)

53 
	#NLM_F_MULTI
 2

	)

54 
	#NLM_F_ACK
 4

	)

55 
	#NLM_F_ECHO
 8

	)

56 
	#NLM_F_DUMP_INTR
 16

	)

59 
	#NLM_F_ROOT
 0x100

	)

60 
	#NLM_F_MATCH
 0x200

	)

61 
	#NLM_F_ATOMIC
 0x400

	)

62 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

65 
	#NLM_F_REPLACE
 0x100

	)

66 
	#NLM_F_EXCL
 0x200

	)

67 
	#NLM_F_CREATE
 0x400

	)

68 
	#NLM_F_APPEND
 0x800

	)

79 
	#NLMSG_ALIGNTO
 4U

	)

80 
	#NLMSG_ALIGN
(
Ën
èĞ(Ö’)+
NLMSG_ALIGNTO
-1è& ~(NLMSG_ALIGNTO-1è)

	)

81 
	#NLMSG_HDRLEN
 ((è
	`NLMSG_ALIGN
((
Æmsghdr
)))

	)

82 
	#NLMSG_LENGTH
(
Ën
è(Ö’è+ 
NLMSG_HDRLEN
)

	)

83 
	#NLMSG_SPACE
(
Ën
è
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
Ö’))

	)

84 
	#NLMSG_DATA
(
Æh
è((*)(((*êlhè+ 
	`NLMSG_LENGTH
(0)))

	)

85 
	#NLMSG_NEXT
(
Æh
,
Ën
è(Ö’è-ğ
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
), \

86 (
Æmsghdr
*)(((*)(
Æh
)è+ 
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
)))

	)

87 
	#NLMSG_OK
(
Æh
,
Ën
è(Ö’è>ğ()(
Æmsghdr
) && \

88 (
Æh
)->
Æmsg_Ën
 >ğ(
Æmsghdr
) && \

89 (
Æh
)->
Æmsg_Ën
 <ğ(
Ën
))

	)

90 
	#NLMSG_PAYLOAD
(
Æh
,
Ën
è(Òlh)->
Æmsg_Ën
 - 
	`NLMSG_SPACE
(Ö’)))

	)

92 
	#NLMSG_NOOP
 0x1

	)

93 
	#NLMSG_ERROR
 0x2

	)

94 
	#NLMSG_DONE
 0x3

	)

95 
	#NLMSG_OVERRUN
 0x4

	)

97 
	#NLMSG_MIN_TYPE
 0x10

	)

99 
	sÆmsg”r
 {

100 
	m”rÜ
;

101 
Æmsghdr
 
	mmsg
;

104 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

105 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

106 
	#NETLINK_PKTINFO
 3

	)

107 
	#NETLINK_BROADCAST_ERROR
 4

	)

108 
	#NETLINK_NO_ENOBUFS
 5

	)

109 
	#NETLINK_RX_RING
 6

	)

110 
	#NETLINK_TX_RING
 7

	)

112 
	sÆ_pktšfo
 {

113 
__u32
 
	mgroup
;

116 
	sÆ_mm­_»q
 {

117 
	mnm_block_size
;

118 
	mnm_block_Ä
;

119 
	mnm_äame_size
;

120 
	mnm_äame_Ä
;

123 
	sÆ_mm­_hdr
 {

124 
	mnm_¡©us
;

125 
	mnm_Ën
;

126 
__u32
 
	mnm_group
;

128 
__u32
 
	mnm_pid
;

129 
__u32
 
	mnm_uid
;

130 
__u32
 
	mnm_gid
;

133 
	eÆ_mm­_¡©us
 {

134 
	mNL_MMAP_STATUS_UNUSED
,

135 
	mNL_MMAP_STATUS_RESERVED
,

136 
	mNL_MMAP_STATUS_VALID
,

137 
	mNL_MMAP_STATUS_COPY
,

138 
	mNL_MMAP_STATUS_SKIP
,

141 
	#NL_MMAP_MSG_ALIGNMENT
 
NLMSG_ALIGNTO


	)

142 
	#NL_MMAP_MSG_ALIGN
(
sz
è
	`__ALIGN_KERNEL
(sz, 
NL_MMAP_MSG_ALIGNMENT
)

	)

143 
	#NL_MMAP_HDRLEN
 
	`NL_MMAP_MSG_ALIGN
((
Æ_mm­_hdr
))

	)

145 
	#NET_MAJOR
 36

	)

148 
	mNETLINK_UNCONNECTED
 = 0,

149 
	mNETLINK_CONNECTED
,

161 
	sÆ©Œ
 {

162 
__u16
 
	mÆa_Ën
;

163 
__u16
 
	mÆa_ty³
;

176 
	#NLA_F_NESTED
 (1 << 15)

	)

177 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

178 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

180 
	#NLA_ALIGNTO
 4

	)

181 
	#NLA_ALIGN
(
Ën
è((Ö’è+ 
NLA_ALIGNTO
 - 1è& ~(NLA_ALIGNTO - 1))

	)

182 
	#NLA_HDRLEN
 ((è
	`NLA_ALIGN
((
Æ©Œ
)))

	)

	@/usr/include/wchar.h

23 #iâdeà
_WCHAR_H


25 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<ã©u»s.h
>

30 #ifdeà
_WCHAR_H


32 
	#__Ãed___FILE


	)

33 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


34 
	#__Ãed_FILE


	)

36 
	~<¡dio.h
>

38 
	#__Ãed___va_li¡


	)

39 
	~<¡d¬g.h
>

41 
	~<b™s/wch¬.h
>

44 
	#__Ãed_size_t


	)

45 
	#__Ãed_wch¬_t


	)

46 
	#__Ãed_NULL


	)

48 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


49 #undeà
__Ãed_wšt_t


50 
	#__Ãed_wšt_t


	)

51 
	~<¡ddef.h
>

55 #iâdeà
_WINT_T


60 
	#_WINT_T


	)

61 
	twšt_t
;

65 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
defšed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twšt_t
;

69 
	g__END_NAMESPACE_STD


74 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
____mb¡©e_t_defšed


80 
	#____mb¡©e_t_defšed
 1

	)

84 
	m__couÁ
;

87 #ifdeà
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wšt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__v®ue
;

94 } 
	t__mb¡©e_t
;

96 #undeà
__Ãed_mb¡©e_t


101 #ifdeà
_WCHAR_H


103 #iâdeà
__mb¡©e_t_defšed


104 
__BEGIN_NAMESPACE_C99


106 
__mb¡©e_t
 
	tmb¡©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb¡©e_t_defšed
 1

	)

111 #ifdeà
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

115 #iâdeà
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #iâdeà
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


128 
	~<wùy³.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

150 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

151 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

156 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

158 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

159 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
)

164 
__THROW
 
__©Œibu‹_pu»__
;

166 
	$wc¢cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©Œibu‹_pu»__
;

168 
__END_NAMESPACE_STD


170 #ifdeà
__USE_XOPEN2K8


172 
	$wcsÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

175 
	$wc¢ÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

176 
size_t
 
__n
è
__THROW
;

180 
	~<xloÿË.h
>

182 
	$wcsÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

183 
__loÿË_t
 
__loc
è
__THROW
;

185 
	$wc¢ÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

186 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscŞl
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

196 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

197 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifdeà
__USE_XOPEN2K8


206 
	$wcscŞl_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

207 
__loÿË_t
 
__loc
è
__THROW
;

212 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

213 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

216 
wch¬_t
 *
	$wcsdup
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

224 "C++" cÚ¡ 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

227 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

228 
__THROW
 
__©Œibu‹_pu»__
;

231 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

233 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

234 "C++" cÚ¡ 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

235 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

237 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

238 
__THROW
 
__©Œibu‹_pu»__
;

240 
__END_NAMESPACE_STD


242 #ifdeà
__USE_GNU


245 
wch¬_t
 *
	$wcschºul
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

246 
__THROW
 
__©Œibu‹_pu»__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__»jeù
)

253 
__THROW
 
__©Œibu‹_pu»__
;

256 
size_t
 
	$wcs¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

257 
__THROW
 
__©Œibu‹_pu»__
;

259 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

261 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

262 "C++" cÚ¡ 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
,

263 cÚ¡ 
wch¬_t
 *
__acû±
)

264 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

266 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

267 
__THROW
 
__©Œibu‹_pu»__
;

270 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

272 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

273 "C++" cÚ¡ 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

274 cÚ¡ 
wch¬_t
 *
__ÃedË
)

275 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

277 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

278 
__THROW
 
__©Œibu‹_pu»__
;

282 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

283 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__d–im
,

284 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

287 
size_t
 
	$wc¦’
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

288 
__END_NAMESPACE_STD


290 #ifdeà
__USE_XOPEN


292 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

294 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

295 "C++" cÚ¡ 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

296 cÚ¡ 
wch¬_t
 *
__ÃedË
)

297 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

299 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

300 
__THROW
 
__©Œibu‹_pu»__
;

304 #ifdeà
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Ën
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

307 
__THROW
 
__©Œibu‹_pu»__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

316 "C++" cÚ¡ 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

320 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©Œibu‹_pu»__
;

325 
	$wmemcmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©Œibu‹_pu»__
;

329 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

330 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

334 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifdeà
__USE_GNU


344 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

345 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

357 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

361 
	$mbsš™
 (cÚ¡ 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

365 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

366 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

367 
mb¡©e_t
 *
__»¡riù
 
__p
è
__THROW
;

370 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

371 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

374 
size_t
 
	$__mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

375 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

376 
size_t
 
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

377 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifdeà
__USE_EXTERN_INLINES


386 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

387 
__ex‹º_šlše
 
wšt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

392 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

393 
__ex‹º_šlše
 

394 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

395 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

396 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

398 
__ex‹º_šlše
 
size_t


399 
__NTH
 (
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

400 
mb¡©e_t
 *
__»¡riù
 
__ps
))

401 {  (
__ps
 !ğ
NULL


402 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

409 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

410 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

414 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

415 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

416 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

424 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

425 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

429 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

430 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

431 
size_t
 
__nwc
, size_ˆ
__Ën
,

432 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

437 #ifdeà
__USE_XOPEN


439 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

443 
	$wcswidth
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc¡od
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

451 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifdeà
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc¡of
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

458 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

459 
	$wc¡Şd
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

460 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc¡Ş
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

469 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

473 
	$wc¡oul
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

474 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #ifdeà
__USE_ISOC99


479 
__BEGIN_NAMESPACE_C99


482 
__ex‹nsiÚ__


483 
	$wc¡Şl
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

484 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

485 
__THROW
;

489 
__ex‹nsiÚ__


490 
	$wc¡ouÎ
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

491 
wch¬_t
 **
__»¡riù
 
__’d±r
,

492 
__ba£
è
__THROW
;

493 
__END_NAMESPACE_C99


496 #ifdeà
__USE_GNU


499 
__ex‹nsiÚ__


500 
	$wc¡oq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

501 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

502 
__THROW
;

506 
__ex‹nsiÚ__


507 
	$wc¡ouq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

508 
wch¬_t
 **
__»¡riù
 
__’d±r
,

509 
__ba£
è
__THROW
;

512 #ifdeà
__USE_GNU


526 
	~<xloÿË.h
>

530 
	$wc¡Ş_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

531 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

532 
__loÿË_t
 
__loc
è
__THROW
;

534 
	$wc¡oul_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

535 
wch¬_t
 **
__»¡riù
 
__’d±r
,

536 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

538 
__ex‹nsiÚ__


539 
	$wc¡Şl_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

540 
wch¬_t
 **
__»¡riù
 
__’d±r
,

541 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

543 
__ex‹nsiÚ__


544 
	$wc¡ouÎ_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

545 
wch¬_t
 **
__»¡riù
 
__’d±r
,

546 
__ba£
, 
__loÿË_t
 
__loc
)

547 
__THROW
;

549 
	$wc¡od_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

550 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

551 
__THROW
;

553 
	$wc¡of_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

554 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

555 
__THROW
;

557 
	$wc¡Şd_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

558 
wch¬_t
 **
__»¡riù
 
__’d±r
,

559 
__loÿË_t
 
__loc
è
__THROW
;

563 #ifdeà
__USE_XOPEN2K8


566 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

567 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

571 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

572 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

583 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

594 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

595 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

601 
	`w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

604 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

605 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

606 
__THROW
 ;

612 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

613 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

614 
__gnuc_va_li¡
 
__¬g
)

620 
	`vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

621 
__gnuc_va_li¡
 
__¬g
)

625 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

626 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

627 
__gnuc_va_li¡
 
__¬g
)

628 
__THROW
 ;

635 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

636 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

642 
	`wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

645 
	$swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

646 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

647 
__THROW
 ;

649 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

650 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

651 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

652 #ifdeà
__REDIRECT


656 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

657 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

658 
__isoc99_fwsÿnf
)

660 
	`__REDIRECT
 (
wsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

661 
__isoc99_wsÿnf
)

663 
	`__REDIRECT_NTH
 (
swsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

664 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

665 ...), 
__isoc99_swsÿnf
)

668 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

669 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

670 
	`__isoc99_wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

671 
	$__isoc99_swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

672 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

673 
__THROW
;

674 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

675 
	#wsÿnf
 
__isoc99_wsÿnf


	)

676 
	#swsÿnf
 
__isoc99_swsÿnf


	)

680 
__END_NAMESPACE_STD


683 #ifdeà
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

690 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

691 
__gnuc_va_li¡
 
__¬g
)

697 
	`vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

698 
__gnuc_va_li¡
 
__¬g
)

701 
	$vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

702 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

703 
__gnuc_va_li¡
 
__¬g
)

704 
__THROW
 ;

706 #ià!
defšed
 
__USE_GNU
 \

707 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

708 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

709 #ifdeà
__REDIRECT


710 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

711 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

712 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

714 
	`__REDIRECT
 (
vwsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

715 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

717 
	`__REDIRECT_NTH
 (
vswsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

718 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

719 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

722 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

723 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

724 
__gnuc_va_li¡
 
__¬g
);

725 
	`__isoc99_vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

726 
__gnuc_va_li¡
 
__¬g
);

727 
	$__isoc99_vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

728 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

729 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

730 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

731 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

732 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

746 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

752 
wšt_t
 
	`g‘wch¬
 ();

759 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

760 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

766 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

774 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

775 
__FILE
 *
__»¡riù
 
__¡»am
);

781 
	`åutws
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

782 
__FILE
 *
__»¡riù
 
__¡»am
);

789 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

790 
__END_NAMESPACE_STD


793 #ifdeà
__USE_GNU


801 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

802 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

810 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

818 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

827 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

828 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

837 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

838 
__FILE
 *
__»¡riù
 
__¡»am
);

846 
	`åutws_uÆocked
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

847 
__FILE
 *
__»¡riù
 
__¡»am
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

856 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

857 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifdeà
__USE_GNU


861 
	~<xloÿË.h
>

865 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

866 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

867 cÚ¡ 
tm
 *
__»¡riù
 
__
,

868 
__loÿË_t
 
__loc
è
__THROW
;

877 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


878 
	#__Ãed_iswxxx


	)

879 
	~<wùy³.h
>

883 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


884 
	~<b™s/wch¬2.h
>

887 #ifdeà
__LDBL_COMPAT


888 
	~<b™s/wch¬-ldbl.h
>

891 
__END_DECLS


899 #undeà
__Ãed_mb¡©e_t


900 #undeà
__Ãed_wšt_t


	@/usr/include/linux/kernel.h

1 #iâdeà
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

4 
	~<lšux/sysšfo.h
>

9 
	#__ALIGN_KERNEL
(
x
, 
a
è
	`__ALIGN_KERNEL_MASK
(x, (
	`ty³of
(x))×è- 1)

	)

10 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
è(((xè+ (mask)è& ~(mask))

	)

	@/usr/include/wctype.h

23 #iâdeà
_WCTYPE_H


25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 #iâdeà
__Ãed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__Ãed_wšt_t


	)

33 
	~<wch¬.h
>

37 #iâdeà
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #undeà
__Ãed_iswxxx


46 #iâdeà
__iswxxx_defšed


47 
	#__iswxxx_defšed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	twùy³_t
;

53 
	g__END_NAMESPACE_C99


55 #iâdeà
_ISwb™


60 
	~<’dŸn.h
>

61 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


62 
	#_ISwb™
(
b™
è(1 << (b™))

	)

64 
	#_ISwb™
(
b™
) \

65 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (è((1UL << (
b™
)è>> 24))))

	)

73 
	m__ISwuµ”
 = 0,

74 
	m__ISwlow”
 = 1,

75 
	m__ISw®pha
 = 2,

76 
	m__ISwdig™
 = 3,

77 
	m__ISwxdig™
 = 4,

78 
	m__ISw¥aû
 = 5,

79 
	m__ISw´št
 = 6,

80 
	m__ISwg¿ph
 = 7,

81 
	m__ISwbÏnk
 = 8,

82 
	m__ISwúŒl
 = 9,

83 
	m__ISwpunù
 = 10,

84 
	m__ISw®num
 = 11,

86 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

87 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

88 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

89 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

90 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

91 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

92 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

93 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

94 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

95 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

96 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

97 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

117 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

120 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

124 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

128 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

133 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

136 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

141 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

146 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

151 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

156 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

161 #ifdeà
__USE_ISOC99


162 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

171 
wùy³_t
 
	$wùy³
 (cÚ¡ *
__´İ”ty
è
__THROW
;

175 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 cÚ¡ 
	t__št32_t
 *
	twù¿ns_t
;

187 
__END_NAMESPACE_C99


188 #ifdeà
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

197 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifdeà
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
wù¿ns_t
 
	$wù¿ns
 (cÚ¡ *
__´İ”ty
è
__THROW
;

221 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifdeà
__USE_XOPEN2K8


226 
	~<xloÿË.h
>

230 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

236 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

239 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

243 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

247 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

252 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

255 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

260 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

265 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

270 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

275 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

280 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

284 
wùy³_t
 
	$wùy³_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

285 
__THROW
;

289 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

290 
__THROW
;

298 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

301 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

305 
wù¿ns_t
 
	$wù¿ns_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

306 
__THROW
;

309 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

310 
__loÿË_t
 
__loÿË
è
__THROW
;

314 
__END_DECLS


	@/usr/include/linux/sysinfo.h

1 #iâdeà
_LINUX_SYSINFO_H


2 
	#_LINUX_SYSINFO_H


	)

4 
	~<lšux/ty³s.h
>

6 
	#SI_LOAD_SHIFT
 16

	)

7 
	ssysšfo
 {

8 
__k”Ãl_lÚg_t
 
	mu±ime
;

9 
__k”Ãl_ulÚg_t
 
	mlßds
[3];

10 
__k”Ãl_ulÚg_t
 
	mtÙ®¿m
;

11 
__k”Ãl_ulÚg_t
 
	mä“¿m
;

12 
__k”Ãl_ulÚg_t
 
	msh¬ed¿m
;

13 
__k”Ãl_ulÚg_t
 
	mbufã¼am
;

14 
__k”Ãl_ulÚg_t
 
	mtÙ®sw­
;

15 
__k”Ãl_ulÚg_t
 
	mä“sw­
;

16 
__u16
 
	m´ocs
;

17 
__u16
 
	m·d
;

18 
__k”Ãl_ulÚg_t
 
	mtÙ®high
;

19 
__k”Ãl_ulÚg_t
 
	mä“high
;

20 
__u32
 
	mmem_un™
;

21 
	m_f
[20-2*(
__k”Ãl_ulÚg_t
)-(
__u32
)];

	@
2
.
.
1
/usr/include
82
1832
SNAPSHOT.h
arping.c
clockdiff.c
in6_flowlabel.h
ping.c
ping6.c
ping6_niquery.h
ping_common.c
ping_common.h
rarpd.c
rdisc.c
tftp.h
tftpd.c
tftpsubs.c
tracepath.c
tracepath6.c
traceroute6.c
/usr/include/arpa/inet.h
/usr/include/ctype.h
/usr/include/dirent.h
/usr/include/endian.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/ifaddrs.h
/usr/include/linux/errqueue.h
/usr/include/linux/filter.h
/usr/include/linux/if.h
/usr/include/linux/if_arp.h
/usr/include/linux/if_ether.h
/usr/include/linux/if_packet.h
/usr/include/linux/limits.h
/usr/include/linux/route.h
/usr/include/linux/sockios.h
/usr/include/linux/types.h
/usr/include/locale.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/net/if.h
/usr/include/net/if_arp.h
/usr/include/netdb.h
/usr/include/netinet/icmp6.h
/usr/include/netinet/in.h
/usr/include/netinet/in_systm.h
/usr/include/netinet/ip.h
/usr/include/netinet/ip6.h
/usr/include/netinet/ip_icmp.h
/usr/include/netinet/udp.h
/usr/include/protocols/timed.h
/usr/include/resolv.h
/usr/include/sched.h
/usr/include/setjmp.h
/usr/include/signal.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/syslog.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/arpa/nameser.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/inttypes.h
/usr/include/libio.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/netdevice.h
/usr/include/linux/posix_types.h
/usr/include/linux/socket.h
/usr/include/rpc/netdb.h
/usr/include/stdint.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/arpa/nameser_compat.h
/usr/include/linux/if_link.h
/usr/include/linux/stddef.h
/usr/include/stdc-predef.h
/usr/include/gconv.h
/usr/include/linux/netlink.h
/usr/include/wchar.h
/usr/include/linux/kernel.h
/usr/include/wctype.h
/usr/include/linux/sysinfo.h
